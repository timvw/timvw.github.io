<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Enable and disable TabPages on a TabControl - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Enable and disable TabPages on a TabControl">
<meta itemprop="description" content="Apparently Microsoft choose not to implement support for disabled TabPages. The reason seems to be that it&rsquo;s against their Guidelines for Tabs. Let&rsquo;s ignore the guideline and implement the support anyway. First we set the DrawMode property of the TabControl to OwnerDrawFixed. Next we add an eventhandler for the DrawItem Event
private void tabControl1_DrawItem(object sender, DrawItemEventArgs e) { TabControl tabControl = sender as TabControl; TabPage tabPage = tabControl.TabPages[e.Index]; Rectangle tabRectangle = tabControl.">
<meta itemprop="datePublished" content="2007-01-06T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-04T14:52:31+01:00" />
<meta itemprop="wordCount" content="309">



<meta itemprop="keywords" content="C#,Windows Forms," />
<meta property="og:title" content="Enable and disable TabPages on a TabControl" />
<meta property="og:description" content="Apparently Microsoft choose not to implement support for disabled TabPages. The reason seems to be that it&rsquo;s against their Guidelines for Tabs. Let&rsquo;s ignore the guideline and implement the support anyway. First we set the DrawMode property of the TabControl to OwnerDrawFixed. Next we add an eventhandler for the DrawItem Event
private void tabControl1_DrawItem(object sender, DrawItemEventArgs e) { TabControl tabControl = sender as TabControl; TabPage tabPage = tabControl.TabPages[e.Index]; Rectangle tabRectangle = tabControl." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/2007-01-06-enable-and-disable-tabpages-on-a-tabcontrol/" />
<meta property="article:published_time" content="2007-01-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-04T14:52:31+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Enable and disable TabPages on a TabControl"/>
<meta name="twitter:description" content="Apparently Microsoft choose not to implement support for disabled TabPages. The reason seems to be that it&rsquo;s against their Guidelines for Tabs. Let&rsquo;s ignore the guideline and implement the support anyway. First we set the DrawMode property of the TabControl to OwnerDrawFixed. Next we add an eventhandler for the DrawItem Event
private void tabControl1_DrawItem(object sender, DrawItemEventArgs e) { TabControl tabControl = sender as TabControl; TabPage tabPage = tabControl.TabPages[e.Index]; Rectangle tabRectangle = tabControl."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="">Tim Van Wassenhove</a></h1>
	<div class="site-description"><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../post">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">06</span>
							<span class="rest">Jan 2007</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Enable and disable TabPages on a TabControl</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p><img src="http://www.timvw.be/wp-content/images/disabled-tabcontrol-1.gif" alt="screenshot of tabcontrol with disabled tabpages"></p>
<p><img src="http://www.timvw.be/wp-content/images/disabled-tabcontrol-2.gif" alt="screenshot of tabcontrol with disabled tabpages"></p>
<p>Apparently <a href="http://www.microsoft.com">Microsoft</a> choose not to implement support for disabled <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabpage.aspx">TabPage</a>s. The reason seems to be that it&rsquo;s against their <a href="http://msdn2.microsoft.com/en-us/library/aa511493.aspx">Guidelines for Tabs</a>. Let&rsquo;s ignore the guideline and implement the support anyway. First we set the <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.drawmode.aspx">DrawMode</a> property of the <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.aspx">TabControl</a> to <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabdrawmode.aspx">OwnerDrawFixed</a>. Next we add an eventhandler for the <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.drawitem.aspx">DrawItem</a> Event</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">void</span> tabControl1_DrawItem(<span style="color:#458;font-weight:bold">object</span> sender, DrawItemEventArgs e)
{
	TabControl tabControl = sender <span style="color:#000;font-weight:bold">as</span> TabControl;
	TabPage tabPage = tabControl.TabPages[e.Index];
	Rectangle tabRectangle = tabControl.GetTabRect(e.Index);

	<span style="color:#000;font-weight:bold">if</span> (tabControl.Alignment == TabAlignment.Left || tabControl.Alignment == TabAlignment.Right)
	{
		<span style="color:#458;font-weight:bold">float</span> rotateAngle = <span style="color:#099">90</span>;
		<span style="color:#000;font-weight:bold">if</span> (tabControl.Alignment == TabAlignment.Left)
		{
			rotateAngle = <span style="color:#099">270</span>;
		}

		PointF cp = <span style="color:#000;font-weight:bold">new</span> PointF(tabRectangle.Left + (tabRectangle.Width / <span style="color:#099">2</span>), tabRectangle.Top + (tabRectangle.Height / <span style="color:#099">2</span>));
		e.Graphics.TranslateTransform(cp.X, cp.Y);
		e.Graphics.RotateTransform(rotateAngle);
		tabRectangle = <span style="color:#000;font-weight:bold">new</span> Rectangle(-(tabRectangle.Height / <span style="color:#099">2</span>), -(tabRectangle.Width / <span style="color:#099">2</span>), tabRectangle.Height, tabRectangle.Width);
	}

	<span style="color:#000;font-weight:bold">using</span> (SolidBrush foreBrush = <span style="color:#000;font-weight:bold">new</span> SolidBrush(tabPage.ForeColor))
	{
		<span style="color:#000;font-weight:bold">using</span> (SolidBrush backBrush = <span style="color:#000;font-weight:bold">new</span> SolidBrush(tabPage.BackColor))
		{
			<span style="color:#000;font-weight:bold">if</span> (!tabPage.Enabled)
			{
				foreBrush.Color = SystemColors.GrayText;
			}

			e.Graphics.FillRectangle(backBrush, tabRectangle);

			<span style="color:#000;font-weight:bold">using</span> (StringFormat stringFormat = <span style="color:#000;font-weight:bold">new</span> StringFormat())
			{
				stringFormat.Alignment = StringAlignment.Center;
				stringFormat.LineAlignment = StringAlignment.Center;
				e.Graphics.DrawString(tabPage.Text, e.Font, foreBrush, tabRectangle, stringFormat);
			}
		}
	}

	e.Graphics.ResetTransform();
}
</code></pre></div><p>And we handle the <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.selecting.aspx">Selecting</a> Event as following</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">void</span> tabControl1_Selecting(<span style="color:#458;font-weight:bold">object</span> sender, TabControlCancelEventArgs e)
{
	<span style="color:#000;font-weight:bold">if</span> (!e.TabPage.Enabled)
	{
		e.Cancel = <span style="color:#000;font-weight:bold">true</span>;
	}
}
</code></pre></div><p>This works pretty fine, but we still have to make sure that the TabPages are Invalidated when the users changes their <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.enabled.aspx">Enabled</a> property. We do this by attaching and detaching an eventhandler for their <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.enabledchanged.aspx">EnabledChanged</a> Event when they&rsquo;re <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.controladded.aspx">added</a> and <a href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.controlremoved.aspx">removed</a>.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">void</span> tabControl1_ControlAdded(<span style="color:#458;font-weight:bold">object</span> sender, ControlEventArgs e)
{
	TabPage tabPage = sender <span style="color:#000;font-weight:bold">as</span> TabPage;
	<span style="color:#000;font-weight:bold">if</span> (tabPage != <span style="color:#000;font-weight:bold">null</span>)
	{
		tabPage.EnabledChanged += <span style="color:#000;font-weight:bold">new</span> EventHandler(<span style="color:#000;font-weight:bold">this</span>.tabPage_EnabledChanged);
	}
}

<span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">void</span> tabControl1_ControlRemoved(<span style="color:#458;font-weight:bold">object</span> sender, ControlEventArgs e)
{
	TabPage tabPage = sender <span style="color:#000;font-weight:bold">as</span> TabPage;
	<span style="color:#000;font-weight:bold">if</span> (tabPage != <span style="color:#000;font-weight:bold">null</span>)
	{
		tabPage.EnabledChanged -= <span style="color:#000;font-weight:bold">new</span> EventHandler(<span style="color:#000;font-weight:bold">this</span>.tabPage_EnabledChanged);
	}
}

<span style="color:#000;font-weight:bold">void</span> tabPage_EnabledChanged(<span style="color:#458;font-weight:bold">object</span> sender, EventArgs e)
{
	TabPage tabPage = sender <span style="color:#000;font-weight:bold">as</span> TabPage;
	TabControl tabControl = tabPage.Parent <span style="color:#000;font-weight:bold">as</span> TabControl;
	tabControl.Invalidate(tabPage.ClientRectangle);
}
</code></pre></div><p>Feel free to download the demo application: <a href="http://www.timvw.be/wp-content/code/csharp/DisabledTabControl.zip">DisabledTabControl.zip</a>.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../tags/C">C#</a></li>
							
							<li><a href="../../tags/Windows-Forms">Windows Forms</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
