<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Exploring DataGridViewComboBoxColumn databinding - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Exploring DataGridViewComboBoxColumn databinding">
<meta itemprop="description" content="Let&rsquo;s start with a simple example: Each Person has a Name (string) and PersonTypeCode (an Enumerated value) property. We drag a DataGridView on the designer form and add two columns (DataGridViewComboBoxColumn for the PersonTypeCode property). And then we hook up the Bindingsource as following
class Form1 : Form { public Form1() { InitializeComponent(); this.dataGridView1.AutoGenerateColumns = false; this.ColumnName.DataPropertyName = &#34;Name&#34;; this.ColumnPersonTypeCode.DataPropertyName = &#34;PersonTypeCode&#34;; BindingSource bindingSource = new BindingSource(); bindingSource.DataSource = FindPersons(); this.">
<meta itemprop="datePublished" content="2007-01-17T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-04T14:52:31+01:00" />
<meta itemprop="wordCount" content="1058">



<meta itemprop="keywords" content="C#,Windows Forms," />
<meta property="og:title" content="Exploring DataGridViewComboBoxColumn databinding" />
<meta property="og:description" content="Let&rsquo;s start with a simple example: Each Person has a Name (string) and PersonTypeCode (an Enumerated value) property. We drag a DataGridView on the designer form and add two columns (DataGridViewComboBoxColumn for the PersonTypeCode property). And then we hook up the Bindingsource as following
class Form1 : Form { public Form1() { InitializeComponent(); this.dataGridView1.AutoGenerateColumns = false; this.ColumnName.DataPropertyName = &#34;Name&#34;; this.ColumnPersonTypeCode.DataPropertyName = &#34;PersonTypeCode&#34;; BindingSource bindingSource = new BindingSource(); bindingSource.DataSource = FindPersons(); this." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/2007-01-17-exploring-datagridviewcomboboxcolumn-databinding/" />
<meta property="article:published_time" content="2007-01-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-04T14:52:31+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Exploring DataGridViewComboBoxColumn databinding"/>
<meta name="twitter:description" content="Let&rsquo;s start with a simple example: Each Person has a Name (string) and PersonTypeCode (an Enumerated value) property. We drag a DataGridView on the designer form and add two columns (DataGridViewComboBoxColumn for the PersonTypeCode property). And then we hook up the Bindingsource as following
class Form1 : Form { public Form1() { InitializeComponent(); this.dataGridView1.AutoGenerateColumns = false; this.ColumnName.DataPropertyName = &#34;Name&#34;; this.ColumnPersonTypeCode.DataPropertyName = &#34;PersonTypeCode&#34;; BindingSource bindingSource = new BindingSource(); bindingSource.DataSource = FindPersons(); this."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="">Tim Van Wassenhove</a></h1>
	<div class="site-description"><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../post">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">17</span>
							<span class="rest">Jan 2007</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Exploring DataGridViewComboBoxColumn databinding</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Let&rsquo;s start with a simple example: Each Person has a Name (string) and PersonTypeCode (an Enumerated value) property. We drag a DataGridView on the designer form and add two columns (DataGridViewComboBoxColumn for the PersonTypeCode property). And then we hook up the Bindingsource as following</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Form1</span> : Form
{
	<span style="color:#000;font-weight:bold">public</span> Form1()
	{
		InitializeComponent();

		<span style="color:#000;font-weight:bold">this</span>.dataGridView1.AutoGenerateColumns = <span style="color:#000;font-weight:bold">false</span>;
		<span style="color:#000;font-weight:bold">this</span>.ColumnName.DataPropertyName = <span style="color:#d14">&#34;Name&#34;</span>;
		<span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.DataPropertyName = <span style="color:#d14">&#34;PersonTypeCode&#34;</span>;

		BindingSource bindingSource = <span style="color:#000;font-weight:bold">new</span> BindingSource();
		bindingSource.DataSource = FindPersons();
		<span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource = bindingSource;
	}

	<span style="color:#000;font-weight:bold">private</span> BindingList&lt;person&gt; FindPersons()
	{
		BindingList&lt;person&gt; bindingList = <span style="color:#000;font-weight:bold">new</span> BindingList&lt;person&gt;();
		bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;Timvw&#34;</span>, PersonTypeCode.Geek));
		bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;John Doe&#34;</span>, PersonTypeCode.Anonymous));
		bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;An Onymous&#34;</span>, PersonTypeCode.Anonymous));
		bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;Jenna Jameson&#34;</span>, PersonTypeCode.Babe));
		<span style="color:#000;font-weight:bold">return</span> bindingList;
	}
}

<span style="color:#000;font-weight:bold">enum</span> PersonTypeCode
{
	Geek = <span style="color:#099">0</span>,
	Anonymous = <span style="color:#099">1</span>,
	Babe = <span style="color:#099">2</span>
}

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Person</span>
{
	<span style="color:#000;font-weight:bold">private</span> PersonTypeCode personTypeCode;
	<span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">string</span> name;

	<span style="color:#000;font-weight:bold">public</span> Person(<span style="color:#458;font-weight:bold">string</span> name, PersonTypeCode personTypeCode)
	{
		<span style="color:#000;font-weight:bold">this</span>.name = name;
		<span style="color:#000;font-weight:bold">this</span>.personTypeCode = personTypeCode;
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">string</span> Name
	{
		<span style="color:#000;font-weight:bold">get</span> { <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span>.name; }
		<span style="color:#000;font-weight:bold">set</span> { <span style="color:#000;font-weight:bold">this</span>.name = <span style="color:#000;font-weight:bold">value</span>; }
	}

	<span style="color:#000;font-weight:bold">public</span> PersonTypeCode PersonTypeCode
	{
		<span style="color:#000;font-weight:bold">get</span> { <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span>.personTypeCode; }
		<span style="color:#000;font-weight:bold">set</span> { <span style="color:#000;font-weight:bold">this</span>.personTypeCode = <span style="color:#000;font-weight:bold">value</span>; }
	}
}
</code></pre></div><p>If we run this code we run in the following error:</p>
<p><img src="http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-1.gif" alt="DataGridViewComboBoxCell value is not valid."></p>
<p>Always make sure the DataGridViewComboxColumn knows about all the possible values (<a href="http://www.timvw.be/implementing-masterdetail-for-custom-objects-with-datagridviewcomboboxcolumns/">Add them via the Items property</a> or use databinding). Let&rsquo;s extend our Form1 class as following:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> Form1()
{
InitializeComponent();

<span style="color:#000;font-weight:bold">this</span>.dataGridView1.AutoGenerateColumns = <span style="color:#000;font-weight:bold">false</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnName.DataPropertyName = <span style="color:#d14">&#34;Name&#34;</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.DataPropertyName = <span style="color:#d14">&#34;PersonTypeCode&#34;</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.DataSource = FindPersonTypeCodes();

BindingSource bindingSource = <span style="color:#000;font-weight:bold">new</span> BindingSource();
bindingSource.DataSource = FindPersons();
<span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource = bindingSource;
}

<span style="color:#000;font-weight:bold">private</span> BindingList&lt;personTypeCode&gt; FindPersonTypeCodes()
{
BindingList&lt;personTypeCode&gt; bindingList = <span style="color:#000;font-weight:bold">new</span> BindingList&lt;personTypeCode&gt;();
<span style="color:#000;font-weight:bold">foreach</span> (PersonTypeCode personTypeCode <span style="color:#000;font-weight:bold">in</span> Enum.GetValues(<span style="color:#000;font-weight:bold">typeof</span>(PersonTypeCode)))
{
bindingList.Add(personTypeCode);
}
<span style="color:#000;font-weight:bold">return</span> bindingList;
}
</code></pre></div><p>Allright, here is a screenshot of our first working version:</p>
<p><img src="http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-2.gif" alt="datagridviewcomboboxcolumn with enumerated values"></p>
<p>Instead of displaying the bare enum values we want to display a nice label. In order to achieve this we define a class PersonType to hold both the PersonTypeCode and the label:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">PersonType</span>
{
<span style="color:#000;font-weight:bold">private</span> PersonTypeCode personTypeCode;
<span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">string</span> label;

<span style="color:#000;font-weight:bold">public</span> PersonType(<span style="color:#458;font-weight:bold">string</span> label, PersonTypeCode personTypeCode)
{
<span style="color:#000;font-weight:bold">this</span>.label = label;
<span style="color:#000;font-weight:bold">this</span>.personTypeCode = personTypeCode;
}

<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">string</span> Label
{
<span style="color:#000;font-weight:bold">get</span> { <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span>.label; }
<span style="color:#000;font-weight:bold">set</span> { <span style="color:#000;font-weight:bold">this</span>.label = <span style="color:#000;font-weight:bold">value</span>; }
}

<span style="color:#000;font-weight:bold">public</span> PersonTypeCode PersonTypeCode
{
<span style="color:#000;font-weight:bold">get</span> { <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span>.personTypeCode; }
<span style="color:#000;font-weight:bold">set</span> { <span style="color:#000;font-weight:bold">this</span>.personTypeCode = <span style="color:#000;font-weight:bold">value</span>; }
}
}
</code></pre></div><p>We modify our code so that this new PersonType class is used for the ComboBoxColumn:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> Form1()
{
InitializeComponent();

<span style="color:#000;font-weight:bold">this</span>.dataGridView1.AutoGenerateColumns = <span style="color:#000;font-weight:bold">false</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnName.DataPropertyName = <span style="color:#d14">&#34;Name&#34;</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.DataPropertyName = <span style="color:#d14">&#34;PersonTypeCode&#34;</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.DisplayMember = <span style="color:#d14">&#34;Label&#34;</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.ValueMember = <span style="color:#d14">&#34;PersonTypeCode&#34;</span>;
<span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.DataSource = FindPersonTypes();

BindingSource bindingSource = <span style="color:#000;font-weight:bold">new</span> BindingSource();
bindingSource.DataSource = FindPersons();
<span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource = bindingSource;
}

<span style="color:#000;font-weight:bold">private</span> BindingList&lt;personType&gt; FindPersonTypes()
{
BindingList&lt;personType&gt; bindingList = <span style="color:#000;font-weight:bold">new</span> BindingList&lt;personType&gt;();
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> PersonType(<span style="color:#d14">&#34;A geeky person&#34;</span>, PersonTypeCode.Geek));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> PersonType(<span style="color:#d14">&#34;A coward&#34;</span>, PersonTypeCode.Anonymous));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> PersonType(<span style="color:#d14">&#34;Feeling hot hot hot&#34;</span>, PersonTypeCode.Babe));
<span style="color:#000;font-weight:bold">return</span> bindingList;
}
</code></pre></div><p><img src="http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-3.gif" alt="datagridviewcomboboxcolumn with nice labels."></p>
<p>Great! Now we&rsquo;ll add some functionality that limits the possible values in the ComboBoxColumn basesd on the Name (I already demonstrated this technique <a href="http://www.timvw.be/implementing-masterdetail-for-custom-objects-with-datagridviewcomboboxcolumns/">here</a>). Simply handle the EditingControlShowing Event on the DataGridView as following:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">void</span> dataGridView1_EditingControlShowing(<span style="color:#458;font-weight:bold">object</span> sender, DataGridViewEditingControlShowingEventArgs e)
{
BindingSource bindingSource = <span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource <span style="color:#000;font-weight:bold">as</span> BindingSource;
Person person = bindingSource.Current <span style="color:#000;font-weight:bold">as</span> Person;
BindingList&lt;personType&gt; bindingList = <span style="color:#000;font-weight:bold">this</span>.FindPersonTypes(person);

DataGridViewComboBoxEditingControl comboBox = e.Control <span style="color:#000;font-weight:bold">as</span> DataGridViewComboBoxEditingControl;
comboBox.DataSource = bindingList;
}

<span style="color:#000;font-weight:bold">private</span> BindingList&lt;personType&gt; FindPersonTypes(Person person)
{
<span style="color:#998;font-style:italic">// by default, all persons simply have one of the available persontypecodes
</span><span style="color:#998;font-style:italic"></span>BindingList&lt;personType&gt; bindingList = FindPersonTypes();

<span style="color:#000;font-weight:bold">if</span> (person.PersonTypeCode == PersonTypeCode.Geek)
{
<span style="color:#998;font-style:italic">// geeks are doomed to stay geeks
</span><span style="color:#998;font-style:italic"></span>bindingList.RemoveAt(<span style="color:#099">2</span>);
bindingList.RemoveAt(<span style="color:#099">1</span>);
}

<span style="color:#000;font-weight:bold">return</span> bindingList;
}
</code></pre></div><p>If you open the combox for &ldquo;Timvw&rdquo; you see that you can only choose &ldquo;A geeky person&rdquo;:</p>
<p><img src="http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-4.gif" alt="datagridviewcomboboxcolumn with limited options."></p>
<p>Instead of using an enum we could have used a regular class too. The key is to override the Equals method:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">PersonTypeCode</span>
{
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> PersonTypeCode Geek
{
<span style="color:#000;font-weight:bold">get</span> { <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> PersonTypeCode(<span style="color:#099">0</span>); }
}

<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> PersonTypeCode Anonymous
{
<span style="color:#000;font-weight:bold">get</span> { <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> PersonTypeCode(<span style="color:#099">1</span>); }
}

<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> PersonTypeCode Babe
{
<span style="color:#000;font-weight:bold">get</span> { <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> PersonTypeCode(<span style="color:#099">2</span>); }
}

<span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">int</span> id;

<span style="color:#000;font-weight:bold">public</span> PersonTypeCode(<span style="color:#458;font-weight:bold">int</span> id)
{
<span style="color:#000;font-weight:bold">this</span>.id = id;
}

<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">override</span> <span style="color:#458;font-weight:bold">bool</span> Equals(<span style="color:#458;font-weight:bold">object</span> obj)
{
<span style="color:#000;font-weight:bold">if</span> (obj == <span style="color:#000;font-weight:bold">null</span>) <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">false</span>;
<span style="color:#000;font-weight:bold">if</span> (obj == <span style="color:#000;font-weight:bold">this</span>) <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">true</span>;
PersonTypeCode personTypeCode = obj <span style="color:#000;font-weight:bold">as</span> PersonTypeCode;
<span style="color:#000;font-weight:bold">if</span> (personTypeCode == <span style="color:#000;font-weight:bold">null</span>) <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">false</span>;
<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span>.id == personTypeCode.id;
}

<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">override</span> <span style="color:#458;font-weight:bold">int</span> GetHashCode()
{
<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span>.id.GetHashCode();
}
}

<span style="color:#000;font-weight:bold">private</span> BindingList&lt;personType&gt; FindPersonTypes(Person person)
{
<span style="color:#998;font-style:italic">// by default, all persons simply have one of the available persontypecodes
</span><span style="color:#998;font-style:italic"></span>BindingList&lt;personType&gt; bindingList = FindPersonTypes();

<span style="color:#998;font-style:italic">//if (person.PersonTypeCode == PersonTypeCode.Geek)
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">if</span> (person.PersonTypeCode.Equals(PersonTypeCode.Geek))
{
<span style="color:#998;font-style:italic">// geeks are doomed to stay geeks
</span><span style="color:#998;font-style:italic"></span>bindingList.RemoveAt(<span style="color:#099">2</span>);
bindingList.RemoveAt(<span style="color:#099">1</span>);
}

<span style="color:#000;font-weight:bold">return</span> bindingList;
}
</code></pre></div><p>And now you&rsquo;re thinking: But i want the user to not select a PersonTypeCode (null). We&rsquo;ll represent that with an empty string &ldquo;&quot;:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">private</span> BindingList&lt;person&gt; FindPersons()
{
BindingList&lt;person&gt; bindingList = <span style="color:#000;font-weight:bold">new</span> BindingList&lt;person&gt;();
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;Timvw&#34;</span>, PersonTypeCode.Geek));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;John Doe&#34;</span>, PersonTypeCode.Anonymous));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;An Onymous&#34;</span>, PersonTypeCode.Anonymous));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;Jenna Jameson&#34;</span>, PersonTypeCode.Babe));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;Null Able&#34;</span>, <span style="color:#000;font-weight:bold">null</span>));
<span style="color:#000;font-weight:bold">return</span> bindingList;
}

<span style="color:#000;font-weight:bold">private</span> BindingList&lt;personType&gt; FindPersonTypes()
{
BindingList&lt;personType&gt; bindingList = <span style="color:#000;font-weight:bold">new</span> BindingList&lt;personType&gt;();
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> PersonType(<span style="color:#d14">&#34;A geeky person&#34;</span>, PersonTypeCode.Geek));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> PersonType(<span style="color:#d14">&#34;A coward&#34;</span>, PersonTypeCode.Anonymous));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> PersonType(<span style="color:#d14">&#34;Feeling hot hot hot&#34;</span>, PersonTypeCode.Babe));
bindingList.Add(<span style="color:#000;font-weight:bold">new</span> PersonType(<span style="color:#458;font-weight:bold">string</span>.Empty, <span style="color:#000;font-weight:bold">null</span>));
<span style="color:#000;font-weight:bold">return</span> bindingList;
}

<span style="color:#000;font-weight:bold">private</span> BindingList&lt;personType&gt; FindPersonTypes(Person person)
{
<span style="color:#998;font-style:italic">// by default, all persons simply have one of the available persontypecodes
</span><span style="color:#998;font-style:italic"></span>BindingList&lt;personType&gt; bindingList = FindPersonTypes();

<span style="color:#000;font-weight:bold">if</span> (person.PersonTypeCode != <span style="color:#000;font-weight:bold">null</span> &amp;&amp; person.PersonTypeCode.Equals(PersonTypeCode.Geek))
{
<span style="color:#998;font-style:italic">// geeks are doomed to stay geeks
</span><span style="color:#998;font-style:italic"></span>bindingList.RemoveAt(<span style="color:#099">2</span>);
bindingList.RemoveAt(<span style="color:#099">1</span>);
}

<span style="color:#000;font-weight:bold">return</span> bindingList;
}
</code></pre></div><p><img src="http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-5.gif" alt="datagridviewcomboboxcolumn with null option."></p>
<p>When the user starts editing the record, the combobox will choose the first item in the list (A geeky person). Now we change this behaviour so that the actual PersonTypeCode is selected:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">void</span> dataGridView1_EditingControlShowing(<span style="color:#458;font-weight:bold">object</span> sender, DataGridViewEditingControlShowingEventArgs e)
{
<span style="color:#000;font-weight:bold">if</span> (<span style="color:#000;font-weight:bold">this</span>.dataGridView1.CurrentCell.ColumnIndex == <span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.Index)
{
BindingSource bindingSource = <span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource <span style="color:#000;font-weight:bold">as</span> BindingSource;
Person person = bindingSource.Current <span style="color:#000;font-weight:bold">as</span> Person;
BindingList&lt;personType&gt; bindingList = <span style="color:#000;font-weight:bold">this</span>.FindPersonTypes(person);

DataGridViewComboBoxEditingControl comboBox = e.Control <span style="color:#000;font-weight:bold">as</span> DataGridViewComboBoxEditingControl;
comboBox.DataSource = bindingList;
<span style="color:#000;font-weight:bold">if</span> (person.PersonTypeCode != <span style="color:#000;font-weight:bold">null</span>)
{
comboBox.SelectedValue = person.PersonTypeCode;
}
<span style="color:#000;font-weight:bold">else</span>
{
comboBox.SelectedValue = <span style="color:#458;font-weight:bold">string</span>.Empty;
}
}
}
</code></pre></div><p><img src="http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-6.gif" alt="datagridviewcomboboxcolumn with selected item."></p>
<p>In order to make the DataGridView more usable we set the EditMode property to EditOnEnter. Selected values in the ComboBox are only commited when the user leaves the current cell. Handling the SelectionChangeCommited event on the ComboBox allows us to commit that value without requiring the user to leave the current cell:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">void</span> dataGridView1_EditingControlShowing(<span style="color:#458;font-weight:bold">object</span> sender, DataGridViewEditingControlShowingEventArgs e)
{
<span style="color:#000;font-weight:bold">if</span> (<span style="color:#000;font-weight:bold">this</span>.dataGridView1.CurrentCell.ColumnIndex == <span style="color:#000;font-weight:bold">this</span>.ColumnPersonTypeCode.Index)
{
BindingSource bindingSource = <span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource <span style="color:#000;font-weight:bold">as</span> BindingSource;
Person person = bindingSource.Current <span style="color:#000;font-weight:bold">as</span> Person;
BindingList&lt;personType&gt; bindingList = <span style="color:#000;font-weight:bold">this</span>.FindPersonTypes(person);

DataGridViewComboBoxEditingControl comboBox = e.Control <span style="color:#000;font-weight:bold">as</span> DataGridViewComboBoxEditingControl;
comboBox.DataSource = bindingList;
<span style="color:#000;font-weight:bold">if</span> (person.PersonTypeCode != <span style="color:#000;font-weight:bold">null</span>)
{
comboBox.SelectedValue = person.PersonTypeCode;
}
<span style="color:#000;font-weight:bold">else</span>
{
comboBox.SelectedValue = <span style="color:#458;font-weight:bold">string</span>.Empty;
}

comboBox.SelectionChangeCommitted -= <span style="color:#000;font-weight:bold">this</span>.comboBox_SelectionChangeCommitted;
comboBox.SelectionChangeCommitted += <span style="color:#000;font-weight:bold">this</span>.comboBox_SelectionChangeCommitted;
}
}

<span style="color:#000;font-weight:bold">void</span> comboBox_SelectionChangeCommitted(<span style="color:#458;font-weight:bold">object</span> sender, EventArgs e)
{
<span style="color:#000;font-weight:bold">this</span>.dataGridView1.EndEdit();
}
</code></pre></div><p>Now it&rsquo;s up to you to apply these simple techniques and build great software. Feel free to download the complete source: <a href="http://www.timvw.be/wp-content/code/csharp/DataGridViewComboBoxBinding.zip">DataGridViewComboBoxBinding.zip</a>.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../tags/C">C#</a></li>
							
							<li><a href="../../tags/Windows-Forms">Windows Forms</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
