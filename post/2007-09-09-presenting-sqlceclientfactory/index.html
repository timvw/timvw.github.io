<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Presenting SqlCeClientFactory - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Presenting SqlCeClientFactory">
<meta itemprop="description" content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it.">
<meta itemprop="datePublished" content="2007-09-09T00:00:00+00:00" />
<meta itemprop="dateModified" content="2007-09-09T00:00:00+00:00" />
<meta itemprop="wordCount" content="213">



<meta itemprop="keywords" content="C#," />
<meta property="og:title" content="Presenting SqlCeClientFactory" />
<meta property="og:description" content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/2007-09-09-presenting-sqlceclientfactory/" />
<meta property="article:published_time" content="2007-09-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2007-09-09T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Presenting SqlCeClientFactory"/>
<meta name="twitter:description" content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="">Tim Van Wassenhove</a></h1>
	<div class="site-description"><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li></ul>
		</nav></div>

	<nav class="nav">
		<ul class="flat">
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">09</span>
							<span class="rest">Sep 2007</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Presenting SqlCeClientFactory</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SqlCeClientFactory</span> : DbProviderFactory
{
	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> SqlCeClientFactory Instance = <span style="color:#66d9ef">new</span> SqlCeClientFactory();

	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> DbCommand CreateCommand()
	{
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> SqlCeCommand();
	}

	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> DbCommandBuilder CreateCommandBuilder()
	{
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> SqlCeCommandBuilder();
	}

	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> DbConnection CreateConnection()
	{
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> SqlCeConnection();
	}

	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> DbDataAdapter CreateDataAdapter()
	{
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> SqlCeDataAdapter();
	}

	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> DbParameter CreateParameter()
	{
		<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> SqlCeParameter();
	}
}
</code></pre></div><p>As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it. Anyway, here is how our App.config would look like if we wanted to register and use the SqlCeClientFactory (we could also install the assembly in the GAC and edit machine.config so that all applications can take advantage of it)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#f92672">&lt;configuration&gt;</span>
	<span style="color:#f92672">&lt;connectionStrings&gt;</span>
		<span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;localdb&#34;</span> <span style="color:#a6e22e">providerName=</span><span style="color:#e6db74">&#34;System.Data.SqlServerCe&#34;</span> <span style="color:#a6e22e">connectionString=</span><span style="color:#e6db74">&#34;Data Source=&#39;localdb.sdf&#39;;&#34;</span><span style="color:#f92672">/&gt;</span>
	<span style="color:#f92672">&lt;/connectionStrings&gt;</span>
	<span style="color:#f92672">&lt;system.data&gt;</span>
		<span style="color:#f92672">&lt;dbProviderFactories&gt;</span>
			<span style="color:#f92672">&lt;add</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;SQL Server Everywhere Edition Data Provider&#34;</span> <span style="color:#a6e22e">invariant=</span><span style="color:#e6db74">&#34;System.Data.SqlServerCe&#34;</span> <span style="color:#a6e22e">description=</span><span style="color:#e6db74">&#34;.NET Framework Data Provider for Microsoft SQL Server Everywhere Edition&#34;</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;SqlCeApplication.SqlCeClientFactory, SqlCeApplication&#34;</span> <span style="color:#f92672">/&gt;</span>
		<span style="color:#f92672">&lt;/dbProviderFactories&gt;</span>
	<span style="color:#f92672">&lt;/system.data&gt;</span>
<span style="color:#f92672">&lt;/configuration&gt;</span>
</code></pre></div><p>And now we can use the <a href="http://www.timvw.be/helper-methods-for-dbconnection/">DbConnectionHelper</a> to create a DbConnection and do some work</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Main(<span style="color:#66d9ef">string</span>[] args)
{
	<span style="color:#66d9ef">using</span> (DbConnection conn = DbConnectionHelper.GetConnection(<span style="color:#e6db74">&#34;localdb&#34;</span>))
	{
		conn.Open();
		<span style="color:#75715e">// do some work...
</span><span style="color:#75715e"></span>	}

	Console.Write(<span style="color:#e6db74">&#34;{0}Press any key to continue...&#34;</span>, Environment.NewLine);
	Console.ReadKey();
}
</code></pre></div>
			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="/tags/C">C#</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
