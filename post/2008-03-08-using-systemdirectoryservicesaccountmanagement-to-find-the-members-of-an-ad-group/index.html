<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Using System.DirectoryServices.AccountManagement to find the members of an AD group - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Using System.DirectoryServices.AccountManagement to find the members of an AD group">
<meta itemprop="description" content="A while ago i posted some code that demonstrated how to find the members of an AD group. If you&rsquo;re using the brandnew .Net 3.5 framework you can take advantage of the System.DirectoryServices.AccountManagement library which is an abstraction for AD (DS, LDS) and SAM accounts. Using this new library my method can be simplified
private static IEnumerable&lt;string&gt; FindUsernames(string groupname) { PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, &#34;mydomain&#34;); GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(principalContext, groupname); foreach (Principal principal in groupPrincipal.">
<meta itemprop="datePublished" content="2008-03-08T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-04T14:56:32+01:00" />
<meta itemprop="wordCount" content="103">



<meta itemprop="keywords" content="C#," />
<meta property="og:title" content="Using System.DirectoryServices.AccountManagement to find the members of an AD group" />
<meta property="og:description" content="A while ago i posted some code that demonstrated how to find the members of an AD group. If you&rsquo;re using the brandnew .Net 3.5 framework you can take advantage of the System.DirectoryServices.AccountManagement library which is an abstraction for AD (DS, LDS) and SAM accounts. Using this new library my method can be simplified
private static IEnumerable&lt;string&gt; FindUsernames(string groupname) { PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, &#34;mydomain&#34;); GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(principalContext, groupname); foreach (Principal principal in groupPrincipal." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://timvw.be/post/2008-03-08-using-systemdirectoryservicesaccountmanagement-to-find-the-members-of-an-ad-group/" />
<meta property="article:published_time" content="2008-03-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-04T14:56:32+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Using System.DirectoryServices.AccountManagement to find the members of an AD group"/>
<meta name="twitter:description" content="A while ago i posted some code that demonstrated how to find the members of an AD group. If you&rsquo;re using the brandnew .Net 3.5 framework you can take advantage of the System.DirectoryServices.AccountManagement library which is an abstraction for AD (DS, LDS) and SAM accounts. Using this new library my method can be simplified
private static IEnumerable&lt;string&gt; FindUsernames(string groupname) { PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, &#34;mydomain&#34;); GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(principalContext, groupname); foreach (Principal principal in groupPrincipal."/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../post">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">08</span>
							<span class="rest">Mar 2008</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Using System.DirectoryServices.AccountManagement to find the members of an AD group</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>A while ago i posted some code that demonstrated how to <a href="http://www.timvw.be/find-the-members-of-an-ad-group/">find the members of an AD group</a>. If you&rsquo;re using the brandnew .Net 3.5 framework you can take advantage of the <a href="http://msdn2.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx">System.DirectoryServices.AccountManagement</a> library which is an abstraction for AD (DS, LDS) and SAM accounts. Using this new library my method can be simplified</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">static</span> IEnumerable&lt;<span style="color:#458;font-weight:bold">string</span>&gt; FindUsernames(<span style="color:#458;font-weight:bold">string</span> groupname)
{
	PrincipalContext principalContext = <span style="color:#000;font-weight:bold">new</span> PrincipalContext(ContextType.Domain, <span style="color:#d14">&#34;mydomain&#34;</span>);
	GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(principalContext, groupname);

	<span style="color:#000;font-weight:bold">foreach</span> (Principal principal <span style="color:#000;font-weight:bold">in</span> groupPrincipal.Members)
	{
		<span style="color:#000;font-weight:bold">yield</span> <span style="color:#000;font-weight:bold">return</span> principal.DistinguishedName;
	}
}
</code></pre></div><p>If you&rsquo;re looking for more information i would recommend that you read <a href="http://msdn2.microsoft.com/en-us/magazine/cc135979.aspx">Managing Directory Security Principals in the .NET Framework 3.5</a>.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../tags/C">C#</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
