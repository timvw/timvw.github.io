<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>C# on Tim Van Wassenhove&#39;s blog</title>
    <link>/tags/C#/</link>
    <description>Recent content in C# on Tim Van Wassenhove&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 21 Jul 2010 00:00:00 +0000</lastBuildDate><atom:link href="/tags/C#/feed.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Quick reminder about the workings of Type.IsAssignableFrom</title>
      <link>/post/2010-07-21-quick-reminder-about-the-workings-of-type-isassignablefrom/</link>
      <pubDate>Wed, 21 Jul 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-07-21-quick-reminder-about-the-workings-of-type-isassignablefrom/</guid>
      <description>
        
          &lt;p&gt;Here is a quick reminder about the workings of &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.type.isassignablefrom.aspx&#34;&gt;Type.IsAssignableFrom&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Fruit&lt;/span&gt; {}
&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Banana&lt;/span&gt; : Fruit {}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[Test]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; CanAssignBananaToFruit()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; fruit = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt; (Fruit);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; banana = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt; (Banana);
	Assert.IsTrue(fruit.IsAssignableFrom(banana));
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[Test]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; CanNotAssignFruitToBanana()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; fruit = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Fruit);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; banana = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Banana);
	Assert.IsFalse(banana.IsAssignableFrom(fruit));
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I really hate this API because it always seems backward to me. Here is how i really want to use it&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Assert.IsTrue(banana.CanBeAssignedTo(fruit));
Assert.IsFalse(fruit.CanBeAssignedTo(banana));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;With the aid of an extension method we can easily achieve this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; CanBeAssignedTo(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; Type sourceType, Type destinationType)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; destinationType.IsAssignableFrom(sourceType);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Removing Dead Tracks (Duplicates that don&#39;t exist) from iTunes using C#</title>
      <link>/post/2010-07-20-removing-dead-tracks-duplicates-that-dont-exist-from-itunes-using-c/</link>
      <pubDate>Tue, 20 Jul 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-07-20-removing-dead-tracks-duplicates-that-dont-exist-from-itunes-using-c/</guid>
      <description>
        
          &lt;p&gt;Last week i noticed the following post from Scott Hanselman: &lt;a href=&#34;http://www.hanselman.com/blog/RemovingDeadTracksDuplicatesThatDontExistFromITunesUsingC.aspx&#34;&gt;Removing Dead Tracks (Duplicates that don&amp;rsquo;t exist) from iTunes using C#&lt;/a&gt;. As a good boy scout i noticed that these days iTunesLib.IITTrackCollection inherits from IEnumerable so i rewrote the code a little&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Program&lt;/span&gt;
{
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[STAThread]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; itunes = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; iTunesApp();
		itunes.DeleteTracksThatDoNotExist();
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ITunesExtensions&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DeleteTracksThatDoNotExist(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; IiTunes itunes)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; tracksThatDoNotExist = FindTracksThatDoNotExist(itunes);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; track &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; tracksThatDoNotExist) track.Delete();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IEnumerable&amp;lt;iitfileOrCDTrack&amp;gt; FindTracksThatDoNotExist(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; IiTunes iTunes)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; iTunes.LibraryPlaylist.Tracks
			.OfType&amp;lt;iitfileOrCDTrack&amp;gt;()
			.Where(track =&amp;gt; !File.Exists(track.Location));
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Sometimes you can write it better than Resharper</title>
      <link>/post/2010-07-03-sometimes-you-can-write-it-better-than-resharper/</link>
      <pubDate>Sat, 03 Jul 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-07-03-sometimes-you-can-write-it-better-than-resharper/</guid>
      <description>
        
          &lt;p&gt;Here is a real-life example of when people are much better expressing intent than a tool: Consider the following code from a typical Silverlight Navigation application&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (UIElement child &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; LinksStackPanel.Children)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; hb = child &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; HyperlinkButton;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (hb != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; hb.NavigateUri != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
	{ .. }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Resharper proposed to write this as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; hb &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; LinksStackPanel.Children
	.Select(child =&amp;gt; child &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; HyperlinkButton)
	.Where(hb =&amp;gt; hb != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; hb.NavigateUri != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;))
	{ .. }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is what i wrote instead&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; hb &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; LinksStackPanel.Children
	.OfType&amp;lt;hyperlinkButton&amp;gt;()
	.Where(hb =&amp;gt; hb.NavigateUri != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;))
	{ .. }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Support both GET and HEAD requests on the same method with WCF REST</title>
      <link>/post/2010-05-28-support-both-get-and-head-requests-on-the-same-method-with-wcf-rest/</link>
      <pubDate>Fri, 28 May 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-05-28-support-both-get-and-head-requests-on-the-same-method-with-wcf-rest/</guid>
      <description>
        
          &lt;p&gt;A while ago i had to modify an existing &lt;a href=&#34;http://msdn.microsoft.com/en-us/netframework/cc950529.aspx&#34;&gt;WCF REST&lt;/a&gt; service which was being consumed by &lt;a href=&#34;http://en.wikipedia.org/wiki/Background_Intelligent_Transfer_Service&#34;&gt;BITS&lt;/a&gt;. Apparently the implementation has changed in Windows7 in such a way that the BITS client first makes a HEAD request to discover the file size.&lt;/p&gt;
&lt;p&gt;The following attempts did not work&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// A method can not have both WebGet and WebInvoke attributes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[OperationContract]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;[WebGet]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;[WebInvoke(Method=&amp;#34;HEAD&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Stream Download(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; token) { }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// A method can not have multiple WebInvoke attributes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[OperationContract]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;[WebInvoke(Method=&amp;#34;GET&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;[WebInvoke(&amp;#34;HEAD&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Stream Download(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; token) { }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The trick is to use * as Method and handle the method related logic in your code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[OperationContract]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;[WebInvoke(Method=&amp;#34;*&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Stream Download(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; token)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; method = WebOperationContext.Current.IncomingRequest.Method;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (method == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;HEAD&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ProcessHead();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (method == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;GET&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ProcessGet();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentException(method + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; is not supported.&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>WCF REST: generate correct Content-Length header for HEAD request</title>
      <link>/post/2010-05-28-wcf-rest-generate-correct-content-length-header-for-head-request/</link>
      <pubDate>Fri, 28 May 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-05-28-wcf-rest-generate-correct-content-length-header-for-head-request/</guid>
      <description>
        
          &lt;p&gt;The point of a HEAD request is to return a Content-Length header, but with an empty body.
The WCF transport stack has the annoying &amp;lsquo;feature&amp;rsquo; that it &amp;lsquo;corrects&amp;rsquo; the Content-Length header based on the stream that is returned.
With the aid of Carlos Figueira&amp;rsquo;s &lt;a href=&#34;http://social.msdn.microsoft.com/Forums/en/wcf/thread/c2672206-f255-4b14-b45e-7e3d057f4ffc&#34;&gt;MyLengthOnlyStream&lt;/a&gt; i was able to workaround that &amp;lsquo;feature&amp;rsquo; :)
(I know, i know, a good old HttpHandler is so much easier to implement!)&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Enumerating SpecialFolders</title>
      <link>/post/2010-05-02-enumerating-specialfolders/</link>
      <pubDate>Sun, 02 May 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-05-02-enumerating-specialfolders/</guid>
      <description>
        
          &lt;p&gt;&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx&#34;&gt;Environment.SpecialFolder&lt;/a&gt; is a value-type that i always seem to forget about. Let&amp;rsquo;s try to do something about that by posting about it here :)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; name &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; Enum.GetNames(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Environment.SpecialFolder)))
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; specialFolder = (Environment.SpecialFolder)Enum.Parse(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Environment.SpecialFolder), name);
	Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0,25} =&amp;gt; {1}&amp;#34;&lt;/span&gt;, name, Environment.GetFolderPath(specialFolder));
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Start Menu\Programs
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\Documents
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\Documents
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\Favorites
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Recent
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\SendTo
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Start Menu
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\Music
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\Desktop
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Templates
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Local
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Local\Microsoft\Windows\Temporary Internet Files
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Cookies
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\AppData\Local\Microsoft\Windows\History
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\ProgramData
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Windows\system32
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Program Files
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Users\timvw\Pictures
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  C:\Program Files\Common Files
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;

        
      </description>
    </item>
    
    <item>
      <title>Get root directory for IsolatedStorageFiles</title>
      <link>/post/2010-05-01-get-root-directory-for-isolatedstoragefiles/</link>
      <pubDate>Sat, 01 May 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-05-01-get-root-directory-for-isolatedstoragefiles/</guid>
      <description>
        
          &lt;p&gt;Sometimes you want to know the absolute path of a file that is persisted with &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile(VS.95).aspx&#34;&gt;IsolatedStorageFile&lt;/a&gt;. Apparently there is an internal property RootDirectory which contains this information&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;IsolatedStorageFileExtensions&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; GetRootDirectory(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; IsolatedStorageFile isf)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; property = isf.GetType().GetProperty(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RootDirectory&amp;#34;&lt;/span&gt;, BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.GetProperty);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;)property.GetValue(isf, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is a real world example of using &lt;a href=&#34;http://sharpbits.codeplex.com/&#34;&gt;SharpBITS.NET&lt;/a&gt; to download a file to IsolatedStorage:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Program&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; mgr = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BitsManager();
		mgr.OnJobError += mgr_OnJobError;
		mgr.OnJobTransferred += mgr_OnJobTransferred;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; job = mgr.CreateJob(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;job@&amp;#34;&lt;/span&gt; + DateTime.Now, JobType.Download);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; src = &lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;http://localhost/&amp;#34;&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; dst = Path.Combine(GetIsfRoot(), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;test.html&amp;#34;&lt;/span&gt;);
		job.AddFile(src,dst);
		job.Resume();

		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;running...&amp;#34;&lt;/span&gt;);
		Console.ReadKey();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; mgr_OnJobTransferred(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, NotificationEventArgs e)
	{
		e.Job.Complete();
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;completed: &amp;#34;&lt;/span&gt; + e.Job.DisplayName);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; mgr_OnJobError(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, ErrorNotificationEventArgs e)
	{
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;error: &amp;#34;&lt;/span&gt; + e.Error.Description);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; GetIsfRoot()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; f = IsolatedStorageFile.GetUserStoreForAssembly())
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; f.GetRootDirectory();
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Exploring System.Interactive</title>
      <link>/post/2010-02-18-exploring-system-interactive/</link>
      <pubDate>Thu, 18 Feb 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-02-18-exploring-system-interactive/</guid>
      <description>
        
          &lt;p&gt;A couple of weeks ago i was working on an application that would transfer data through a couple of components as a List&lt;!-- raw HTML omitted --&gt;. In essence, all we were doing over and over again was the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IMapper
{
	TEntity FromObjectList(List objectList);
	List ToObjectList(TEntity entity);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;My initial implementation (using EnumerableEx operators from &lt;!-- raw HTML omitted --&gt;Reactive Extensions&lt;!-- raw HTML omitted --&gt;) looked like this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; TEntity FromObjectList(List objectList)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; entity = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TEntity();
	
	properties
		.Zip(objectList, (property, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;) =&amp;gt; AssignValueToProperty(entity, property, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;))
		.Run();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; entity;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; AssignValueToProperty(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; entity, PropertyInfo property, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
{
	property.SetValue(entity, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; List ToObjectList(TEntity entity)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; properties
	.Select(property =&amp;gt; property.GetValue(entity, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;))
	.ToList();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And the consumer code looks like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; person = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person { Id = &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, Score = &lt;span style=&#34;color:#ae81ff&#34;&gt;1.3&lt;/span&gt;, Name = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tim&amp;#34;&lt;/span&gt;, Title = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sir&amp;#34;&lt;/span&gt; };

&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; personMapper = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mapper()
	.Map(x =&amp;gt; x.Id)
	.Map(x =&amp;gt; x.Score)
	.Map(x =&amp;gt; x.Name)
	.Map(x =&amp;gt; x.Title);

&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; data = personMapper.ToObjectList(person);
&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; clonedPerson = personMapper.FromObjectList(data);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Wait a minute, in most situations we simply want to map all properties on the object. Let&amp;rsquo;s create a mapper for this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;AutoMapper&lt;/span&gt; : Mapper &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; TEntity : &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt;()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; AutoMapper()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(TEntity).GetProperties().Run(property =&amp;gt; Map(property));
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we don&amp;rsquo;t have to waste time doing the same thing over and over again! Because we always need to map all properties of our types we ended up with the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Mapper&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; List ToObjectsList(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; TEntity entity)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; entity.GetType().GetProperties()
		.Select(property =&amp;gt; property.GetValue(entity, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;))
		.ToList();
	}
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; TEntity ToEntity(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; List objectsList) &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; TEntity : &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt;()
	{
		TEntity entity = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TEntity();
		entity.GetType().GetProperties()
			.Zip(objectsList, (property, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;) =&amp;gt;{ property.SetValue(entity, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;,&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;); &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;})
			.Run();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; entity;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Learned something from Resharper: Enumerable.OfType&lt;TResult&gt;</title>
      <link>/post/2010-02-17-learned-something-from-resharper-enumerable-oftypetresult/</link>
      <pubDate>Wed, 17 Feb 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-02-17-learned-something-from-resharper-enumerable-oftypetresult/</guid>
      <description>
        
          &lt;p&gt;A couple of weeks ago i discovered &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/bb360913.aspx&#34;&gt;Enumerable.OfType&lt;!-- raw HTML omitted --&gt;&lt;/a&gt; when i let Resharper rewrite my code as a Linq statement. Here is the original code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; selectedPersons = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;personSelectItem&amp;gt;();
&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; selectedItem &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; selectedItems)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; selectedPerson = selectedItem &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PersonSelectItem;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (selectedPerson == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;continue&lt;/span&gt;;
	selectedPersons.Add(selectedPerson);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is how it looks after the rewrite:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; selectedPersons = selectedItems.OfType&amp;lt;personSelectItem&amp;gt;().ToList();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Yup, the &lt;a href=&#34;http://www.jetbrains.com/resharper/&#34;&gt;Resharper&lt;/a&gt; license was definitely worth it&amp;rsquo;s money.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Calculate EndpointAddress for Silverlight client</title>
      <link>/post/2010-02-15-calculate-endpointaddress-for-silverlight-client/</link>
      <pubDate>Mon, 15 Feb 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-02-15-calculate-endpointaddress-for-silverlight-client/</guid>
      <description>
        
          &lt;p&gt;Because Silverlight checks the origin it considers http://localhost and http://127.0.0.1 as different locations. In case you want your visitors to be able to use both addresses you can recalculate the address as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;EndpointAddress GetEndpointAddress(EndpointAddress endpointAddress)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; scheme = Application.Current.Host.Source.GetComponents(UriComponents.Scheme, UriFormat.Unescaped);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; serverAndPort = Application.Current.Host.Source.GetComponents(UriComponents.HostAndPort, UriFormat.Unescaped);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; pathAndQuery = endpointAddress.Uri.GetComponents(UriComponents.PathAndQuery, UriFormat.Unescaped);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EndpointAddress(scheme + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;://&amp;#34;&lt;/span&gt; + serverAndPort + pathAndQuery);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And you can use this method as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; client = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DirectoryServiceClient();
client.Endpoint.Address = GetEndpointAddress(client.Endpoint.Address);
client.GetMessageCompleted += ClientGetMessageCompleted;
client.GetMessageAsync();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Another missing method for IEnumerable&lt;T&gt;</title>
      <link>/post/2010-02-10-another-missing-method-for-ienumerablet/</link>
      <pubDate>Wed, 10 Feb 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-02-10-another-missing-method-for-ienumerablet/</guid>
      <description>
        
          &lt;p&gt;Currently there are two overloads for OrderBy on Enumerable&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;OrderBy(this IEnumerable&lt;!-- raw HTML omitted --&gt; source, Func&amp;lt;TSource, TKey&amp;gt; keySelector)&lt;/li&gt;
&lt;li&gt;OrderBy(this IEnumerable&lt;!-- raw HTML omitted --&gt; source, Func&amp;lt;TSource, TKey&amp;gt; keySelector, IComparer&lt;!-- raw HTML omitted --&gt; comparer)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Because i don&amp;rsquo;t want to implement an IComparer&lt;!-- raw HTML omitted --&gt; each time i have implemented the following class&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DelegateComparer&lt;/span&gt;&amp;lt;T&amp;gt; : IComparer&amp;lt;T&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Func&amp;lt;t, T, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; CompareFunction { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; DelegateComparer(Func&amp;lt;t, T, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; compareFunction)
	{
		CompareFunction = compareFunction;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Compare(T x, T y)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; CompareFunction(x, y);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now i can define a nice extension method:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IOrderedEnumerable&amp;lt;tsource&amp;gt; OrderBy&amp;lt;tsource, TKey&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; IEnumerable&amp;lt;tsource&amp;gt; source, Func&amp;lt;tsource, TKey&amp;gt; keySelector, Func&amp;lt;tkey, TKey, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; compareFunction)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; comparer = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DelegateComparer&amp;lt;tkey&amp;gt;(compareFunction);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; source.OrderBy(keySelector, comparer);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Verify that a X509Certificate can be used for key exchange</title>
      <link>/post/2010-02-02-verify-that-a-x509certificate-can-be-used-for-key-exchange/</link>
      <pubDate>Tue, 02 Feb 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-02-02-verify-that-a-x509certificate-can-be-used-for-key-exchange/</guid>
      <description>
        
          &lt;p&gt;Here is another method that earned it&amp;rsquo;s place in my ever growing toolbox:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; CanDoKeyExchange(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; X509Certificate2 certificate)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (!certificate.HasPrivateKey) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; privateKey = certificate.PrivateKey &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; RSACryptoServiceProvider;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (privateKey == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; canDoKeyExchange = privateKey.CspKeyContainerInfo.KeyNumber == KeyNumber.Exchange;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; canDoKeyExchange;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting ValueType&lt;T&gt;</title>
      <link>/post/2010-01-28-presenting-valuetypet/</link>
      <pubDate>Thu, 28 Jan 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-01-28-presenting-valuetypet/</guid>
      <description>
        
          &lt;p&gt;Here is a base class for some code that i have written once too many in my life: (In case you&amp;rsquo;re an early adaptor (.Net 4.0) you may want to use System.Tuple&lt;!-- raw HTML omitted --&gt; as base class)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ValueType&lt;/span&gt;&amp;lt;T&amp;gt; : IComparable, IComparable&amp;lt;valueType&amp;lt;T&amp;gt;&amp;gt;, IEquatable&amp;lt;valueType&amp;lt;T&amp;gt;&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; T : IComparable&amp;lt;T&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; T Value { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ValueType(T &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
	{
		Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; GetHashCode()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Value.GetHashCode();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; ToString()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Value.ToString();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; Equals(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; obj)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Equals(obj &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ValueType&amp;lt;T&amp;gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; Equals(ValueType&amp;lt;T&amp;gt; other)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Compare(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, other) == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; CompareTo(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; obj)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; CompareTo(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, obj &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ValueType&amp;lt;T&amp;gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; CompareTo(ValueType&amp;lt;T&amp;gt; other)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Compare(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, other);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Compare(ValueType&amp;lt;T&amp;gt; instance1, ValueType&amp;lt;T&amp;gt; instance2)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ReferenceEquals(instance1, instance2)) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ReferenceEquals(instance1, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ReferenceEquals(instance2, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ReferenceEquals(instance1.Value, instance2.Value)) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ReferenceEquals(instance1.Value, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (ReferenceEquals(instance2.Value, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; instance1.Value.CompareTo(instance2.Value);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;operator&lt;/span&gt; ==(ValueType&amp;lt;T&amp;gt; instance1, ValueType&amp;lt;T&amp;gt; instance2)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Compare(instance1, instance2) == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;operator&lt;/span&gt; !=(ValueType&amp;lt;T&amp;gt; instance1, ValueType&amp;lt;T&amp;gt; instance2)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; !(instance1 == instance2);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;operator&lt;/span&gt; &amp;lt;(ValueType&amp;lt;T&amp;gt; instance1, ValueType&amp;lt;T&amp;gt; instance2)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Compare(instance1, instance2) &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; 
	} 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;operator&lt;/span&gt; &amp;gt;(ValueType&amp;lt;T&amp;gt; instance1, ValueType&amp;lt;T&amp;gt; instance2)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Compare(instance1, instance2) &amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Programming the Bus Pirate with C#</title>
      <link>/post/2010-01-16-programming-the-bus-pirate-with-c/</link>
      <pubDate>Sat, 16 Jan 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-01-16-programming-the-bus-pirate-with-c/</guid>
      <description>
        
          &lt;p&gt;A while ago i received my &lt;a href=&#34;http://code.google.com/p/the-bus-pirate/&#34;&gt;Bus Pirate&lt;/a&gt; from &lt;a href=&#34;http://www.seeedstudio.com/depot/&#34;&gt;Seeed Studio Depot&lt;/a&gt;. In essence it is a universal serial bus interface and i would love to program it using c#. I know that i can use the DataReceived event and then fiddle with bits (read &lt;a href=&#34;http://msmvps.com/blogs/coad/archive/2005/03/23/39466.aspx#usb&#34;&gt;here&lt;/a&gt; if you&amp;rsquo;re into that kind of self-punishment) but spawning a separate thread to do the blocking work is ten times less work to get it up and running&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; serialPort = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SerialPort(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;COM9&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;115200&lt;/span&gt;, Parity.None, &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, StopBits.One))
	{
		serialPort.Open();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Thread(() =&amp;gt; WriteLinesFrom(serialPort)).Start();

		&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; command = Console.ReadLine();
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (command == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;EXIT&amp;#34;&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
			serialPort.WriteLine(command);
		}
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; WriteLinesFrom(SerialPort serialPort)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;) Console.WriteLine(serialPort.ReadLine());
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (Exception)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>About raising events</title>
      <link>/post/2010-01-09-about-raising-events/</link>
      <pubDate>Sat, 09 Jan 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-01-09-about-raising-events/</guid>
      <description>
        
          &lt;p&gt;Very often i see people write the following to &amp;lsquo;safely&amp;rsquo; raise a method&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; EventHandler Stopped;

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; RaiseStoppedEvent()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (Stopped != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) Stopped(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, EventArgs.Empty);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Some developers think that they should program defensively and avoid the potential concurrency problem&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; EventHandler Stopped;

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; RaiseStoppedEvent()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; handler = Stopped;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (handler!= &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) handler(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, EventArgs.Empty);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And then there is Tim&amp;rsquo;s way to raise an event: (If i&amp;rsquo;m not mistaken it was &lt;a href=&#34;http://www.ayende.com&#34;&gt;Ayende&lt;/a&gt; who once blogged about this)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; EventHandler Stopped = &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { };

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; RaiseStoppedEvent()
{
	Stopped(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, EventArgs.Empty);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Creating graphs with the Silverlight Toolkit</title>
      <link>/post/2010-01-08-creating-graphs-with-the-silverlight-toolkit/</link>
      <pubDate>Fri, 08 Jan 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-01-08-creating-graphs-with-the-silverlight-toolkit/</guid>
      <description>
        
          &lt;p&gt;As i wrote already: In a chart the elements on the X-axis are usually numbers or dates, and the elements on the Y-axis are usually doubles. We can define such a combination as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Point&lt;/span&gt;&amp;lt;T&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; T X { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; Y { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is a little helper function for creating line series that are used by the &lt;a href=&#34;http://silverlight.codeplex.com/&#34;&gt;Silverlight Toolkit&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; LineSeries Create&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; title, Series&amp;lt;T&amp;gt; series, Func&amp;lt;t, &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt;&amp;gt; f) &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; T : IComparable&amp;lt;T&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; points = series.Select(x =&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Point&amp;lt;T&amp;gt; { X = x, Y = f(x) });

	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; lineSeries = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; LineSeries
	{
		Title = title,
		ItemsSource = points,
		IndependentValuePath = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X&amp;#34;&lt;/span&gt;,
		DependentValuePath = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Y&amp;#34;&lt;/span&gt;
	};

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; lineSeries;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Given all this infrastructure we can easily draw the graph of a function:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; MainPage()
{
	InitializeComponent();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; series = &lt;span style=&#34;color:#ae81ff&#34;&gt;0.&lt;/span&gt;To(&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;);

	Func&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt;&amp;gt; multiplyByTwo = x =&amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; * x;
	Chart1.Series.Add(Create(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;2x&amp;#34;&lt;/span&gt;, series, multiplyByTwo));

	Func&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt;&amp;gt; multiplyByThree = x =&amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; * x;
	Chart1.Series.Add(Create(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;x/2&amp;#34;&lt;/span&gt;, series, multiplyByThree));
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is how the result looks like (too much data on the chart)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/silverlightchart.png&#34; alt=&#34;screenshot of chart in silverlight toolkit&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Creating series of elements</title>
      <link>/post/2010-01-08-creating-series-of-elements/</link>
      <pubDate>Fri, 08 Jan 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-01-08-creating-series-of-elements/</guid>
      <description>
        
          &lt;p&gt;Lately i have done quite a bit of charting. Very often the X-axis is populated with a series of numbers or dates. This can be as simple as: (My very little DSL in &lt;a href=&#34;http://codebetter.com/blogs/jeremy.miller/archive/2010/01/06/writing-internal-dsl-s-in-msdn.aspx&#34;&gt;Jeremy D. Miller Style&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[Test]&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToGetSeriesOfNumbers()
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; series = &lt;span style=&#34;color:#ae81ff&#34;&gt;3.&lt;/span&gt;To(&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; elements = series.Elements;

	&lt;span style=&#34;color:#75715e&#34;&gt;// Assert
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; expected = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt; };
	CollectionAssert.AreEqual(expected, elements);
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[Test]&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToGetSeriesOfDays()
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; now = DateTime.Now.Date;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; twoDaysLater = now.AddDays(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; series = now.To(twoDaysLater);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; elements = series.Elements;

	&lt;span style=&#34;color:#75715e&#34;&gt;// Assert
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; expectedDays = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt;[] { now, now.AddDays(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), now.AddDays(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;) };
	CollectionAssert.AreEqual(expectedDays, elements);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is the code that makes these tests pass&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Series&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Series&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; To(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; to)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Create(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, to);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Series&amp;lt;dateTime&amp;gt; To(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; DateTime &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, DateTime to)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Create(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, to);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Series&amp;lt;dateTime&amp;gt; Create(DateTime &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, DateTime to)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Series&amp;lt;dateTime&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;.Date, to.Date, d =&amp;gt; d.AddDays(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;));
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Series&amp;lt;dateTime&amp;gt; Create(DateTime &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; numberOfDays)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Create(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;.Date, &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;.Date.AddDays(numberOfDays));
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Series&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; Create(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; to)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Series&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, to, n =&amp;gt; n + &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Series&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; Create(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; to, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; stepSize)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Series&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, to, n =&amp;gt; n + stepSize);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Series&lt;/span&gt;&amp;lt;T&amp;gt; : IEnumerable&amp;lt;T&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; T : IComparable
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; T From { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; T To { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Func&amp;lt;t, T&amp;gt; Step { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Series(T &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, T to, Func&amp;lt;t, T&amp;gt; step)
	{
		From = &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;;
		To = to;
		Step = step;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; Elements
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; current = From;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (current.CompareTo(To) &amp;lt;= &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) 
			{ 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;yield&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; current; current = Step(current); 
			} 
		} 
	} 
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IEnumerator&amp;lt;T&amp;gt; GetEnumerator()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Elements.GetEnumerator();
	}

	IEnumerator IEnumerable.GetEnumerator()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; GetEnumerator();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Ninject: connect an IProxyFactory component to the kernel</title>
      <link>/post/2009-12-16-ninject-connect-an-iproxyfactory-component-to-the-kernel/</link>
      <pubDate>Wed, 16 Dec 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-12-16-ninject-connect-an-iproxyfactory-component-to-the-kernel/</guid>
      <description>
        
          &lt;p&gt;Because it&amp;rsquo;s the second time that i run into this i will post the solution here so that i (and all the other people that run into the same issue) can easily solve it next time. Anyway, i was playing with &lt;a href=&#34;http://ninject.org/&#34;&gt;Ninject&lt;/a&gt; and ran into the following exception:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Error activating XXX: the implementation type YYY requests static interceptors, or dynamic interceptors have been defined.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;In order to provide interception, you must connect an IProxyFactory component to the kernel.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you search for implementations of IProxyFactory you will find the DynamicProxy2ProxyFactory and the LinFuProxyFactory classes. But how can you tell your kernel to use them? This is pretty simple (but hard to find on the web):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Kernel.Components.Connect&amp;lt;iproxyFactory&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DynamicProxy2ProxyFactory());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Instead of writing this code to connect the ProxyFactory implementation you can also use the XXX module (which does it for you) as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; kernel = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StandardKernel(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DynamicProxy2Module(), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BusinessModule());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>In case you really have to Append one array to another</title>
      <link>/post/2009-12-04-in-case-you-really-have-to-append-one-array-to-another/</link>
      <pubDate>Fri, 04 Dec 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-12-04-in-case-you-really-have-to-append-one-array-to-another/</guid>
      <description>
        
          &lt;p&gt;Here is another problem i&amp;rsquo;ve seen people solve once too many: Append one array to another. STOP. Revisit the problem. Can&amp;rsquo;t you simply use List&lt;!-- raw HTML omitted --&gt; and move on to solving actual business problems? In case you really can&amp;rsquo;t get rid of the arrays read the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Given()
{
	source = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt;[] { SourceElement };
	destination = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt;[] { DestinationElement };
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;When()
{
	source.AppendTo(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; destination);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;ThenTheDestinationShouldStillHaveTheDestinationElement()
{
	Assert.AreEqual(DestinationElement, destination[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;and&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;ThenTheDestinationShouldHaveBeenExtendedWithTheSourceElement()
{
	Assert.AreEqual(SourceElement, destination[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is the code which satisfies the requirements&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Extensions&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; AppendTo&amp;lt;t&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; T[] sourceArray, &lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; T[] destinationArray)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; sourceLength = sourceArray.Length;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; destinationLength = destinationArray.Length;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; extendedLength = destinationLength + sourceLength;
		Array.Resize(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; destinationArray, extendedLength);
		Array.Copy(sourceArray, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, destinationArray, destinationLength, sourceLength);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Perhaps it&amp;rsquo;s time to start (or does it exist already, cause i can&amp;rsquo;t find it) an open-source project with extension methods.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Easy pattern for Control state</title>
      <link>/post/2009-11-21-easy-pattern-for-control-state/</link>
      <pubDate>Sat, 21 Nov 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-11-21-easy-pattern-for-control-state/</guid>
      <description>
        
          &lt;p&gt;If you have decided that your WebControl requires to maintain it&amp;rsquo;s state you will want to figure out how to implement Control state. Most examples on the web will then create an array of objects and then hardcode the indices to find stuff back&amp;hellip; Simply define a serializable inner class and use that instead of the &amp;lsquo;magic array object&amp;rsquo;. Eg&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SilverlightHost&lt;/span&gt; : WebControl
{
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[Serializable]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; BaseState { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; SilverlightUrl { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; SilverlightErrorHandlerUrl { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Dictionary&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt; Parameters { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnInit(EventArgs e)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.OnInit(e);
		Page.RegisterRequiresControlState(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; SaveControlState()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; state = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; State
		{
			BaseState = &lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.SaveControlState(),
			SilverlightUrl = SilverlightUrl,
			SilverlightErrorHandlerUrl = SilverlightErrorHandlerUrl,
			Parameters = parameters
		};
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; state;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; LoadControlState(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; savedState)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; state = (State)savedState;
		SilverlightUrl = state.SilverlightUrl;
		SilverlightErrorHandlerUrl = state.SilverlightErrorHandlerUrl;
		parameters = state.Parameters;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.LoadControlState(state.BaseState);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Couple of methods missing on ObservableCollection</title>
      <link>/post/2009-11-06-couple-of-methods-missing-on-observablecollection/</link>
      <pubDate>Fri, 06 Nov 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-11-06-couple-of-methods-missing-on-observablecollection/</guid>
      <description>
        
          &lt;p&gt;Here are a couple of methods that are missing on &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms668604.aspx&#34;&gt;ObservableCollection&lt;!-- raw HTML omitted --&gt;&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ObservableCollectionExtensions&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; AddRange&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; ObservableCollection&amp;lt;T&amp;gt; observableCollection, IEnumerable&amp;lt;T&amp;gt; elements)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; element &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; elements) observableCollection.Add(element);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; ObservableCollection&amp;lt;T&amp;gt; Create&amp;lt;T&amp;gt;(IEnumerable&amp;lt;T&amp;gt; elements)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; observableCollection = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ObservableCollection&amp;lt;T&amp;gt;();
		observableCollection.AddRange(elements);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; observableCollection;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting FilterList</title>
      <link>/post/2009-11-06-presenting-filterlist/</link>
      <pubDate>Fri, 06 Nov 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-11-06-presenting-filterlist/</guid>
      <description>
        
          &lt;p&gt;Earlier today i decided to add &amp;lsquo;Filtering&amp;rsquo; to my SortableBindingList. This resulted in writing a &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/FilterList.txt&#34;&gt;FilterList&lt;/a&gt; class. This class can be easily used as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; textBoxFilter_KeyUp(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, KeyEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; filterChars = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.textBoxFilter.Text.ToLower();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Filter(filterChars);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Filter(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; filterChars)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; persons = (FilterList&amp;lt;person&amp;gt;)&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource;
	persons.Filter(p =&amp;gt; p.Firstname.ToLower().Contains(filterChars));
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I even created a screencast to demonstrate it:&lt;/p&gt;
&lt;p&gt;[mediaplayer src=&amp;lsquo;http://www.timvw.be/screencasts/filterlist.wmv&amp;rsquo; width=512 height=344]&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Another method i wrote once too many</title>
      <link>/post/2009-11-01-another-method-i-wrote-once-too-many/</link>
      <pubDate>Sun, 01 Nov 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-11-01-another-method-i-wrote-once-too-many/</guid>
      <description>
        
          &lt;p&gt;Virtually every Silverlight application will fetch resources at one point or another. In case you&amp;rsquo;re using the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.net.webclient(VS.95).aspx&#34;&gt;WebClient&lt;/a&gt; you have probably written the following in your xxxCompletedEventHandler&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.Error != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !e.Cancelled)
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// do something with the result
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Anyway, i don&amp;rsquo;t like repetition so i captured the conditions in a method:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ExtensionMethods&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HasResult(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; AsyncCompletedEventArgs e)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.Error != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.Cancelled) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we can write our code as:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.HasResult())
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// do something with the result
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Apart from saving a couple of keystrokes this also allows us to easily add another condition to determine the success of the operation.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Party for one</title>
      <link>/post/2009-10-29-party-for-one/</link>
      <pubDate>Thu, 29 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-29-party-for-one/</guid>
      <description>
        
          &lt;p&gt;Inspired by Jimmy Bogard&amp;rsquo;s &lt;a href=&#34;http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/10/15/more-missing-linq-operators.aspx&#34;&gt;More missing LINQ operators&lt;/a&gt; i found another one&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IEnumerable&amp;lt;T&amp;gt; MakeEnumerable&amp;lt;T&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; T element)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;yield&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; element;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting PathBuilder</title>
      <link>/post/2009-10-29-presenting-pathbuilder/</link>
      <pubDate>Thu, 29 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-29-presenting-pathbuilder/</guid>
      <description>
        
          &lt;p&gt;Currently it is annoying to build a path with &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/fyy7a5kt.aspx&#34;&gt;Path.Combine&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; home1 = Path.Combine(Path.Combine(Path.Combine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Users&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;timvw&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;My Documents&amp;#34;&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is how it can be:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; home2 = PathBuilder.Combine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Users&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;timvw&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;My Documents&amp;#34;&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The implementation is pretty simple:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PathBuilder&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Combine(&lt;span style=&#34;color:#66d9ef&#34;&gt;params&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] parts)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; parts.Aggregate((l, r) =&amp;gt; Path.Combine(l, r));
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Separation of concerns: Behavior = Trigger &#43; TriggerAction</title>
      <link>/post/2009-10-19-separation-of-concerns-behavior-trigger-triggeraction/</link>
      <pubDate>Mon, 19 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-19-separation-of-concerns-behavior-trigger-triggeraction/</guid>
      <description>
        
          &lt;p&gt;If you look at my &lt;a href=&#34;http://www.timvw.be/true-keybehavior-with-system-windows-interactivity-behavior/&#34;&gt;KeyBehavior&lt;/a&gt; you notice that it is doing two things: register for events so that the behavior can be triggered and handle the actual command invocation. In order to enhance reuse we can refactor this KeyBehavior in a KeyTrigger and an InvokeCommandAction. Well, we&amp;rsquo;re not going to do that, because they exist already in the silverlight sdk.&lt;/p&gt;
&lt;p&gt;A shortcoming of the InvokeCommandAction is that it can only invoke commands on the FrameworkElement itself, thus we write a custom implementation that finds commands on the DataContext instead&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;InvokeCommandAction&lt;/span&gt; : TriggerAction&amp;lt;frameworkElement&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; CommandName { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Invoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; parameter)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; viewModel = AssociatedObject.DataContext;
		GetCommandAndExecuteIt(viewModel, CommandName);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetCommandAndExecuteIt(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; viewModel, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; commandName)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; command = viewModel.GetPropertyValue&amp;lt;icommand&amp;gt;(commandName);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(command.CanExecute(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)) command.Execute(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we can drag this action on our design surface in Blend and select a trigger that goes with it&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/InvokeCommandAction_ChooseTrigger.png&#34; alt=&#34;choosing a keypress trigger in blend&#34;&gt;&lt;/p&gt;
&lt;p&gt;All we have to do is choose the Key and Command to invoke&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/InvokeCommandAction_SetProperties.png&#34; alt=&#34;setting properties for action in blend&#34;&gt;&lt;/p&gt;
&lt;p&gt;In XAML this looks like&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;interactivity:Interaction.Triggers&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;ii:KeyTrigger&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Right&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:InvokeCommandAction&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerRight&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/ii:KeyTrigger&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;ii:KeyTrigger&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Left&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:InvokeCommandAction&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerLeft&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/ii:KeyTrigger&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;ii:KeyTrigger&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Up&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:InvokeCommandAction&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerUp&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/ii:KeyTrigger&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;ii:KeyTrigger&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Down&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:InvokeCommandAction&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerDown&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/ii:KeyTrigger&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/interactivity:Interaction.Triggers&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I guess this ends our exploration of the behavior features in Silverlight.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>True KeyBehavior with System.Windows.Interactivity.Behavior</title>
      <link>/post/2009-10-19-true-keybehavior-with-system-windows-interactivity-behavior/</link>
      <pubDate>Mon, 19 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-19-true-keybehavior-with-system-windows-interactivity-behavior/</guid>
      <description>
        
          &lt;p&gt;Yesterday i demonstrated how attached properties can be used to invoke commands on specific key presses (and releases). With the aid of System.Windows.Interactivity.Behavior we can implement a true behavior and we get an extension point to do the required cleanup.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/BlendKeyBehavior.png&#34; alt=&#34;screenshot of Blend managing a KeyBehavior&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;grid&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;interactivity:Interaction.Behaviors&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyBehavior&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyBehavior.DownKeyCommands&amp;gt;&lt;/span&gt;
				&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommandName&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Right&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerRight&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommandName&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Left&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerLeft&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommandName&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Up&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerUp&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
				&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommandName&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Down&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerDown&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/inf:KeyBehavior.DownKeyCommands&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/inf:KeyBehavior&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/interactivity:Interaction.Behaviors&amp;gt;&lt;/span&gt;
...
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/grid&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The behavior implementation is the same as yesterday, only this time we thankfully override the OnAttached and OnDetaching methods&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;KeyBehavior&lt;/span&gt; : Behavior&amp;lt;frameworkElement&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; List&amp;lt;keyCommandName&amp;gt; DownKeyCommands { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; List&amp;lt;keyCommandName&amp;gt; UpKeyCommands { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; KeyBehavior()
	: &lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;()
	{
		DownKeyCommands = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;keyCommandName&amp;gt;();
		UpKeyCommands = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;keyCommandName&amp;gt;();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnAttached()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.OnAttached();
		SubscribeToKeyEvents();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnDetaching()
	{
		UnsubscribeFromKeyEvents();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.OnDetaching();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; SubscribeToKeyEvents()
	{
		AssociatedObject.KeyDown += AssociatedObject_KeyDown;
		AssociatedObject.KeyUp += AssociatedObject_KeyUp;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UnsubscribeFromKeyEvents()
	{
		AssociatedObject.KeyDown -= AssociatedObject_KeyDown;
		AssociatedObject.KeyUp -= AssociatedObject_KeyUp;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Silverlight: leveraging attached properties to handle key events</title>
      <link>/post/2009-10-17-silverlight-leveraging-attached-properties-to-handle-key-events/</link>
      <pubDate>Sat, 17 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-17-silverlight-leveraging-attached-properties-to-handle-key-events/</guid>
      <description>
        
          &lt;p&gt;I strongly believe that input handling is a responsability that belongs to the View. At first i simply added the following in the code-behind of my GameView&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnKeyDown(KeyEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.OnKeyDown(e);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.Key == Key.Left) Model.MovePlayerLeft();
	...
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;But i wanted to play with the cool kids so i exposed ICommand properties on my ViewModel instead and rewrote the code like this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnKeyDown(KeyEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.OnKeyDown(e);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.Key == Key.Left) Model.PlayerLeft.Execute(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Offcourse, designers should not have to write code at all, thus i searched for a different solution. Because there isn&amp;rsquo;t a behavior that allows me to differentiate the command based on the actual key being pressed i wrote my own KeyEvents class which allows the designer to map a key to a command. Here is an example&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;grid&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyEvents.Down&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommand&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Right&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerRight&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommand&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Left&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerLeft&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommand&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Up&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerUp&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;inf:KeyCommand&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Key=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Down&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PlayerDown&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/inf:KeyEvents.Down&amp;gt;&lt;/span&gt;
	...
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/grid&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The down property is nothing more than an attached property:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;readonly&lt;/span&gt; DependencyProperty DownProperty = DependencyProperty.RegisterAttached(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Down&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(List&amp;lt;keyCommand&amp;gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(KeyEvents), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PropertyMetadata(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, OnSetDownCallback));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A KeyCommand is a simple pair of a Key and a Command name:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;KeyCommand&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Key Key { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; CommandName { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The GetDown method (for the attached Down property) will instantiate a KeyBehavior class which hooks up to the element&amp;rsquo;s KeyDown and KeyUp events and uses a bit of reflection to find the commands&amp;hellip;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;KeyBehavior&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; KeyBehavior(FrameworkElement frameworkElement)
	{
		FrameworkElement = frameworkElement;
		DownKeyCommands = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;keyCommand&amp;gt;();
		UpKeyCommands = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;keyCommand&amp;gt;();

		frameworkElement.KeyDown += frameworkElement_KeyDown;
		frameworkElement.KeyUp += frameworkElement_KeyUp;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; FrameworkElement FrameworkElement { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IList&amp;lt;keyCommand&amp;gt; DownKeyCommands { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IList&amp;lt;keyCommand&amp;gt; UpKeyCommands { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; &lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;; }

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; frameworkElement_KeyUp(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, KeyEventArgs e)
	{
		ExecuteCommandsForKey(e.Key, UpKeyCommands);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; frameworkElement_KeyDown(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, KeyEventArgs e)
	{
		ExecuteCommandsForKey(e.Key, DownKeyCommands);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ExecuteCommandsForKey(Key key, IEnumerable&amp;lt;keyCommand&amp;gt; commands)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; commandNamesForKey = commands.Where(p =&amp;gt; p.Key == key).Select(p =&amp;gt; p.CommandName);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; viewModel = FrameworkElement.DataContext;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; command &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; commandNamesForKey) GetCommandAndExecuteIt(viewModel, command);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetCommandAndExecuteIt(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; model, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; command = GetCommand(model, name);
		command.Execute(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	}

	ICommand GetCommand(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; model, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (ICommand)model.GetType().GetProperty(name).GetValue(model, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The only thing that is missing is a way to unsubscribe from the events (and so you will end up with memory leaks). WeakReferences may come of use but i&amp;rsquo;ll leave that as an exercise for the reader. Many thanks go to the &lt;a href=&#34;http://wpfdisciples.wordpress.com/&#34;&gt;WPF Disciples&lt;/a&gt; because they inspired me to come up with this attached properties magic.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>ViewModel to translate domain messages to view events</title>
      <link>/post/2009-10-13-viewmodel-to-translate-domain-messages-to-view-events/</link>
      <pubDate>Tue, 13 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-13-viewmodel-to-translate-domain-messages-to-view-events/</guid>
      <description>
        
          &lt;p&gt;Here is an example of a ViewModel that translates domain messages to view events:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;GameViewModel&lt;/span&gt; : INotifyPropertyChanged, IListener&amp;lt;boardChanged&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; PropertyChangedEventHandler PropertyChanged = &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { };

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; GameViewModel()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; messageBus = ServiceLocator.MessageBus;
		messageBus.Subscribe&amp;lt;boardChanged&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; IListener&amp;lt;boardChanged&amp;gt;.Handle(BoardChanged message)
	{
		PropertyChanged(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Board&amp;#34;&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Fluent Builders: More than creating context specifications</title>
      <link>/post/2009-10-08-fluent-builders-more-than-creating-context-specifications/</link>
      <pubDate>Thu, 08 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-08-fluent-builders-more-than-creating-context-specifications/</guid>
      <description>
        
          &lt;p&gt;Last couple of months i have been using the concept of (Fluent) Builder classes in order to create context specifications and i &lt;a href=&#34;http://www.timvw.be/about-the-design-of-a-fluent-interface/&#34;&gt;blogged about the steps i take to design their API&lt;/a&gt;. Lately i have realised that this concept has more uses than context specifcation only. Here is an example:&lt;/p&gt;
&lt;p&gt;In sokoban a game board can be stored in plain text using the following &amp;lsquo;protocol&amp;rsquo;:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Level element&lt;/th&gt;
&lt;th&gt;Character&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Wall&lt;/td&gt;
&lt;td&gt;#&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Player&lt;/td&gt;
&lt;td&gt;@&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Player on Goal&lt;/td&gt;
&lt;td&gt;+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Box&lt;/td&gt;
&lt;td&gt;$&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Box on Goal&lt;/td&gt;
&lt;td&gt;*&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Goal&lt;/td&gt;
&lt;td&gt;.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Floor&lt;/td&gt;
&lt;td&gt;(space)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Notice how a Fluent Builder allows us to implement this protocol with some elegant code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;actions.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;#&amp;#39;&lt;/span&gt;, aBoard =&amp;gt; aBoard.AddFloor().WithWall());
actions.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;@&amp;#39;&lt;/span&gt;, aBoard =&amp;gt; aBoard.AddFloor().WithPlayer());
actions.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;+&amp;#39;&lt;/span&gt;, aBoard =&amp;gt; aBoard.AddGoal().WithPlayer());
actions.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;$&amp;#39;&lt;/span&gt;, aBoard =&amp;gt; aBoard.AddFloor().WithBox());
actions.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;, aBoard =&amp;gt; aBoard.AddGoal().WithBox());
actions.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;, aBoard =&amp;gt; aBoard.AddGoal());
actions.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;, aBoard =&amp;gt; aBoard.AddFloor());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Fluent Builders: The case against implicit conversion</title>
      <link>/post/2009-10-08-fluent-builders-the-case-against-implicit-conversion/</link>
      <pubDate>Thu, 08 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-08-fluent-builders-the-case-against-implicit-conversion/</guid>
      <description>
        
          &lt;p&gt;Most people add an implicit conversion to their builder API which gives them the advantage that they don&amp;rsquo;t have to call Build explicitely. I have decided that i do not want to have this implicit conversion for a couple of reasons:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;C# does not allow to define implicit conversions to or from an interface&lt;/li&gt;
&lt;li&gt;Implicit conversions are not very discoverable&lt;/li&gt;
&lt;li&gt;Implicit conversions can break the API&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here is an example to clarify that last reason: Consider an OrderBuilder which requires the user to provide a product and then a quantity:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; ITakeProduct { ITakeQuantity WithProduct(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; productId); }
&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; ITakeQuantity { IBuildProduct WithQuantity(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; quantity); }
&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IBuildProduct { Product Build(); }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;With the existence of an implicit conversion operator a developer can create an invalid order as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Order order = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; OrderBuilder();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Conclusion: I am not convinced that Fluent Builders should support implicit conversion.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Fluent Builders: The case against implicit conversion (2)</title>
      <link>/post/2009-10-08-fluent-builders-the-case-against-implicit-conversion-2/</link>
      <pubDate>Thu, 08 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-10-08-fluent-builders-the-case-against-implicit-conversion-2/</guid>
      <description>
        
          &lt;p&gt;Here is another example that demonstrates how implicit conversion in a Fluent Builder can lead to surprises (&lt;a href=&#34;http://elegantcode.com/2009/03/21/be-careful-with-the-var-keyword-and-expression-builders/&#34;&gt;Jan Van Ryswyck noticed this too&lt;/a&gt;). Originally the code in my &lt;a href=&#34;http://www.timvw.be/fluent-builders-the-case-against-implicit-conversion/&#34;&gt;previous example&lt;/a&gt; was the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; order = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; OrderBuilder();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Wich would make the c# compiler conclude that order is an OrderBuilder instead of an Order.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Brad Abrams and extension methods to the rescue..</title>
      <link>/post/2009-09-29-brad-abrams-and-extension-methods-to-the-rescue/</link>
      <pubDate>Tue, 29 Sep 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-09-29-brad-abrams-and-extension-methods-to-the-rescue/</guid>
      <description>
        
          &lt;p&gt;Currently i am implementing &lt;a href=&#34;http://en.wikipedia.org/wiki/Sokoban&#34;&gt;Sokoban&lt;/a&gt; and i was pondering which methods i should add to my Cell class:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bool HoldsWall&lt;/li&gt;
&lt;li&gt;bool HoldsBox&lt;/li&gt;
&lt;li&gt;bool HoldsPlayer&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Or&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bool HoldsPieceOfType(Type type)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Which option should i choose? With the aid of extension methods (in the same namespace) i can have them both:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;namespace&lt;/span&gt; Sokoban.Domain
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ExtensionMethods&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HoldsBox(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; Cell cell)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; cell.HoldsPieceOfType(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Box));
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HoldsPlayer(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; Cell cell)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; cell.HoldsPieceOfType(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Player));
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HoldsWall(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; Cell cell)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; cell.HoldsPieceOfType(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Wall));
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In case you don&amp;rsquo;t like this solution, blame &lt;a href=&#34;http://blogs.msdn.com/brada/&#34;&gt;Brad Abrams&lt;/a&gt; who inspired me to implement it this way with his session at &lt;a href=&#34;http://www.visug.be&#34;&gt;Visug&lt;/a&gt; yesterday.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Remark:&lt;/strong&gt; Because the possible pieces in Sokoban are very well known (the game/requirements are not going to change) thus one should choose the first option (No extension methods required.)&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Improve readability with LINQ</title>
      <link>/post/2009-09-29-improve-readability-with-linq/</link>
      <pubDate>Tue, 29 Sep 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-09-29-improve-readability-with-linq/</guid>
      <description>
        
          &lt;p&gt;At first i was not very fond of LINQ but it seems that i am finally convinced that LINQ may improve readability:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; IsCompleted()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; boxesNotOnGoal = &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt; cell &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; Cells
	&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; cell.HoldsBox() &amp;amp;&amp;amp; !cell.IsGoal()
	&lt;span style=&#34;color:#66d9ef&#34;&gt;select&lt;/span&gt; cell.Piece;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; boxesNotOnGoal.Any();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Instruct T4 to use C# v3.5</title>
      <link>/post/2009-09-11-instruct-t4-to-use-c-v3-5/</link>
      <pubDate>Fri, 11 Sep 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-09-11-instruct-t4-to-use-c-v3-5/</guid>
      <description>
        
          &lt;p&gt;Consider this simple T4 template:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;&lt;/span&gt;# for (var i = 0; i &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt; 10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;++i)&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;WriteLine(&amp;#34;hello&amp;#34;);&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Trying to build the project results in a compilation error because &amp;lsquo;var&amp;rsquo; is an unknown type. A bit of research learned me that i should instruct the processor to use a specific c# version like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;&lt;/span&gt;#@ template language=&amp;#34;C#v3.5&amp;#34; inherits=&amp;#34;Microsoft.VisualStudio.TextTemplating.VSHost.ModelingTextTransformation&amp;#34; #&amp;gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;&lt;/span&gt;# for (var i = 0; i &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt; 10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;++i)&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;WriteLine(&amp;#34;hello&amp;#34;);&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Problem solved 🙂&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Extension methods to improve readability</title>
      <link>/post/2009-08-28-extension-methods-to-improve-readability/</link>
      <pubDate>Fri, 28 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-08-28-extension-methods-to-improve-readability/</guid>
      <description>
        
          &lt;p&gt;A common reason to take advantage of extension methods is to enhance readability (think fluent interfaces). My team uses the &lt;a href=&#34;http://en.wikipedia.org/wiki/Specification_pattern&#34;&gt;specification pattern&lt;/a&gt; regularly and in case a requirement says something like &amp;ldquo;if the player has reached level 10 a message should be displayed&amp;rdquo; they would implement it as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HasReachedLevel(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;).IsSatisfiedBy(player))
{
	view.DisplayMessage(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Congratulations! You have reached level 10.&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Pretty good but did you notice that they changed the order of player and level in their (code) story? With the aid of an extension method we can express this requirement as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (player.Satisfies(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HasReachedLevel(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)))
{
	view.DisplayMessage(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Congratulations! You have reached level 10.&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is the extension method that allows you to express the requirement in this way&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; Satisfies&amp;lt;t&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; T candidate, ISpecification&amp;lt;t&amp;gt; specification)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; specification.IsSatisfiedBy(candidate);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>About the design of a fluent interface</title>
      <link>/post/2009-08-17-about-the-design-of-a-fluent-interface/</link>
      <pubDate>Mon, 17 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-08-17-about-the-design-of-a-fluent-interface/</guid>
      <description>
        
          &lt;p&gt;Now that i have &lt;a href=&#34;&#34;&gt;presented a simple ControlStateMachine&lt;/a&gt; i can raise the bar a little. A statemachine that handles commands. Here is how a developer should be able to initialize this machine:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;sut.WhenIn(States.Loading)
.On(Commands.Next)
.Do(() =&amp;gt; Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;got next command while loading...&amp;#34;&lt;/span&gt;))
.Do(() =&amp;gt; Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;doing it again...&amp;#34;&lt;/span&gt;))
.On(Commands.Previous)
.Do(() =&amp;gt; Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;got previous command while loading...&amp;#34;&lt;/span&gt;));

sut.WhenIn(States.Ready)
.On(Commands.Previous)
.Do(() =&amp;gt; Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;got previous command while ready...&amp;#34;&lt;/span&gt;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So how should we define our methods to accomplish this initialization style? Let&amp;rsquo;s begin with identifying the methods we need.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WhenIn(TSTate state)&lt;/li&gt;
&lt;li&gt;On(TCommand command)&lt;/li&gt;
&lt;li&gt;Do(Action action)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Next thing to do is analyze in which sequence these methods can be called:&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;th style=&amp;quot;width: 100px&amp;quot;&amp;gt;
  WhenIn
&amp;lt;/th&amp;gt;

&amp;lt;th style=&amp;quot;width: 100px&amp;quot;&amp;gt;
  On
&amp;lt;/th&amp;gt;

&amp;lt;th style=&amp;quot;width: 100px&amp;quot;&amp;gt;
  Do
&amp;lt;/th&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  X
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  X
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  X
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  X
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;Ok, now that we have clarified the requirements a little we can start working on a solution. Let&amp;rsquo;s start with defining an interface for each of the methods:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IChooseState&amp;lt;tstate, TCommand&amp;gt; { Q1 WhenIn(TState state); }
&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IChooseCommand&amp;lt;tstate, TCommand&amp;gt; { Q2 On(TCommand command); }
&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IChooseAction&amp;lt;tstate, TCommand&amp;gt; { Q3 Do(Action action); }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;From WhenIn we need to be able to call On. Thus Q1 = IChooseCommand&amp;lt;TState, TCommand&amp;gt;. Q2 is also easily solved because from On we only have to be able to call Do, thus Q2 = IChooseAction&amp;lt;TState, TCommand&amp;gt;.&lt;/p&gt;
&lt;p&gt;From Do we should be able to call both On and Do. We can do that by defining another interface which has both methods:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IChooseCommandAndAction&amp;lt;tstate, TCommand&amp;gt; : IChooseCommand&amp;lt;tstate, TCommand&amp;gt;, IChooseAction&amp;lt;tstate, TCommand&amp;gt; { }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now that we have found answers for Q1, Q2 and Q3 we can define the API for initializing our StateMachine as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;IChooseCommand&amp;lt;tstate, TCommand&amp;gt; WhenIn(TState state);
IChooseAction&amp;lt;tstate, TCommand&amp;gt; On(TCommand command);
IChooseCommandAndAction&amp;lt;tstate, TCommand&amp;gt; Do(Action action);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now tell me about your strategy for implementing a fluent interface!&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>About the implementation of a fluent interface</title>
      <link>/post/2009-08-17-about-the-implementation-of-a-fluent-interface/</link>
      <pubDate>Mon, 17 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-08-17-about-the-implementation-of-a-fluent-interface/</guid>
      <description>
        
          &lt;p&gt;Now that i have &lt;a href=&#34;http://www.timvw.be/about-the-design-of-a-fluent-interface/&#34;&gt;defined my API for initialization&lt;/a&gt; it is time to implement it. Inspired by the Moq.Language and Moq.Language.Flow namespaces in &lt;a href=&#34;http://code.google.com/p/moq/&#34;&gt;Moq&lt;/a&gt; i have decided to define my interfaces in a separate namespace: Infrastructure.StateMachineLanguage.&lt;/p&gt;
&lt;p&gt;Ever since i have read &lt;a href=&#34;http://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882&#34;&gt;Clean code&lt;/a&gt; i feel the need to write classes that do one thing (and one thing only) so i came up with the following classes&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;something to store commands per state, CommandsForState&lt;/li&gt;
&lt;li&gt;something to store actions per command, ActionsForCommand&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the implementation of the IChooseCommandAndAction interface i have decided to create a class that falls back on my classes that handle IChooseCommand and IChooseAction already&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CommandAndActionForState&lt;/span&gt;&amp;lt;tstate, TCommand&amp;gt; : IChooseCommandAndAction&amp;lt;tstate, TCommand&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;readonly&lt;/span&gt; CommandsForState&amp;lt;tstate, TCommand&amp;gt; commandsForState;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;readonly&lt;/span&gt; ActionsForCommand&amp;lt;tstate, TCommand&amp;gt; actionsForCommand;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; CommandAndActionForState(CommandsForState&amp;lt;tstate, TCommand&amp;gt; commands, ActionsForCommand&amp;lt;tstate, TCommand&amp;gt; actions)
	{
		commandsForState = commands;
		actionsForCommand = actions;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IChooseAction&amp;lt;tstate, TCommand&amp;gt; On(TCommand command)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; commandsForState.On(command);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IChooseCommandAndAction&amp;lt;tstate, TCommand&amp;gt; Do(Action action)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; actionsForCommand.Do(action);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/statemachine.solution.png&#34; alt=&#34;screenshot of files in statemachine solution.&#34;&gt;&lt;/p&gt;
&lt;p&gt;As you can see, complex problems can have simple solutions. Feel free to download the complete solution: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/StateMachine.zip&#34;&gt;StateMachine.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting ControlStateMachine</title>
      <link>/post/2009-08-17-presenting-controlstatemachine/</link>
      <pubDate>Mon, 17 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-08-17-presenting-controlstatemachine/</guid>
      <description>
        
          &lt;p&gt;Here is a situation we are all familiar with: A form that only displays a certain set of controls depending on the mode or state of the application. Let me start with an example: At design time there are three buttons&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/controlstatemachine.design.png&#34; alt=&#34;screenshot of flowlayoutpanel with three buttons: edit, save and cancel.&#34;&gt;&lt;/p&gt;
&lt;p&gt;The user can look at the data and decide to edit it:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/controlstatemachine.display.png&#34; alt=&#34;screenshot of flowlayoutpanel with only one visible button: edit.&#34;&gt;&lt;/p&gt;
&lt;p&gt;Or the user is editing the data and can decide to commit or discard her changes:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/controlstatemachine.edit.png&#34; alt=&#34;screenshot of flowlayoutpanel with two visible buttons: save and cancel.&#34;&gt;&lt;/p&gt;
&lt;p&gt;A couple of years i ago i used to spread such display logic all over my code and it was hard to figure out which control was visible at a given point. Later on i refactored that code and encapsulated it in functions like: MakeControlsForDisplayVisible and MakeControlsForEditVisible which felt like a huge improvement. These days i have the feeling that a very simple state machine can improve the readability even better.&lt;/p&gt;
&lt;p&gt;Ok, so how simple is simple? Currently the requirements list is pretty limited:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/controlstatemachine.specs.png&#34; alt=&#34;screenshot of unittests for controlstatemachine&#34;&gt;&lt;/p&gt;
&lt;p&gt;Anyway, here is how i would write the code today (Yeah, for a stupid example this looks like overkill):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; InitializeButtonLayoutPanelMachine()
{
controlStateMachine = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ControlStateMachine&amp;lt;displayAndEditStates&amp;gt;(buttonLayoutPanel);

controlStateMachine.WhenStateChangesTo(DisplayAndEditStates.Display)
.TheOnlyVisibleControlsAre(buttonEdit);

controlStateMachine.WhenStateChangesTo(DisplayAndEditStates.Edit)
.TheOnlyVisibleControlsAre(buttonSave, buttonCancel);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As always, here is the source: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ControlStateMachine.cs.txt&#34;&gt;ControlStateMachine&lt;/a&gt; and &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/WhenChangingState.cs.txt&#34;&gt;WhenChangingState&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting ControlChanges</title>
      <link>/post/2009-08-15-presenting-controlchanges/</link>
      <pubDate>Sat, 15 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-08-15-presenting-controlchanges/</guid>
      <description>
        
          &lt;p&gt;Because i noticed that i kept writing the same operations on control over and over again i decided to capture them in a couple of functions. I presume most of you have done this already. Here is the list of operations:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/controlchanges.cd.png&#34; alt=&#34;screenshot of a class diagram with the following operations: MakeVisible, MakeInvisible and TheOnlyVisibleControlsAre.&#34;&gt;&lt;/p&gt;
&lt;p&gt;In case it is not clear what these methods should do i have defined the following specifications for them:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/controlchanges.specs.png&#34; alt=&#34;screenshot of requirements list for controlchanges.&#34;&gt;&lt;/p&gt;
&lt;p&gt;Get the code here: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ControlChanges.cs.txt&#34;&gt;ControlChanges&lt;/a&gt; and &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/WhenExecutingControlChanges.cs.txt&#34;&gt;WhenExecutingControlChanges&lt;/a&gt;. Stay tuned for more!&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Experimenting with ControlStateMachine and Fluent interfaces</title>
      <link>/post/2009-08-13-experimenting-with-controlstatemachine-and-fluent-interfaces/</link>
      <pubDate>Thu, 13 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-08-13-experimenting-with-controlstatemachine-and-fluent-interfaces/</guid>
      <description>
        
          &lt;p&gt;A long time ago i read &lt;a href=&#34;http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx&#34;&gt;Build your own CAB series&lt;/a&gt; and recently i noticed that there is a wiki: &lt;a href=&#34;http://www.jeremydmiller.com/ppatterns/Default.aspx?Page=MainPage&amp;amp;AspxAutoDetectCookieSupport=1&#34;&gt;Presentation Patterns Wiki!&lt;/a&gt; and it inspired me to experiment with state machines. Here are a couple of examples:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;controlStateMachine = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ControlStateMachine&amp;lt;states&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;);

controlStateMachine.AfterEachStateChange()
.Do(MakeRelevantButtonsVisible);

controlStateMachine.WhenStateChangesTo(States.RetrievingSubscriptionPeriod)
.TheOnlyVisibleControlsAre(flowLayoutPanel1, datePicker1);

controlStateMachine.WhenStateChangesTo(States.RetrievingCustomerInformation)
.MakeVisible(customerInput1)
.Do(() =&amp;gt; customerInput1.Dock = DockStyle.Fill);

controlStateMachine.WhenStateChangesTo(States.Ready)
.MakeInvisible(customerInput1);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is another example:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;wizardStateMachine = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; WizardStateMachine&amp;lt;states&amp;gt;(controlStateMachine);

wizardStateMachine.InState(States.RetrievingSubscriptionPeriod)
.OnCommand(WizardCommands.Next)
.TransitionTo(States.RetrievingCustomerInformation);

wizardStateMachine.InState(States.RetrievingCustomerInformation)
.OnCommand(WizardCommands.Back)
.TransitionTo(States.RetrievingSubscriptionPeriod)
.OnCommand(WizardCommands.Finish)
.TransitionTo(States.Ready);

wizardStateMachine.InState(States.Ready)
.OnCommand(WizardCommands.New)
.Do(() =&amp;gt; MessageBox.Show(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Currently not supported&amp;#34;&lt;/span&gt;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Stay tuned for future posts where i describe the problem space that have lead to this API.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Small modification to achieve better modularity with Prism</title>
      <link>/post/2009-07-11-modularity-with-prism/</link>
      <pubDate>Sat, 11 Jul 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-07-11-modularity-with-prism/</guid>
      <description>
        
          &lt;p&gt;I have been experimenting with WPF and Prism (&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/cc707819.aspx&#34;&gt;Composite Application Guidance for WPF and Silverlight&lt;/a&gt;) and ran into a major issue: modularity. Here is an excerpt from the documentation&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Modules have explicit boundaries, typically by subsystem or feature. Having these boundaries makes it easier for separate teams to develop modules. On large applications, teams may be organized by cross-cutting capabilities in addition to being organized by a specific subsystem or feature. For example, there may be a team assigned to shared components of the application, such as the shell or the common infrastructure module.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The Modularity quick start solution uses the DirectoryModuleCatalog to discover modules. The module projects have a build event that copy their output to a single Modules folder&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;xcopy &amp;#34;$(TargetDir)*.*&amp;#34; &amp;#34;$(SolutionDir)DirectoryLookupModularity\$(OutDir)Modules\&amp;#34; /Y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This means that if two modules output a file with the same name, one of the two will get lost :(. In order to avoid this we create a directory per module&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;xcopy &amp;#34;$(TargetDir)*.*&amp;#34; &amp;#34;$(SolutionDir)DirectoryLookupModularity\$(OutDir)Modules\$(TargetName)\&amp;#34; /Y
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;To make this work we have to modify the catalog a little&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; InnerLoad()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.IsNullOrEmpty(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ModulePath))
		&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvalidOperationException(Resources.ModulePathCannotBeNullOrEmpty);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (!Directory.Exists(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ModulePath))
		&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; InvalidOperationException(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(CultureInfo.CurrentCulture, Resources.DirectoryNotFound, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ModulePath));

	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; assemblyFile &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; Directory.GetFiles(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ModulePath, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*.dll&amp;#34;&lt;/span&gt;, SearchOption.AllDirectories))
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; privateBinPath = Path.GetFullPath(Path.GetDirectoryName(assemblyFile));
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; childDomain = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.BuildChildDomain(AppDomain.CurrentDomain, privateBinPath);

		&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; loaderType = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(InnerModuleInfoLoader);
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (loaderType.Assembly == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;continue&lt;/span&gt;;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; loader = (InnerModuleInfoLoader)childDomain.CreateInstanceFromAndUnwrap(loaderType.Assembly.Location, loaderType.FullName);
			loader.LoadAssembly(assemblyFile);
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Items.AddRange(loader.GetModuleInfos());
		}		
		&lt;span style=&#34;color:#66d9ef&#34;&gt;finally&lt;/span&gt;
		{
			AppDomain.Unload(childDomain);
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As long as we don&amp;rsquo;t use (unsigned and different) assembly files with the same name in different modules we will have a working solution.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Using the Do handler for a method with out parameters</title>
      <link>/post/2009-05-25-using-the-do-handler-for-a-method-with-out-parameters/</link>
      <pubDate>Mon, 25 May 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-05-25-using-the-do-handler-for-a-method-with-out-parameters/</guid>
      <description>
        
          &lt;p&gt;As you can read in &lt;a href=&#34;http://ayende.com/Wiki/(S(mc1hst55a1303emfc34dkmyr))/Rhino+Mocks+The+Do()+Handler.ashx&#34;&gt;the documentation&lt;/a&gt; for Rhino Mocks:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There are times when the returning a static value is not good enough for the scenario that you are testing, so for those cases, you can use the Do() handler to add custom behavior when the method is called. In general, the Do() handler simply replaces the method call. Its return value will be returned from the mocked call (as well as any exception thrown). The handler&amp;rsquo;s signature must match the method signature, since it gets the same parameters as the call.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There are quite a lot of delegates defined in Rhino.Mocks.Delegates but none of them has an output parameter so we got stuck when we tried to mock a method with the following signature:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; TryGet(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; Entity entity);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Luckily enough it didn&amp;rsquo;t take too long before i realised we could simply define our own delegate:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; TryGetMethod&amp;lt;keyType, ValueType&amp;gt;(KeyType key, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; ValueType &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we can easily setup a result for our method:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;myEntityRepository
.Stub(repository =&amp;gt; repository.TryGet(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; myEntity);)
.IgnoreArguments()
.Do((TryGetMethod&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;, MyEntity&amp;gt;)&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; MyEntity entity)
{
entity = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MyEntity();
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; id == &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
});
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Measuring elapsed time</title>
      <link>/post/2009-05-16-measuring-elapsed-time/</link>
      <pubDate>Sat, 16 May 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-05-16-measuring-elapsed-time/</guid>
      <description>
        
          &lt;p&gt;As the documentation for &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx&#34;&gt;System.Diagnostics.Stopwatch&lt;/a&gt; says&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In a typical Stopwatch scenario, you call the Start method, then eventually call the Stop method, and then you check elapsed time using the Elapsed property.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;I find it a shame that they didn&amp;rsquo;t provide a method that covers this particular scenario so i did it myself&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Stopwatch&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; TimeSpan Measure(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; Action action)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; stopwatch = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; System.Diagnostics.Stopwatch();
		stopwatch.Start();
		action.Invoke();
		stopwatch.Stop();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; stopwatch.Elapsed;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Consuming this method is as simple as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; duration = Stopwatch.Measure(() =&amp;gt; FindElement(&lt;span style=&#34;color:#ae81ff&#34;&gt;10000&lt;/span&gt;));
Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;It took {0:0} seconds.&amp;#34;&lt;/span&gt;, duration.TotalSeconds);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>POC: Moq API adapter for Rhino Mocks</title>
      <link>/post/2009-04-03-poc-moq-api-adapter-for-rhino-mocks/</link>
      <pubDate>Fri, 03 Apr 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-04-03-poc-moq-api-adapter-for-rhino-mocks/</guid>
      <description>
        
          &lt;p&gt;One of my main concerns with third party software, and software in general, is maintainability. The Rhino Mocks project has been out there for a couple of years now and i&amp;rsquo;m pretty confident that it won&amp;rsquo;t go away anytime soon. The Moq project is a lot younger and will have to proove that it can stay alive&amp;hellip;&lt;/p&gt;
&lt;p&gt;Anyway, because most people seem to digg the Moq API i have decided to write an adapter that provides the same API using Rhino Mocks. Here are some simple examples&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IEcho
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Echo(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; input);
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestClass]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MockTests&lt;/span&gt;
{
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestMethod]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToReturnObject()
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Mock&amp;lt;iecho&amp;gt; sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iecho&amp;gt;();

		&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		IEcho echo = sut.Object;

		&lt;span style=&#34;color:#75715e&#34;&gt;// Assert
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Assert.IsNotNull(echo);
		Assert.IsInstanceOfType(echo, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(IEcho));
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestMethod]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToSetupAnAction()
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Mock&amp;lt;iecho&amp;gt; sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iecho&amp;gt;();

		sut.Setup(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(IEcho echo)
		{
		echo.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);
		}).Returns(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);

		&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; result = sut.Object.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);

		&lt;span style=&#34;color:#75715e&#34;&gt;// Assert
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Assert.AreEqual(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;, result);
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestMethod]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToVerifyAnAction()
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Mock&amp;lt;iecho&amp;gt; sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iecho&amp;gt;();

		&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		sut.Object.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);

		&lt;span style=&#34;color:#75715e&#34;&gt;// Assert
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		sut.Verify(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(IEcho echo)
		{
		echo.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);
		});
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[ExpectedException(typeof(ExpectationViolationException))]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToVerifyAnActionThatDidNotHappen()
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Mock&amp;lt;iecho&amp;gt; sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iecho&amp;gt;();

		&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		sut.Object.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);

		&lt;span style=&#34;color:#75715e&#34;&gt;// Assert
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		sut.Verify(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(IEcho echo)
		{
		echo.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;mike&amp;#34;&lt;/span&gt;);
		});
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestMethod]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToRaiseAnEvent()
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Mock&amp;lt;iecho&amp;gt; sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iecho&amp;gt;();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; wasCalled = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;

		sut.Object.EchoCompleted += &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
		{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (sender == sut &amp;amp;&amp;amp; e == EventArgs.Empty) wasCalled = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
		};

		&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		sut.Raise(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(IEcho echo) { echo.EchoCompleted += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; }, sut, EventArgs.Empty);

		&lt;span style=&#34;color:#75715e&#34;&gt;// Assert
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Assert.IsTrue(wasCalled);
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[ExpectedException(typeof(ArgumentException))]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldBeAbleToThrowAnException()
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// Arrange
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Mock&amp;lt;iecho&amp;gt; sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iecho&amp;gt;();

		sut.Setup(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(IEcho echo)
		{
		echo.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);
		}).Throws&amp;lt;argumentException&amp;gt;();

		&lt;span style=&#34;color:#75715e&#34;&gt;// Act
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		sut.Object.Echo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tim&amp;#34;&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is the actual code for this simplistic adapter&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Mock&lt;/span&gt;&amp;lt;T&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; T : &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;readonly&lt;/span&gt; T mockedObject;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Mock()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.mockedObject = MockRepository.GenerateStub&amp;lt;T&amp;gt;();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; T Object
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.mockedObject; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Setup&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;, T&amp;gt; Setup(Action&amp;lt;T&amp;gt; action)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Setup&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;, T&amp;gt;(RhinoMocksExtensions.Stub(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.mockedObject, action));
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Setup&amp;lt;R, T&amp;gt; Setup&amp;lt;R&amp;gt;(Delegates.Function&amp;lt;R, T&amp;gt; action)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Setup&amp;lt;R, T&amp;gt;(RhinoMocksExtensions.Stub(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.mockedObject, action));
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Verify(Action&amp;lt;T&amp;gt; action)
	{
		RhinoMocksExtensions.AssertWasCalled(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.mockedObject, action);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Raise(Action&amp;lt;T&amp;gt; eventSubscription, &lt;span style=&#34;color:#66d9ef&#34;&gt;params&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] args)
	{
		RhinoMocksExtensions.Raise(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.mockedObject, eventSubscription, args);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Setup&amp;lt;R, T&amp;gt; Throws&amp;lt;e&amp;gt;() &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; E : Exception, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt;()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Setup&amp;lt;R, T&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.options.Throw(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; E()));
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Setup&lt;/span&gt;&amp;lt;R, T&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;readonly&lt;/span&gt; IMethodOptions&amp;lt;R&amp;gt; options;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Setup(IMethodOptions&amp;lt;R&amp;gt; options)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.options = options;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Setup&amp;lt;R, T&amp;gt; Returns(R objToReturn)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Setup&amp;lt;R, T&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.options.Return(objToReturn));
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Setup&amp;lt;R, T&amp;gt; Returns(Delegates.Function&amp;lt;R, T&amp;gt; action)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Setup&amp;lt;R, T&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.options.Do(action));
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Strict mocks lead to overspecification</title>
      <link>/post/2009-03-24-strict-mocks-lead-to-overspecification/</link>
      <pubDate>Tue, 24 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-03-24-strict-mocks-lead-to-overspecification/</guid>
      <description>
        
          &lt;p&gt;Here is an example that demonstrates how strick mocks lead to overspecification. Imagine that we are creating a simple screen in a &lt;a href=&#34;http://martinfowler.com/eaaDev/PassiveScreen.html&#34;&gt;Passive View&lt;/a&gt; architecture. The first feature that we implement is displaying the message &amp;ldquo;edit&amp;rdquo; when the user clicks the edit button&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[Fact]&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldDisplayEditClickMessage()
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// Establish context
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	MockRepository mockRepository = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MockRepository();
	IView view = mockRepository.StrictMock&amp;lt;iview&amp;gt;();
	Expect.Call(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { view.EditClick += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; }).IgnoreArguments();
	mockRepository.Replay(view);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Create sut
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	Presenter sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Presenter(view);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Setup expectations
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	mockRepository.BackToRecord(view, BackToRecordOptions.Expectations);
	Expect.Call(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { view.DisplayClickMessage(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;edit&amp;#34;&lt;/span&gt;); });
	mockRepository.ReplayAll();

	&lt;span style=&#34;color:#75715e&#34;&gt;// Exercise
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	RhinoMocksExtensions
	.GetEventRaiser(view, &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(IView v) { v.EditClick += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; })
	.Raise(view, EventArgs.Empty);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Verify
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	mockRepository.VerifyAll();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/overspecification-01.PNG&#34; alt=&#34;screenshot of test runner with all tests passing&#34;&gt;&lt;/p&gt;
&lt;p&gt;And now we add the feature that displays the message &amp;ldquo;save&amp;rdquo; whenever the user clicks on the save button&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[Fact]&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldDisplaySaveClickMessage()
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// Establish context
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	MockRepository mockRepository = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MockRepository();
	IView view = mockRepository.StrictMock&amp;lt;iview&amp;gt;();
	Expect.Call(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { view.EditClick += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; }).IgnoreArguments();
	Expect.Call(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { view.SaveClick += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; }).IgnoreArguments();
	mockRepository.Replay(view);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Create sut
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	Presenter sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Presenter(view);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Setup expectations
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	mockRepository.BackToRecord(view, BackToRecordOptions.Expectations);
	Expect.Call(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { view.DisplayClickMessage(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;save&amp;#34;&lt;/span&gt;); });
	mockRepository.ReplayAll();

	&lt;span style=&#34;color:#75715e&#34;&gt;// Exercise
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	RhinoMocksExtensions
	.GetEventRaiser(view, &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(IView v) { v.SaveClick += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; })
	.Raise(view, EventArgs.Empty);

	&lt;span style=&#34;color:#75715e&#34;&gt;// Verify
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	mockRepository.VerifyAll();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/overspecification-02.PNG&#34; alt=&#34;screenshot of test runner with a failing test.&#34;&gt;&lt;/p&gt;
&lt;p&gt;Although we implemented the feature correctly, and left the code of the first feature untouched, we notice that our ShouldDisplayEditClickMessage test fails because it is not expecting a subscription to the SaveClick event. Imho, this way of testing is a testing &lt;strong&gt;anti-pattern&lt;/strong&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Comparing Moq to Rhino Mocks</title>
      <link>/post/2009-03-23-comparing-moq-to-rhino-mocks/</link>
      <pubDate>Mon, 23 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-03-23-comparing-moq-to-rhino-mocks/</guid>
      <description>
        
          &lt;p&gt;So which mocking framework should we use? Do we fall back on good old &lt;a href=&#34;http://ayende.com/projects/rhino-mocks.aspx&#34;&gt;Rhino Mocks&lt;/a&gt; or do we choose for the new kid on the block &lt;a href=&#34;http://code.google.com/p/moq/&#34;&gt;Moq&lt;/a&gt;?&lt;/p&gt;
&lt;p&gt;From a technical point of view i would dare to say that they will be able to support the same set of features because they&amp;rsquo;re both based on Castle&amp;rsquo;s &lt;a href=&#34;http://www.castleproject.org/dynamicproxy/index.html&#34;&gt;DynamicProxy&lt;/a&gt;. Rhino Mocks has the advantages that it, unlike Moq, supports the mocking of Delegates and can be used in a .Net 2.0 only environment. Whether or not we should care about these differences is a question i will leave unanswered.&lt;/p&gt;
&lt;p&gt;From a user point of view i find the Moq API a bit cleaner because &lt;!-- raw HTML omitted --&gt;it frees me from thinking about the record-replay model&lt;!-- raw HTML omitted --&gt; and Rhino Mocks wants me to make assertions on a stub. Apart from that the differences are rather small given for the use-cases i presented in &lt;a href=&#34;http://www.timvw.be/getting-started-with-moq/&#34;&gt;Getting started with Moq&lt;/a&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Creating instances&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Rhino  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; productDetailView = MockRepository.GenerateStub&amp;lt;iproductDetailView&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;vs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Moq
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; productDetailViewMock = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iproductDetailView&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Setting up results&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Rhino Mocks
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productRepository
    .Stub(repository =&amp;gt; repository.GetCategory(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)).IgnoreArguments()
    .Do((Delegates.Function&amp;lt;icategory, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;)(categoryId =&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; category;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;vs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Moq
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productRepositoryMock    
    .Setup(repository =&amp;gt; repository.GetCategory(It.IsAny&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;())) 
    .Returns&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(categoryId =&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; category.Object;});
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Consuming the mocked objects&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Rhino Mocks
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Nothing to do
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;vs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Moq  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Nothing to do
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Raising events&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Rhino Mocks
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productDetailView.Raise(view =&amp;gt; view.EditClick += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;).Raise(sender, EventArgs.Empty);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;vs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Moq  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productDetailViewMock.Raise(view =&amp;gt; view.EditClick += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, sender, EventArgs.Empty);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Verifying that a method was invoked&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Rhino Mocks -- Odd that i&amp;#39;m asserting on a Stub.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productRepository.AssertWasCalled(    
    repository =&amp;gt; repository.FindCategories(
    Arg&amp;lt;ispecification&amp;lt;icategory&amp;gt;&amp;gt;.Matches(Is.TypeOf(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(All&amp;lt;icategory&amp;gt;)))));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;vs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Moq
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productRepositoryMock.Verify(    
    repository =&amp;gt; repository.FindCategories(
		It.Is&amp;lt;ispecification&amp;lt;icategory&amp;gt;&amp;gt;(specification =&amp;gt; specification.GetType() == &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(All&amp;lt;icategory&amp;gt;))));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Override a result&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Rhino Mocks  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productDetailView.BackToRecord();
    
productDetailView    
    .Stub(view =&amp;gt; view.CategoryId)
    .Returns(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;vs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Moq  
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;productDetailViewMock
    .Setup(view =&amp;gt; view.CategoryId).Returns(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Editted code to take advantage of the new AAA syntax that comes with Rhino Mocks 3.5 If only someone could show me how i can override a Stubbed result&amp;hellip;&lt;/strong&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Getting started with Moq</title>
      <link>/post/2009-03-21-getting-started-with-moq/</link>
      <pubDate>Sat, 21 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-03-21-getting-started-with-moq/</guid>
      <description>
        
          &lt;p&gt;In this article I will demonstrate the Moq API by means of a simple application that allows the user to manage a quote.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/QuoteOfTheDay-01.jpg&#34; alt=&#34;screenshot of quote manager displaying opening screen.&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/QuoteOfTheDay-02.jpg&#34; alt=&#34;screenshot of quote manager displaying edit screen.&#34;&gt;&lt;/p&gt;
&lt;p&gt;In order to prevent that we have to rewrite our application when we move to a different graphical environment such as Web Forms, Silverlight or WPF I have decided to apply the [Humble Object](&lt;a href=&#34;http://xunitpatterns.com/Humble&#34;&gt;http://xunitpatterns.com/Humble&lt;/a&gt; Object.html) pattern in the design. The implementation of the application has been based on the &lt;a href=&#34;http://martinfowler.com/eaaDev/PassiveScreen.html&#34;&gt;Passive View pattern&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;First we describe what should happen when the user launches the application:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The quote should be displayed&lt;/li&gt;
&lt;li&gt;The Edit button should be visible&lt;/li&gt;
&lt;li&gt;The OK button should be invisible&lt;/li&gt;
&lt;li&gt;The Cancel button should be invisible&lt;/li&gt;
&lt;li&gt;It should not be possible to edit the quote&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now we translate these requirements in &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/Code-01.txt&#34;&gt;code&lt;/a&gt;. Because it is too expensive to test with actual Windows resources I have decided to use a mock object that mimics the actual resource. This is done in the Given method which arranges the context in which we want to verify the behavior:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;iquoteFormView&amp;gt;();
&lt;span style=&#34;color:#75715e&#34;&gt;// The mimicked view object is available via the Object property
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.sut = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; QuoteFormPresenter(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock.Object);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The When method is used to invoke the behavior that we want to verify. In the situation where the user launches the application this means raising the Load event:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock.Raise(view =&amp;gt; view.Load += &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, EventArgs.Empty);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We can verify that a certain method has been called as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock.Verify(view =&amp;gt; view.MakeEditButtonVisible(&lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In situations where we don’t have the exact parameters for the method that should be invoked we can use the &lt;a href=&#34;http://api.moq.me/html/FBE0FFA5.htm&#34;&gt;It&lt;/a&gt; class to describe those parameters:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock.Verify(view =&amp;gt; view.DisplayQuote(It.IsAny&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;()));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We repeat this process of defining and implementing the requirements for the other interactions we want to describe. We end up with a set of requirements that looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/QuoteOfTheDay-03.jpg&#34; alt=&#34;screenshot of test manager&#34;&gt;&lt;/p&gt;
&lt;p&gt;In case the user clicked the Cancel button we want to verify that the updated quote is not displayed:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock.Verify(view =&amp;gt; view.DisplayQuote(It.IsAny&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;()), Times.Never());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In case the user clicked the OK button we have to ensure a context where an updated quote is available. This is achieved by adding the following in our Given method:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock
.Setup(view =&amp;gt; view.UpdatedQuote)
.Returns(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.updatedQuote);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we can verify that the updated quote is displayed:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock.Verify(view =&amp;gt; view.DisplayQuote(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.updatedQuote));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Virtually every application interacts with a database and the same is true for our application. Just like we abstracted our view, we decide to abstract our quote resource too. In case the user clicked the OK button we want to verify that the resource was instructed to update the quote.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; quote = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteFormViewMock.Object.UpdatedQuote;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.quoteResourceMock.Verify(resource =&amp;gt; resource.Update(quote));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In case the quote resource fails we would like to display an error message. To achieve this we create a new test that establishes a context where the quote resource throws an exception when it is asked to update a quote as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.Given();
&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.quoteResourceMock
.Setup(resource =&amp;gt; resource.Update(It.IsAny&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;()))
.Throws(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ApplicationException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Resource is unavailable.&amp;#34;&lt;/span&gt;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Sometimes we want to determine what should happen based on the parameters that are provided. In that case we can provide the Returns function a delegate:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.quoteResourceMock
.Setup(resource =&amp;gt; resource.Update(It.IsAny&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;()))
.Returns&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;(quote =&amp;gt;
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.IsNullOrEmpty(quote)) &lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ApplicationException();
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; quote.Replace(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;b&amp;#34;&lt;/span&gt;);
});
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I think that this covers most typical usage scenarios. Feel free to download the code: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/QuoteManager.zip&#34;&gt;QuoteManager.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Another reason for not using mstest</title>
      <link>/post/2009-03-14-another-reason-for-not-using-mstest/</link>
      <pubDate>Sat, 14 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-03-14-another-reason-for-not-using-mstest/</guid>
      <description>
        
          &lt;p&gt;As you can read in &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms182172(VS.80).aspx&#34;&gt;CA1001&lt;/a&gt;: Types that own disposable fields should be disposable. Pretty solid advice, but for some reason the mstest runner does not dispose of classes that implement IDisposable. A possible workaround is to apply a &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testcleanupattribute(VS.80).aspx&#34;&gt;TestCleanupAttribute&lt;/a&gt; to the Dispose method, but this is really contradictory with the &amp;ldquo;Shared test fixture&amp;rdquo; approach mstest uses. Imho, there is only one clean solution: use a decent testing framework instead.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Setup expectation with successive function calls using Moq</title>
      <link>/post/2009-03-14-setup-expectation-with-successive-function-calls-using-moq/</link>
      <pubDate>Sat, 14 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-03-14-setup-expectation-with-successive-function-calls-using-moq/</guid>
      <description>
        
          &lt;p&gt;In the &lt;a href=&#34;http://code.google.com/p/moq/wiki/QuickStart&#34;&gt;Quickstart&lt;/a&gt; guide we find an example that shows us how to setup a different return value for each invocation as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// returning different values on each invocation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; mock = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;ifoo&amp;gt;();
&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; calls = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
mock.Setup(foo =&amp;gt; foo.Execute(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ping&amp;#34;&lt;/span&gt;))
	.Returns(() =&amp;gt; calls)
	.Callback(() =&amp;gt; calls++);
&lt;span style=&#34;color:#75715e&#34;&gt;// returns 0 on first invocation, 1 on the next, and so on
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;Console.WriteLine(mock.Object.Execute(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ping&amp;#34;&lt;/span&gt;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In &lt;a href=&#34;http://www.madprops.org/blog/moq-triqs-successive-expectations/&#34;&gt;Moq Triqs &amp;ndash; Successive Expectations&lt;/a&gt; i found inspiration to implement an extension method that allows me to define an expectation that calls a set of successive functions&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MoqExtensions&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IReturnsResult&amp;lt;tmock&amp;gt; ReturnsInOrder&amp;lt;tmock, TResult&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; ISetup&amp;lt;tmock, TResult&amp;gt; setup, &lt;span style=&#34;color:#66d9ef&#34;&gt;params&lt;/span&gt; Func&amp;lt;tresult&amp;gt;[] valueFunctions) &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; TMock : &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; functionQueue = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Queue&amp;lt;func&amp;lt;tresult&amp;gt;&amp;gt;(valueFunctions);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; setup.Returns(() =&amp;gt; functionQueue.Dequeue()());
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This allows me to define a set of functions that i want to be called for each successive call&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;WhenSettingUpOrderedExpectationFunctions&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; ICategory { &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Id { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; } }
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[Fact]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldReturnTheSequenceOfIds()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; category = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Mock&amp;lt;icategory&amp;gt;();

		category.Setup(c =&amp;gt; c.Id).ReturnsInOrder(
			() =&amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
			() =&amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,
			() =&amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,
			() =&amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;);

		&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; expectedIds = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; { &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt; };
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; expectedId &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; expectedIds) Assert.Equal(expectedId, category.Object.Id);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Using sed</title>
      <link>/post/2009-03-05-using-sed/</link>
      <pubDate>Thu, 05 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-03-05-using-sed/</guid>
      <description>
        
          &lt;p&gt;For a couple of days now i&amp;rsquo;ve been pondering about posting something about my love for &lt;a href=&#34;http://www.gnu.org/software/textutils/&#34;&gt;GNU text-utilities&lt;/a&gt; but never got round to it. A couple of minutes ago i read Phil Windley&amp;rsquo;s &lt;a href=&#34;http://www.windley.com/archives/2009/03/using_grep_and_find.shtml&#34;&gt;Using Grep and Find&lt;/a&gt; post so here is a one-liner that shows how you can add a reference to a msbuild target file to all csproj files in a given folder:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;find -name *.csproj -exec sed -i -e &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;#^&amp;lt;/project&amp;gt;$# &amp;lt;import Project=&amp;#34;X:\\BuildTasks\\Corp.targets&amp;#34; /&amp;gt;\r\n&amp;lt;/project&amp;gt;&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;{}&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Or if you are frustrated with System.Diagnostics.CodeAnalysis.SuppressMessageAttributes and want to remove them from all your cs files:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;find -name &lt;span style=&#34;color:#ae81ff&#34;&gt;\*&lt;/span&gt;.cs -exed sed -r -i -e &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;s#\[.\*?SuppressMessage.*?\]##&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;{}&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;\&amp;#34;&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting MyTestRunner</title>
      <link>/post/2008-12-24-presenting-mytestrunner/</link>
      <pubDate>Wed, 24 Dec 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-12-24-presenting-mytestrunner/</guid>
      <description>
        
          &lt;p&gt;Here are a couple of reasons why i dislike the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms243147(VS.80).aspx&#34;&gt;Unit Testing Framework&lt;/a&gt; that comes with &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/fda2bad5(VS.80).aspx&#34;&gt;Visual Studio Team System&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Not all versions of Visual Studio are capable of running the tests.&lt;/li&gt;
&lt;li&gt;Test inheritance is not supported.&lt;/li&gt;
&lt;li&gt;Running tests via mstest.exe is slow.&lt;/li&gt;
&lt;li&gt;Visual Studio creating tens of .vmsdi files.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There are already a couple of better frameworks out there, and currently &lt;a href=&#34;http://mbunit.com/&#34;&gt;MbUnit&lt;/a&gt; is my favorite one, certainly in combination with &lt;a href=&#34;http://www.testdriven.net/&#34;&gt;TestDriven.NET&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I have created a custom implementation of the Microsoft.VisualStudio.QualityTools.UnitTestingFramework assembly. Actually, the assembly only has a couple of Attributes for the moment but contributions are always welcome 😉&lt;/p&gt;
&lt;p&gt;In order to achieve better performance i decided to implement a custom test runner. Currently &lt;a href=&#34;http://www.gallio.org/&#34;&gt;Gallio&lt;/a&gt; uses mstest.exe but there might be a day that i decide to write a plugin so that mytestrunner can be used instead.&lt;/p&gt;
&lt;p&gt;I was inspired by &lt;a href=&#34;http://docs.mbunit.com/help/html/MbUnitAndVisualStudio/CreatingSelfTestingAssemblies.htm&#34;&gt;Creating Self-testing Assemblies&lt;/a&gt; and decided to use that approach but for some odd reason visual studio insists on running unit tests although the assembly is a console application 🙁 Anyway, i can still invoke mytestrunner via the external tools as following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/mytestrunner-external-tools.gif&#34; alt=&#34;screenshot of external tools dialog&#34;&gt;&lt;/p&gt;
&lt;p&gt;The source code is available at &lt;a href=&#34;http://code.google.com/p/mytestrunner/&#34;&gt;http://code.google.com/p/mytestrunner/&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Query a specific Google Calendar</title>
      <link>/post/2008-10-22-query-a-specific-google-calendar/</link>
      <pubDate>Wed, 22 Oct 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-10-22-query-a-specific-google-calendar/</guid>
      <description>
        
          &lt;p&gt;Despite the multiple copies of the &lt;a href=&#34;http://code.google.com/apis/calendar/developers_guide_dotnet.html&#34;&gt;API Developer&amp;rsquo;s Guide: .NET&lt;/a&gt; i found i was unable to find how i should query a specific calendar (not the default). Anyway, it can be done by using the CalendarEntry.Content.BaseUri as the query uri. Here is an example&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;CalendarHelper&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; OwnedCalendarsUrl = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.google.com/calendar/feeds/default/owncalendars/full&amp;#34;&lt;/span&gt;;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;readonly&lt;/span&gt; CalendarService svc;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; CalendarHelper(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; username, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; password)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.svc = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CalendarService(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;demo&amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.svc.setUserCredentials(username, password);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IEnumerable&amp;lt;calendarEntry&amp;gt; FindOwnedCalendars()
	{
		CalendarQuery query = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CalendarQuery(OwnedCalendarsUrl);
		CalendarFeed result = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.svc.Query(query);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (CalendarEntry entry &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; result.Entries) &lt;span style=&#34;color:#66d9ef&#34;&gt;yield&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; entry;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; CalendarEntry GetCalendar(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (
			&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt; calendar &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.FindOwnedCalendars()
			&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; calendar.Title.Text == name
			&lt;span style=&#34;color:#66d9ef&#34;&gt;select&lt;/span&gt; calendar).SingleOrDefault();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IEnumerable&amp;lt;atomEntry&amp;gt; FindEvents(CalendarEntry calendar, DateTime begin, DateTime end)
	{
		EventQuery myQuery = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EventQuery(calendar.Content.AbsoluteUri);
		myQuery.StartTime = begin;
		myQuery.EndTime = end;
		EventFeed result = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.svc.Query(myQuery);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; result.Entries.Count; ++i) &lt;span style=&#34;color:#66d9ef&#34;&gt;yield&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; result.Entries[i]; 
	} 
} 

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main() 
{ 
	CalendarHelper helper = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CalendarHelper(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;user@gmail.com&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;xxx&amp;#34;&lt;/span&gt;); 
	DateTime begin = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;); 
	DateTime end= &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2009&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;31&lt;/span&gt;); 
	IEnumerable&amp;lt;calendarEntry&amp;gt; calendars = helper.FindOwnedCalendars();
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (CalendarEntry calendar &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; calendars)
	{
		Console.WriteLine(calendar.Title.Text);

		IEnumerable&amp;lt;atomEntry&amp;gt; calendarEvents = helper.FindEvents(calendar, begin, end);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt;(AtomEntry calendarEvent &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; calendarEvents)
		{
			Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}: {1}&amp;#34;&lt;/span&gt;, calendarEvent.Updated, calendarEvent.Title.Text);
		}

		Console.WriteLine();
	}

	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Refactoring Application Environment (Part 2)</title>
      <link>/post/2008-10-17-refactoring-application-environment-part-2/</link>
      <pubDate>Fri, 17 Oct 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-10-17-refactoring-application-environment-part-2/</guid>
      <description>
        
          &lt;p&gt;&lt;a href=&#34;http://lucamilan.blogspot.com/&#34;&gt;Luca Milan&lt;/a&gt; notified me of a design issue. Until now the ApplicationEnvironment had an Instance property as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; ApplicationEnvironment Instance { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { ... } }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;A lot of flexibility can be added by extracting an interface IApplicationEnvironment and use that as return type for the property:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IApplicationEnvironment Instance { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { ... } }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now that we have &lt;a href=&#34;http://www.codeplex.com/CommonServiceLocator&#34;&gt;Common Service Locator&lt;/a&gt; i have decided to completely remove the Instance property. Code that requires an instance of the IApplicationEnvironment will have to resolve it via the ServiceLocator:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;IApplicationEnvironment appEnv = ServiceLocator.Current.GetInstance&amp;lt;iapplicationEnvironment&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>How does the controller know which action method to invoke?</title>
      <link>/post/2008-10-15-how-does-the-controller-know-which-action-method-to-invoke/</link>
      <pubDate>Wed, 15 Oct 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-10-15-how-does-the-controller-know-which-action-method-to-invoke/</guid>
      <description>
        
          &lt;p&gt;Yesterday i attended another great &lt;a href=&#34;http://www.visug.be&#34;&gt;VISUG&lt;/a&gt; event on ASP.NET presented by &lt;a href=&#34;http://blog.maartenballiauw.be/&#34;&gt;Maarten Balliauw&lt;/a&gt;. He demonstrated a custom filter but did not dig into the mechanics of action method resolving. With the aid of of the ActionName attribute we can map different methods to the same action. The following methods will all map to the same &amp;ldquo;Detail&amp;rdquo; action&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ActionResult Detail(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; productId) { ... }
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ActionResult Detail(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; productId, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name) { ... }
&lt;span style=&#34;color:#a6e22e&#34;&gt;[ActionName(&amp;#34;Detail&amp;#34;)]&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ActionResult DisplayDetail(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; productId) { ... }
&lt;span style=&#34;color:#a6e22e&#34;&gt;[ActionName(&amp;#34;Detail&amp;#34;)]&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ActionResult ModifyDetail(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; productId, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name) { ... }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So how does the Controller know which method to invoke? The answer can be found in the ActionMethodSelector which tries to find the method as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; MethodInfo FindActionMethod(ControllerContext controllerContext, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; action)
{
	List&amp;lt;methodInfo&amp;gt; methodsMatchingName = GetMatchingAliasedMethods(controllerContext, action);
	methodsMatchingName.AddRange(NonAliasedMethods[action]);
	List&amp;lt;methodInfo&amp;gt; finalMethods = RunSelectionFilters(controllerContext, methodsMatchingName);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;switch&lt;/span&gt; (finalMethods.Count)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; finalMethods[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;];
		&lt;span style=&#34;color:#66d9ef&#34;&gt;default&lt;/span&gt;: &lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; CreateAmbiguousMatchException(finalMethods, action);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In the RunSelectionFilters method all the found ActionSelection Attributes have their IsValidForRequest method called in the hope that only one potential method remains.&lt;/p&gt;
&lt;p&gt;The most common scenario is that we want our controller to behave depending upon the request method (POST vs GET). For this scenario there is the AcceptVerbsAttribute. eg&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[ActionName(&amp;#34;Detail&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;[AcceptVerbs(&amp;#34;GET&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ActionResult DisplayDetail(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; productId) { ... }
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[ActionName(&amp;#34;Detail&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#a6e22e&#34;&gt;[AcceptVerbs(&amp;#34;POST&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ActionResult ModifyDetail(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; productId, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name) { ... }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The implementation of the IsValidForRequest method in the AcceptVerbsAttribute is pretty simple&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; IsValidForRequest(ControllerContext controllerContext, MethodInfo methodInfo)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (controllerContext == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentNullException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;controllerContext&amp;#34;&lt;/span&gt;);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; incomingVerb = controllerContext.HttpContext.Request.HttpMethod;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Verbs.Contains(incomingVerb, StringComparer.OrdinalIgnoreCase);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Adaptive control behavior: LinkButton without javascript</title>
      <link>/post/2008-10-14-adaptive-control-behavior-linkbutton-without-javascript/</link>
      <pubDate>Tue, 14 Oct 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-10-14-adaptive-control-behavior-linkbutton-without-javascript/</guid>
      <description>
        
          &lt;p&gt;&amp;lsquo;Experiment with &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/67276kc5.aspx&#34;&gt;Adaptive Control Behavior&lt;/a&gt;&amp;rsquo; has been an item on my TO-DO list for a very long time and this weekend i finally found some time to do exactly that. Because i hate it that a &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.aspx&#34;&gt;LinkButton&lt;/a&gt; renders as &lt;!-- raw HTML omitted --&gt; i decided to develop a &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.web.ui.adapters.controladapter.aspx&#34;&gt;ControlAdapter&lt;/a&gt; that makes the LinkButton work without JavaScript. While i was at it i also wrote adapters for the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.loginstatus(VS.80).aspx&#34;&gt;LoginStatus&lt;/a&gt; and &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.aspx&#34;&gt;Login&lt;/a&gt; controls. Feel free to play with the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/AdaptiveRenderingDemo.zip&#34;&gt;Adaptive Rendering Demo&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Revisited the int and string ValueObject templates</title>
      <link>/post/2008-10-13-revisited-the-int-and-string-valueobject-templates/</link>
      <pubDate>Mon, 13 Oct 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-10-13-revisited-the-int-and-string-valueobject-templates/</guid>
      <description>
        
          &lt;p&gt;After reading &lt;a href=&#34;http://blogs.msdn.com/bclteam/archive/2008/10/06/the-compare-contract-kim-hamilton.aspx&#34;&gt;The Compare Contract&lt;/a&gt; last week i realized that my &lt;a href=&#34;http://www.timvw.be/presenting-templates-for-int-and-string-valueobjects&#34;&gt;templates for int and string ValueObjects&lt;/a&gt; did not comply with the contract so i decided to add a unittest that reproduces the faulty behavior (and then corrected the implementation)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldReturnPositiveWhenComparedWithNull()
{
	&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;classname&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;classname&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;$&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;);
	Assert.IsTrue(&lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;.CompareTo(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Anyway, feel free to download the corrected &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/IntValueObject.zip&#34;&gt;IntValueObject&lt;/a&gt; and &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/StringValueObject.zip&#34;&gt;StringValueObject&lt;/a&gt; templates.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Experimenting with NDepend</title>
      <link>/post/2008-09-27-experimenting-with-ndepend/</link>
      <pubDate>Sat, 27 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-27-experimenting-with-ndepend/</guid>
      <description>
        
          &lt;p&gt;Google Reader found 122 posts in my &lt;a href=&#34;http://www.timvw.be/wp-links-opml.php&#34;&gt;blogroll&lt;/a&gt; about &lt;a href=&#34;http://www.ndepend.com&#34;&gt;NDepend&lt;/a&gt; so i happily accepted the professional license which &lt;a href=&#34;http://codebetter.com/blogs/patricksmacchia/&#34;&gt;Patrick Smacchia&lt;/a&gt; (thank you) offered me earlier this week. I quickly picked the assemblies from a project that has evolved over more than 5 years (.NET 1.0, 1.1 and 2.0) and the tool generated a screen loaded with data, but i found it difficult to extract any valuable information out of the statistics. Although i found zooming in the UI impressive, i was a bit disappointed.&lt;/p&gt;
&lt;p&gt;Today i decided to start with something more sensible and created an NDepend project for the &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt; solution. In order to add the code coverage results i first had to export them from visual studio. And then i let the analyzer do it&amp;rsquo;s job. In the results of the default &lt;a href=&#34;http://www.ndepend.com/CQL.htm&#34;&gt;CQL&lt;/a&gt; queries i found that the DateTimeHelper class was stateless, and thus could be turned into a static class. I also noticed the warning that the UnixEpoch field was public. After giving it a bit of thought i decided to leave the field public, but make it readonly. Although i have only used the tool for only an hour or so, it has already proven it&amp;rsquo;s usefulness. More experimentation is definitely required.&lt;/p&gt;
&lt;p&gt;I will finish with a couple of feature requests:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Automate the import of code coverage results generated by Visual Studio.&lt;/li&gt;
&lt;li&gt;Use the default browser instead of launching Internet Explorer.&lt;/li&gt;
&lt;/ul&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting templates for int and string ValueObjects</title>
      <link>/post/2008-09-26-presenting-templates-for-int-and-string-valueobjects/</link>
      <pubDate>Fri, 26 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-26-presenting-templates-for-int-and-string-valueobjects/</guid>
      <description>
        
          &lt;p&gt;Most &lt;a href=&#34;http://domaindrivendesign.org/discussion/messageboardarchive/ValueObjects.html&#34;&gt;ValueObjects&lt;/a&gt; that i have implemented were wrappers around an int or a string. Apart from the domain specific rules, there is a lot of repetitive work in implementing operator overloads, IEquatable&lt;!-- raw HTML omitted --&gt;, IComparable&lt;!-- raw HTML omitted --&gt;, &amp;hellip; Thus i decided to create a couple of Item templates that generate this code (and related tests).&lt;/p&gt;
&lt;p&gt;Simply save &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/IntValueObject.zip&#34;&gt;IntValueObject.zip&lt;/a&gt; and &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/StringValueObject.zip&#34;&gt;StringValueObject.zip&lt;/a&gt; under %My Documents%\Visual Studio 2005\Templates\ItemTemplates and click on &amp;ldquo;Add New Item&amp;rdquo; in your project:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/template_add_new_item.gif&#34; alt=&#34;screenshot of add new item dialog in visual studio&#34;&gt;&lt;/p&gt;
&lt;p&gt;Add the bottom of the dialog you can choose one of the templates:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/template_my_templates.gif&#34; alt=&#34;screenshot of add new item dialog in visual studio&#34;&gt;&lt;/p&gt;
&lt;p&gt;Here is the result of adding an &lt;a href=&#34;http://en.wikipedia.org/wiki/International_Standard_Book_Number&#34;&gt;International Standard Book Number&lt;/a&gt; class:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/template_isbn.gif&#34; alt=&#34;screenshot of generated artificates for isbn&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Why MockRepository does not implement IDisposable</title>
      <link>/post/2008-09-26-why-mockrepository-does-not-implement-idisposable/</link>
      <pubDate>Fri, 26 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-26-why-mockrepository-does-not-implement-idisposable/</guid>
      <description>
        
          &lt;p&gt;Earlier this week i was experimenting with &lt;a href=&#34;http://ayende.com/projects/rhino-mocks.aspx&#34;&gt;Rhino Mocks&lt;/a&gt; and i was wondering why the MockRepository does not implement &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.idisposable.aspx&#34;&gt;IDisposable&lt;/a&gt; unlike most other mocking frameworks for .NET&lt;!-- raw HTML omitted --&gt;. After a bit of searching i found out that (&lt;a href=&#34;http://groups.google.com/group/RhinoMocks/browse_thread/thread/c1a89f58d512d03e/48ca85746276c97b?lnk=gst&amp;amp;q=idisposable+mockrepository&amp;amp;pli=1&#34;&gt;here&lt;/a&gt;) originally the MockRepository did implement the interface, but that the implementation was removed because it is can be painful (hiding the original exception) when unexpected exceptions are thrown.&lt;/p&gt;
&lt;p&gt;I really like the API. Here is a simple example and notice that i did not have to provide the method name (as in the string &amp;ldquo;GetTime&amp;rdquo;) for the excepted calls.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestClass]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;WhenTestingApplicabilityOfContract&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; MockRepository repository;
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestInitialize]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; BeforeEachMethod()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.repository = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MockRepository();
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestCleanup]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; AfterEachMethod()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.repository.VerifyAll();
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[TestMethod]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldReturnTrueWhenTimeInPeriodOfContract()
	{
		ITimeProvider provider = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.repository.StrictMock&amp;lt;itimeProvider&amp;gt;();

		using(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.repository.Record())
		{
			Expect.Call(provider.GetTime()).Return(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;));
			Expect.Call(provider.GetTime()).Return(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;));
			Expect.Call(provider.GetTime()).Return(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2009&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;));
		}

		using(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.repository.Playback())
		{
			Contract contract = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Contract(provider, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;31&lt;/span&gt;));

			Assert.IsFalse(contract.IsApplicable(), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;not applicablein 2007&amp;#34;&lt;/span&gt;);
			Assert.IsTrue(contract.IsApplicable(), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;applicable in 2008&amp;#34;&lt;/span&gt;);
			Assert.IsFalse(contract.IsApplicable(), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;not applicable in 2009&amp;#34;&lt;/span&gt;);
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Refactoring ApplicationEnvironment</title>
      <link>/post/2008-09-23-refactoring-applicationenvironment/</link>
      <pubDate>Tue, 23 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-23-refactoring-applicationenvironment/</guid>
      <description>
        
          &lt;p&gt;Yesterday i blogged about an &lt;a href=&#34;http://www.timvw.be/presenting-applicationenvironment/&#34;&gt;ApplicationEnvironment&lt;/a&gt; which had a dependency on the application configuration file. With my &lt;a href=&#34;http://www.timvw.be/presenting-configurationfilesession/&#34;&gt;ConfigurationFileSession&lt;/a&gt; i was able to test the implementation despite that dependency. Today i modified the design a little so that i do not require the ConfigurationFileSession hack anymore.&lt;/p&gt;
&lt;p&gt;First i added an internal constructor as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; ApplicationEnvironment(DateTime instanceEpoch, DateTime applicationEpoch)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.instanceEpoch = instanceEpoch;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.applicationEpoch = applicationEpoch;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Then i made the internals visible to the test project&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[assembly: InternalsVisibleTo(&amp;#34;Be.Timvw.Framework.Domain.Tests&amp;#34;)]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And finally i added a base class that takes care of the initialization and clean up as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestInitialize]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; TestInitialize()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.original = ApplicationEnvironment.Instance;
	ApplicationEnvironment.Instance = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ApplicationEnvironment(DateTime.UtcNow, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;1998&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;));
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestCleanup]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; TestCleanUp()
{
	ApplicationEnvironment.Instance = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.original;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Refactoring EffectivityManager</title>
      <link>/post/2008-09-23-refactoring-effectivitymanager/</link>
      <pubDate>Tue, 23 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-23-refactoring-effectivitymanager/</guid>
      <description>
        
          &lt;p&gt;A while ago i presented the &lt;a href=&#34;http://www.timvw.be/presenting-a-generic-effectivitymanager/&#34;&gt;EffectivityManager&lt;/a&gt;. Having used this class for a while i have decided to rename it to Temporal&lt;!-- raw HTML omitted --&gt;. The implementation of IList&lt;!-- raw HTML omitted --&gt; is not required anymore because a user is typically only interested in a specific effectivity, not the evolution of the effectivities.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; ITemporal&amp;lt;T&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Modify(T element, DateTime &lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;);
	IEffectivity&amp;lt;T&amp;gt; GetSnapshot(DateTime validityDate);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; TryGetSnapshot(DateTime validityDate, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; IEffectivity&amp;lt;T&amp;gt; effectivity);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In the implementation i have added a constructor that accepts a &lt;a href=&#34;http://www.timvw.be/presenting-a-generic-discreterange/&#34;&gt;DiscreteValuesGenerator&lt;!-- raw HTML omitted --&gt;&lt;/a&gt; which makes it possible to create Periods with a resolution of a day instead of seconds.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting ApplicationEnvironment</title>
      <link>/post/2008-09-22-presenting-applicationenvironment/</link>
      <pubDate>Mon, 22 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-22-presenting-applicationenvironment/</guid>
      <description>
        
          &lt;p&gt;Imagine we are an ice cream vendor. During summer months our available capacity is twice as high as in the rest of the year. In code this problem looks like the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; AvailableCapacity
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;
	{
		DateTime now = DateTime.UtcNow;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(now.Year, &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &amp;lt;= now &amp;amp;&amp;amp; now &amp;lt;= &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(now.Year, &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) ) { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10000&lt;/span&gt;; } 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt;; } 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This code is pretty difficult to test because it depends on DateTime.UtcNow. In order to get control over that dependency i have defined an ApplicationEnvironment and rewritten the code as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; AvailableCapacity
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;
	{
		DateTime now = ApplicationEnvironment.Instance.CurrentDateTime;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(now.Year, &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &amp;lt;= now &amp;amp;&amp;amp; now &amp;lt;= &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(now.Year, &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) ) { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10000&lt;/span&gt;; } 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt;; } 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now i can use my &lt;a href=&#34;http://www.timvw.be/presenting-configurationfilesession/&#34;&gt;ConfigurationFileSession&lt;/a&gt; to test this code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldReturn10000InSummer()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConfigurationFileSession(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Summer.config&amp;#34;&lt;/span&gt;))
	{
		ApplicationEnvironment.Instance.Refresh();
		Assert.AreEqual(&lt;span style=&#34;color:#ae81ff&#34;&gt;10000&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; IceCreamPlant().AvailableCapacity);
	}
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldReturn5000InWinter()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConfigurationFileSession(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Winter.config&amp;#34;&lt;/span&gt;))
	{
		ApplicationEnvironment.Instance.Refresh();
		Assert.AreEqual(&lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; IceCreamPlant().AvailableCapacity);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting ConfigurationFileSession</title>
      <link>/post/2008-09-22-presenting-configurationfilesession/</link>
      <pubDate>Mon, 22 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-22-presenting-configurationfilesession/</guid>
      <description>
        
          &lt;p&gt;Here is a little class that allows you to use different configuration files. I find it extremely useful for tests where i want to mock the values that would be retrieved via the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx&#34;&gt;ConfigurationManager&lt;/a&gt;. Here are a couple of examples how it can be used&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldUseSystemTimeWhenNoValuesAreProvided()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConfigurationFileSession(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;WithoutDateTimeManipulation.config&amp;#34;&lt;/span&gt;))
	{
		ApplicationEnvironment.Instance.Refresh();

		DateTime now = DateTime.UtcNow;
		TimeSpan allowedDifference = TimeSpan.FromSeconds(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
		TimeSpan actualDifference = ApplicationEnvironment.Instance.CurrentDateTime -- configurationNow;
		Assert.IsTrue(actualDifference &amp;lt; allowedDifference); 
	} 
} 
&lt;span style=&#34;color:#a6e22e&#34;&gt;		
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt; 
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ShouldUseValuesAsProvided() 
{ 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ConfigurationFileSession(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;WithDateTimeManipulation.config&amp;#34;&lt;/span&gt;)) 
	{ 
		ApplicationEnvironment.Instance.Refresh(); 
		DateTime now = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2000&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;); 
		TimeSpan allowedDifference = TimeSpan.FromSeconds(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;); 
		TimeSpan actualDifference = ApplicationEnvironment.Instance.CurrentDateTime - configurationNow; 
		Assert.IsTrue(actualDifference &amp;lt; allowedDifference); 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Feel free to download the code from &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting a couple of custom MarkupExtensions</title>
      <link>/post/2008-09-10-playing-with-xaml/</link>
      <pubDate>Wed, 10 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-10-playing-with-xaml/</guid>
      <description>
        
          &lt;p&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/Xaml&#34;&gt;XAML&lt;/a&gt; provides us a way to declare objects with xml. Because i don&amp;rsquo;t want to clutter my domain classes with attributes like &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.componentmodel.typeconverterattribute.aspx&#34;&gt;TypeConverterAttribute&lt;/a&gt;, i needed a different approach to manipulate the parsing. This is where custom &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.windows.markup.markupextension.aspx&#34;&gt;MarkupExtension&lt;/a&gt;s come to the rescue. Here is an example where i use the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms752340.aspx&#34;&gt;x:Array MarkupExtension&lt;/a&gt; in order to load a list of Lines into my IList&lt;!-- raw HTML omitted --&gt; Lines property&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34; ?&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;d:Address&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:x=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://schemas.microsoft.com/winfx/2006/xaml&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:s=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:System;assembly=mscorlib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:d=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Domain;assembly=XamlDemo&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:e=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Infrastructure.Extensions;assembly=XamlDemo&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;d:Address.Lines&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;x:Array&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;s:String&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;s:String&amp;gt;&lt;/span&gt;Ikaroslaan 21&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/s:String&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;s:String&amp;gt;&lt;/span&gt;B-1930 Zaventem&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/s:String&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/x:Array&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/d:Address.Lines&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/d:Address&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;By default all XAML documents have all the data embedded. Sometimes this is undesirable so i decided to define External and ExternalList MarkupExtensions that allow us to specify that the resource is elsewhere available. Here is an example of Jeff who has one address in a different file, Domain\Address\Leuven\Brusselsestraat_400.xaml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34; ?&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;d:Person&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:x=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://schemas.microsoft.com/winfx/2006/xaml&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:s=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:System;assembly=mscorlib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:d=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Domain;assembly=XamlDemo&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:e=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Infrastructure.Extensions;assembly=XamlDemo&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Jeff&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Birthday=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{e:DateTime 14/10/1972}&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;d:Person.Addresses&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;e:ExternalList&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;XamlDemo.Domain.Address&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;e:ExternalList.Resources&amp;gt;&lt;/span&gt;
				&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;x:Array&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;s:String&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
					&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;s:String&amp;gt;&lt;/span&gt;Domain.Address.Leuven.Brusselsestraat_400&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/s:String&amp;gt;&lt;/span&gt;
				&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/x:Array&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/e:ExternalList.Resources&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/e:ExternalList&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/d:Person.Addresses&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/d:Person&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It is also possible to have multiple redirections. Here is an example of Tim who has two addresses defined in Domain\Address\ForPerson\Tim.xaml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34; ?&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;d:Person&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:x=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://schemas.microsoft.com/winfx/2006/xaml&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:s=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:System;assembly=mscorlib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:d=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Domain;assembly=XamlDemo&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:e=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Infrastructure.Extensions;assembly=XamlDemo&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tim&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Birthday=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{e:DateTime 30/04/1980}&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;d:Person.Addresses&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;e:External&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;XamlDemo.Domain.Address&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Resource=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Domain.Address.ForPerson.Tim&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/d:Person.Addresses&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/d:Person&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is the definition for Domain\Address\ForPerson\Tim.xaml&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34; ?&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;e:ExternalList&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:x=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://schemas.microsoft.com/winfx/2006/xaml&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:s=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:System;assembly=mscorlib&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:d=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Domain;assembly=XamlDemo&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns:e=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;clr-namespace:XamlDemo.Infrastructure.Extensions;assembly=XamlDemo&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;XamlDemo.Domain.Address&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;e:ExternalList.Resources&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;x:Array&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;s:String&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;s:String&amp;gt;&lt;/span&gt;Domain.Address.Leuven.Bondgenotenlaan_14&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/s:String&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;s:String&amp;gt;&lt;/span&gt;Domain.Address.Zaventem.Ikaroslaan_21&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/s:String&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/x:Array&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/e:ExternalList.Resources&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/e:ExternalList&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Anyway, feel free to download the sample application, &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/XamlDemo.zip&#34;&gt;XamlDemo.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting WindowsIdentityHelper</title>
      <link>/post/2008-09-06-presenting-windowsidentityhelper/</link>
      <pubDate>Sat, 06 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-06-presenting-windowsidentityhelper/</guid>
      <description>
        
          &lt;p&gt;One of the difficulties of using the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx&#34;&gt;WindowsIdentity&lt;/a&gt; class is the fact that it requires a handle (&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.intptr.aspx&#34;&gt;IntPtr&lt;/a&gt;) to a Windows Security Token. Using the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/aa378184(VS.85).aspx&#34;&gt;LogonUser&lt;/a&gt; functionality we can get a hold of such a handle&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[DllImport(Advapi32File, CharSet = DefaultCharSet, SetLastError = DefaultSetLastError)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; LogonUser( &lt;span style=&#34;color:#75715e&#34;&gt;/* other parameters */&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; IntPtr userTokenHandle);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The easiest way to avoid memory leaks is to implement a custom &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.safehandle.aspx&#34;&gt;SafeHandle&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SafeTokenHandle&lt;/span&gt; : SafeHandleZeroOrMinusOneIsInvalid
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;internal&lt;/span&gt; SafeTokenHandle()
	: &lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;)
	{
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; ReleaseHandle()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;(!&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.IsInvalid)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; NativeMethods.CloseHandle(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.handle);
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;With that SafeHandle in place we can change the signature to&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[DllImport(Advapi32File, CharSet = DefaultCharSet, SetLastError = DefaultSetLastError)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; LogonUser( &lt;span style=&#34;color:#75715e&#34;&gt;/* other parameters */&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; SafeTokenHandle userTokenHandle);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;With the Be.Timvw.Framework.Security.Principal.WindowsIdentityHelper we can now easily obtain a WindowsIdentity and use it to do some impersonation&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;using(WindowsIdentityHelper windowsIdentityHelper = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; WindowsIdentityHelper(username, domain, password))
using(windowsIdentityHelper.GetWindowsIdentity().Impersonate())
{
	File.WriteAllText(&lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;c:\temp\blah.txt&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;hello there&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting AssemblyTypePicker</title>
      <link>/post/2008-09-01-presenting-assemblytypepicker/</link>
      <pubDate>Mon, 01 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-01-presenting-assemblytypepicker/</guid>
      <description>
        
          &lt;p&gt;I really like the way the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/exy1facf(VS.80).aspx&#34;&gt;Object Browser&lt;/a&gt; makes the types in an assembly visible. Because i have a couple of programs that require a given type as input, i have decided to add a TypeTree control to &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt; that mimicks the Object Browser. Here are a couple of screenshots of the control in a demo application that allows the user to generate interfaces and wrapper classes based on a selected type:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/codegenerator_01.gif&#34; alt=&#34;screenshot of assemblytypepicker with no values&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/codegenerator_02.gif&#34; alt=&#34;screenshot of dialog that requests the user to pick an assembly file&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/codegenerator_03.gif&#34; alt=&#34;screenshot of dialog that requests the user to pick a type in the previously selected assembly&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/CodeGenerator.zip&#34;&gt;CodeGenerator.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting EventHandlerHelper</title>
      <link>/post/2008-09-01-presenting-eventhandlerhelper/</link>
      <pubDate>Mon, 01 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-01-presenting-eventhandlerhelper/</guid>
      <description>
        
          &lt;p&gt;Being bored of writing code to raise an event, i have added an EventHandlerHelper to &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;EventHandlerHelper&lt;/span&gt;
{
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[MethodImpl(MethodImplOptions.NoInlining)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Raise&amp;lt;T&amp;gt;(EventHandler&amp;lt;T&amp;gt; handler, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, T e) &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; T : EventArgs
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (handler != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			handler(sender, e);
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting ItemEventArgs&lt;T&gt;</title>
      <link>/post/2008-09-01-presenting-itemeventargst/</link>
      <pubDate>Mon, 01 Sep 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-09-01-presenting-itemeventargst/</guid>
      <description>
        
          &lt;p&gt;Because i believe in the &lt;a href=&#34;http://en.wikipedia.org/wiki/Don%27t_repeat_yourself&#34;&gt;DRY&lt;/a&gt; principle i decided to add a generic ItemEventArgs class to &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ItemEventArgs&lt;/span&gt;&amp;lt;T&amp;gt; : EventArgs
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; T item;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ItemEventArgs(T item)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.item = item;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; T Item
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.item; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.item = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting OneTimePasswordMembershipProvider</title>
      <link>/post/2008-08-29-presenting-onetimepasswordmembershipprovider/</link>
      <pubDate>Fri, 29 Aug 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-08-29-presenting-onetimepasswordmembershipprovider/</guid>
      <description>
        
          &lt;p&gt;What good is a &lt;a href=&#34;http://www.timvw.be/presenting-timeotpclient/&#34;&gt;TimeOTP&lt;/a&gt; client if you don&amp;rsquo;t have anything to use it with? Last week i have implemented a &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx&#34;&gt;MembershipProvider&lt;/a&gt; that uses &lt;a href=&#34;http://www.timvw.be/presenting-hmac-based-otp-and-time-based-otp/&#34;&gt;Time-based One-Time Password&lt;/a&gt; to validate the user credentials. Basically, it is a wrapper around an existing MembershipProvider, you get to choose which one via the providerType attribute in the configuration, and requires that it can access the password of users. Here is an example configuration that relies on the SqlMembershipProvider&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34;?&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;connectionStrings&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;add&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MyDatabase&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;connectionString=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;xxxxx&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;providerName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System.Data.SqlClient&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/connectionStrings&amp;gt;&lt;/span&gt;
	
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;system.web&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;membership&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;defaultProvider=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;OTPMembershipProvider&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;providers&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;add&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;connectionStringName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MyDatabase&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;enablePasswordRetrieval=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;enablePasswordReset=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;requiresQuestionAndAnswer=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;applicationName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;/DemoOTP&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;requiresUniqueEmail=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;false&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;passwordFormat=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Clear&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;maxInvalidPasswordAttempts=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;5&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;minRequiredPasswordLength=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;7&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;minRequiredNonalphanumericCharacters=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;passwordAttemptWindow=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;10&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;passwordStrengthRegularExpression=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;OTPMembershipProvider&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Be.Timvw.Framework.Web.Security.OneTimePasswordMembershipProvider, Be.Timvw.Framework.Web&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;providerType=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System.Web.Security.SqlMembershipProvider, System.Web&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/providers&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/membership&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;authentication&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;mode=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Forms&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;authorization&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;allow&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;users=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;timvw&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;deny&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;users=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/authorization&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/system.web&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;While i was writing unittests i ran into a couple of issues&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.nmock.org/&#34;&gt;NMock&lt;/a&gt; seemingly only works with interfaces so i had to rip out an interface out of the abstract base class and wrap that in a MockMembershipProvider.&lt;/li&gt;
&lt;li&gt;Settings expectations for output parameters can be achieved with a SetNameParameterAction as described &lt;a href=&#34;http://www.pashabitz.com/PermaLink,guid,02e35fa6-c729-43a8-85c3-8c05df7a4aa8.aspx&#34;&gt;here&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Anyway, you can find the implementation of the MembershipProvider in &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt; and &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DemoOTP.zip&#34;&gt;download the demo webapplication&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting HMAC-Based OTP and Time-Based OTP</title>
      <link>/post/2008-08-22-presenting-hmac-based-otp-and-time-based-otp/</link>
      <pubDate>Fri, 22 Aug 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-08-22-presenting-hmac-based-otp-and-time-based-otp/</guid>
      <description>
        
          &lt;p&gt;I could not find a .NET implementation of the HMAC-Based One Time Password (HOTP) algorithm as specified in &lt;a href=&#34;ftp://ftp.rfc-editor.org/in-notes/rfc4226.txt&#34;&gt;RFC4226&lt;/a&gt; so i decided to write one myself. Because the &lt;a href=&#34;http://www.ietf.org/internet-drafts/draft-mraihi-totp-timebased-00.txt&#34;&gt;Time-Based OTP (TOTP)&lt;/a&gt; algorithm is an application of HOTP, more specifically: TOTP = HOTP(K, T) with T = (Current Unix time &amp;ndash; T0) / Timestep, i have implemented that algorithm too.&lt;/p&gt;
&lt;p&gt;You can find both Be.Timvw.Framework.Security.HmacOneTimePassword and Be.Timvw.Framework.Security.TimeOneTimePassword in the &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;. For more information about authentication i would recommend the &lt;a href=&#34;http://www.openauthentication.org/specifications&#34;&gt;specifications and technicals resources&lt;/a&gt; at the &lt;a href=&#34;http://www.openauthentication.org/&#34;&gt;OATH&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting TimeSpanHelper</title>
      <link>/post/2008-08-20-presenting-timespanhelper/</link>
      <pubDate>Wed, 20 Aug 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-08-20-presenting-timespanhelper/</guid>
      <description>
        
          &lt;p&gt;A &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.timespan.aspx&#34;&gt;TimeSpan&lt;/a&gt; is a structure that represents a time interval or a duration. To make the everything as clear as possible, a well designed system should not only know the quantity, but also the unit of that quantity. In order to create a TimeSpan that represents the right value, you will probably use one of the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.timespan_methods.aspx&#34;&gt;FromXXX (Hours, Days, Minutes, Seconds) methods&lt;/a&gt; as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; unit = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Day&amp;#34;&lt;/span&gt;;

TimeSpan actual;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (unit == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Day&amp;#34;&lt;/span&gt;)
{
	actual = TimeSpan.FromDays(&lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;);
}
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (unit == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hour&amp;#34;&lt;/span&gt;)
{
	actual = TimeSpan.FromHours(&lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;);
}
&lt;span style=&#34;color:#75715e&#34;&gt;// more else if statements...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After a while you get bored of writing that same if-else (or switch) construct and you end up wishing for something like&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; unit = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Day&amp;#34;&lt;/span&gt;;

TimeUnit timeUnit = EnumHelper.Parse&amp;lt;timeUnit&amp;gt;(unit);
TimeSpan actual = TimeSpanHelper.Create(&lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;, timeUnit);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Well, from now on you can find it in &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting UriHelper</title>
      <link>/post/2008-08-09-presenting-urihelper/</link>
      <pubDate>Sat, 09 Aug 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-08-09-presenting-urihelper/</guid>
      <description>
        
          &lt;p&gt;Adding parameters to an &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.uri.aspx&#34;&gt;Uri&lt;/a&gt; is an example where my &lt;a href=&#34;http://www.timvw.be/presenting-namevaluecollectionhelper/&#34;&gt;NameValueCollectionHelper&lt;/a&gt; comes in handy. Although &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.uritemplate.aspx&#34;&gt;UriTemplate&lt;/a&gt; allows us to bind parameters, it doesn&amp;rsquo;t really support add/remove/fail on duplicate parameters. Here is an example&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; TestAddParametersReplaceWithReplaceOfExistingParameters()
{
	Uri originalUri = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.example.com/path/?key1=val1&amp;amp;key2=val2#abcd&amp;#34;&lt;/span&gt;)

	NameValueCollection parameters = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; NameValueCollection();
	parameters.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;key1&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;newval&amp;#34;&lt;/span&gt;);
	parameters.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;key3&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;val3&amp;#34;&lt;/span&gt;);

	Uri expected = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.example.com/path/?key1=newval&amp;amp;key2=val2&amp;amp;key3=val3#abcd&amp;#34;&lt;/span&gt;);

	Uri actual = UriHelper.AddParameters(originalUri, parameters, DuplicateKeyBehavior.Replace);
	Assert.AreEqual(expected, actual);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Once again, source of this class can be found at &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting NameValueCollectionHelper</title>
      <link>/post/2008-08-08-presenting-namevaluecollectionhelper/</link>
      <pubDate>Fri, 08 Aug 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-08-08-presenting-namevaluecollectionhelper/</guid>
      <description>
        
          &lt;p&gt;Here are a couple functions that i find extremely useful when i&amp;rsquo;m working with a &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.collections.specialized.namevaluecollection.aspx&#34;&gt;NameValueCollection&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;NameValueCollectionHelper&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; AddOrIgnoreOnDuplicateKey(NameValueCollection collection, NameValueCollection nameValuesToAdd);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; AddOrReplaceOnDuplicateKey(NameValueCollection collection, NameValueCollection nameValuesToAdd);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; AddOrCombineOnDuplicateKey(NameValueCollection collection, NameValueCollection nameValuesToAdd);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; AddOrFailOnDuplicateKey(NameValueCollection collection, NameValueCollection nameValuesToAdd);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;All these methods provide a specific scenario of the more generic Add operation&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;NameValueCollectionHelper&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; Dictionary&amp;lt;duplicateKeyBehavior, Action&amp;lt;nameValueCollection, NameValueCollection&amp;gt;&amp;gt; duplicateKeyBehaviors;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; NameValueCollectionHelper()
	{
		duplicateKeyBehaviors = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Dictionary&amp;lt;duplicateKeyBehavior, Action&amp;lt;nameValueCollection, NameValueCollection&amp;gt;&amp;gt;();
		duplicateKeyBehaviors.Add(DuplicateKeyBehavior.Ignore, NameValueCollectionHelper.AddOrIgnoreOnDuplicateKey);
		duplicateKeyBehaviors.Add(DuplicateKeyBehavior.Replace, NameValueCollectionHelper.AddOrReplaceOnDuplicateKey);
		duplicateKeyBehaviors.Add(DuplicateKeyBehavior.Combine, NameValueCollectionHelper.AddOrCombineOnDuplicateKey);
		duplicateKeyBehaviors.Add(DuplicateKeyBehavior.Fail, NameValueCollectionHelper.AddOrFailOnDuplicateKey);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Add(NameValueCollection collection, NameValueCollection nameValuesToAdd, DuplicateKeyBehavior duplicateKeyBehavior)
	{
		duplicateKeyBehaviors[duplicateKeyBehavior](collection, nameValuesToAdd);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;You should already know that the source is available at &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting EnumerableHelper</title>
      <link>/post/2008-08-06-presenting-enumerablehelper/</link>
      <pubDate>Wed, 06 Aug 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-08-06-presenting-enumerablehelper/</guid>
      <description>
        
          &lt;p&gt;I noticed (eg: &lt;a href=&#34;http://derek-says.blogspot.com/2008/08/generic-collections-and-inheritance.html&#34;&gt;here&lt;/a&gt;) that i&amp;rsquo;m not the only one that has experienced some annoyances when working with generics. Here are a couple of methods that i find extremely helpful when i&amp;rsquo;m working with &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/9eekhta0.aspx&#34;&gt;IEnumerable&lt;!-- raw HTML omitted --&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;IEnumerable&amp;lt;tbase&amp;gt; Convert&amp;lt;tderived, TBase&amp;gt;(IEnumerable&amp;lt;tderived&amp;gt; enumerable) &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; TDerived : TBase;
IEnumerable&amp;lt;t&amp;gt; Convert&amp;lt;t&amp;gt;(IEnumerable enumerable);
&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HaveSameElements&amp;lt;t&amp;gt;(IEnumerable&amp;lt;t&amp;gt; enumerable1, IEnumerable&amp;lt;t&amp;gt; enumerable2, Func&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;, T, T&amp;gt; areEqual);
&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HaveSameElements(IEnumerable enumerable1, IEnumerable enumerable2, Func&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;&amp;gt; areEqual);
&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HaveSameElements(IEnumerable enumerable1, IEnumerable enumerable2);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;You can download the actual implementation of this Be.Timvw.Framework.Collections.Generic.EnumerableHelper class in &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting the SortableBindingList&lt;T&gt; (take two)</title>
      <link>/post/2008-08-02-presenting-the-sortablebindinglistt-take-two/</link>
      <pubDate>Sat, 02 Aug 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-08-02-presenting-the-sortablebindinglistt-take-two/</guid>
      <description>
        
          &lt;p&gt;I&amp;rsquo;m in the progress of adding classes that i find interesting to the &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt; project. The original implementation of my &lt;a href=&#34;http://www.timvw.be/presenting-the-sortablebindinglistt/&#34;&gt;SortableBindingList&lt;!-- raw HTML omitted --&gt;&lt;/a&gt; relied on &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.icomparable.aspx&#34;&gt;IComparable&lt;/a&gt; to implement ApplySortCore(PropertyDescriptor property, ListSortDirection direction). I received some good feedback and &lt;a href=&#34;http://www.timvw.be/improvements-for-the-sortablebindinglist-and-typedlist/&#34;&gt;blogged about those improvements&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Because some of my classes only implement &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/4d7sx9hd.aspx&#34;&gt;IComparable&lt;!-- raw HTML omitted --&gt;&lt;/a&gt; i needed support for this too. My first thought was to use Comparer&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;IComparer comparer = Comparer&amp;lt;t&amp;gt;.Default;
itemsList.Sort(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(T t1, T t2)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; property1 = prop.GetValue(t1);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; property2 = prop.GetValue(t2);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; reverse * comparer.Compare(property1, property2);
});
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Obviously that didn&amp;rsquo;t work. The problem is that i received the default Comparer for T, instead of the Comparer for the type of the property. Anyway, with a bit of reflection i got access to that Comparer&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Type comparablePropertyType = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Comparer&amp;lt;&amp;gt;).MakeGenericType(property.PropertyType);
IComparer comparer = (IComparer)comparablePropertyType.InvokeMember(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Default&amp;#34;&lt;/span&gt;, BindingFlags.Static | BindingFlags.GetProperty | BindingFlags.Public, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After a bit of refactoring i ended up with a PropertyComparer&lt;!-- raw HTML omitted --&gt; which allowed me to implement the sorting as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Type propertyType = property.PropertyType;

&lt;span style=&#34;color:#75715e&#34;&gt;// this cache minimizes the cost of reflection in the PropertyComparer constructor
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;PropertyComparer&amp;lt;t&amp;gt; comparer;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (!&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comparers.TryGetValue(propertyType, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; comparer))
{
	comparer = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PropertyComparer&amp;lt;t&amp;gt;(property, direction);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comparers.Add(propertyType, comparer);
}
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
{
	comparer.SetListSortDirection(direction);
}

itemsList.Sort(comparer);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In order to write unittests, i needed a way to get instances of a &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.componentmodel.propertydescriptor.aspx&#34;&gt;PropertyDescriptor&lt;/a&gt;. This was achieved by using the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.componentmodel.typedescriptor_methods.aspx&#34;&gt;TypeDescriptor&lt;/a&gt; as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;PropertyDescriptor GetPropertyDescriptor(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; component, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; propertyName)
{
	PropertyDescriptorCollection propertyDescriptors = TypeDescriptor.GetProperties(component);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (PropertyDescriptor propertyDescriptor &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; propertyDescriptors)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (propertyDescriptor.Name == propertyName)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; propertyDescriptor;
		}
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentException(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The property &amp;#39;{0}&amp;#39; was not found.&amp;#34;&lt;/span&gt;, propertyName));
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Feel free to download the updated demo application: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/SortableBindingList.zip&#34;&gt;sortablebindinglist.zip&lt;/a&gt;. There are even real applications that use this class, eg: &lt;a href=&#34;http://vstrac.devjavu.com/&#34;&gt;VSTrac&lt;/a&gt; and &lt;a href=&#34;http://monotorrent.com/&#34;&gt;MonoTorrent&lt;/a&gt;. If you&amp;rsquo;re interested in the unittests you&amp;rsquo;ll have to get the code at &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>NHibernate SessionFactory configuration</title>
      <link>/post/2008-07-28-nhibernate-sessionfactory-configuration/</link>
      <pubDate>Mon, 28 Jul 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-07-28-nhibernate-sessionfactory-configuration/</guid>
      <description>
        
          &lt;p&gt;My preferred way for configuring &lt;a href=&#34;http://www.nhibernate.org&#34;&gt;NHibernate&lt;/a&gt; is as following&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create a hibernate.cfg.xml file for session-factory settings.&lt;/li&gt;
&lt;li&gt;Add mapping files, named type.hbm.xml, as embedded resources to the library project that implements the repository.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When i looked at the &lt;a href=&#34;http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html_single/#configuration-programmatic&#34;&gt;documentation&lt;/a&gt; i found the following&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Another alternative (probably the best) way is to let NHibernate load all of the mapping files contained in an Assembly:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Configuration cfg = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Configuration(); 
cfg.AddAssembly( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NHibernate.Auction&amp;#34;&lt;/span&gt; );
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Whenever i tried that code i received an InvalidOperationException: Could not find the dialect in the configuration. In order to make the configuration work the way i prefer you have to do the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Configuration cfg = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Configuration().Configure();
cfg.AddAssembly(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(MyRepository).Assembly);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Another attention point is the fact that i believe that all connectionStrings belong in App.Config. This can be realised by using the connection.connection_string_name attribute&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34; ?&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;hibernate-configuration&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;xmlns=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;urn:nhibernate-configuration-2.2&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;session-factory&amp;gt;&lt;/span&gt; 
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;connection.provider&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;NHibernate.Connection.DriverConnectionProvider&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;dialect&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;NHibernate.Dialect.MsSql2005Dialect&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt; 
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;connection.driver_class&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;NHibernate.Driver.SqlClientDriver&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt; 
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;property&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;connection.connection_string_name&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;AdventureWorks&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/property&amp;gt;&lt;/span&gt; 
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/session-factory&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/hibernate-configuration&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting HtmlClipboard</title>
      <link>/post/2008-06-30-presenting-htmlclipboard/</link>
      <pubDate>Mon, 30 Jun 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-06-30-presenting-htmlclipboard/</guid>
      <description>
        
          &lt;p&gt;Very often i need to encode/decode the contents of my Clipboard so i decided to write a little tray application to help me&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/htmlclipboard.gif&#34; alt=&#34;screenshot of htmlclipboard tray application&#34;&gt;&lt;/p&gt;
&lt;p&gt;With the aid of &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.windows.forms.clipboard.aspx&#34;&gt;Clipboard&lt;/a&gt; and &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/system.web.httputility.aspx&#34;&gt;HttpUtility&lt;/a&gt; this is quite easy to implement&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; toolStripMenuItemDecode_Click(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; original = Clipboard.GetText();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; decodedHtml = HttpUtility.HtmlDecode(original);
	Clipboard.SetText(decodedHtml);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; toolStripMenuItemEncode_Click(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; original = Clipboard.GetText();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; encodedHtml = HttpUtility.HtmlEncode(original);
	Clipboard.SetText(encodedHtml);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Anyway, feel free to download &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/HtmlClipboard.zip&#34;&gt;HtmlClipboard.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Example implementation of a callback method for use in the Asynchronous Programming Model</title>
      <link>/post/2008-06-28-example-usage-of-the-asynchronous-programming-model/</link>
      <pubDate>Sat, 28 Jun 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-06-28-example-usage-of-the-asynchronous-programming-model/</guid>
      <description>
        
          &lt;p&gt;I always seem to forget about the mechanics of implementing a Callback method that can be used in the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/ms228963(VS.80).aspx&#34;&gt;Asynchronous Programming Model (APM)&lt;/a&gt;. So here is a simple example in C# 3.0 using the &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/bb549151.aspx&#34;&gt;Func&amp;lt;T, TResult&amp;gt;&lt;/a&gt; delegate&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Program&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
	{
		Func&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt; echoDelegate = Echo;
		IAsyncResult asyncResult = echoDelegate.BeginInvoke(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;some input&amp;#34;&lt;/span&gt;, EchoCallback, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;x&amp;#34;&lt;/span&gt;);

		WaitHandle.WaitAll(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; WaitHandle[] {asyncResult.AsyncWaitHandle});

		Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
		Console.ReadKey();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Echo(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; input)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Echoing {0}&amp;#34;&lt;/span&gt;, input);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; EchoCallback(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; state)
	{
		IAsyncResult r = (IAsyncResult)state;
		Debug.Assert(r.AsyncState == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;x&amp;#34;&lt;/span&gt;);

		AsyncResult asyncResult = (AsyncResult)state;
		Func&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt; echoDelegate = (Func&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;)asyncResult.AsyncDelegate;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; echoResult = echoDelegate.EndInvoke(asyncResult);
		Debug.Assert(echoResult == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Echoing some input&amp;#34;&lt;/span&gt;);

		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;EchoCallback completed.&amp;#34;&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Enumerate all properties and their value of an object</title>
      <link>/post/2008-06-14-get-a-list-of-all-properties-and-their-values-of-an-object/</link>
      <pubDate>Sat, 14 Jun 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-06-14-get-a-list-of-all-properties-and-their-values-of-an-object/</guid>
      <description>
        
          &lt;p&gt;Earlier today someone asked me how to generate a List with all the properties (and their respective value) that an object has. With C# 2.0 i would have created a class to represent a single element, PropertyRow, with a Name and a Value property and a class that is IEnumerable&lt;!-- raw HTML omitted --&gt; to hold all PropertyRows.&lt;/p&gt;
&lt;p&gt;With C# 3.0 we can take advantage of &lt;a href=&#34;http://msdn.microsoft.com/en-us/library/bb397696.aspx&#34;&gt;anonymous types&lt;/a&gt; and the code we have to write is fairly minimal&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Person angelina = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Angelina&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Jolie&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;0275198123&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CloseToMe blv 12&amp;#34;&lt;/span&gt;);

&lt;span style=&#34;color:#66d9ef&#34;&gt;var&lt;/span&gt; propertyRows =
	&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt; propertyInfo &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; angelina.GetType().GetProperties()
	&lt;span style=&#34;color:#66d9ef&#34;&gt;select&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; { Name = propertyInfo.Name, Value = propertyInfo.GetValue(angelina, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) };

BindingSource bs = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingSource();
bs.DataSource = propertyRows;

&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = bs;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Just as with anonymous delegates, as soon as you notice that you define the same anonymous class more than once, you may want to consider to take it out of the anonymousity.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Exploring the Microsoft Sync Framework</title>
      <link>/post/2008-05-24-exploring-the-microsoft-sync-framework/</link>
      <pubDate>Sat, 24 May 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-05-24-exploring-the-microsoft-sync-framework/</guid>
      <description>
        
          &lt;p&gt;Earlier this week i&amp;rsquo;ve been experimenting with the &lt;a href=&#34;http://msdn.microsoft.com/en-us/sync/default.aspx&#34;&gt;Microsoft Sync Framework&lt;/a&gt;. In a typical n-tier architecture the client can&amp;rsquo;t access the remote database directly but uses a proxy instead. The available [Earlier this week i&amp;rsquo;ve been experimenting with the &lt;a href=&#34;http://msdn.microsoft.com/en-us/sync/default.aspx&#34;&gt;Microsoft Sync Framework&lt;/a&gt;. In a typical n-tier architecture the client can&amp;rsquo;t access the remote database directly but uses a proxy instead. The available](&lt;a href=&#34;http://msdn.microsoft.com/en-us/library/microsoft.synchronization.data.serversyncproviderproxy(SQL.100).aspx&#34;&gt;http://msdn.microsoft.com/en-us/library/microsoft.synchronization.data.serversyncproviderproxy(SQL.100).aspx&lt;/a&gt;) has only one constructor which accepts an object. With reflector i found out that the proxy simply uses reflection to call some methods. Here are a couple of helper classes that help you prevent runtime errors due to this approach&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[ServiceContract(Namespace = &amp;#34;http://www.timvw.be/Synchronization&amp;#34;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IServerSyncProvider
{
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[OperationContract]&lt;/span&gt;
	SyncServerInfo GetServerInfo(SyncSession syncSession);
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[OperationContract]&lt;/span&gt;
	SyncSchema GetSchema(Collection&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt; tableNames, SyncSession syncSession);
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[OperationContract]&lt;/span&gt;
	SyncContext GetChanges(SyncGroupMetadata groupMetadata, SyncSession syncSession);
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[OperationContract]&lt;/span&gt;
	SyncContext ApplyChanges(SyncGroupMetadata groupMetadata, DataSet dataSet, SyncSession syncSession);
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MyServerSyncProviderProxy&lt;/span&gt; : ServerSyncProviderProxy
{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; MyServerSyncProviderProxy(IServerSyncProvider serverSyncProvider)
		: &lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;(serverSyncProvider)
		{
		}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now you can easily consume a ServerSyncProviderProxy as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;SyncAgent syncAgent = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SyncAgent();
EndpointAddress address = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EndpointAddress(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://somewhere/Be.Timvw.Demo.Host/ServerSyncProvider.svc&amp;#34;&lt;/span&gt;);
BasicHttpBinding binding = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BasicHttpBinding();
ChannelFactory&amp;lt;iserverSyncProvider&amp;gt; factory = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ChannelFactory&amp;lt;iserverSyncProvider&amp;gt;(binding, address);
IServerSyncProvider serverSyncProvider = factory.CreateChannel();
syncAgent.RemoteProvider = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SafeServerSyncProviderProxy(serverSyncProvider);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Using Linq for statically-typed reflection</title>
      <link>/post/2008-03-14-using-linq-for-statically-typed-reflection/</link>
      <pubDate>Fri, 14 Mar 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-03-14-using-linq-for-statically-typed-reflection/</guid>
      <description>
        
          &lt;p&gt;I discovered the &lt;a href=&#34;http://www.codeplex.com/Release/ProjectReleases.aspx?ProjectName=clarius&amp;amp;ReleaseId=9495&#34;&gt;TypedReflector&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;on &lt;a href=&#34;http://www.clariusconsulting.net/blogs/kzu/archive/2007/12/30/49063.aspx&#34;&gt;Daniel Cazzulino&amp;rsquo;s Blog&lt;/a&gt;. In essence, a simplified version of the code looks like&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Reflector&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; PropertyInfo GetProperty&amp;lt;t, TRet&amp;gt;(Expression&amp;lt;func&amp;lt;t, TRet&amp;gt;&amp;gt; expression)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; GetMemberInfo(expression) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PropertyInfo;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; FieldInfo GetField&amp;lt;t, TRet&amp;gt;(Expression&amp;lt;func&amp;lt;t, TRet&amp;gt;&amp;gt; expression)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; GetMemberInfo(expression) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; FieldInfo;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; MethodInfo GetMethod&amp;lt;t, TRet&amp;gt;(Expression&amp;lt;func&amp;lt;t, TRet&amp;gt;&amp;gt; expression)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; GetMemberInfo(expression) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; MethodInfo;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; MemberInfo GetMemberInfo(Expression memberInfoExpression)
	{
		Expression lambdaBodyExpression = ((LambdaExpression)memberInfoExpression).Body;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;switch&lt;/span&gt; (lambdaBodyExpression.NodeType)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; ExpressionType.MemberAccess:
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ((MemberExpression)lambdaBodyExpression).Member;
			
			&lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; ExpressionType.Call:
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ((MethodCallExpression)lambdaBodyExpression).Method;
			
			&lt;span style=&#34;color:#66d9ef&#34;&gt;default&lt;/span&gt;:
			&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Unsupported NodeType&amp;#34;&lt;/span&gt;);
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This class allows me to write the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;PropertyInfo namePropertyInfo = Reflector.GetProperty&amp;lt;person, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;(p =&amp;gt; p.Surname);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Not only can i be sure that the lambda (and thus the namePropertyInfo.Invoke) will always return a string, i can also use it to avoid &amp;lsquo;hardcoded&amp;rsquo; propertynames&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//const string SurnameProperty = &amp;#34;Surname&amp;#34;;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//comboBox1.DisplayMember = SurnameProperty;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;comboBox1.DisplayMember = Reflector.GetProperty&amp;lt;person, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;(p =&amp;gt; p.Surname).Name;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Using System.DirectoryServices.AccountManagement to find the members of an AD group</title>
      <link>/post/2008-03-08-using-systemdirectoryservicesaccountmanagement-to-find-the-members-of-an-ad-group/</link>
      <pubDate>Sat, 08 Mar 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-03-08-using-systemdirectoryservicesaccountmanagement-to-find-the-members-of-an-ad-group/</guid>
      <description>
        
          &lt;p&gt;A while ago i posted some code that demonstrated how to &lt;a href=&#34;http://www.timvw.be/find-the-members-of-an-ad-group/&#34;&gt;find the members of an AD group&lt;/a&gt;. If you&amp;rsquo;re using the brandnew .Net 3.5 framework you can take advantage of the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx&#34;&gt;System.DirectoryServices.AccountManagement&lt;/a&gt; library which is an abstraction for AD (DS, LDS) and SAM accounts. Using this new library my method can be simplified&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IEnumerable&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt; FindUsernames(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; groupname)
{
	PrincipalContext principalContext = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PrincipalContext(ContextType.Domain, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;mydomain&amp;#34;&lt;/span&gt;);
	GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(principalContext, groupname);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (Principal principal &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; groupPrincipal.Members)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;yield&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; principal.DistinguishedName;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If you&amp;rsquo;re looking for more information i would recommend that you read &lt;a href=&#34;http://msdn2.microsoft.com/en-us/magazine/cc135979.aspx&#34;&gt;Managing Directory Security Principals in the .NET Framework 3.5&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Exploring alternative input: ActiveHome</title>
      <link>/post/2008-03-06-exploring-alternative-input-activehome/</link>
      <pubDate>Thu, 06 Mar 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-03-06-exploring-alternative-input-activehome/</guid>
      <description>
        
          &lt;p&gt;A while ago i bought &lt;a href=&#34;http://www.easycomputing.com/product.asp?ref=3655&#34;&gt;Media Centerkit&lt;/a&gt; for an euro or two. I wouldn&amp;rsquo;t recommend the product because it comes with crappy software. Anyway, i was only interested in playing with the hardware (RF Remote and USB Receiver) so i downloaded the &lt;a href=&#34;http://www.activehomepro.com/sdk/sdk-info.html&#34;&gt;ActiveHome Professional SDK&lt;/a&gt;. Once you install this you can add a reference to &amp;ldquo;ActiveHomeScript 1.0 Type Library&amp;rdquo; under the COM tab in Visual Studio. I wrote a little library so that i can consume the ActiveHomeClass.RecvAction in a Type-safe way&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/activehomelibrary.png&#34; alt=&#34;class diagram of activehome library&#34;&gt;&lt;/p&gt;
&lt;p&gt;Here is some sample code that demonstrates how you can use the Notifier to receive Notifications&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// register our eventhandler and tell the notifier to start raising events
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;Notifier.Instance.NotificationReceived += &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Instance_NotificationReceived;
Notifier.Instance.Enable();

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Instance_NotificationReceived(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, NotificationReceivedEventArgs e)
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// for more complex logic i would recommend that you apply a Filter pattern...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	RadioFrequencyNotification rfNotification = e.Notification &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; RadioFrequencyNotification;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (rfNotification.IsKeyPressed)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (rfNotification.Command == RadioFrequencyCommand.Menu)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.RaiseToolStripMenuItemClicked(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.MenuClicked, EventArgs.Empty);
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As always feel free to download the library and sample application: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ActiveHome.zip&#34;&gt;ActiveHome.zip&lt;/a&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Find the members of an AD group</title>
      <link>/post/2008-03-05-find-the-members-of-an-ad-group/</link>
      <pubDate>Wed, 05 Mar 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-03-05-find-the-members-of-an-ad-group/</guid>
      <description>
        
          &lt;p&gt;Because i always seem to forget about the syntax of LDAP Search Filters (&lt;a href=&#34;http://www.ietf.org/rfc/rfc2254.txt&#34;&gt;RFC 2254: The String Representation of LDAP Search Filters&lt;/a&gt; and &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/ms675768(VS.85).aspx&#34;&gt;Creating a Query Filter&lt;/a&gt;) i&amp;rsquo;m going to post a basic demo of &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.directoryservices.directorysearcher.aspx&#34;&gt;DirectorySearcher&lt;/a&gt; that returns the members that are part of a given AD group&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; member &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; FindUsernames(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;CWBE-PS-.NetDev&amp;#34;&lt;/span&gt;))
	{
		Console.WriteLine(member);
	}

	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IEnumerable&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt; FindUsernames(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; groupname)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; filter = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(&amp;amp;(&amp;amp;(objectCategory=Group)(objectClass=Group))(name={0}))&amp;#34;&lt;/span&gt;;
	filter = &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(filter, groupname);

	DirectoryEntry directoryEntry = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DirectoryEntry();
	DirectorySearcher searcher = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DirectorySearcher(directoryEntry);
	searcher.SearchScope = SearchScope.Subtree;
	searcher.Filter = filter;

	DirectoryEntry groupEntry = searcher.FindOne().GetDirectoryEntry();
	PropertyValueCollection members = (PropertyValueCollection)groupEntry.Properties[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;member&amp;#34;&lt;/span&gt;];
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ConvertAll&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;((&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[])members.Value);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IEnumerable&amp;lt;to&amp;gt; ConvertAll&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;, To&amp;gt;(IEnumerable&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;from&lt;/span&gt;&amp;gt; elements)
{
	Type toType = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(To);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (From element &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; elements)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;yield&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (To)Convert.ChangeType(element, toType);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Display WorkItems in a WinForms application</title>
      <link>/post/2008-02-29-display-workitems-in-a-winforms-application/</link>
      <pubDate>Fri, 29 Feb 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-02-29-display-workitems-in-a-winforms-application/</guid>
      <description>
        
          &lt;p&gt;Using the Microsoft.TeamFoundation.WorkItemTracking.Controls assembly it is possibe to display WorkItems. Here is a little demo application that will display all the WorkItems that have been changed by one of the given users in the given range&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/workitemtracker.gif&#34; alt=&#34;screenshot of workitemtracker application&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download the source: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/WorkItemTracker.zip&#34;&gt;WorkItemTracker.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Edit (05/03/2008):&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Refactored the code a little and added some features like sortable columns, loading default tfsserver and users from App.Config, &amp;hellip;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Find WorkItems that have been changed between two dates</title>
      <link>/post/2008-02-28-find-workitems-that-have-been-changed-between-two-dates/</link>
      <pubDate>Thu, 28 Feb 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-02-28-find-workitems-that-have-been-changed-between-two-dates/</guid>
      <description>
        
          &lt;p&gt;Sometimes i want to know which WorkItems i have closed (or completed) between two dates. According to &lt;a href=&#34;http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=2528099&amp;amp;SiteID=1&#34;&gt;Amit Ghosh&lt;/a&gt; it&amp;rsquo;s not possible to write such a query so i wrote some code that uses the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/bb130146(VS.80).aspx&#34;&gt;TFS SDK&lt;/a&gt; to get that list&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	TeamFoundationServer tfs = TeamFoundationServerFactory.GetServer(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tfsrtm08&amp;#34;&lt;/span&gt;);
	WorkItemStore wis = (WorkItemStore)tfs.GetService(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(WorkItemStore));

	DateTime begin = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
	DateTime end = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2008&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;28&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; username = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Darren&amp;#34;&lt;/span&gt;;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (WorkItem workItem &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; FindChangesByUserInRange(wis, username, begin, end))
	{
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;[{0:00000}] {1}&amp;#34;&lt;/span&gt;, workItem.Id, workItem.Title);
	}

	Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Press any key to continue...&amp;#34;&lt;/span&gt;);
	Console.ReadKey();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; List&amp;lt;workItem&amp;gt; FindChangesByUserInRange(WorkItemStore workItemStore, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; username, DateTime begin, DateTime end)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; query = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SELECT System.ID, System.Title FROM workitems WHERE [Changed By] EVER &amp;#39;{0}&amp;#39; AND [State] IN (&amp;#39;Closed&amp;#39;, &amp;#39;Resolved&amp;#39;) AND [Changed Date] &amp;gt;= &amp;#39;{1}&amp;#39;&amp;#34;&lt;/span&gt;;
	query = &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(query, username, begin.Date.ToShortDateString());

	List&amp;lt;workItem&amp;gt; result = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;workItem&amp;gt;();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (WorkItem workItem &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; workItemStore.Query(query))
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (IsChangedByUserInRange(workItem, username, begin, end))
		{
			result.Add(workItem);
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; result;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; IsChangedByUserInRange(WorkItem workItem, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; username, DateTime begin, DateTime end)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (Revision rev &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; workItem.Revisions)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; changedBy = (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;)rev.Fields[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Changed By&amp;#34;&lt;/span&gt;].Value;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (changedBy == username)
		{
			DateTime changedDate = (DateTime)rev.Fields[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Changed Date&amp;#34;&lt;/span&gt;].Value;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (begin &amp;lt;= changedDate &amp;amp;&amp;amp; changedDate &amp;lt;= end) 
			{ 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;; 
			} 
		} 
	} 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;; 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Writing Xml without the XmlDeclaration</title>
      <link>/post/2008-02-26-writing-xml-without-the-xmldeclaration/</link>
      <pubDate>Tue, 26 Feb 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-02-26-writing-xml-without-the-xmldeclaration/</guid>
      <description>
        
          &lt;p&gt;Consider the following xml file:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;utf-8&amp;#34; ?&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;!-- some comment --&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;root&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/root&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;&amp;lt;!-- another comment --&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If you look at the &lt;a href=&#34;http://www.w3.org/TR/REC-xml/#sec-well-formed&#34;&gt;Well-Formed XML Documents&lt;/a&gt; section in the &lt;a href=&#34;http://www.w3.org/TR/REC-xml/&#34;&gt;XML specification&lt;/a&gt; you see that a well-formed document is defined as:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[1] document ::= &lt;a href=&#34;http://www.w3.org/TR/REC-xml/#NT-prolog&#34;&gt;prolog&lt;/a&gt; &lt;a href=&#34;http://www.w3.org/TR/REC-xml/#NT-element&#34;&gt;element&lt;/a&gt; &lt;a href=&#34;http://www.w3.org/TR/REC-xml/#NT-Misc&#34;&gt;Misc*&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Since there is only 1 root element (ever), i assumed that if you &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.xml.xmldocument.load.aspx&#34;&gt;Load&lt;/a&gt; this file with &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.xml.xmldocument.aspx&#34;&gt;XmlDocument&lt;/a&gt; their would be only one &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.xml.xmlnode.aspx&#34;&gt;XmlNode&lt;/a&gt; in the document &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.xml.xmlnode.childnodes.aspx&#34;&gt;ChildNodes&lt;/a&gt;. In reality there ChildNodes.Count returns 4.&lt;/p&gt;
&lt;p&gt;The simplest way to write this XmlDocument without the declaration would be as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;XmlWriterSettings xmlWriterSettings = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; XmlWriterSettings();
xmlWriterSettings.OmitXmlDeclaration = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
xmlWriterSettings.Encoding = Encoding.UTF8;
&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (XmlWriter writer = XmlWriter.Create(&lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;result.xml&amp;#34;&lt;/span&gt;, xmlWriterSettings))
{
	xmlDoc.WriteTo(writer);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Introducing DeferredExecutionHelper</title>
      <link>/post/2008-02-23-introducing-deferredexecutionhelper/</link>
      <pubDate>Sat, 23 Feb 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-02-23-introducing-deferredexecutionhelper/</guid>
      <description>
        
          &lt;p&gt;Sometimes i don&amp;rsquo;t want a costly function to be performed unless it&amp;rsquo;s really necessary. In Patterns of Enterprise Application Architecture it&amp;rsquo;s described as &lt;a href=&#34;http://www.martinfowler.com/eaaCatalog/lazyLoad.html&#34;&gt;Lazy Load&lt;/a&gt;. Anyway, in order to achieve that i&amp;rsquo;ve written a wrapper for &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.runtime.remoting.proxies.realproxy.aspx&#34;&gt;RealProxy&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DeferredExecutionHelper&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; IList&amp;lt;Tresult&amp;gt; GetListHelper&amp;lt;T, TResult&amp;gt;(Func&amp;lt;T, IList&amp;lt;Tresult&amp;gt;&amp;gt; costlyFunction, T t)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Proxy&amp;lt;T, IList&amp;lt;Tresult&amp;gt;&amp;gt;(costlyFunction, t).ResultProxy;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; TResult GetHelper&amp;lt;T, TResult&amp;gt;(Func&amp;lt;T, TResult&amp;gt; costlyFunction, T t) &lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt; TResult : MarshalByRefObject
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Proxy&amp;lt;T, TResult&amp;gt;(costlyFunction, t).ResultProxy;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here are a couple of unittests that demonstrate how the wrapper can be used for MarshalByRefObjects&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetHelperTestDeferredExecution()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; expectedParameter = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;x&amp;#34;&lt;/span&gt;;
	Order expectedResult = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Order(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;amount&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Amount[] { &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Amount(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) }));

	&lt;span style=&#34;color:#75715e&#34;&gt;// DeferredExecutionHelper.GetHelper&amp;lt;T, TResult&amp;gt; where TResult : MarshalByRefObject
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	Order actualResult = DeferredExecutionHelper.GetHelper&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, Order&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; actualParameter)
	{
		Assert.AreEqual(expectedParameter, actualParameter);
		Assert.Fail(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Should not perform this method.&amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; expectedResult;
	}, expectedParameter);
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetHelperTestDeferredExecutionResult()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; expectedParameter = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;x&amp;#34;&lt;/span&gt;;
	Order expectedResult = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Order(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;amount&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Amount[] { &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Amount(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) }));

	Order actualResult = DeferredExecutionHelper.GetHelper&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, Order&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; actualParameter)
	{
		Assert.AreEqual(expectedParameter, actualParameter);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; expectedResult;
	}, expectedParameter);

	Assert.AreEqual(expectedResult.Id, actualResult.Id);
	Assert.AreEqual(expectedResult.Amounts, actualResult.Amounts);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I&amp;rsquo;ve also added a helper method that allows you to defer execution of methods that return an IList of T. Here are some tests that demonstrate it&amp;rsquo;s usage&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetListHelperTestDeferredExecution()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; expectedParameter = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
	IList&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; expectedResult = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; });

	IList&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; actualResult = DeferredExecutionHelper.GetListHelper&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; actualParameter)
	{
		Assert.AreEqual(expectedParameter, actualParameter);
		Assert.Fail(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Should not perform this method.&amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; expectedResult;
	}, expectedParameter);
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[TestMethod]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetListHelperTestDeferredExecutionResult()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; expectedParameter = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
	IList&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; expectedResult = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; });

	IList&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt; actualResult = DeferredExecutionHelper.GetListHelper&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; actualParameter)
	{
		Assert.AreEqual(expectedParameter, actualParameter);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; expectedResult;
	}, expectedParameter);

	Assert.AreEqual(expectedResult.Count, actualResult.Count);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; expectedResult.Count; ++i) { Assert.AreEqual(expectedResult[i], actualResult[i]); } 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Feel free to download &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DeferredExecution.zip&#34;&gt;DeferredExecution.zip&lt;/a&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Generating Artifacts By Using Text Templates</title>
      <link>/post/2008-02-21-generating-artifacts-by-using-text-templates/</link>
      <pubDate>Thu, 21 Feb 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-02-21-generating-artifacts-by-using-text-templates/</guid>
      <description>
        
          &lt;p&gt;Since i remember myself thinking &amp;ldquo;I should look up that .tt templating thing&amp;rdquo; already a couple of times and always forgot to actually do so, i&amp;rsquo;m posting it here: &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/bb126445.aspx&#34;&gt;Generating Artifacts By Using Text Templates&lt;/a&gt;. The tools comes with the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/bb166441(VS.80).aspx&#34;&gt;Visual Studio SDK&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>How the name of an embedded resource is generated in a C# project</title>
      <link>/post/2008-02-20-how-the-name-of-an-embedded-resource-is-generated-in-a-c-project/</link>
      <pubDate>Wed, 20 Feb 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-02-20-how-the-name-of-an-embedded-resource-is-generated-in-a-c-project/</guid>
      <description>
        
          &lt;p&gt;A while ago i was wondering how the name of an embedded resource is generated in a C# project. Earlier today i was looking in Microsoft.CSharp.targets and found the answer&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The CreateManifestResourceNames target create the manifest resource names from the .RESX files.&lt;/p&gt;
&lt;p&gt;[IN]
@(ResxWithNoCulture) - The names the non-culture .RESX files.
@(ResxWithCulture) - The names the culture .RESX files.
@(NonResxWithNoCulture) - The names of the non-culture non-RESX files (like bitmaps, etc).
@(NonResxWithCulture) - The names of the culture non-RESX files (like bitmaps, etc).&lt;/p&gt;
&lt;p&gt;[OUT]
@(ManifestResourceWithNoCultureName) - The corresponding manifest resource name (.RESOURCE)
@(ManifestResourceWithCultureName) - The corresponding manifest resource name (.RESOURCE)
@(ManifestNonResxWithNoCulture) - The corresponding manifest resource name.
@(ManifestNonResxWithCulture) - The corresponding manifest resource name.&lt;/p&gt;
&lt;p&gt;For C# applications the transformation is like:&lt;/p&gt;
&lt;p&gt;Resources1.resx =&amp;gt; RootNamespace.Resources1 =&amp;gt; Build into main assembly
SubFolder\Resources1.resx =&amp;gt; RootNamespace.SubFolder.Resources1 =&amp;gt; Build into main assembly
Resources1.fr.resx =&amp;gt; RootNamespace.Resources1.fr =&amp;gt; Build into satellite assembly
Resources1.notaculture.resx =&amp;gt; RootNamespace.Resources1.notaculture =&amp;gt; Build into main assembly&lt;/p&gt;
&lt;p&gt;For other project systems, this transformation may be different.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;With &lt;a href=&#34;http://www.attrice.info/msbuild/index.htm&#34;&gt;Attrice Corporation Microsoft Build Sidekick v2&lt;/a&gt; you can easily visualize the flow throughout the targets via Tools -&amp;gt; View Targets Diagram.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Updating Assembly References with TFS</title>
      <link>/post/2008-02-18-updating-assembly-references-with-tfs/</link>
      <pubDate>Mon, 18 Feb 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-02-18-updating-assembly-references-with-tfs/</guid>
      <description>
        
          &lt;p&gt;A while ago i &lt;a href=&#34;http://www.timvw.be/programming-the-csproj-file/&#34;&gt;posted some code that allows you to update the Assembly references&lt;/a&gt;. Here is some code that uses the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/bb130146(VS.80).aspx&#34;&gt;Team Foundation Server SDK&lt;/a&gt; that checks the csproj files out and updates their references. Afterwards it&amp;rsquo;s possible to check the modified csproj files in with a reference to a WorkItem (or to undo the checkout in case no modifications were made).&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; tfsServerName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;tfsrtm08&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; projectsPath = &lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;D:\Projects&amp;#34;&lt;/span&gt;;

	Console.WriteLine( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Connecting to TFS [&amp;#34;&lt;/span&gt; + tfsServerName + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;]...&amp;#34;&lt;/span&gt; );
	TeamFoundationServer teamFoundationServer = TeamFoundationServerFactory.GetServer( tfsServerName );

	Console.WriteLine( Environment.NewLine + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Modified ProjectFiles:&amp;#34;&lt;/span&gt; );
	List&amp;lt;workspace&amp;gt; workSpacesWithUpdatedProjectFiles = UpdateReferencesInProjectFiles( teamFoundationServer, projectsPath );

	Console.WriteLine( Environment.NewLine + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Modified Workspaces: &amp;#34;&lt;/span&gt; );
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt;( Workspace workSpace &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; workSpacesWithUpdatedProjectFiles )
	{
		Console.WriteLine( workSpace.Name );
	}

	&lt;span style=&#34;color:#75715e&#34;&gt;//int workItemId = -1;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;//CheckInPendingChanges( teamFoundationServer, workItemId, workSpacesWithUpdatedProjectFiles );
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
	Console.Write( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine );
	Console.ReadKey();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; List&amp;lt;workspace&amp;gt; UpdateReferencesInProjectFiles( TeamFoundationServer teamFoundationServer, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; projectsPath )
{
	VersionControlServer versionControlServer = (VersionControlServer) teamFoundationServer.GetService( &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;( VersionControlServer ) );

	List&amp;lt;workspace&amp;gt; workSpacesWithUpdatedProjectFiles = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;workspace&amp;gt;();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt;( &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; projectFileName &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; ProjectFile.Find( projectsPath ) )
	{
		Workspace workSpace = versionControlServer.GetWorkspace( Path.GetFullPath( projectFileName ) );
		workSpace.PendEdit( projectFileName );

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;( UpdateReferencesInProjectFile( projectFileName ) )
		{
			Console.WriteLine( projectFileName );
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;( !workSpacesWithUpdatedProjectFiles.Contains( workSpace ) )
			{
				workSpacesWithUpdatedProjectFiles.Add( workSpace );
			}
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		{
			workSpace.Undo( projectFileName );
		}
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; workSpacesWithUpdatedProjectFiles;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; CheckInPendingChanges( TeamFoundationServer teamFoundationServer, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; workItemId, List&amp;lt;workspace&amp;gt; workSpacesWithUpdatedProjectFiles )
{
	WorkItemStore workItemStore = (WorkItemStore) teamFoundationServer.GetService( &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;( WorkItemStore ) );

	WorkItem workItem = workItemStore.GetWorkItem( workItemId );
	WorkItemCheckinInfo[] workItemChanges = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; WorkItemCheckinInfo[] { &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; WorkItemCheckinInfo( workItem, WorkItemCheckinAction.Associate ) };
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt;( Workspace workSpace &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; workSpacesWithUpdatedProjectFiles )
	{
		PendingChange[] pendingChanges = workSpace.GetPendingChanges();
		workSpace.CheckIn( pendingChanges, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, workItemChanges, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; );
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Feel free to download the code: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ReferenceManager.zip&#34;&gt;ReferenceManager.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Programming the csproj file</title>
      <link>/post/2008-01-25-programming-the-csproj-file/</link>
      <pubDate>Fri, 25 Jan 2008 00:00:00 +0000</pubDate>
      
      <guid>/post/2008-01-25-programming-the-csproj-file/</guid>
      <description>
        
          &lt;p&gt;Imagine that you have a couple of project files that reference framework libraries that are on a buildserver. Upgrading to a newer version requires that you update all the references&amp;hellip; I wrote some wrapper classes (&lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ProjectFile.txt&#34;&gt;ProjectFile&lt;/a&gt;, &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/AssemblyReference.txt&#34;&gt;AssemblyReference&lt;/a&gt;) that make this tedious task a breeze. Here is an example of their usage&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; path = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;D:\\Projects\\MyProject&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] projectFileNames = ProjectFile.Find(path);
&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; projectFileName &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; projectFileNames)
{
	ProjectFile projectFile = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ProjectFile(projectFileName);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; updated = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (AssemblyReference assemblyReference &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; projectFile.AssemblyReferences)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (assemblyReference.HintPath.ToLower().StartsWith(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;\\\\buildserver\\framework\\2.0&amp;#34;&lt;/span&gt;))
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; newHintPath = assemblyReference.HintPath.Replace(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;\\2.0\\&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;\\2.1\\&amp;#34;&lt;/span&gt;);
			assemblyReference.HintPath = newHintPath;

			AssemblyName assemblyName = AssemblyName.GetAssemblyName(assemblyReference.HintPath);
			assemblyReference.AssemblyName = assemblyName.FullName + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;, processorArchitecture=&amp;#34;&lt;/span&gt; + assemblyName.ProcessorArchitecture;

			updated = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (updated)
	{
		projectFile.Save();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt; Be careful because it might be possible that the code changes the encoding of your csproj file (and it seems that the TFS 2005 merge tool doesn&amp;rsquo;t like that). Currently files are written as UTF-8, which is the default for VS2005 csproj files.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Build your own netstat.exe with c#</title>
      <link>/post/2007-09-09-build-your-own-netstatexe-with-c/</link>
      <pubDate>Sun, 09 Sep 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-09-09-build-your-own-netstatexe-with-c/</guid>
      <description>
        
          &lt;p&gt;Earlier today i wrote ManagedIpHelper, a wrapper for &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/aa366073.aspx&#34;&gt;IP Helper API&lt;/a&gt; it&amp;rsquo;s &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/aa365928.aspx&#34;&gt;GetExtendedTcpTable&lt;/a&gt;. Using this wrapper i could easily create my own version of netstat.exe. The following code generates the same output (but much faster) than &amp;ldquo;netstat.exe -anvbp tcp&amp;rdquo;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Active Connections&amp;#34;&lt;/span&gt;);
	Console.WriteLine();

	Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; Proto Local Address Foreign Address State PID&amp;#34;&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (TcpRow tcpRow &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; ManagedIpHelper.GetExtendedTcpTable(&lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;))
	{
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; {0,-7}{1,-23}{2, -23}{3,-14}{4}&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;TCP&amp;#34;&lt;/span&gt;, tcpRow.LocalEndPoint, tcpRow.RemoteEndPoint, tcpRow.State, tcpRow.ProcessId);

		Process process = Process.GetProcessById(tcpRow.ProcessId);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (process.ProcessName != &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System&amp;#34;&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (ProcessModule processModule &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; process.Modules)
			{
				Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; {0}&amp;#34;&lt;/span&gt;, processModule.FileName);
			}

			Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; [{0}]&amp;#34;&lt;/span&gt;, Path.GetFileName(process.MainModule.FileName));
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		{
			Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; -- unknown component(s) --&amp;#34;&lt;/span&gt;);
			Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; [{0}]&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System&amp;#34;&lt;/span&gt;);
		}

		Console.WriteLine();
	}

	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As always, feel free to download the code for the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/managediphelperanddemo.zip&#34;&gt;ManagedIpHelper and demo&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting SqlCeClientFactory</title>
      <link>/post/2007-09-09-presenting-sqlceclientfactory/</link>
      <pubDate>Sun, 09 Sep 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-09-09-presenting-sqlceclientfactory/</guid>
      <description>
        
          &lt;p&gt;Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SqlCeClientFactory&lt;/span&gt; : DbProviderFactory
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;readonly&lt;/span&gt; SqlCeClientFactory Instance = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SqlCeClientFactory();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; DbCommand CreateCommand()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SqlCeCommand();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; DbCommandBuilder CreateCommandBuilder()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SqlCeCommandBuilder();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; DbConnection CreateConnection()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SqlCeConnection();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; DbDataAdapter CreateDataAdapter()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SqlCeDataAdapter();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; DbParameter CreateParameter()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SqlCeParameter();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As you can see, the implementation is trivial, so i still wonder why microsoft didn&amp;rsquo;t provide it. Anyway, here is how our App.config would look like if we wanted to register and use the SqlCeClientFactory (we could also install the assembly in the GAC and edit machine.config so that all applications can take advantage of it)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;connectionStrings&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;add&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;localdb&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;providerName=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System.Data.SqlServerCe&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;connectionString=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Data Source=&amp;#39;localdb.sdf&amp;#39;;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/connectionStrings&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;system.data&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;dbProviderFactories&amp;gt;&lt;/span&gt;
			&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;add&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;name=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SQL Server Everywhere Edition Data Provider&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;invariant=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System.Data.SqlServerCe&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;description=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.NET Framework Data Provider for Microsoft SQL Server Everywhere Edition&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;type=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SqlCeApplication.SqlCeClientFactory, SqlCeApplication&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
		&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/dbProviderFactories&amp;gt;&lt;/span&gt;
	&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/system.data&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we can use the &lt;a href=&#34;http://www.timvw.be/helper-methods-for-dbconnection/&#34;&gt;DbConnectionHelper&lt;/a&gt; to create a DbConnection and do some work&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (DbConnection conn = DbConnectionHelper.GetConnection(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;localdb&amp;#34;&lt;/span&gt;))
	{
		conn.Open();
		&lt;span style=&#34;color:#75715e&#34;&gt;// do some work...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	}

	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Query a Web Service hosted outside IIS with it&#39;s DNS name</title>
      <link>/post/2007-09-08-host-a-web-service-outside-iis/</link>
      <pubDate>Sat, 08 Sep 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-09-08-host-a-web-service-outside-iis/</guid>
      <description>
        
          &lt;p&gt;Yesterday someone asked the following:&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;My first attempt was to simulate the problem. I added an entry in my hosts file so that example.com resolves to 192.168.10.1 (My machine&amp;rsquo;s IP address) and wrote the following code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;EndpointReference epr = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EndpointReference(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;soap.tcp://example.com:9090/BookService&amp;#34;&lt;/span&gt;));
SoapReceivers.Add(epr, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(BookService));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When i tried to run this code i received an ArgumentException: &amp;ldquo;WSE813: The following transport address could not be mapped to a local network interface: soap.tcp://example.com:9090/BookService&amp;rdquo;. My intuition said that i should help the infrastructure a little&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;EndpointReference epr = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EndpointReference(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;soap.tcp://192.168.10.1:9090/BookService&amp;#34;&lt;/span&gt;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The application started fine this time, but when i used wsewsdl3.exe to generate the proxy i received the following error: Destination Unreachable. Anyway, after a lot of experimenting i found that the following method allows me to generate a proxy using the DNS name&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; EndpointReference GetEndpointReference(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; host, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; port, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; path)
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// we happy:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// for the Address part we use the DNS name
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;//
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// infrastructure happy:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// for the Via par we use the first IP that maps to the provided DNS name
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
	Uri address = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;soap.tcp://{0}:{1}/{2}&amp;#34;&lt;/span&gt;, host, port, path));
	Uri via = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;soap.tcp://{0}:{1}/{2}&amp;#34;&lt;/span&gt;, Dns.GetHostEntry(host).AddressList[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], port, path));
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EndpointReference(address, via);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	EndpointReference epr = GetEndpointReference(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;example.com&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;9090&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;BookService&amp;#34;&lt;/span&gt;);
	SoapReceivers.Add(epr, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(BookService));

	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();

	SoapReceivers.Remove(epr);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As always, you can download a sample solution with a windows service that hosts the webservice, and a console application that consumes the webservice: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/MsdnSoapExample.zip&#34;&gt;MsdnSoapExample.zip&lt;/a&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Using DateTimePicker and Custom Format</title>
      <link>/post/2007-08-29-using-datetimepicker-and-custom-format/</link>
      <pubDate>Wed, 29 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-29-using-datetimepicker-and-custom-format/</guid>
      <description>
        
          &lt;p&gt;Today we ran into a nasty problem with &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datetimepickerformat.aspx&#34;&gt;DateTimePickerFormat&lt;/a&gt;.Custom. We allow the user to input a month/date with a DateTimePicker as following (nothing fancy)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Form1_Load(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTimePicker1.Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;31&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTimePicker1.Format = DateTimePickerFormat.Custom;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTimePicker1.CustomFormat = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MM/yyyy&amp;#34;&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now, change to 09/2007 and notice that you get an Exception, because the control tries to create an unrepresentable new DateTime(2007, 8+1, 31). Thus, if you&amp;rsquo;re going to use the DateTimePicker for MM/yyyy input make sure to set it&amp;rsquo;s value to a DateTimeTime with a day component that exists for all months/years (thus a value between 1 and 28).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Addendum:&lt;/strong&gt; As usual, super moderator and MVP &lt;a href=&#34;https://mvp.support.microsoft.com/default.aspx/profile=6c93adc6-026f-42bf-823c-8e65ca732af2&#34;&gt;Hans Passant&lt;/a&gt; provided a nice workaround for the problem:)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MonthPicker&lt;/span&gt; : DateTimePicker 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; MonthPicker() 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Format = DateTimePickerFormat.Custom;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.CustomFormat = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MM/yyyy&amp;#34;&lt;/span&gt;;
		DateTime now = DateTime.Now;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(now.Year, now.Month, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
	}
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; WndProc(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; Message m) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (m.Msg == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;x204e) 
		{
			NMHDR hdr = (NMHDR)m.GetLParam(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(NMHDR));
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (hdr.code == -&lt;span style=&#34;color:#ae81ff&#34;&gt;759&lt;/span&gt;) 
				{
					NMDATETIMECHANGE dt = (NMDATETIMECHANGE)m.GetLParam(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(NMDATETIMECHANGE));
					&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(dt.st.wYear, dt.st.wMonth, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
					&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt;;
				}
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.WndProc(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; m);
	}
	
	&lt;span style=&#34;color:#75715e&#34;&gt;// P/Invoke declarations
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[StructLayout(LayoutKind.Sequential)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;NMHDR&lt;/span&gt; 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IntPtr hWnd;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IntPtr id;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; code;
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;	
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;NMDATETIMECHANGE&lt;/span&gt; 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; NMHDR nmhdr;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; dwFlags;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; SYSTEMTIME st;
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;	
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[StructLayout(LayoutKind.Sequential)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SYSTEMTIME&lt;/span&gt; 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wYear;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wMonth;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wDayOfWeek;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wDay;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wHour;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wMinute;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wSecond;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;short&lt;/span&gt; wMilliseconds;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>ClickOnce Deployment is not user-friendly!</title>
      <link>/post/2007-08-26-clickonce-deployment-is-not-user-friendly/</link>
      <pubDate>Sun, 26 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-26-clickonce-deployment-is-not-user-friendly/</guid>
      <description>
        
          &lt;p&gt;Today i was experimenting with &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/t71a733d(VS.80).aspx&#34;&gt;ClickOnce Deployment&lt;/a&gt;. Some people have warned for the elevation of permissions: &lt;a href=&#34;http://www.leastprivilege.com/BewareBeAwareOfClickOnceDefaultSettings.aspx&#34;&gt;Be aware of ClickOnce default settings&lt;/a&gt;. What i find even more annoying is the fact that all you get to see are the following dialogs&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/clickonce-permissions-01.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/clickonce-permissions-02.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;If the user has to make an informed decision about the permissions he&amp;rsquo;s going to grant to an application he should have atleast an easily accessible dialog that displays the PermissionSet that is being request. &lt;strong&gt;Having to browse to the manifest file to find the PermissionSet is NOT user-friendly!&lt;/strong&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Bending the code generation of IExtenderProvider to your will</title>
      <link>/post/2007-08-21-bending-the-code-generation-of-iextenderprovider-to-your-will/</link>
      <pubDate>Tue, 21 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-21-bending-the-code-generation-of-iextenderprovider-to-your-will/</guid>
      <description>
        
          &lt;p&gt;In &lt;a href=&#34;http://www.timvw.be/exploring-codedomserializer/&#34;&gt;Exploring CodeDomSerializer&lt;/a&gt; i already explained how we can modify the code that the Visual Studio designer generates for us. With a typical &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.componentmodel.iextenderprovider.aspx&#34;&gt;IExtenderProvider&lt;/a&gt; the designer generates an initializer, SetXXX methods and a variable declaration, which looks like&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.constantsExtenderProvider1 = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; WindowsApplication1.ConstantsExtenderProvider();

&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.constantsExtenderProvider1.SetConstants(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.button1, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] {
&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Operation1&amp;#34;&lt;/span&gt;,
&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Operation5&amp;#34;&lt;/span&gt;});

&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.constantsExtenderProvider1.SetConstants(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; ConstantsExtenderProvider constantsExtenderProvider1;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now, what if we&amp;rsquo;re not happy with those generated SetXXX methods on each Component? The problem is that this code is not generated by the serializer for the ConstantsExtenderProvider but by the serializers for the Components. An easy workaround for this problem is to set the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.componentmodel.designerserializationvisibilityattribute.aspx&#34;&gt;DesignerSerializationVisibilityAttribute&lt;/a&gt; on the GetXXX method in our IExtenderProvider to &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.componentmodel.designerserializationvisibility.aspx&#34;&gt;Hidden&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With those ugly SetXXX methods out of the way it&amp;rsquo;s up to us to do it better. We do this by implementing a custom serializer for our ConstantsExtenderProvider&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ConstantsSerializer&lt;/span&gt;&amp;lt;T&amp;gt; : CodeDomSerializer
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; Serialize(IDesignerSerializationManager manager, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
	{
		ConstantsExtenderProvider provider = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ConstantsExtenderProvider;

		CodeDomSerializer baseClassSerializer = manager.GetSerializer(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(ConstantsExtenderProvider).BaseType, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(CodeDomSerializer)) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; CodeDomSerializer;
		CodeStatementCollection statements = baseClassSerializer.Serialize(manager, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; CodeStatementCollection;

		IDesignerHost host = (IDesignerHost)manager.GetService(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(IDesignerHost));
		ComponentCollection components = host.Container.Components;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.SerializeExtender(manager, provider, components, statements);

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; statements;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; SerializeExtender(IDesignerSerializationManager manager, ConstantsExtenderProvider provider, ComponentCollection components, CodeStatementCollection statements)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (IComponent component &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; components)
		{
			Control control = component &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Control;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (control != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; (control &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Form == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;))
			{
				CodeMethodInvokeExpression methodcall = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeMethodInvokeExpression(&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.SerializeToExpression(manager, provider), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SetConstants&amp;#34;&lt;/span&gt;);
				methodcall.Parameters.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeFieldReferenceExpression(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeThisReferenceExpression(), control.Name));

				&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] constants = provider.GetConstants(control);
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (constants != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
				{
					StringBuilder sb = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StringBuilder();
					sb.Append(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;new string[] { &amp;#34;&lt;/span&gt;);

					&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; constant &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; constants)
					{
						sb.Append(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(T).FullName);
						sb.Append(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;);
						sb.Append(constant);
						sb.Append(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;, &amp;#34;&lt;/span&gt;);
					}

					sb.Remove(sb.Length -- &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
					sb.Append(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; }&amp;#34;&lt;/span&gt;);

					methodcall.Parameters.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeSnippetExpression(sb.ToString()));
				}
				&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
				{
					methodcall.Parameters.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodePrimitiveExpression(&lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;));
				}

				statements.Add(methodcall);
			}
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now the generated code looks like&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.constantsExtenderProvider1.SetConstants(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.button1, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] { WindowsApplication1.Constants.Operation1, WindowsApplication1.Constants.Operation5 });
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As always, feel free to download the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ConstantsExtenderProvider.zip&#34;&gt;ConstantsExtenderProvider&lt;/a&gt; source.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Exploring CodeDomSerializer</title>
      <link>/post/2007-08-17-exploring-codedomserializer/</link>
      <pubDate>Fri, 17 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-17-exploring-codedomserializer/</guid>
      <description>
        
          &lt;p&gt;Sometimes we want absolute control over the code that the visual studio designer generates. Imagine that we have a UserControl with a Number property and instead of the default &amp;ldquo;this.userControl1.Number = 27;&amp;rdquo; code that the designer would generate we want it like &amp;ldquo;this.userControl1.Number = 1 + 3 + 23&amp;rdquo;. In order to achieve this we first have to inform the designer that we want custom serialization. This is done by adding a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.componentmodel.design.serialization.designerserializerattribute.aspx&#34;&gt;DesignerSerializerAttribute&lt;/a&gt; to our UserControl&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[DesignerSerializer(typeof(PrimeSerializer), typeof(CodeDomSerializer))]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;UserControl1&lt;/span&gt; : UserControl
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; number;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Number
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.number; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.number = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}

	&lt;span style=&#34;color:#75715e&#34;&gt;// ...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now it&amp;rsquo;s time to implement the PrimeSerializer for the custom assignment code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PrimeSerializer&lt;/span&gt; : CodeDomSerializer
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; Serialize(IDesignerSerializationManager manager, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
	{
		UserControl1 uc = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; UserControl1;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (uc == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; }

		&lt;span style=&#34;color:#75715e&#34;&gt;// Instead of implementing all the serialization code, we&amp;#39;ll rely on the implementation of the baseclass, namely UserControl
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		CodeDomSerializer baseClassSerializer = manager.GetSerializer(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(UserControl1).BaseType, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(CodeDomSerializer)) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; CodeDomSerializer;
		Object codeObject = baseClassSerializer.Serialize(manager, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;);

		&lt;span style=&#34;color:#75715e&#34;&gt;// The only thing we have to do is find the statement where the assigment to the Number property is made, and replace that...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		CodeStatementCollection codeStatements = codeObject &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; CodeStatementCollection;
		CodeAssignStatement numberAssignmentStatement = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.FindNumberCodeStatement(codeStatements) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; CodeAssignStatement;
		numberAssignmentStatement.Right = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeSnippetExpression(GetNumberAsSumOfPrimes(uc.Number));

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; codeObject;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; CodeStatement FindNumberCodeStatement(CodeStatementCollection codeStatements)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (CodeStatement codeStatement &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; codeStatements)
		{
			CodeAssignStatement codeAssignment = codeStatement &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; CodeAssignStatement;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (codeAssignment != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
			{
				CodePropertyReferenceExpression left = codeAssignment.Left &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; CodePropertyReferenceExpression;
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (left != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; left.PropertyName == &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Number&amp;#34;&lt;/span&gt;)
				{
					&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; codeStatement;
				}
			}
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Exception(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The CodeStatement for Number was not found&amp;#34;&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; GetNumberAsSumOfPrimes(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; number)
	{
		StringBuilder sb = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StringBuilder();

		&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] primes = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;17&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;29&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;31&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;37&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;41&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;43&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;47&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;53&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;59&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;61&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;67&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;71&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;73&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;79&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;83&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;89&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;97&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;101&lt;/span&gt; };
		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = primes.Length -- &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;; i &amp;gt;= &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; number &amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; --i)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (primes[i] &amp;lt;= number) 
			{ 
				sb.Insert(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, primes[i]); sb.Insert(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; + &amp;#34;&lt;/span&gt;); 
				number -= primes[i]; 
			} 
		} 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; sb.ToString().Substring(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;); 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we can look at the generated code in Form1.Designer.cs to verify everything works as expected&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// userControl1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.userControl1.BackColor = System.Drawing.Color.Maroon;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.userControl1.Location = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; System.Drawing.Point(&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.userControl1.Name = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;userControl11&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.userControl1.Number = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; + &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; + &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.userControl1.Size = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; System.Drawing.Size(&lt;span style=&#34;color:#ae81ff&#34;&gt;686&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;294&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.userControl1.TabIndex = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I&amp;rsquo;ll leave the implementation of the Deserialize method up to you. By adding the DesignerSerializer attribute to our &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.componentmodel.iextenderprovider.aspx&#34;&gt;IExtenderProvider&lt;/a&gt; implementations we can get full control over their code generation too 🙂&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>StreamHelper</title>
      <link>/post/2007-08-17-streamhelper/</link>
      <pubDate>Fri, 17 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-17-streamhelper/</guid>
      <description>
        
          &lt;p&gt;The following is an example of a classic mistake for people that read from a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.io.stream.aspx&#34;&gt;Stream&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;Offcourse, if you look at the documentation for the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.io.stream.read.aspx&#34;&gt;Read&lt;/a&gt; method it clearly says that the function returns the number of bytes that were actually read. Here is a little helper function that keeps you from writing the same code over and over again&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Copy(Stream input, Stream output, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; bufferSize)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[] buffer = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[bufferSize];
	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; bytesRead;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt;((bytesRead = input.Read(buffer, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, bufferSize)) &amp;gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
	{
		output.Write(buffer, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, bytesRead);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And as usual, a little demo of it&amp;rsquo;s use&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DownloadFile(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; url, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; path)
{
	WebRequest req = WebRequest.Create(url);
	WebResponse rsp = req.GetResponse();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (Stream input = rsp.GetResponseStream())
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (Stream output = File.Open(path, FileMode.Create))
	{
		StreamHelper.Copy(input, output, &lt;span style=&#34;color:#ae81ff&#34;&gt;1024&lt;/span&gt; * &lt;span style=&#34;color:#ae81ff&#34;&gt;1000&lt;/span&gt;);
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	DownloadFile(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;ftp://example.com/pub/test.bin&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;c:\test.bin&amp;#34;&lt;/span&gt;);

	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>List string resources</title>
      <link>/post/2007-08-11-list-string-resources/</link>
      <pubDate>Sat, 11 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-11-list-string-resources/</guid>
      <description>
        
          &lt;p&gt;Earlier today someone asked how he could list the string resources (name, value and comment) in a Resource file. Here is some code that generates a nice list of the information&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	DislayResourceStrings(GetResourceStrings(&lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;C:\Resource1.resx&amp;#34;&lt;/span&gt;));

	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; List&amp;lt;resourceString&amp;gt; GetResourceStrings(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; path)
{
	List&amp;lt;resourceString&amp;gt; resourceStrings = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;resourceString&amp;gt;();

	XPathDocument doc = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; XPathDocument(path);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (XPathNavigator node &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; doc.CreateNavigator().Select(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;//data&amp;#34;&lt;/span&gt;))
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; type = node.GetAttribute(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (type == &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty)
		{
			XPathNavigator nav;

			&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name = node.GetAttribute(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty);
			nav = node.SelectSingleNode(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./value&amp;#34;&lt;/span&gt;);
			&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; = nav != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; ? nav.Value : &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty;

			nav = node.SelectSingleNode(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;./comment&amp;#34;&lt;/span&gt;);
			&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; comment = nav != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; ? nav.Value : &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty;

			resourceStrings.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ResourceString(name, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;, comment));
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; resourceStrings;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DisplayResourceStrings(List&amp;lt;resourceString&amp;gt; resourceStrings)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; format = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0, -25} {1, -25} {2, -25}&amp;#34;&lt;/span&gt;;
	Console.WriteLine(format, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Value&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Comment&amp;#34;&lt;/span&gt;);
	Console.WriteLine(format, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;---&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;----&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-----&amp;#34;&lt;/span&gt;);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (ResourceString resourceString &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; resourceStrings)
	{
		Console.WriteLine(format, resourceString.Name, resourceString.Value, resourceString.Comment);
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ResourceString&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Value;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Comment;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; ResourceString(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; comment)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Name = name;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Comment = comment;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Debugging custom UITypeEditors</title>
      <link>/post/2007-08-10-debugging-custom-uitypeeditors/</link>
      <pubDate>Fri, 10 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-10-debugging-custom-uitypeeditors/</guid>
      <description>
        
          &lt;p&gt;If you read this you&amp;rsquo;re probably gonna think: What a moron! Anyway, i&amp;rsquo;m sharing this in the hope that i&amp;rsquo;ll be the last to undergo the following. In order to test my custom &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.drawing.design.uitypeeditor.aspx&#34;&gt;UITypeEditor&lt;/a&gt; i did the following&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Create a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.usercontrol.aspx&#34;&gt;UserControl&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Add a property to the control&lt;/li&gt;
&lt;li&gt;Add an &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.componentmodel.editorattribute.aspx&#34;&gt;Editor&lt;/a&gt; attribute to the property&lt;/li&gt;
&lt;li&gt;Build&lt;/li&gt;
&lt;li&gt;Drag a UserControl on the designer form&lt;/li&gt;
&lt;li&gt;Test via Visual Studio&amp;rsquo;s Property Window if the UITypeEditor works as expected&lt;/li&gt;
&lt;li&gt;Everytime i changed some code: &lt;strong&gt;Restart Visual Studio&lt;/strong&gt;, load the project and repeat 6.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;A tedious task to say the least. Yesterday i figured out that i could &lt;strong&gt;drag a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.propertygrid.aspx&#34;&gt;PropertyGrid&lt;/a&gt; on the designer form, and set it&amp;rsquo;s SelectedObject property to a class with a property that uses the custom UITypeEditor; Instead of having to reload visual studio i can simply start a debug session, and click on the property in the PropertyGrid.&lt;/strong&gt; Now it&amp;rsquo;s a breeze to develop custom UITypeEditors.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/uitypeeditor.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Form1_Load(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// display an instance of PersonEntry,
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// a class with a property that should use the custom UITypeEditor i want to test
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.propertyGrid1.SelectedObject = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonEntry(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tim&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Van Wassenhove&amp;#34;&lt;/span&gt;));
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PersonEntry&lt;/span&gt;
{
	...

	&lt;span style=&#34;color:#75715e&#34;&gt;// instruct the PropertyGrid to use my custom PersonUITypeEditor
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[Editor(typeof(PersonUITypeEditor), typeof(UITypeEditor))]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person Person
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.person; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.person = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PersonUITypeEditor&lt;/span&gt; : UITypeEditor
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; UITypeEditorEditStyle.Modal;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; EditValue(ITypeDescriptorContext context, IServiceProvider provider, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
	{
		Person person = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Person;

		IWindowsFormsEditorService svc = context.GetService(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(IWindowsFormsEditorService)) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; IWindowsFormsEditorService;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (svc != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (PersonEditorForm personEditorForm = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonEditorForm(person))
			{
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (svc.ShowDialog(personEditorForm) == DialogResult.OK)
				{
					&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; personEditorForm.Person;
				}
			}
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Helper methods for DbProviderFactory</title>
      <link>/post/2007-08-07-helper-methods-for-dbconnection/</link>
      <pubDate>Tue, 07 Aug 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-08-07-helper-methods-for-dbconnection/</guid>
      <description>
        
          &lt;p&gt;Here are a couple of functions that make it easier to take advantage of the DbProviderFactory to create DbConnections&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; DbConnection GetDbConnection(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; connectionStringName)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; GetDbConnection(ConfigurationManager.ConnectionStrings[connectionStringName]);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; DbConnection GetDbConnection(ConnectionStringSettings connectionStringSettings)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; GetDbConnection(connectionStringSettings.ProviderName, connectionStringSettings.ConnectionString);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; DbConnection GetDbConnection(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; providerInvariantName, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; connectionString)
{
	DbConnection connection = DbProviderFactories.GetFactory(providerInvariantName).CreateConnection();
	connection.ConnectionString = connectionString;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; connection;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Using these functions, the pattern for querying a database could be something as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (DbConnection conn = GetDbConnection(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Local_Northwind&amp;#34;&lt;/span&gt;))
{
	conn.Open();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (DbCommand cmd = conn.CreateCommand())
	{
		cmd.CommandText = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SELECT EmployeeID, FirstName, LastName FROM Employees&amp;#34;&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (DbDataReader reader = cmd.ExecuteReader())
		{
			&lt;span style=&#34;color:#75715e&#34;&gt;// process the result
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Exploring formatting...</title>
      <link>/post/2007-07-28-exploring-formatting/</link>
      <pubDate>Sat, 28 Jul 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-07-28-exploring-formatting/</guid>
      <description>
        
          &lt;p&gt;In the documentation you can read the following for &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx&#34;&gt;CultureInfo&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;First i&amp;rsquo;ll initialize an instance of a customized CultureInfo and install it in the current thread:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;CultureInfo appCultureInfo = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CultureInfo(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;en-US&amp;#34;&lt;/span&gt;);
appCultureInfo.NumberFormat.NumberDecimalSeparator = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;;
appCultureInfo.NumberFormat.NumberGroupSeparator = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;;
appCultureInfo.NumberFormat.NumberDecimalDigits = &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;;
appCultureInfo.NumberFormat.CurrencySymbol = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;€&amp;#34;&lt;/span&gt;;
Thread.CurrentThread.CurrentCulture = appCultureInfo;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; The culture in Thread.CurrentThread.CurrentUICulture is only used by the Resource Manager to lookup culture-specific resources at run-time. Since we&amp;rsquo;re not playing with resources, we don&amp;rsquo;t have to care about this one.&lt;/p&gt;
&lt;p&gt;If you don&amp;rsquo;t provide the desired format specifier, you will get the generic format specifier &amp;ldquo;G&amp;rdquo; ( Standard &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/dwhawy9k(VS.71).aspx&#34;&gt;Numeric&lt;/a&gt;, &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/az4se3k1(VS.71).aspx&#34;&gt;DateTime&lt;/a&gt;, &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/c3s1ez6e(VS.71).aspx&#34;&gt;Enumeration&lt;/a&gt; Format Strings) And now it&amp;rsquo;s time for a little demo&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; SomeValue
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;12345.6789&lt;/span&gt;; }
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Form1_Load(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	label1.Text = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;default to generic format: &amp;#34;&lt;/span&gt; + SomeValue.ToString();
	label2.Text = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;numeric format: &amp;#34;&lt;/span&gt; + SomeValue.ToString(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;N&amp;#34;&lt;/span&gt;);
	label3.Text = String.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;currency format: {0:C}&amp;#34;&lt;/span&gt;, SomeValue);
	label4.DataBindings.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Text&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SomeValue&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;, DataSourceUpdateMode.Never, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;P&amp;#34;&lt;/span&gt;);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column1.DefaultCellStyle.Format = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;E1&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column1.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SomeValue&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Form1[] { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt; };
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/formatting-01.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;Another important interface for formatting is &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.IFormattable.aspx&#34;&gt;IFormattable&lt;/a&gt; which provides functionality to format the value of an object into a string representation. Put simply, it allows you to define your own format specifiers. Here is an example that allows the user to build his own representation of a Person&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Person&lt;/span&gt; : IFormattable
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// omitted the code for 4 properties: Id, Name, Title and Birthday
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; ToString()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; ToString(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{Id}, {Name}&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; ToString(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; format, IFormatProvider formatProvider)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; actualFormat = format;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] replacements = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Id&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Title&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Birthday&amp;#34;&lt;/span&gt; };
		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; replacements.Length; ++i) 
		{ 
			actualFormat = actualFormat.Replace(replacements[i], i.ToString()); 
		} 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(actualFormat, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.title, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.birthday); 
	} 
} 

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Form1_Load(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e) 
{ 
	List&amp;lt;person&amp;gt; persons = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;person&amp;gt;();
	persons.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;1980&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tim&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sir&amp;#34;&lt;/span&gt;));
	persons.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;1974&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Jenna&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Miss&amp;#34;&lt;/span&gt;));

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBox1.FormatString = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{Name} born on {Birthday}&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBox1.FormattingEnabled = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBox1.DataSource = persons;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/formatting-02.gif&#34; alt=&#34;&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Using interfaces with Drag and Drop</title>
      <link>/post/2007-07-26-using-interfaces-with-drag-and-drop/</link>
      <pubDate>Thu, 26 Jul 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-07-26-using-interfaces-with-drag-and-drop/</guid>
      <description>
        
          &lt;p&gt;Earlier today i was refactoring some graphical components. I wanted to use an interface instead of concrete implementations for my drag and drop code&amp;hellip; Although i was using an instance of Foo, and thus IFoo, the following code never allowed me to drop&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IFoo { }
&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt; : IFoo { }

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; label1_MouseDown(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, MouseEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.DoDragDrop(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Foo(), DragDropEffects.All);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Form1_DragEnter(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DragEventArgs e)
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// for an instance of Foo it returns false,
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// if you use typeof(Foo) it returns true though...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.Data.GetDataPresent(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(IFoo)))
	{
		e.Effect = DragDropEffects.All;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Simply wrapping the concrete instance in a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.dataobject(VS.80).aspx&#34;&gt;DataObject&lt;/a&gt; results in the desired behaviour&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; label1_MouseDown(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, MouseEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.DoDragDrop(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DataObject(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(IFoo).FullName,&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Foo()), DragDropEffects.All);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Pondering about DateTime and it&#39;s Ticks...</title>
      <link>/post/2007-07-18-pondering-about-datetime-and-its-ticks/</link>
      <pubDate>Wed, 18 Jul 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-07-18-pondering-about-datetime-and-its-ticks/</guid>
      <description>
        
          &lt;p&gt;Recently someone was able to convince me that there is no problem with using &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/System.Datetime.aspx&#34;&gt;System.DateTime&lt;/a&gt; for the storage of localtimes (even if DST is in effect), because it works with &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.datetime.ticks.aspx&#34;&gt;Ticks&lt;/a&gt; and i bought into his base + offset story&amp;hellip;. The following table explains his reasoning&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;th style=&amp;quot;width: 33%&amp;quot;&amp;gt;
  Localtime
&amp;lt;/th&amp;gt;

&amp;lt;th style=&amp;quot;width: 33%&amp;quot;&amp;gt;
  Ticks (Localtime)
&amp;lt;/th&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 01:59:59
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;599&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:00
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;600&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:01
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;601&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:59:59
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329137&amp;lt;b&amp;gt;199&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:00
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;200&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:01
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;201&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;This reasoning gives you the impression that for each second &lt;strong&gt;1&lt;/strong&gt;0000000 is added to the ticks.. However, this is faulty and in reality you get the following&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;th style=&amp;quot;width: 33%&amp;quot;&amp;gt;
  Localtime
&amp;lt;/th&amp;gt;

&amp;lt;th style=&amp;quot;width: 33%&amp;quot;&amp;gt;
  Ticks (Localtime)
&amp;lt;/th&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 01:59:59
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;599&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:00
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;600&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:01
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;601&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:59:59
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329137&amp;lt;b&amp;gt;199&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:00
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;span style=&amp;quot;color: red&amp;quot;&amp;gt;&amp;lt;b&amp;gt;600&amp;lt;/b&amp;gt;&amp;lt;/span&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;td&amp;gt;
  2007-10-28 02:00:01
&amp;lt;/td&amp;gt;

&amp;lt;td&amp;gt;
  63329133&amp;lt;b&amp;gt;601&amp;lt;/b&amp;gt;0000000
&amp;lt;/td&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;p&gt;As you can see, instead of adding &lt;strong&gt;1&lt;/strong&gt;0000000 to the ticks between 2007-10-27 00:59:59 and 01:00:00 in UTC there is a &lt;!-- raw HTML omitted --&gt;reduction of ticks in the localtime&lt;!-- raw HTML omitted --&gt; instead&amp;hellip;. Because of this new DateTime(633291336000000000, DateTimeKind.Local) could represent both 2007-10-27 00:00:00 UTC and 2007-10-27 01:00:00 UTC&amp;hellip; So if you want to keep out of trouble you&amp;rsquo;d better start storing your dates as UTC&amp;hellip; If you don&amp;rsquo;t believe me, run the test yourself&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;List&amp;lt;dateTime&amp;gt; localTimes = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;dateTime&amp;gt;();

&lt;span style=&#34;color:#75715e&#34;&gt;// start at 2007-10-27 23:59:59 UTC, which is 2007-28-10 01:59:59 localtime
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;DateTime utcBase = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;27&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;23&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;59&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;59&lt;/span&gt;, DateTimeKind.Utc);
localTimes.Add(utcBase.ToLocalTime());

&lt;span style=&#34;color:#75715e&#34;&gt;// add 1 second to the base, which is 2007-28-10 02:00:00 localtime (first time)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;localTimes.Add(utcBase.AddSeconds(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).ToLocalTime());

&lt;span style=&#34;color:#75715e&#34;&gt;// add 2 seconds to the base, which is 2007-28-10 02:00:01 localtime (first time)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;localTimes.Add(utcBase.AddSeconds(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;).ToLocalTime());

&lt;span style=&#34;color:#75715e&#34;&gt;// add 60 minutes to the base, which is 2007-28-10 02:59:59 localtime (first time)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;localTimes.Add(utcBase.AddMinutes(&lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt;).ToLocalTime());

&lt;span style=&#34;color:#75715e&#34;&gt;// add 60 minutes and 1 second to the base, which is 2007-28-10 02:00:00 localtime (second time)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;localTimes.Add(utcBase.AddMinutes(&lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt;).AddSeconds(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).ToLocalTime());

&lt;span style=&#34;color:#75715e&#34;&gt;// add 60 minutes and 2 second to the base, which is 2007-28-10 02:00:01 localtime (second time)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;localTimes.Add(utcBase.AddMinutes(&lt;span style=&#34;color:#ae81ff&#34;&gt;60&lt;/span&gt;).AddSeconds(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;).ToLocalTime());

&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (DateTime localTime &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; localTimes)
{
	Console.WriteLine(localTime.ToString(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;yyyy-MM-dd HH:mm:ss&amp;#34;&lt;/span&gt;));
	Console.WriteLine(localTime.Ticks);
	Console.WriteLine();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>About Authorization</title>
      <link>/post/2007-07-06-about-authorization/</link>
      <pubDate>Fri, 06 Jul 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-07-06-about-authorization/</guid>
      <description>
        
          &lt;p&gt;Yesterday i visited an evening session about authentication and authorization at &lt;a href=&#34;http://www.compuware.be&#34;&gt;Compuware&lt;/a&gt; (Yes, i&amp;rsquo;ve got interesting collegues that are willing to share their knowledige). Anyway, i left the meeting with a couple of questions&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;How does System.Security.Principal.PrincipalPolicy work under &lt;a href=&#34;http://www.mono-project.com/Main_Page&#34;&gt;Mono&lt;/a&gt;?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Well, NoPrincipal and UnauthenticatedPrincipal behave exactly the same way as they do in the Microsoft implementation. For the WindowsPrincipal the unix groups are used to determine the result of IsInRole. eg&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//lists the groups the user timvw is part of:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//timvw@debian:~$ groups
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//timvw dialout cdrom floppy audio video plugdev
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
AppDomain.CurrentDomain.SetPrincipalPolicy(PrincipalPolicy.WindowsPrincipal);
IPrincipal principal = Thread.CurrentPrincipal;

&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] roles = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;floppy&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;wheel&amp;#34;&lt;/span&gt; };
&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; role &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; roles)
{
	Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0} is in the {1} role: {2}.&amp;#34;&lt;/span&gt;, principal.Identity.Name, role, principal.IsInRole(role));
}

&lt;span style=&#34;color:#75715e&#34;&gt;// the output:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//timvw@debian:~$ ./Main.exe
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//timvw is in the floppy role: True.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//timvw is in the wheel role: False.
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;How are instances of IPrincipal propgated into other threads?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A bit of research learned me that BeginInvoke and Thread.Start copy the Thread.CurrentPrincipal into the new thread and that ThreadPool.QueueUserWorkItem and System.Threading.Timer don&amp;rsquo;t copy the Thread.CurrentPrincipal.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;How can i use the &lt;a href=&#34;http://blogs.msdn.com/azman/&#34;&gt;Authorization Manager&lt;/a&gt; without Windows Identity?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A possible solution would be the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; GetSid()
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// modify this so that it contains an application and user id
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;S-1-9-1-1&amp;#34;&lt;/span&gt;;
}

&lt;span style=&#34;color:#75715e&#34;&gt;// By passing in 1 as the second parameter, no verification of the SID against the AD is performed
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;IAzClientContext cctx = app.InitializeClientContextFromStringSid(GetSid(), &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);

&lt;span style=&#34;color:#75715e&#34;&gt;// Because the MMC does not allow you to add custom SIDs you&amp;#39;ll have to edit to add these manually (eg: by using the API)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;IAzApplicationGroup &lt;span style=&#34;color:#66d9ef&#34;&gt;group&lt;/span&gt; = app.OpenApplicationGroup(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DemoApplicationUsers&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;group&lt;/span&gt;.AddMember(GetSid(), &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;group&lt;/span&gt;.Submit(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);

&lt;span style=&#34;color:#75715e&#34;&gt;// And now you can verify is the custom SID has access to a given operation:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;Console.WriteLine(HasAccess(cctx, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; }));

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; HasAccess(IAzClientContext context, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] scopeNames, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] operationIds)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; subject = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;audit&amp;#34;&lt;/span&gt;;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; scopes;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (scopeNames == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; || scopeNames.Length == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
	{
		scopes = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt; };
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		scopes = Array.ConvertAll&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;&amp;gt;(scopeNames, &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; scopeName) { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; scopeName; });
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] operations = Array.ConvertAll&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;&amp;gt;(operationIds, &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; operationId) { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; operationId; });
	&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] results = (&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[])context.AccessCheck(subject, scopes, operations, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; result &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; results)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)result != &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>About additional precision and unpredicted behaviour...</title>
      <link>/post/2007-06-26-about-additional-precision-and-unpredicted-behaviour/</link>
      <pubDate>Tue, 26 Jun 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-06-26-about-additional-precision-and-unpredicted-behaviour/</guid>
      <description>
        
          &lt;p&gt;Earlier today someone posted the following code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;float&lt;/span&gt; a = &lt;span style=&#34;color:#ae81ff&#34;&gt;0.12f&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;float&lt;/span&gt; b = a * &lt;span style=&#34;color:#ae81ff&#34;&gt;100f&lt;/span&gt;;
Console.WriteLine((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;) b); &lt;span style=&#34;color:#75715e&#34;&gt;// prints 12
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;Console.WriteLine((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)(a * &lt;span style=&#34;color:#ae81ff&#34;&gt;100f&lt;/span&gt;)); &lt;span style=&#34;color:#75715e&#34;&gt;// prints 11 !!!!!!!!
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;An (extensive) explanation for this strange behaviour can be found at &lt;a href=&#34;http://blogs.msdn.com/davidnotario/archive/2005/08/08/449092.aspx&#34;&gt;CLR and floating point: Some answers to common questions&lt;/a&gt;&amp;hellip; A possible way to force the compiler and runtime to get rid of the additional precision would be the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Console.WriteLine((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)(&lt;span style=&#34;color:#66d9ef&#34;&gt;float&lt;/span&gt;)(a * &lt;span style=&#34;color:#ae81ff&#34;&gt;100f&lt;/span&gt;));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Improvements for the SortableBindingList (and TypedList)</title>
      <link>/post/2007-05-10-improvements-for-the-sortablebindinglist-and-typedlist/</link>
      <pubDate>Thu, 10 May 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-05-10-improvements-for-the-sortablebindinglist-and-typedlist/</guid>
      <description>
        
          &lt;p&gt;I found out that the sorting didn&amp;rsquo;t work for &amp;lsquo;Expression&amp;rsquo; properties. My first thought was to add another switch to the logic of the already existing code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; value1 = t1;
&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; value2 = t2;

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (prop.Name.StartsWith(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;||&amp;#34;&lt;/span&gt;))
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// do something to find the &amp;#39;ExpressionProperty&amp;#39; values
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; property &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; prop.Name.Split(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;))
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// navigate through the relations
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		PropertyInfo propertyInfo = value1.GetType().GetProperty(property);
		value1 = propertyInfo.GetValue(value1, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
		value2 = propertyInfo.GetValue(value2, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Since i already have a PropertyDescriptor it seems a lot smarter to use it&amp;rsquo;s GetValue instead&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; value1 = prop.GetValue(t1);
&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; value2 = prop.GetValue(t2);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;At &lt;a href=&#34;http://blog.developpez.com/index.php?blog=121&amp;amp;title=typedlistalt_tagt&amp;amp;more=1&amp;amp;c=1&amp;amp;tb=1&amp;amp;pb=1&#34;&gt;Matthieu MEZIL&lt;/a&gt;&amp;rsquo;s blog i found a suggestion to use &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/cfttsh47(VS.80).aspx&#34;&gt;Comparer&lt;!-- raw HTML omitted --&gt;&lt;/a&gt;. This allowed me to reduce&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;IComparable comparable = value1 &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; IComparable;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (comparable != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; reverse * comparable.CompareTo(value2);
}
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
{
	comparable = value2 &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; IComparable;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (comparable != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;* reverse &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;* comparable.CompareTo(value1);
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;with&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Notice that this requires that atleast value1 or value2 are an instance of a type that implements IComparable
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; reverse * Comparer.Default.Compare(value1, value2);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Feel free to get yet another version of &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/TypedList.zip&#34;&gt;TypedList.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting the ExpressionDescriptor</title>
      <link>/post/2007-05-08-presenting-the-expressiondescriptor/</link>
      <pubDate>Tue, 08 May 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-05-08-presenting-the-expressiondescriptor/</guid>
      <description>
        
          &lt;p&gt;A couple of days ago i presented you the &lt;a href=&#34;http://www.timvw.be/presenting-the-typedlistt/&#34;&gt;TypedList&lt;/a&gt; which supports navigation through subproperties. Another common feature request is the possibility to add a column that has a value based on other values in the row (like a DataColumn with it&amp;rsquo;s Expression property set). With the plumbing code i&amp;rsquo;ve written it&amp;rsquo;s as simple as implementing the following interface&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IExpressionProvider&amp;lt;componentType, PropertyType&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt;; }
	PropertyType GetValue(ComponentType component);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;An example implementation could be an expression that represents the duration of an Appointment&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DurationExpressionProvider&lt;/span&gt; : IExpressionProvider&amp;lt;appointment, TimeSpan&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name { &lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;||Duration&amp;#34;&lt;/span&gt;; } }

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; TimeSpan GetValue(Appointment component)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; component.DateTimeRange.End -- component.DateTimeRange.Start;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I&amp;rsquo;ve changed the constructor of TypedList a bit so that it accepts an enumeration of PropertyDescriptors. In my example you can initialise the list as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;List&amp;lt;propertyDescriptor&amp;gt; propertyDescriptors = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;propertyDescriptor&amp;gt;();

&lt;span style=&#34;color:#75715e&#34;&gt;// create the subpropertydescriptors
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] propertyNames = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Patient.Name&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Patient.Address.Municipality&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DateTimeRange.Start&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DateTimeRange.End&amp;#34;&lt;/span&gt; };
propertyDescriptors.AddRange(Array.ConvertAll&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;, SubPropertyDescriptor&amp;lt;appointment&amp;gt;&amp;gt;(propertyNames, &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; propertyName) { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SubPropertyDescriptor&amp;lt;appointment&amp;gt;(propertyName); }));

&lt;span style=&#34;color:#75715e&#34;&gt;// add an expressiondescriptor
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;IExpressionProvider&amp;lt;appointment, TimeSpan&amp;gt; expressionProvider = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DurationExpressionProvider();
ExpressionDescriptor&amp;lt;appointment, TimeSpan&amp;gt; durationDescriptor = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ExpressionDescriptor&amp;lt;appointment, TimeSpan&amp;gt;(expressionProvider);
propertyDescriptors.Add(durationDescriptor);

TypedBindingList&amp;lt;appointment&amp;gt; appointments = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TypedBindingList&amp;lt;appointment&amp;gt;(propertyDescriptors);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And this is how it looks like at runtime&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/typedlist-3.gif&#34; alt=&#34;image of the typedlist&#34;&gt;&lt;/p&gt;
&lt;p&gt;As always, feel free to download the code: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/TypedList.zip&#34;&gt;TypedList.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting the TypedList&lt;T&gt;</title>
      <link>/post/2007-05-05-presenting-the-typedlistt/</link>
      <pubDate>Sat, 05 May 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-05-05-presenting-the-typedlistt/</guid>
      <description>
        
          &lt;p&gt;A while ago i presented the &lt;a href=&#34;http://www.timvw.be/presenting-the-sortablebindinglistt/&#34;&gt;SortableBindingList&lt;/a&gt;. One of the nice features you get with DataSets is that you can use relations to navigate through the data. Business Objects don&amp;rsquo;t give you this functionality by default. Today i implemented a BindingList that supports navigation through relations. First i&amp;rsquo;ll present you the Business Objects&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/typedlist-1.gif&#34; alt=&#34;screenshot of business objects&#34;&gt;&lt;/p&gt;
&lt;p&gt;We would like to create an overview of the appointments using a datagridview&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/typedlist-2.gif&#34; alt=&#34;screenshot of wanted ui&#34;&gt;&lt;/p&gt;
&lt;p&gt;I drag a datagridview on the designer form, add columns, and then i set the datapropertynames as following: (Notice how i use a . to navigate the relations)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnId.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Id&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPatient.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Patient.Name&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnMunicipality.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Patient.Address.Municipality&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnStart.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DateTimeRange.Start&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnEnd.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DateTimeRange.End&amp;#34;&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;First we need to implement a method that allows us to find a PropertyInfo for the given property name&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; PropertyInfo Resolve(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; propertyName)
{
	Type t = &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(T);
	PropertyInfo propertyInfo = &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] subPropertyNames = propertyName.Split(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (subPropertyNames.Length == &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// a regular property
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		propertyInfo = t.GetProperty(propertyName);
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// navigate through the subproperties
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; subPropertyNames.Length - &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;; ++i) 
		{ 
			propertyInfo = t.GetProperty(subPropertyNames[i]); 
			t = propertyInfo.PropertyType; 
		} 
	} 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; propertyInfo; 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now we are ready to implement the ITypedList.GetItemProperties method in our TypedList&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PropertyDescriptorCollection GetItemProperties(PropertyDescriptor[] listAccessors)
{
	PropertyDescriptorCollection propertyDescriptors = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PropertyDescriptorCollection(listAccessors);

	&lt;span style=&#34;color:#75715e&#34;&gt;// add the regular property descriptors T has
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (PropertyDescriptor propertyDescriptor &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; TypeDescriptor.GetProperties(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(T)))
	{
		propertyDescriptors.Add(propertyDescriptor);
	}

	&lt;span style=&#34;color:#75715e&#34;&gt;// add the subproperties
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; subPropertyName &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.subPropertyNames)
	{
		propertyDescriptors.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SubPropertyDescriptor&amp;lt;t&amp;gt;(subPropertyName));
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; propertyDescriptors;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Using this class is as simple as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// create a TypedList that holds Appointments
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;TypedBindingList&amp;lt;appointment&amp;gt; appointments = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TypedBindingList&amp;lt;appointment&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Patient.Name&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Patient.Address.Municipality&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DateTimeRange.Start&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DateTimeRange.End&amp;#34;&lt;/span&gt; });

&lt;span style=&#34;color:#75715e&#34;&gt;// Initialise two patients
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;Patient patient = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Patient(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tim&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Address(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MyStreet&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1820&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Melsbroek&amp;#34;&lt;/span&gt;));
Patient patient2 = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Patient(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;John&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Address(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;His Street&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3000&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Leuven&amp;#34;&lt;/span&gt;));

&lt;span style=&#34;color:#75715e&#34;&gt;// Add appointsments to the list
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;appointments.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Appointment(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, patient, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTimeRange(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))));
appointments.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Appointment(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, patient2, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTimeRange(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))));
appointments.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Appointment(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, patient, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTimeRange(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))));
appointments.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Appointment(&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, patient, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTimeRange(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))));
appointments.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Appointment(&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, patient2, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTimeRange(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))));
appointments.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Appointment(&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, patient, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTimeRange(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;17&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;2007&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;17&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))));

&lt;span style=&#34;color:#75715e&#34;&gt;// Assign this list to the datagridview datasource
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = appointments;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Pretty cool, don&amp;rsquo;t you think? As always, feel free to download the code: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/TypedList.zip&#34;&gt;TypedList.zip&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt; Today, May 8th 2007, i discovered a but in SubPropertyDescriptor.SetValue and uploaded a newer version of the code.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Exploring DataGridViewComboBoxColumn databinding (part2)</title>
      <link>/post/2007-05-03-exploring-datagridviewcomboboxcolumn-databinding-part2/</link>
      <pubDate>Thu, 03 May 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-05-03-exploring-datagridviewcomboboxcolumn-databinding-part2/</guid>
      <description>
        
          &lt;p&gt;A while ago i wrote about &lt;a href=&#34;http://www.timvw.be/exploring-datagridviewcomboboxcolumn-databinding/&#34;&gt;Exploring DataGridViewComboBoxColumn databinding&lt;/a&gt; using Business Objects. Some people asked me to give an example using DataSets&amp;hellip;&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ll start with creating a DataSet, add two DataTables, and create a relation on PersonType.Id (int32). In the designer this looks like&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-dataset1.gif&#34; alt=&#34;screenshot of dataset designer displaying person and persontype&#34;&gt;&lt;/p&gt;
&lt;p&gt;Next i create a DataSetDac that will return an instance of a Filled PersonDataSet (In real life you would probably use a TableAdapter and get the data from a database) The code is as simple as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; PersonsDataSet Find()
{
	PersonsDataSet personsDataSet = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonsDataSet();

	personsDataSet.PersonType.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A geeky person&amp;#34;&lt;/span&gt; });
	personsDataSet.PersonType.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A coward&amp;#34;&lt;/span&gt; });
	personsDataSet.PersonType.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Feeling hot hot hot&amp;#34;&lt;/span&gt; });
	personsDataSet.PersonType.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(None)&amp;#34;&lt;/span&gt; });

	personsDataSet.Person.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Timvw&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; });
	personsDataSet.Person.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;John Doe&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; });
	personsDataSet.Person.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;An Onymous&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; });
	personsDataSet.Person.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Jenna Jameson&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; });
	personsDataSet.Person.Rows.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Null Able&amp;#34;&lt;/span&gt;, -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; });

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; personsDataSet;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now comes the important stuff: Bind the data to the DataGridView and DataGridViewComboBoxColumn&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
{
	InitializeComponent();

	PersonsDataSet personsDataSet = DataSetDac.Find();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnName.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PersonTypeId&amp;#34;&lt;/span&gt;;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Label&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.ValueMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Id&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DataSource = personsDataSet.PersonType;

	BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingSource();
	bindingSource.DataSource = personsDataSet.Person;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = bindingSource;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Geeks are doomed to stay Geeks forever. When you try change a Person that is a Geek, the values in ComboBox should be limited to Geek and (None). The following code takes care of that&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_EditingControlShowing(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewEditingControlShowingEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.CurrentCell.ColumnIndex == &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.Index)
	{
		BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; BindingSource;
		PersonsDataSet.PersonRow person = (bindingSource.Current &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; DataRowView).Row &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PersonsDataSet.PersonRow;

		&lt;span style=&#34;color:#75715e&#34;&gt;// this method returns the allowed persontypes for the given person
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		PersonsDataSet.PersonTypeDataTable personTypeDataTable = DataSetDac.FindPersonTypes(person);

		DataGridViewComboBoxEditingControl comboBox = e.Control &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; DataGridViewComboBoxEditingControl;
		comboBox.DataSource = personTypeDataTable;

		comboBox.SelectionChangeCommitted -= &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBox_SelectionChangeCommitted;
		comboBox.SelectionChangeCommitted += &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBox_SelectionChangeCommitted;
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; PersonsDataSet.PersonTypeDataTable FindPersonTypes(PersonsDataSet.PersonRow person)
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// by default, all persons simply have one of the available persontypecodes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	PersonsDataSet personsDataSet = Find();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (person.PersonTypeId.Equals(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// geeks are doomed to stay geeks
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		personsDataSet.PersonType.Rows.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
		personsDataSet.PersonType.Rows.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; personsDataSet.PersonType;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; comboBox_SelectionChangeCommitted(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.EndEdit();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As always, feel free to download &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DataGridViewComboBoxBinding2.zip&#34;&gt;DataGridViewComboBoxBinding2.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting the MultiPanel</title>
      <link>/post/2007-04-29-presenting-the-multipanel/</link>
      <pubDate>Sun, 29 Apr 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-04-29-presenting-the-multipanel/</guid>
      <description>
        
          &lt;p&gt;A while ago i was thinking that i would be nice to have a control that exposes multiple designer panels, but only shows one at a time&amp;hellip; Somewhat like a TabControl, but without the header.. Anyway, i found out (&lt;a href=&#34;http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=1518961&amp;amp;SiteID=1&#34;&gt;here&lt;/a&gt;) that a TabControl can be tweaked into that behaviour&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MultiPanel&lt;/span&gt; : TabControl
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; WndProc(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; Message m)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (m.Msg == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;x1328 &amp;amp;&amp;amp; !DesignMode)
		{
			m.Result = (IntPtr) &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;.WndProc(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; m);
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In the designer it appears as following&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/MultiPanel1.gif&#34; alt=&#34;screenshot of MultiPanel at designtime&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/MultiPanel2.gif&#34; alt=&#34;screenshot of MultiPanel at designtime&#34;&gt;&lt;/p&gt;
&lt;p&gt;And at runtime it appears as following&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/MultiPanel3.gif&#34; alt=&#34;screenshot of MultiPanel at designtime&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/MultiPanel4.gif&#34; alt=&#34;screenshot of MultiPanel at designtime&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Performing long running tasks in a Windows Application</title>
      <link>/post/2007-04-27-performing-long-running-tasks-in-a-windows-application/</link>
      <pubDate>Fri, 27 Apr 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-04-27-performing-long-running-tasks-in-a-windows-application/</guid>
      <description>
        
          &lt;p&gt;A while ago i blogged about &lt;a href=&#34;http://www.timvw.be/about-thread-safe-gui/&#34;&gt;Thread Safe UI&lt;/a&gt;. Today someone asked the following&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;The first thing i do is define a delegate (void Performer()) that will do the work of a long running operation. The reason i do this is because the compiler generates a class Performer that inherits from System.MulticastDelegate and exposes Begin- and EndInvoke methods.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/performerdelegate.gif&#34; alt=&#34;screenshot of ildasm displaying generated performer class&#34;&gt;&lt;/p&gt;
&lt;p&gt;Since i want to disable my form before each run of a Performer and enable it after each run i implement a method Perform as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Perform(Performer performer, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; message)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.PrePerform(message);
	performer.BeginInvoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.PostPerform, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now it&amp;rsquo;s simply a matter of implemeting Pre- and PostPerform&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; PrePerform(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; message)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.InvokeRequired)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.EndInvoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.BeginInvoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MethodInvoker(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.PrePerform(message); })));
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Enabled = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.toolStripStatusLabel1.Text = message;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.toolStripStatusLabel1.Visible = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.toolStripProgressBar1.Visible = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; PostPerform(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; state)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.InvokeRequired)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.EndInvoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.BeginInvoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MethodInvoker(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.PostPerform(state); })));
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.toolStripProgressBar1.Visible = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.toolStripStatusLabel1.Visible = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.toolStripStatusLabel1.Text = &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Enabled = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now that we have all the infrastructure i implement an eventhandler for a button click&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; button1_Click(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// remove previously retrieved results
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.UpdateResultLabel(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Perform(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// simulate the effect of a blocking operation that takes a while to complete
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#75715e&#34;&gt;// eg: remoting, webrequests, database queries, ...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		Thread.Sleep(&lt;span style=&#34;color:#ae81ff&#34;&gt;5000&lt;/span&gt;);

		&lt;span style=&#34;color:#75715e&#34;&gt;// display the result of the long running operation
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.UpdateResultLabel(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Value was retrieved...&amp;#34;&lt;/span&gt;);
	}, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Retrieving value...&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here are a couple of screenshots of the running program&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/performerdelegate2.gif&#34; alt=&#34;screenshot of application not doing anything&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/performerdelegate3.gif&#34; alt=&#34;screenshot of application performing long running task&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/performerdelegate4.gif&#34; alt=&#34;screenshot of application after completion of long running task&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/AsyncDemo.zip&#34;&gt;AsyncDemo.zip&lt;/a&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Get the complement of a Color</title>
      <link>/post/2007-04-26-get-the-complement-of-a-color/</link>
      <pubDate>Thu, 26 Apr 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-04-26-get-the-complement-of-a-color/</guid>
      <description>
        
          &lt;p&gt;Here is a simple function that returns the complement of a given Color&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetComplement(Color color)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Color.FromArgb(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;.MaxValue -- color.ToArgb());
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Get hexadecimal RGB value from System.Drawing.Color</title>
      <link>/post/2007-04-17-get-hexadecimal-rgb-value-from-systemdrawingcolor/</link>
      <pubDate>Tue, 17 Apr 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-04-17-get-hexadecimal-rgb-value-from-systemdrawingcolor/</guid>
      <description>
        
          &lt;p&gt;Here&amp;rsquo;s a simple function that returns the &lt;a href=&#34;http://en.wikipedia.org/wiki/Hexadecimal&#34;&gt;hexadecimal&lt;/a&gt; &lt;a href=&#34;http://en.wikipedia.org/wiki/Rgb&#34;&gt;RGB&lt;/a&gt; value of a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.drawing.color.aspx&#34;&gt;System.Drawing.Color&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; ToHexadecimalRgb(Color color)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; color.ToArgb().ToString(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X&amp;#34;&lt;/span&gt;).Substring(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt; Apparently there is also a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.drawing.colortranslator.aspx&#34;&gt;ColorTranslator&lt;/a&gt; with methods &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.drawing.colortranslator.tohtml.aspx&#34;&gt;ToHtml&lt;/a&gt; and &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.drawing.colortranslator.fromhtml.aspx&#34;&gt;FromHtml&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Programming .NET Components</title>
      <link>/post/2007-04-07-programming-net-components/</link>
      <pubDate>Sat, 07 Apr 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-04-07-programming-net-components/</guid>
      <description>
        
          &lt;p&gt;I couple of weeks ago i got a copy of &lt;a href=&#34;http://www.oreilly.com/catalog/pnetcomp2/&#34;&gt;Programming .NET Components&lt;/a&gt;&amp;hellip; I can only suggest to read it yourself because i found it really good 😉 Anyway, in one of the chapters &lt;a href=&#34;http://www.oreillynet.com/pub/au/741&#34;&gt;Juval Lowy&lt;/a&gt; talks about context and interception (&lt;a href=&#34;http://msdn.microsoft.com/msdnmag/issues/03/03/ContextsinNET/default.aspx&#34;&gt;msdnmag article&lt;/a&gt;). I got inspired and implemented my own log4net LoggingSink&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;LoggingSink&lt;/span&gt; : IMessageSink
{
	...

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; IMessage SyncProcessMessage(IMessage msg)
	{
		IMethodMessage methodMessage = msg &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; IMethodMessage;
		ILog log = LogManager.GetLogger(methodMessage.TypeName);
		log.Debug(methodMessage);

		IMessage message = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.nextSink.SyncProcessMessage(msg);

		IMethodReturnMessage methodReturnMessage = message &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; IMethodReturnMessage;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (methodReturnMessage != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			log.Debug(methodReturnMessage);
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; message;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I also implemented my own MethodMessageRenderer and MethodReturnMessageRenderer using an ObjectRenderer that was inspired on the ObjectDumper that comes with the &lt;a href=&#34;http://blogs.msdn.com/charlie/archive/2007/03/01/february-ctp-now-available.aspx&#34;&gt;LINQ CTP samples&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MethodReturnMessageRenderer&lt;/span&gt; : IObjectRenderer
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; MethodReturnMessageRenderer()
	{
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; RenderObject(RendererMap rendererMap, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; obj, TextWriter writer)
	{
		IMethodReturnMessage methodReturnMessage = obj &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; IMethodReturnMessage;
		writer.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Called: {1}{2}Params:&amp;#34;&lt;/span&gt;, Environment.NewLine, methodReturnMessage.MethodName, Environment.NewLine);
		ObjectRenderer.RenderObject(methodReturnMessage.Args, writer);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (methodReturnMessage.MethodName != &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.ctor&amp;#34;&lt;/span&gt;)
		{
			writer.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}ReturnValue:&amp;#34;&lt;/span&gt;, Environment.NewLine);
			ObjectRenderer.RenderObject(methodReturnMessage.ReturnValue, writer);
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (methodReturnMessage.Exception != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			writer.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Exception:&amp;#34;&lt;/span&gt;, Environment.NewLine);
			ObjectRenderer.RenderObject(methodReturnMessage.Exception, writer);
		}
		writer.WriteLine();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Adding an [assembly: XmlConfigurator(Watch = true)] attribute to the AssemblyInfo.cs of projects that use log4Net seems the easiest way to get the configuration right. In your configuration you still have to register the IObjectRenderers&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;renderer&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;renderingClass=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;EndPointTools.MethodReturnMessageRenderer, EndPointTools&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;renderedClass=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System.Runtime.Remoting.Messaging.IMethodReturnMessage, mscorlib&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Have a look at the generated &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/log4net.txt&#34;&gt;log&lt;/a&gt; and feel free to download the complete solution: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ContextBoundSamples.zip&#34;&gt;ContextBoundSamples.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>DataGridView to Excel</title>
      <link>/post/2007-04-05-datagridview-to-excel/</link>
      <pubDate>Thu, 05 Apr 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-04-05-datagridview-to-excel/</guid>
      <description>
        
          &lt;p&gt;The &lt;a href=&#34;http://www.carlosag.net/Tools/ExcelXmlWriter/Default.aspx&#34;&gt;CarlosAg Excel Xml Writer Library&lt;/a&gt; does not require &lt;a href=&#34;http://office.microsoft.com/en-us/excel/default.aspx&#34;&gt;Excel&lt;/a&gt; in order to generate Excel Workbooks. I already presented a method to print a DataGridView (&lt;a href=&#34;http://www.timvw.be/print-a-control/&#34;&gt;here&lt;/a&gt;) and now i present you a method that allows you to export a DataGridView to an Excel Workbook: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DataGridViewToExcel.zip&#34;&gt;DataGridViewToExcel.zip&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridview-to-excel-1.gif&#34; alt=&#34;screenshot of the source datagridview&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridview-to-excel-2.gif&#34; alt=&#34;screenshot of the generated excel workbook&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Little INotifyPropertyChanged helper</title>
      <link>/post/2007-03-19-little-inotifypropertychanged-helper/</link>
      <pubDate>Mon, 19 Mar 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-03-19-little-inotifypropertychanged-helper/</guid>
      <description>
        
          &lt;p&gt;Most implementations of INotifyPropertyChanged look as following (notice that you have to make sure that the hardcoded PropertyName is spelled correctly)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MyClass&lt;/span&gt; : INotifyPropertyChanged
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; PropertyChangedEventHandler PropertyChanged;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; x;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; X
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.x; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.x != &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
			{
				&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.x = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
				&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.OnPropertyChanged(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X&amp;#34;&lt;/span&gt;);
			}
		}
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[MethodImpl(MethodImplOptions.NoInlining)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Fire(Delegate del, &lt;span style=&#34;color:#66d9ef&#34;&gt;params&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] args)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (del != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (Delegate sink &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; del.GetInvocationList())
			{
				&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; { sink.DynamicInvoke(args); }
				&lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; { }
			}
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;virtual&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnPropertyChanged( &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; propertyName )
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Fire( &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.PropertyChanged, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PropertyChangedEventArgs( propertyName ) );
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Everytime you refactor a property you also have to make sure to refactor the string with it&amp;rsquo;s name in the setter method. Here&amp;rsquo;s a helper method that makes life a little easier&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnPropertyChanged()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.OnPropertyChanged(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StackTrace(&lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;).GetFrame(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;).GetMethod().Name.Substring(&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;));
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This makes the implementation of a property as simple as (No more hardcoded strings to maintain)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; X
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.x; }
	&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.x != &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.x = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.OnPropertyChanged();
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting the SortableBindingList&lt;T&gt;</title>
      <link>/post/2007-02-22-presenting-the-sortablebindinglistt/</link>
      <pubDate>Thu, 22 Feb 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-02-22-presenting-the-sortablebindinglistt/</guid>
      <description>
        
          &lt;p&gt;If you are databinding your custom objects (in a Bindinglist of &lt;!-- raw HTML omitted --&gt;) to a DataGridView you will notice that the users can&amp;rsquo;t sort the rows by clicking on the columnheaders&amp;hellip; Unlike an unbound DataGridView, the SortCompare event is not raised. Here is a class that uses IComparer to implement a BindingList that supports Sorting:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Please read the &lt;a href=&#34;http://www.timvw.be/presenting-the-sortablebindinglistt-take-two/&#34;&gt;follow up article&lt;/a&gt; to find the updated source code.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Using this SortableBindingList is as easy as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
{
	InitializeComponent();

	SortableBindingList&amp;lt;person&amp;gt; persons = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SortableBindingList&amp;lt;person&amp;gt;();
	persons.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;timvw&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;1980&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;04&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;)));
	persons.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;John Doe&amp;#34;&lt;/span&gt;, DateTime.Now));

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnId.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Id&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnName.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnBirthday.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Birthday&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = persons;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/sortablebindinglist.gif&#34; alt=&#34;the sortablebindinglist at work&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download the source and demoproject: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/SortableBindingList.zip&#34;&gt;SortableBindingList.zip&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Edit:&lt;/strong&gt; You can find the latest implementation at &lt;a href=&#34;http://www.codeplex.com/BeTimvwFramework&#34;&gt;BeTimvwFramework&lt;/a&gt;, a project where i will keep classes that i find interesting.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Don&#39;t wait until the DateTimePicker has lost focus to write back the values</title>
      <link>/post/2007-02-07-dont-wait-until-the-datetimepicker-has-lost-focus-to-write-back-the-values/</link>
      <pubDate>Wed, 07 Feb 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-02-07-dont-wait-until-the-datetimepicker-has-lost-focus-to-write-back-the-values/</guid>
      <description>
        
          &lt;p&gt;Drag a TextBox and a DateTimePicker control on a Form and databind them to a DateTime property, eg&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
	{
		InitializeComponent();

		SimpleObject simpleObject = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SimpleObject();
		simpleObject.Birthday = DateTime.Now;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTimePicker1.DataBindings.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Value&amp;#34;&lt;/span&gt;, simpleObject, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Birthday&amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.textBox1.DataBindings.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Text&amp;#34;&lt;/span&gt;, simpleObject, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Birthday&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;, DataSourceUpdateMode.OnPropertyChanged);
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SimpleObject&lt;/span&gt; : INotifyPropertyChanged
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; DateTime birthday;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;event&lt;/span&gt; PropertyChangedEventHandler PropertyChanged;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; DateTime Birthday
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.birthday; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt;
		{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.birthday = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.OnPropertyChanged(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Birthday&amp;#34;&lt;/span&gt;);
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; OnPropertyChanged(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; propertyName)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.PropertyChanged != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.PropertyChanged(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PropertyChangedEventArgs(propertyName));
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The annoying bit is that every time the user picks a datetime, he has to move the focus before the changes in the DateTimePicker control are written back to the datasource&amp;hellip; You can circumvent this by handling the CloseUp event of the DataTimePicker as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dateTimePicker1_CloseUp(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	DateTimePicker dateTimePicker = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; DateTimePicker;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (dateTimePicker != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (Binding binding &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; dateTimePicker.DataBindings)
		{
			binding.WriteValue();
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I think mosts users will appreciate this new behaviour 🙂 We can also apply this technique on a ComboBox (using the SelectionChangeCommitted event). Instead of manually hooking up to all these events, i&amp;rsquo;ve implemented an IExtenderProvider that takes care of this tedious task (only showing the part for the datetimepicker)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[ProvideProperty(&amp;#34;WriteValuesAfterCloseUp&amp;#34;, typeof(DateTimePicker))]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;WriteValueAfterEventExtender&lt;/span&gt; : Component, IExtenderProvider
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; Dictionary&amp;lt;dateTimePicker, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;&amp;gt; writeValuesAfterCloseUp;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; WriteValueAfterEventExtender()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.writeValuesAfterCloseUp = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Dictionary&amp;lt;dateTimePicker, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt;&amp;gt;();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; CanExtend(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; extendee)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; extendee &lt;span style=&#34;color:#66d9ef&#34;&gt;is&lt;/span&gt; DateTimePicker;
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[Description(&amp;#34;Gets a boolean indicating if the values are written to the datasource after a CloseUp event.&amp;#34;)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; GetWriteValuesAfterCloseUp(DateTimePicker dateTimePicker)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (!&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.writeValuesAfterCloseUp.TryGetValue(dateTimePicker, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;))
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; SetWriteValuesAfterCloseUp(DateTimePicker dateTimePicker, &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.writeValuesAfterCloseUp.ContainsKey(dateTimePicker))
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.writeValuesAfterCloseUp[dateTimePicker] = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.writeValuesAfterCloseUp.Add(dateTimePicker, &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;);
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
		{
			dateTimePicker.CloseUp += &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTimePicker_CloseUp;
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		{
			dateTimePicker.CloseUp -= &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTimePicker_CloseUp;
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dateTimePicker_CloseUp(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
	{
		DateTimePicker dateTimePicker = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; DateTimePicker;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (dateTimePicker != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (Binding binding &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; dateTimePicker.DataBindings)
			{
				binding.WriteValue();
			}
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As soon as you drop an instance of the WriteValueAfterEditExtender component on your designer form you will see the that an extra property appears on the datetimepicker&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/writevalueaftereventextender.gif&#34; alt=&#34;image of the propertylist for datetimepicker&#34;&gt;&lt;/p&gt;
&lt;p&gt;As always, feel free to download the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ExtenderProvider.zip&#34;&gt;ExtenderProvider.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Control the order of Properties in your Class</title>
      <link>/post/2007-02-04-control-the-order-of-properties-in-your-class/</link>
      <pubDate>Sun, 04 Feb 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-02-04-control-the-order-of-properties-in-your-class/</guid>
      <description>
        
          &lt;p&gt;Sometimes you want to manipulate the order in which properties are used for databinding. Eg: If you drag and drop an object datasource on a DataGridView you have no control in which order it binds the properties. Offcourse, you can order the columns by moving them around&amp;hellip; Today someone asked the following&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;I started with the implementation of a PropertyOrderAttribute&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[AttributeUsage(AttributeTargets.Property)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PropertyOrderAttribute&lt;/span&gt; : Attribute
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; order;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PropertyOrderAttribute(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; order)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.order = order;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Order
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.order; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So the user can use this attribute to define the order in which the properties should appear as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; DateTime birthDay;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Foo(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name, DateTime birthDay)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id = id;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name = name;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.birthDay = birthDay;
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[PropertyOrder(0)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Id
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; id; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { id = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[PropertyOrder(2)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; name; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { name = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;	[PropertyOrder(1)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; DateTime BirthDay
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; birthDay; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { birthDay = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now i implement a generic BindingList that makes use of the PropertyOrderAttributes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PropertyOrderBindingList&lt;/span&gt;&amp;lt;T&amp;gt; : BindingList&amp;lt;T&amp;gt;, ITypedList
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PropertyOrderBindingList()
	: &lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;()
	{ }

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PropertyDescriptorCollection GetItemProperties(PropertyDescriptor[] listAccessors)
	{
		PropertyDescriptorCollection typePropertiesCollection = TypeDescriptor.GetProperties(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(T));
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; typePropertiesCollection.Sort(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PropertyDescriptorComparer());
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; GetListName(PropertyDescriptor[] listAccessors)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A list with Properties for {0}&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(T).Name);
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PropertyDescriptorComparer&lt;/span&gt; : IComparer
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Compare(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; x, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; y)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (x == y) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (x == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (y == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;

		PropertyDescriptor propertyDescriptorX = x &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PropertyDescriptor;
		PropertyDescriptor propertyDescriptorY = y &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PropertyDescriptor;

		PropertyOrderAttribute propertyOrderAttributeX = propertyDescriptorX.Attributes[&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(PropertyOrderAttribute)] &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PropertyOrderAttribute;
		PropertyOrderAttribute propertyOrderAttributeY = propertyDescriptorY.Attributes[&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(PropertyOrderAttribute)] &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PropertyOrderAttribute;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (propertyOrderAttributeX == propertyOrderAttributeY) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (propertyOrderAttributeX == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (propertyOrderAttributeY == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; propertyOrderAttributeX.Order.CompareTo(propertyOrderAttributeY.Order);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;With all this infrastructure it becomes as easy as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
{
	InitializeComponent();

	PropertyOrderBindingList&amp;lt;foo&amp;gt; fooList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PropertyOrderBindingList&amp;lt;foo&amp;gt;();
	fooList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Foo(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Timvw&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;1980&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;)));
	fooList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Foo(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Mike&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;1984&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)));
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = fooList;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Presenting the DataGridViewLargeTextBoxCell</title>
      <link>/post/2007-01-27-presenting-the-datagridviewlargetextboxcell/</link>
      <pubDate>Sat, 27 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-27-presenting-the-datagridviewlargetextboxcell/</guid>
      <description>
        
          &lt;p&gt;Today i decided to experiment a bit with custom &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridviewcell.aspx&#34;&gt;DataGridViewCell&lt;/a&gt; implementations. If you insert large text into a DataGridView it will (at best) wrap the text. I wanted my DataGridView to behave like &lt;a href=&#34;http://office.microsoft.com/excel/&#34;&gt;Excel&lt;/a&gt; so that the whole text is displayed. Here are a couple of screenshots of the result&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridviewlargetextboxcell-1.gif&#34; alt=&#34;the large text flows over it&amp;rsquo;s surrounding columns&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridviewlargetextboxcell-2.gif&#34; alt=&#34;the editingcontrol is resized to fit the complete text&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/CustomDataGridViewCells.zip&#34;&gt;CustomDataGridViewCells.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>About Thread-Safe GUI...</title>
      <link>/post/2007-01-21-about-thread-safe-gui/</link>
      <pubDate>Sun, 21 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-21-about-thread-safe-gui/</guid>
      <description>
        
          &lt;p&gt;If you&amp;rsquo;re writing windows applications you&amp;rsquo;ll most certainly recognize the following piece of code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateIntResultDelegate(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; result);

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateIntResult(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; result)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelIntResult.InvokeRequired)
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelIntResult.Invoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; UpdateIntResultDelegate(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.UpdateIntResult), result);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource.IntResult = result;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateStringResultDelegate(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; result);

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateStringResult(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; result)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelStringResult.InvokeRequired)
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelStringResult.Invoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; UpdateStringResultDelegate(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.UpdateStringResult), result);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource.StringResult = result;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Today i was fed up with defining all these Delegates.. So i decided to define a generic delegate instead&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Delegate&amp;lt;t&amp;gt;(T t);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now i can reuse this Delegate for my two update methods&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateIntResult(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; result)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelIntResult.InvokeRequired)
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelIntResult.Invoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Delegate&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.UpdateIntResult), result);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource.IntResult = result;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateStringResult(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; result)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelStringResult.InvokeRequired)
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelStringResult.Invoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Delegate&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.UpdateStringResult), result);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource.StringResult = result;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Apparently (and not surprisingly) i&amp;rsquo;m not the first to come up with this idea, a little websearch for &amp;lsquo;Generic Delegate&amp;rsquo; learned me that &lt;a href=&#34;http://weblogs.asp.net/rosherove/default.aspx&#34;&gt;Roy Osherove&lt;/a&gt; blogged about it in: &lt;a href=&#34;http://weblogs.asp.net/rosherove/archive/2006/03/01/439309.aspx&#34;&gt;The 3 ways to create a Thread-Safe GUI with .NET 2.0, with one clear winner&lt;/a&gt;. After reading the article i decided to take the following approach (The call to UpdateIntResult is type-safe, it only calls Invoke when it&amp;rsquo;s required and no duplication)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateIntResult(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; result)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelIntResult.InvokeRequired)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.labelIntResult.Invoke(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MethodInvoker(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.UpdateIntResult(result); }));
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource.IntResult = result;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Reading and writing unmanged structs from binary files</title>
      <link>/post/2007-01-20-reading-and-writing-binary-files/</link>
      <pubDate>Sat, 20 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-20-reading-and-writing-binary-files/</guid>
      <description>
        
          &lt;p&gt;I still remember one of the first tasks during my internship (At a software shop that still used Visual Studio 6 as development environment) last year: Develop a GUI application using .Net that allows the user to manipulate data stored in a binary file which was generated by c/c++ program. As a newcomer to C# programming i just couldn&amp;rsquo;t find the right attributes to &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/04fy9ya1.aspx&#34;&gt;Marshal&lt;/a&gt; the following structs&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-cpp&#34; data-lang=&#34;cpp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;test1&lt;/span&gt; {
	&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; name[&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;];
	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; score;
};

&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;test2&lt;/span&gt; {
	test1 items[&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;];
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;After a couple of days they wanted me to deliver a product, so i decided to stop experimenting and wrote the application in C++ (&lt;a href=&#34;http://www.timvw.be/reading-unmanaged-structs-with-net/&#34;&gt;Example&lt;/a&gt;). Since i don&amp;rsquo;t like unanswered questions, i decided to give it another try this afternoon&amp;hellip; It didn&amp;rsquo;t take long to come up with the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi, Pack=4)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Test1&lt;/span&gt;
{
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[MarshalAs(UnmanagedType.ByValTStr, SizeConst=9)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Score;
}
&lt;span style=&#34;color:#a6e22e&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[StructLayout(LayoutKind.Sequential, CharSet=CharSet.Ansi, Pack=4)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Test2&lt;/span&gt;
{
&lt;span style=&#34;color:#a6e22e&#34;&gt;	[MarshalAs(UnmanagedType.ByValArray, SizeConst=10)]&lt;/span&gt;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Test1[] Items;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; Read(Stream stream, Type t)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[] buffer = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[Marshal.SizeOf(t)];
	&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; read = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; read &amp;lt; buffer.Length; read += stream.Read(buffer, read, buffer.Length)) ; 
	GCHandle gcHandle = GCHandle.Alloc(buffer, GCHandleType.Pinned); 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; o = Marshal.PtrToStructure(gcHandle.AddrOfPinnedObject(), t); 
	gcHandle.Free(); &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; o; 
} 
	
&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Write(Stream stream, &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; o) 
{ 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[] buffer = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[Marshal.SizeOf(o.GetType())]; 
	GCHandle gcHandle = GCHandle.Alloc(buffer, GCHandleType.Pinned); 
	Marshal.StructureToPtr(o, gcHandle.AddrOfPinnedObject(), &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;); 
	stream.Write(buffer, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, buffer.Length); 
	gcHandle.Free(); 
} 

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args) 
{ 
	Test1 test1 = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Test1(); 
	test1.Name = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;timvw&amp;#34;&lt;/span&gt;; 
	test1.Score = &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;; 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (FileStream fileStream = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FileStream(&lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;c:\test.dat&amp;#34;&lt;/span&gt;, FileMode.OpenOrCreate)) 
	{ 
		Write(fileStream, test1); 
		fileStream.Seek(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, SeekOrigin.Begin); 
		Test1 test2 = (Test1) 
		Read(fileStream, &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(Test1)); 
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name: {0} Score: {1}&amp;#34;&lt;/span&gt;, test2.Name, test2.Score); 
	} 
	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine); 
	Console.ReadKey(); 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Exploring DataGridViewComboBoxColumn databinding</title>
      <link>/post/2007-01-17-exploring-datagridviewcomboboxcolumn-databinding/</link>
      <pubDate>Wed, 17 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-17-exploring-datagridviewcomboboxcolumn-databinding/</guid>
      <description>
        
          &lt;p&gt;Let&amp;rsquo;s start with a simple example: Each Person has a Name (string) and PersonTypeCode (an Enumerated value) property. We drag a DataGridView on the designer form and add two columns (DataGridViewComboBoxColumn for the PersonTypeCode property). And then we hook up the Bindingsource as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
	{
		InitializeComponent();

		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnName.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PersonTypeCode&amp;#34;&lt;/span&gt;;

		BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingSource();
		bindingSource.DataSource = FindPersons();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = bindingSource;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;person&amp;gt; FindPersons()
	{
		BindingList&amp;lt;person&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingList&amp;lt;person&amp;gt;();
		bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Timvw&amp;#34;&lt;/span&gt;, PersonTypeCode.Geek));
		bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;John Doe&amp;#34;&lt;/span&gt;, PersonTypeCode.Anonymous));
		bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;An Onymous&amp;#34;&lt;/span&gt;, PersonTypeCode.Anonymous));
		bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Jenna Jameson&amp;#34;&lt;/span&gt;, PersonTypeCode.Babe));
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;enum&lt;/span&gt; PersonTypeCode
{
	Geek = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,
	Anonymous = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
	Babe = &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Person&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; PersonTypeCode personTypeCode;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name, PersonTypeCode personTypeCode)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name = name;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.personTypeCode = personTypeCode;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PersonTypeCode PersonTypeCode
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.personTypeCode; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.personTypeCode = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If we run this code we run in the following error:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-1.gif&#34; alt=&#34;DataGridViewComboBoxCell value is not valid.&#34;&gt;&lt;/p&gt;
&lt;p&gt;Always make sure the DataGridViewComboxColumn knows about all the possible values (&lt;a href=&#34;http://www.timvw.be/implementing-masterdetail-for-custom-objects-with-datagridviewcomboboxcolumns/&#34;&gt;Add them via the Items property&lt;/a&gt; or use databinding). Let&amp;rsquo;s extend our Form1 class as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
{
InitializeComponent();

&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnName.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PersonTypeCode&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DataSource = FindPersonTypeCodes();

BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingSource();
bindingSource.DataSource = FindPersons();
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = bindingSource;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;personTypeCode&amp;gt; FindPersonTypeCodes()
{
BindingList&amp;lt;personTypeCode&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingList&amp;lt;personTypeCode&amp;gt;();
&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (PersonTypeCode personTypeCode &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; Enum.GetValues(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(PersonTypeCode)))
{
bindingList.Add(personTypeCode);
}
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Allright, here is a screenshot of our first working version:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-2.gif&#34; alt=&#34;datagridviewcomboboxcolumn with enumerated values&#34;&gt;&lt;/p&gt;
&lt;p&gt;Instead of displaying the bare enum values we want to display a nice label. In order to achieve this we define a class PersonType to hold both the PersonTypeCode and the label:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PersonType&lt;/span&gt;
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; PersonTypeCode personTypeCode;
&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; label;

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PersonType(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; label, PersonTypeCode personTypeCode)
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.label = label;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.personTypeCode = personTypeCode;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Label
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.label; }
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.label = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PersonTypeCode PersonTypeCode
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.personTypeCode; }
&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.personTypeCode = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;We modify our code so that this new PersonType class is used for the ComboBoxColumn:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
{
InitializeComponent();

&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnName.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PersonTypeCode&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Label&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.ValueMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;PersonTypeCode&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.DataSource = FindPersonTypes();

BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingSource();
bindingSource.DataSource = FindPersons();
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = bindingSource;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;personType&amp;gt; FindPersonTypes()
{
BindingList&amp;lt;personType&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingList&amp;lt;personType&amp;gt;();
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonType(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A geeky person&amp;#34;&lt;/span&gt;, PersonTypeCode.Geek));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonType(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A coward&amp;#34;&lt;/span&gt;, PersonTypeCode.Anonymous));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonType(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Feeling hot hot hot&amp;#34;&lt;/span&gt;, PersonTypeCode.Babe));
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-3.gif&#34; alt=&#34;datagridviewcomboboxcolumn with nice labels.&#34;&gt;&lt;/p&gt;
&lt;p&gt;Great! Now we&amp;rsquo;ll add some functionality that limits the possible values in the ComboBoxColumn basesd on the Name (I already demonstrated this technique &lt;a href=&#34;http://www.timvw.be/implementing-masterdetail-for-custom-objects-with-datagridviewcomboboxcolumns/&#34;&gt;here&lt;/a&gt;). Simply handle the EditingControlShowing Event on the DataGridView as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_EditingControlShowing(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewEditingControlShowingEventArgs e)
{
BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; BindingSource;
Person person = bindingSource.Current &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Person;
BindingList&amp;lt;personType&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.FindPersonTypes(person);

DataGridViewComboBoxEditingControl comboBox = e.Control &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; DataGridViewComboBoxEditingControl;
comboBox.DataSource = bindingList;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;personType&amp;gt; FindPersonTypes(Person person)
{
&lt;span style=&#34;color:#75715e&#34;&gt;// by default, all persons simply have one of the available persontypecodes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;BindingList&amp;lt;personType&amp;gt; bindingList = FindPersonTypes();

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (person.PersonTypeCode == PersonTypeCode.Geek)
{
&lt;span style=&#34;color:#75715e&#34;&gt;// geeks are doomed to stay geeks
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;bindingList.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
bindingList.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;If you open the combox for &amp;ldquo;Timvw&amp;rdquo; you see that you can only choose &amp;ldquo;A geeky person&amp;rdquo;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-4.gif&#34; alt=&#34;datagridviewcomboboxcolumn with limited options.&#34;&gt;&lt;/p&gt;
&lt;p&gt;Instead of using an enum we could have used a regular class too. The key is to override the Equals method:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;PersonTypeCode&lt;/span&gt;
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; PersonTypeCode Geek
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonTypeCode(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;); }
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; PersonTypeCode Anonymous
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonTypeCode(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;); }
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; PersonTypeCode Babe
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonTypeCode(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;); }
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id;

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; PersonTypeCode(&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id)
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id = id;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; Equals(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; obj)
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (obj == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (obj == &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
PersonTypeCode personTypeCode = obj &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; PersonTypeCode;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (personTypeCode == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id == personTypeCode.id;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; GetHashCode()
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id.GetHashCode();
}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;personType&amp;gt; FindPersonTypes(Person person)
{
&lt;span style=&#34;color:#75715e&#34;&gt;// by default, all persons simply have one of the available persontypecodes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;BindingList&amp;lt;personType&amp;gt; bindingList = FindPersonTypes();

&lt;span style=&#34;color:#75715e&#34;&gt;//if (person.PersonTypeCode == PersonTypeCode.Geek)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (person.PersonTypeCode.Equals(PersonTypeCode.Geek))
{
&lt;span style=&#34;color:#75715e&#34;&gt;// geeks are doomed to stay geeks
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;bindingList.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
bindingList.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now you&amp;rsquo;re thinking: But i want the user to not select a PersonTypeCode (null). We&amp;rsquo;ll represent that with an empty string &amp;ldquo;&amp;quot;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;person&amp;gt; FindPersons()
{
BindingList&amp;lt;person&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingList&amp;lt;person&amp;gt;();
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Timvw&amp;#34;&lt;/span&gt;, PersonTypeCode.Geek));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;John Doe&amp;#34;&lt;/span&gt;, PersonTypeCode.Anonymous));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;An Onymous&amp;#34;&lt;/span&gt;, PersonTypeCode.Anonymous));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Jenna Jameson&amp;#34;&lt;/span&gt;, PersonTypeCode.Babe));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Null Able&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;));
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;personType&amp;gt; FindPersonTypes()
{
BindingList&amp;lt;personType&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingList&amp;lt;personType&amp;gt;();
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonType(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A geeky person&amp;#34;&lt;/span&gt;, PersonTypeCode.Geek));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonType(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A coward&amp;#34;&lt;/span&gt;, PersonTypeCode.Anonymous));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonType(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Feeling hot hot hot&amp;#34;&lt;/span&gt;, PersonTypeCode.Babe));
bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PersonType(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;));
&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; BindingList&amp;lt;personType&amp;gt; FindPersonTypes(Person person)
{
&lt;span style=&#34;color:#75715e&#34;&gt;// by default, all persons simply have one of the available persontypecodes
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;BindingList&amp;lt;personType&amp;gt; bindingList = FindPersonTypes();

&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (person.PersonTypeCode != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; person.PersonTypeCode.Equals(PersonTypeCode.Geek))
{
&lt;span style=&#34;color:#75715e&#34;&gt;// geeks are doomed to stay geeks
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;bindingList.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;);
bindingList.RemoveAt(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; bindingList;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-5.gif&#34; alt=&#34;datagridviewcomboboxcolumn with null option.&#34;&gt;&lt;/p&gt;
&lt;p&gt;When the user starts editing the record, the combobox will choose the first item in the list (A geeky person). Now we change this behaviour so that the actual PersonTypeCode is selected:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_EditingControlShowing(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewEditingControlShowingEventArgs e)
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.CurrentCell.ColumnIndex == &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.Index)
{
BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; BindingSource;
Person person = bindingSource.Current &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Person;
BindingList&amp;lt;personType&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.FindPersonTypes(person);

DataGridViewComboBoxEditingControl comboBox = e.Control &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; DataGridViewComboBoxEditingControl;
comboBox.DataSource = bindingList;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (person.PersonTypeCode != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
{
comboBox.SelectedValue = person.PersonTypeCode;
}
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
{
comboBox.SelectedValue = &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty;
}
}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-datagridviewcomboboxcolumn-6.gif&#34; alt=&#34;datagridviewcomboboxcolumn with selected item.&#34;&gt;&lt;/p&gt;
&lt;p&gt;In order to make the DataGridView more usable we set the EditMode property to EditOnEnter. Selected values in the ComboBox are only commited when the user leaves the current cell. Handling the SelectionChangeCommited event on the ComboBox allows us to commit that value without requiring the user to leave the current cell:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_EditingControlShowing(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewEditingControlShowingEventArgs e)
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.CurrentCell.ColumnIndex == &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnPersonTypeCode.Index)
{
BindingSource bindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; BindingSource;
Person person = bindingSource.Current &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Person;
BindingList&amp;lt;personType&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.FindPersonTypes(person);

DataGridViewComboBoxEditingControl comboBox = e.Control &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; DataGridViewComboBoxEditingControl;
comboBox.DataSource = bindingList;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (person.PersonTypeCode != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
{
comboBox.SelectedValue = person.PersonTypeCode;
}
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
{
comboBox.SelectedValue = &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;.Empty;
}

comboBox.SelectionChangeCommitted -= &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBox_SelectionChangeCommitted;
comboBox.SelectionChangeCommitted += &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBox_SelectionChangeCommitted;
}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; comboBox_SelectionChangeCommitted(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.EndEdit();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now it&amp;rsquo;s up to you to apply these simple techniques and build great software. Feel free to download the complete source: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DataGridViewComboBoxBinding.zip&#34;&gt;DataGridViewComboBoxBinding.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Making WebRequests in parallel...</title>
      <link>/post/2007-01-14-asynchronous-webrequests/</link>
      <pubDate>Sun, 14 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-14-asynchronous-webrequests/</guid>
      <description>
        
          &lt;p&gt;Under the assumption that making sequential WebRequests is slower than making them in parallel i wrote a little program that returns the HTTP status code for each URI in a list. Because the number of WaitHandles on a system is limited to 64 and i would have been required to hack around this limitation i decided to use ThreadPool instead&amp;hellip;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System;
&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System.Collections.Generic;
&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System.Text;
&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System.Threading;
&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System.Net;

&lt;span style=&#34;color:#66d9ef&#34;&gt;namespace&lt;/span&gt; ManyRequests
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Program&lt;/span&gt;
	{
	
		&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
		{
			List&amp;lt;uri&amp;gt; uris = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;uri&amp;gt;();
			uris.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.timvw.be&amp;#34;&lt;/span&gt;));
			uris.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://example.com/does\_not\_exist&amp;#34;&lt;/span&gt;));
			uris.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.timvw.be/c-sharp&amp;#34;&lt;/span&gt;));
			uris.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.timvw.be/rss-feed/&amp;#34;&lt;/span&gt;));
			uris.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Uri(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://localhost&amp;#34;&lt;/span&gt;));

		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Getting the HttpStatusCodes...&amp;#34;&lt;/span&gt;);
		HttpStatusCodeReader httpStatusCodeReader = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; HttpStatusCodeReader(uris);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] httpStatusCodes = httpStatusCodeReader.GetHttpStatusCodes();

		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; uris.Count; ++i) 
		{ 
			Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0} {1}&amp;#34;&lt;/span&gt;, httpStatusCodes[i], uris[i]); }
			Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continueâ€¦&amp;#34;&lt;/span&gt;, Environment.NewLine); 
			Console.ReadKey(); 
		} 
	} 
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;HttpStatusCodeReader&lt;/span&gt; 
	{ 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; List&amp;lt;uri&amp;gt; uris;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] httpStatusCodes;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; syncLock;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; completed;

		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; HttpStatusCodeReader(List&amp;lt;uri&amp;gt; uris)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (uris == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
			{
				&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentNullException(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;uris&amp;#34;&lt;/span&gt;);
			}

			&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (Uri uri &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; uris)
			{
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (uri.Scheme != Uri.UriSchemeHttp &amp;amp;&amp;amp; uri.Scheme != Uri.UriSchemeHttps)
				{
					&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentException(uri.ToString() + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; is not valid http(s) uri.&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;uris&amp;#34;&lt;/span&gt;);
				}
			}

			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.uris = uris;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.httpStatusCodes = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[uris.Count];
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.syncLock = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;();
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.completed = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] GetHttpStatusCodes()
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.httpStatusCodes.Length; ++i) 
			{ 
				HttpWebRequest httpWebRequest = WebRequest.Create(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.uris[i]) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; HttpWebRequest; 
				httpWebRequest.Method = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;HEAD&amp;#34;&lt;/span&gt;; 
				httpWebRequest.AllowAutoRedirect = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;; 
				httpWebRequest.BeginGetResponse(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.GetResponseCompleted, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { httpWebRequest, i });
			} 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;lock&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.syncLock) 
			{ 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.completed &amp;lt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.httpStatusCodes.Length) 
				{ 
					Monitor.Wait(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.syncLock); 
				} 
			} 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.httpStatusCodes; 
		} 
		
		&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; GetResponseCompleted(IAsyncResult ar) 
		{ 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] objects = ar.AsyncState &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[];
			HttpWebRequest httpWebRequest = objects[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;] &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; HttpWebRequest; 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; index = (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)objects[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]; 
			HttpWebResponse httpWebResponse = &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;; 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt; 
			{
				httpWebResponse = httpWebRequest.EndGetResponse(ar) &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; HttpWebResponse; 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.httpStatusCodes[index] = (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)httpWebResponse.StatusCode; 
			} 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (WebException webException) 
			{ 
				httpWebResponse = webException.Response &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; HttpWebResponse; 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (httpWebResponse != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) 
				{ 
					&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.httpStatusCodes[index] = (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)httpWebResponse.StatusCode; 
				} 
			} 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;finally&lt;/span&gt; 
			{ 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (httpWebResponse != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) 
				{ 
					httpWebResponse.Close(); 
				} 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;lock&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.syncLock) 
				{ 
					Interlocked.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.completed, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;); 
					Monitor.Pulse(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.syncLock); 
				} 
			}
		} 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Hide and unhide columns (or rows) in the DataGridView</title>
      <link>/post/2007-01-13-hide-and-unhide-columns-or-rows-in-the-datagridview/</link>
      <pubDate>Sat, 13 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-13-hide-and-unhide-columns-or-rows-in-the-datagridview/</guid>
      <description>
        
          &lt;p&gt;Once in a while i see the following question&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;Using the Visibile property of the DataGridViewColumn makes this a no-brainer. Let&amp;rsquo;s take the &lt;a href=&#34;http://www.timvw.be/developing-a-datasource-for-your-datagridview/&#34;&gt;Databound DataGridView&lt;/a&gt; and implement functionality to hide/unhide the quarterly results. All you have to do is add a DataGridViewButtonColumn and handle the DataGridView CellClick event as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_CellClick(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewCellEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (e.ColumnIndex == &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnButton.Index)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; visible = !&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ1.Visible;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ1.Visible = visible;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ2.Visible = visible;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ3.Visible = visible;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ4.Visible = visible;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnButton.HeaderText = visible ? &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-&amp;#34;&lt;/span&gt; : &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;+&amp;#34;&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This is how it looks like&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridview-hide.gif&#34; alt=&#34;screenshot of datagridview hiding columns&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridview-unhide.gif&#34; alt=&#34;screenshot of datagridview unhiding columns&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download the updated source code for &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DataGridViewDataSource.zip&#34;&gt;DataGridViewDataSource.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Presenting a Generic RemotingHelper</title>
      <link>/post/2007-01-12-presenting-a-generic-remotinghelper/</link>
      <pubDate>Fri, 12 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-12-presenting-a-generic-remotinghelper/</guid>
      <description>
        
          &lt;p&gt;Last couple of months i&amp;rsquo;ve been experimenting with &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/kwdt6w2k.aspx&#34;&gt;Remoting&lt;/a&gt;. Here is a class that helps a client to acquire proxies to an endpoint served by the requested well-known object&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;RemotingHelper&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; RemotingHelper()
	{
		RemotingConfiguration.Configure(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile, &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; GetService(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; fullName)
	{
		WellKnownClientTypeEntry[] wellKnownClientTypeEntries = RemotingConfiguration.GetRegisteredWellKnownClientTypes();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (WellKnownClientTypeEntry welknownClientTypeEntry &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; wellKnownClientTypeEntries)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (welknownClientTypeEntry.ObjectType.FullName == fullName)
			{
				&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Activator.GetObject(welknownClientTypeEntry.ObjectType, welknownClientTypeEntry.ObjectUrl);
			}
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentException(fullName + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; is not a wellKnownClientType.&amp;#34;&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; T GetService&amp;lt;t&amp;gt;()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (T) RemotingHelper.GetService(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(T).FullName);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Getting a proxy is as easy as (Presuming that you&amp;rsquo;ve configured the system.runtime.remoting in your App.config)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;IContract contract = RemotingHelper.GetService&amp;lt;icontract&amp;gt;();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Databinding a Nullable&lt;T&gt; property</title>
      <link>/post/2007-01-10-databinding-a-nullable-t-property/</link>
      <pubDate>Wed, 10 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-10-databinding-a-nullable-t-property/</guid>
      <description>
        
          &lt;p&gt;I find it frustrating that data binding does not really support Nullable&lt;!-- raw HTML omitted --&gt;. Anyway, it&amp;rsquo;s relatively easy to workaround this shortcoming&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; MyDataSource myDataSource;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
	{
		InitializeComponent();

		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MyDataSource();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.textBox1.DataBindings.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Text&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Double&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.textBox1.DataBindings[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Text&amp;#34;&lt;/span&gt;].Parse += &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Text_Parse;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Text_Parse( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, ConvertEventArgs e )
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;( e.Value == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; || e.Value.ToString().Length == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; )
		{
			e.Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;;
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; buttonTellMe_Click(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource.Double.HasValue)
		{
			MessageBox.Show(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The double is: &amp;#34;&lt;/span&gt; + &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myDataSource.Double);
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
		{
			MessageBox.Show(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;The double is null&amp;#34;&lt;/span&gt;);
		}
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MyDataSource&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;double?&lt;/span&gt; _double;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;double?&lt;/span&gt; Double
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;._double; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;._double = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-nullabletext1.gif&#34; alt=&#34;screenshot of double value in textbox&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/databind-nullabletext2.gif&#34; alt=&#34;screenshot of null value in textbox&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Generating UTF-8 with System.Xml.XmlWriter</title>
      <link>/post/2007-01-08-generating-utf-8-with-systemxmlxmlwriter/</link>
      <pubDate>Mon, 08 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-08-generating-utf-8-with-systemxmlxmlwriter/</guid>
      <description>
        
          &lt;p&gt;Today i decided to experiment with &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.xml.xmlwriter.aspx&#34;&gt;XmlWriter&lt;/a&gt;. The first i wanted to do was set the Encoding to UTF-8.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;StringBuilder stringBuilder = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StringBuilder();
XmlWriter xmlWriter = XmlWriter.Create(stringBuilder);
xmlWriter.Settings.Encoding = Encoding.UTF8;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;When i ran this code i recieved the following exception: XmlException was unhandled: The &amp;lsquo;XmlWriterSettings.Encoding&amp;rsquo; property is read only and cannot be set. The documentation for the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.xml.xmlwriter.settings.aspx&#34;&gt;Settings&lt;/a&gt; property clearly says&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;So i wrote the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;StringBuilder stringBuilder = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StringBuilder();
XmlWriterSettings xmlWriterSettings = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; XmlWriterSettings();
xmlWriterSettings.Encoding = Encoding.UTF8;

XmlWriter xmlWriter = XmlWriter.Create(stringBuilder, xmlWriterSettings);
xmlWriter.WriteStartDocument();
xmlWriter.WriteStartElement(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;root&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.timvw.be/ns&amp;#34;&lt;/span&gt;);
xmlWriter.WriteEndElement();
xmlWriter.WriteEndDocument();
xmlWriter.Flush();
xmlWriter.Close();

&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; xmlString = stringBuilder.ToString();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As you can see: &lt;strong&gt;&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;/strong&gt; is still not what i want. Apparently is the Encoding property ignored if the XmlWriter is not using a Stream. So here is my next attempt&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;MemoryStream memoryStream = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MemoryStream();
&lt;span style=&#34;color:#75715e&#34;&gt;// initialize xmlWriterSettings as above...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
XmlWriter xmlWriter = XmlWriter.Create(memoryStream, xmlWriterSettings);
&lt;span style=&#34;color:#75715e&#34;&gt;// call the same operations on the xmlWriter as above...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; xmlString = Encoding.UTF8.GetString(memoryStream.ToArray());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Ok, i&amp;rsquo;m getting close: &lt;strong&gt;?&lt;!-- raw HTML omitted --&gt;&lt;!-- raw HTML omitted --&gt;&lt;/strong&gt;. Luckily enough i knew that the ? (byte with value 239) at the beginning is the &lt;a href=&#34;http://en.wikipedia.org/wiki/Byte_Order_Mark&#34;&gt;BOM&lt;/a&gt;. In order to get rid of that byte i had to create my own instance of &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.text.utf8encoding.aspx&#34;&gt;UTF8Encoding&lt;/a&gt;. Finally, i can present some working code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;MemoryStream memoryStream = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MemoryStream();
XmlWriterSettings xmlWriterSettings = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; XmlWriterSettings();
xmlWriterSettings.Encoding = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; UTF8Encoding(&lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;);
xmlWriterSettings.ConformanceLevel = ConformanceLevel.Document;
xmlWriterSettings.Indent = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;

XmlWriter xmlWriter = XmlWriter.Create(memoryStream, xmlWriterSettings);
xmlWriter.WriteStartDocument();
xmlWriter.WriteStartElement(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;root&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://www.timvw.be/ns&amp;#34;&lt;/span&gt;);
xmlWriter.WriteEndElement();
xmlWriter.WriteEndDocument();
xmlWriter.Flush();
xmlWriter.Close();

&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; xmlString = Encoding.UTF8.GetString(memoryStream.ToArray());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>The NullableDateAndTimePicker Control</title>
      <link>/post/2007-01-07-the-nullabledateandtimepicker-control/</link>
      <pubDate>Sun, 07 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-07-the-nullabledateandtimepicker-control/</guid>
      <description>
        
          &lt;p&gt;A while ago i presented the concept of a &lt;a href=&#34;http://www.timvw.be/a-dateandtimepicker-control/&#34;&gt;DateAndTimePicker&lt;/a&gt;. Today someone asked if it&amp;rsquo;s possible to give the user an option to &amp;lsquo;not choose a DateTime&amp;rsquo;. I created a UserControl that has both a DateAndTimePicker and a CheckBox with a Value property of Nullable&lt;!-- raw HTML omitted --&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/dateandtimepicker-nullable-1.gif&#34; alt=&#34;screenshot of the nullable dateandtimepicker&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/dateandtimepicker-nullable-2.gif&#34; alt=&#34;screenshot of the nullable dateandtimepicker&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download the updated &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DateAndTimePicker.zip&#34;&gt;DateAndTimePicker.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Enable and disable TabPages on a TabControl</title>
      <link>/post/2007-01-06-enable-and-disable-tabpages-on-a-tabcontrol/</link>
      <pubDate>Sat, 06 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-06-enable-and-disable-tabpages-on-a-tabcontrol/</guid>
      <description>
        
          &lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/disabled-tabcontrol-1.gif&#34; alt=&#34;screenshot of tabcontrol with disabled tabpages&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/disabled-tabcontrol-2.gif&#34; alt=&#34;screenshot of tabcontrol with disabled tabpages&#34;&gt;&lt;/p&gt;
&lt;p&gt;Apparently &lt;a href=&#34;http://www.microsoft.com&#34;&gt;Microsoft&lt;/a&gt; choose not to implement support for disabled &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabpage.aspx&#34;&gt;TabPage&lt;/a&gt;s. The reason seems to be that it&amp;rsquo;s against their &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/aa511493.aspx&#34;&gt;Guidelines for Tabs&lt;/a&gt;. Let&amp;rsquo;s ignore the guideline and implement the support anyway. First we set the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.drawmode.aspx&#34;&gt;DrawMode&lt;/a&gt; property of the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.aspx&#34;&gt;TabControl&lt;/a&gt; to &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabdrawmode.aspx&#34;&gt;OwnerDrawFixed&lt;/a&gt;. Next we add an eventhandler for the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.drawitem.aspx&#34;&gt;DrawItem&lt;/a&gt; Event&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; tabControl1_DrawItem(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DrawItemEventArgs e)
{
	TabControl tabControl = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; TabControl;
	TabPage tabPage = tabControl.TabPages[e.Index];
	Rectangle tabRectangle = tabControl.GetTabRect(e.Index);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (tabControl.Alignment == TabAlignment.Left || tabControl.Alignment == TabAlignment.Right)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;float&lt;/span&gt; rotateAngle = &lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (tabControl.Alignment == TabAlignment.Left)
		{
			rotateAngle = &lt;span style=&#34;color:#ae81ff&#34;&gt;270&lt;/span&gt;;
		}

		PointF cp = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; PointF(tabRectangle.Left + (tabRectangle.Width / &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), tabRectangle.Top + (tabRectangle.Height / &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;));
		e.Graphics.TranslateTransform(cp.X, cp.Y);
		e.Graphics.RotateTransform(rotateAngle);
		tabRectangle = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Rectangle(-(tabRectangle.Height / &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), -(tabRectangle.Width / &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;), tabRectangle.Height, tabRectangle.Width);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (SolidBrush foreBrush = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SolidBrush(tabPage.ForeColor))
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (SolidBrush backBrush = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SolidBrush(tabPage.BackColor))
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (!tabPage.Enabled)
			{
				foreBrush.Color = SystemColors.GrayText;
			}

			e.Graphics.FillRectangle(backBrush, tabRectangle);

			&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (StringFormat stringFormat = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StringFormat())
			{
				stringFormat.Alignment = StringAlignment.Center;
				stringFormat.LineAlignment = StringAlignment.Center;
				e.Graphics.DrawString(tabPage.Text, e.Font, foreBrush, tabRectangle, stringFormat);
			}
		}
	}

	e.Graphics.ResetTransform();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And we handle the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.tabcontrol.selecting.aspx&#34;&gt;Selecting&lt;/a&gt; Event as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; tabControl1_Selecting(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, TabControlCancelEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (!e.TabPage.Enabled)
	{
		e.Cancel = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This works pretty fine, but we still have to make sure that the TabPages are Invalidated when the users changes their &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.enabled.aspx&#34;&gt;Enabled&lt;/a&gt; property. We do this by attaching and detaching an eventhandler for their &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.enabledchanged.aspx&#34;&gt;EnabledChanged&lt;/a&gt; Event when they&amp;rsquo;re &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.controladded.aspx&#34;&gt;added&lt;/a&gt; and &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.controlremoved.aspx&#34;&gt;removed&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; tabControl1_ControlAdded(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, ControlEventArgs e)
{
	TabPage tabPage = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; TabPage;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (tabPage != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
	{
		tabPage.EnabledChanged += &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EventHandler(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.tabPage_EnabledChanged);
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; tabControl1_ControlRemoved(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, ControlEventArgs e)
{
	TabPage tabPage = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; TabPage;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (tabPage != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
	{
		tabPage.EnabledChanged -= &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EventHandler(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.tabPage_EnabledChanged);
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; tabPage_EnabledChanged(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	TabPage tabPage = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; TabPage;
	TabControl tabControl = tabPage.Parent &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; TabControl;
	tabControl.Invalidate(tabPage.ClientRectangle);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Feel free to download the demo application: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DisabledTabControl.zip&#34;&gt;DisabledTabControl.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Developing a DataSource for your DataGridView</title>
      <link>/post/2007-01-04-developing-a-datasource-for-your-datagridview/</link>
      <pubDate>Thu, 04 Jan 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-01-04-developing-a-datasource-for-your-datagridview/</guid>
      <description>
        
          &lt;p&gt;Imagine that you want to develop a DataSource that is capable to represent the data displayed in the following excel sheet&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/dgv-ds-1.gif&#34; alt=&#34;screenshot of excel sheet&#34;&gt;&lt;/p&gt;
&lt;p&gt;For each region the values are given. The YEAR value is defined as the sum of Q1, Q2, Q3 and Q4, eg: for EMEA this is SUM(B2:E2). The GLOBAL values are calculated as the sum of the regions for the quarter, eg: for Q1 this is SUM(B2:B5). We&amp;rsquo;ll start with the easiest task: Add columns to the DGV and define the headers&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/dgv-ds-2.gif&#34; alt=&#34;screenshot of first datagridview&#34;&gt;&lt;/p&gt;
&lt;p&gt;If we look at the DGV it becomes clear that each row exists out of a Label, values for Q1 to Q4 and the sum of those values. If we translate this to code we end up with something like: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/SalesRow.txt&#34;&gt;SalesRow&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve implemented &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx&#34;&gt;INotifyPropertyChanged&lt;/a&gt; because i want the DGV to request and display the updated Year value when one of the quarterly values changes. Configure the Columns to use these properties as DataPropertyName and add a couple of SalesRow instances to a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/ms132679.aspx&#34;&gt;BindingList&lt;/a&gt; that we use as DataSource for the DGV.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
{
	InitializeComponent();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnRegion.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Label&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ1.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q1&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ2.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q2&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ3.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q3&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ4.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q4&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnYear.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Year&amp;#34;&lt;/span&gt;;

	BindingList&amp;lt;salesRow&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingList&amp;lt;salesRow&amp;gt;();
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;EMEA&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; }));
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;LATAM&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt; }));
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;APAC&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; }));
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NORAM&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt; }));
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = bindingList;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Notice that the Year value is nicely updated when the user changes one of the quarterly values&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/dgv-ds-3.gif&#34; alt=&#34;screenshot of datagridview with rows for regions.&#34;&gt;&lt;/p&gt;
&lt;p&gt;In order to calculate the GLOBAL values we inherit from the SalesRow class and override the implementation for the Q1, Q2, Q3, Q4 and Year properties: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/GlobalSalesRow.txt&#34;&gt;GlobalSalesRow&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Finally we can wrap everyting in a &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/SalesRows.txt&#34;&gt;SalesRows&lt;/a&gt; class to represent our Data. Hooking this code up is as easy as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
{
	InitializeComponent();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.AutoGenerateColumns = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnRegion.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Label&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ1.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q1&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ2.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q2&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ3.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q3&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnQ4.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Q4&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.ColumnYear.DataPropertyName = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Year&amp;#34;&lt;/span&gt;;

	BindingList&amp;lt;salesRow&amp;gt; bindingList = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingList&amp;lt;salesRow&amp;gt;();
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;EMEA&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; }));
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;LATAM&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt; }));
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;APAC&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt; }));
	bindingList.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRow(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;NORAM&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt; }));

	SalesRows salesRows = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SalesRows(bindingList);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Rows&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DataSource = salesRows;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is a screenshot of the result&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/dgv-ds-4.gif&#34; alt=&#34;screenshot of the complete implementation at work&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download the complete project: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DataGridViewDataSource.zip&#34;&gt;DataGridViewDataSource.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Print a Control</title>
      <link>/post/2006-12-31-print-a-control/</link>
      <pubDate>Sun, 31 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-31-print-a-control/</guid>
      <description>
        
          &lt;p&gt;A while ago i discovered the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.drawtobitmap.aspx&#34;&gt;DrawToBitmap&lt;/a&gt; method on the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.aspx&#34;&gt;Control&lt;/a&gt; class. The availability of this method makes it relatively easy to implement a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.drawing.printing.printpageeventhandler.aspx&#34;&gt;PrintPageEventHandler&lt;/a&gt; for the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.drawing.printing.printdocument.aspx&#34;&gt;PrintDocument&lt;/a&gt; class. Here is an example implementation that prints a DataGridView&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; buttonPrint_Click(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.printDocument1.Print();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; printDocument1_BeginPrint(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, PrintEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.currentPage = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; printDocument1_PrintPage(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, System.Drawing.Printing.PrintPageEventArgs e)
{
	Size oldSize = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Size;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Height = Math.Max(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Height, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.PreferredSize.Height);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Width = Math.Max(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Width, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.PreferredSize.Width);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; requiredPagesForWidth = ((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Width / e.MarginBounds.Width) + &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; requiredPagesForHeight = ((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Height / e.MarginBounds.Height) + &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; requiredPages = requiredPagesForWidth * requiredPagesForHeight;
	e.HasMorePages = (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.currentPage &amp;lt; requiredPages - &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;); 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; posX = ((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.currentPage % requiredPagesForWidth) &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;* e.MarginBounds.Width; 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; posY = ((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.currentPage / requiredPagesForWidth) &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;* e.MarginBounds.Height; 
	Graphics graphics = e.Graphics; 
	Bitmap bitmap = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Bitmap(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Width, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Height); 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.DrawToBitmap(bitmap, &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Bounds); 
	graphics.DrawImage(bitmap, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Rectangle(e.MarginBounds.X, e.MarginBounds.Y, e.MarginBounds.Width, e.MarginBounds.Height), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Rectangle(posX, posY, e.MarginBounds.Width, e.MarginBounds.Height), GraphicsUnit.Pixel); 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Size = oldSize; 
	++&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.currentPage; 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now that you understand the main idea, let&amp;rsquo;s wrap it in a class and make it reusable: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ResizedControlPrintPageEventHandler.txt&#34;&gt;ResizedControlPrintPageEventHandler&lt;/a&gt;. Using this class is as simple as&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Initialise a controlPrintPageEventHandler and register the PrintPage method...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;ResizedControlPrintPageEventHandler resizedControlPrintPageEventHandler = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ResizedControlPrintPageEventHandler(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1);
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.printDocument1.PrintPage += resizedControlPrintPageEventHandler.PrintPage;

&lt;span style=&#34;color:#75715e&#34;&gt;// Print the control
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; buttonPrint_Click(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.printDocument1.Print();
}

&lt;span style=&#34;color:#75715e&#34;&gt;// Give the user a preview
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; buttonPreview_Click(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.printPreviewDialog1.Show();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here are a couple of screenshots&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/print-datagridview1.gif&#34; alt=&#34;Screenshot of demo application that has a datagridview with scrollbars.&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/print-datagridview2.gif&#34; alt=&#34;Screenshot of print preview. Notice that the scrollbars are gone.&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/print-datagridview3.gif&#34; alt=&#34;Screenshot of the print document.&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download the class and demo application: &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/ControlPrintPageEventHandler.zip&#34;&gt;ControlPrintPageEventHandler.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Exploring System.CodeDom</title>
      <link>/post/2006-12-26-exploring-systemcodedom/</link>
      <pubDate>Tue, 26 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-26-exploring-systemcodedom/</guid>
      <description>
        
          &lt;p&gt;Today i wanted to experiment with &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.codedom.aspx&#34;&gt;System.CodeDom&lt;/a&gt;. This little program requests the user to input names for a namespace, class and method. It also asks the user to input the code that should go into the method body. Then it generates an assembly (test.dll) and creates a new appdomain in which the assembly is loaded&amp;hellip; Finally it initializes an instance of the created class and calls the method&amp;hellip;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; loopEnd = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (loopEnd != &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X&amp;#34;&lt;/span&gt;)
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;//string namespaceName = &amp;#34;MySpace&amp;#34;;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#75715e&#34;&gt;//string className = &amp;#34;MyClass&amp;#34;;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#75715e&#34;&gt;//string methodName = &amp;#34;MyMethod&amp;#34;;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#75715e&#34;&gt;//StringBuilder stringBuilder = new StringBuilder(&amp;#34;System.Console.WriteLine(\&amp;#34;hihi\&amp;#34;);&amp;#34;);
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
		Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Enter namespace: &amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; namespaceName = Console.ReadLine();
		Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Enter class: &amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; className = Console.ReadLine();
		Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Enter method: &amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; methodName = Console.ReadLine();

		StringBuilder stringBuilder = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; StringBuilder();
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Enter method body (X to stop)&amp;#34;&lt;/span&gt;);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; input = Console.ReadLine();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (input != &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;X&amp;#34;&lt;/span&gt;)
		{
			stringBuilder.Append(input);
			input = Console.ReadLine();
		}

		CodeCompileUnit codeCompileUnit = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeCompileUnit();

		CodeAttributeDeclaration assemblyTitleAttribute = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeAttributeDeclaration(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;System.Reflection.AssemblyTitle&amp;#34;&lt;/span&gt;);
		assemblyTitleAttribute.Arguments.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeAttributeArgument(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodePrimitiveExpression(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A Generated Assembly&amp;#34;&lt;/span&gt;)));
		codeCompileUnit.AssemblyCustomAttributes.Add(assemblyTitleAttribute);

		CodeTypeDeclaration codeTypeDeclaration = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeTypeDeclaration();
		codeTypeDeclaration.Name = className;
		codeTypeDeclaration.IsClass = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
		codeTypeDeclaration.Attributes = MemberAttributes.Public;

		CodeMemberMethod codeMemberMethod = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeMemberMethod();
		codeMemberMethod.Name = methodName;
		codeMemberMethod.Attributes = MemberAttributes.Public;
		codeMemberMethod.ReturnType = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeTypeReference(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt;));
		codeMemberMethod.Statements.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeSnippetStatement(stringBuilder.ToString()));

		codeTypeDeclaration.Members.Add(codeMemberMethod);

		CodeNamespace codeNamespace = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CodeNamespace(namespaceName);
		codeNamespace.Types.Add(codeTypeDeclaration);
		codeCompileUnit.Namespaces.Add(codeNamespace);

		CompilerParameters compilerParameters = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CompilerParameters();
		compilerParameters.OutputAssembly = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;test.dll&amp;#34;&lt;/span&gt;;
		compilerParameters.GenerateExecutable = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
		compilerParameters.GenerateInMemory = &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;

		CSharpCodeProvider cSharpCodeProvider = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CSharpCodeProvider();
		CompilerResults compilerResults = cSharpCodeProvider.CompileAssemblyFromDom(compilerParameters, codeCompileUnit);

		AppDomain appDomain = AppDomain.CreateDomain(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;new appdomain&amp;#34;&lt;/span&gt;);
		Assembly assembly = appDomain.Load(compilerResults.CompiledAssembly.FullName);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; instance = assembly.CreateInstance(namespaceName + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt; + className);
		instance.GetType().InvokeMember(methodName, BindingFlags.Instance | BindingFlags.Public | BindingFlags.InvokeMethod, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;, instance, &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;);
		AppDomain.Unload(appDomain);

		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Enter X to end (enter something different to continue)&amp;#34;&lt;/span&gt;);
		loopEnd = Console.ReadLine();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Drag and Drop Microsoft Office Outlook Contacts on your WinForm</title>
      <link>/post/2006-12-19-drag-and-drop-microsoft-office-outlook-contacts-on-your-winform/</link>
      <pubDate>Tue, 19 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-19-drag-and-drop-microsoft-office-outlook-contacts-on-your-winform/</guid>
      <description>
        
          &lt;p&gt;Earlier today i saw someone that wanted to know how to drag and drop Microsoft Office Outlook Contacts on his winform (and get the data of the contact). Here are the few lines of code that do what he asked for&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in the constructor of the form (or in the InitializeComponent method if you set it via the Designer)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.AllowDrop = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;

&lt;span style=&#34;color:#75715e&#34;&gt;// handle the DragOver event
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Form1_DragOver(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DragEventArgs e)
{
	e.Effect = DragDropEffects.All;
}

&lt;span style=&#34;color:#75715e&#34;&gt;// handle the DragDrop event
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Form1_DragDrop(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DragEventArgs e)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; text = (&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;)e.Data.GetData(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Text&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.label1.Text = text;

	&lt;span style=&#34;color:#75715e&#34;&gt;// for more finegrained access to the data
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;//string[] lines = text.Split(new string[] { Environment.NewLine }, StringSplitOptions.RemoveEmptyEntries);
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/outlookcontactdragdrop.jpg&#34; alt=&#34;screenshot of outlook contact that was dragged and dropped on the form&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>A DateAndTimePicker control</title>
      <link>/post/2006-12-18-a-dateandtimepicker-control/</link>
      <pubDate>Mon, 18 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-18-a-dateandtimepicker-control/</guid>
      <description>
        
          &lt;p&gt;The &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datetimepicker.aspx&#34;&gt;DateTimePicker&lt;/a&gt; control allows the user to input a Date or a Time. The problem is that you can&amp;rsquo;t let the user pick both a date and a time with one instance of the control (unless you set the CustomFormat property and give up the &amp;lsquo;nice&amp;rsquo; ui) so i decided to build my own DateAndTimePicker control&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/dateandtimepicker.jpg&#34; alt=&#34;screenshot of the dateandtimepicker control&#34;&gt;&lt;/p&gt;
&lt;p&gt;Feel free to download and extended the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/DateAndTimePicker.zip&#34;&gt;DateAndTimePicker.zip&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Looking up the MediaType of a given Logical Drive</title>
      <link>/post/2006-12-18-looking-up-the-mediatype-of-a-given-logical-drive/</link>
      <pubDate>Mon, 18 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-18-looking-up-the-mediatype-of-a-given-logical-drive/</guid>
      <description>
        
          &lt;p&gt;Earlier today i saw someone asking how he could find out the MediaType of a given logical drive. The easy solution would be to iterate over &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.io.driveinfo.getdrives.aspx&#34;&gt;DriveInfo.GetDrives&lt;/a&gt; and pick the one you are looking for&amp;hellip; Anyway, i thought it would be nice to experiment with &lt;a href=&#34;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/wmi_start_page.asp&#34;&gt;WMI&lt;/a&gt; so i wrote a little function that uses &lt;a href=&#34;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wmisdk/wmi/Win32_LogicalDisk.asp&#34;&gt;Win32_LogicalDisk&lt;/a&gt; to look the MediaType up&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt;[] driveLetters = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt;[] { &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;e&amp;#39;&lt;/span&gt; };
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; driveLetter &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; driveLetters)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;
		{
			Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Drive {0} is a {1}&amp;#34;&lt;/span&gt;, driveLetter, GetMediaType(driveLetter));
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;catch&lt;/span&gt; (ManagementException)
		{
			Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Drive {0} was not found&amp;#34;&lt;/span&gt;, driveLetter);
		}
	}

	Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Press any key to continue...&amp;#34;&lt;/span&gt;);
	Console.ReadKey();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; GetMediaType(&lt;span style=&#34;color:#66d9ef&#34;&gt;char&lt;/span&gt; driveLetter)
{
	ManagementObject disk = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ManagementObject(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;win32_logicaldisk.deviceid=\&amp;#34;&amp;#34;&lt;/span&gt; + driveLetter + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;:\&amp;#34;&amp;#34;&lt;/span&gt;);
	disk.Get();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; GetMediaMeaning((&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt;)disk[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MediaType&amp;#34;&lt;/span&gt;]);
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; GetMediaMeaning(&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt; mediaType)
{
	Dictionary&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt; mediaTypes = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Dictionary&amp;lt;&lt;span style=&#34;color:#66d9ef&#34;&gt;uint&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;&amp;gt;();
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Unknown Format&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 1.2Mb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 1.44Mb -512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 2.88Mb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 20.8Mb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 720Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 360Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 320Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 320Kb -- 1024bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 180Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 160Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;11&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Removable media other than floppy&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Fixed hard disk media&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 120Mb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 640Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 640Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 720Kb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;17&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 1.2Mb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;18&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 1.23Mb -- 1024bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;19&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;51/4-Inch Floppy Disk -- 1.23Mb -- 1024bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 128Mb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;31/2-Inch Floppy Disk -- 230Mb -- 512bytes/sector&amp;#34;&lt;/span&gt;);
	mediaTypes.Add(&lt;span style=&#34;color:#ae81ff&#34;&gt;22&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;8-Inch Floppy Disk -- 256Kb -- 128bytes/sector&amp;#34;&lt;/span&gt;);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; meaning = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Unknown format&amp;#34;&lt;/span&gt;;
	mediaTypes.TryGetValue(mediaType, &lt;span style=&#34;color:#66d9ef&#34;&gt;out&lt;/span&gt; meaning);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; meaning;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Simple OutlookBar Control</title>
      <link>/post/2006-12-17-simple-outlookbar-control/</link>
      <pubDate>Sun, 17 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-17-simple-outlookbar-control/</guid>
      <description>
        
          &lt;p&gt;Earlier this evening i wanted to experiment with the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.toolstrip.aspx&#34;&gt;ToolStrip&lt;/a&gt; class so i decided to design a simple OutlookBar Control and a demo application that uses this control. Feel free to download &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/OutlookBar.zip&#34;&gt;OutlookBar.zip&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/outlookbardemo.jpg&#34; alt=&#34;screenshot of OutlookBar demo&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Pondering about the difference between abstract classes and interfaces</title>
      <link>/post/2006-12-16-pondering-about-the-difference-between-abstract-classes-and-interfaces/</link>
      <pubDate>Sat, 16 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-16-pondering-about-the-difference-between-abstract-classes-and-interfaces/</guid>
      <description>
        
          &lt;p&gt;Back in May i was asked to explain the difference between an &lt;a href=&#34;http://msdn.microsoft.com/library/en-us/csref/html/vcreftheinterfacetype.asp&#34;&gt;interface&lt;/a&gt; and an &lt;a href=&#34;http://msdn.microsoft.com/library/en-us/csspec/html/vclrfcsharpspec_10_1_1_1.asp&#34;&gt;abstract class&lt;/a&gt; at a job interview. Obviously the interviewer wanted me to tell him that an abstract class allows you to provide a partial implementation&amp;hellip; I answered that the major difference is the fact that with interface-based programming you&amp;rsquo;re not forced into an inheritance tree that might not make sense and that i didn&amp;rsquo;t see much use for abstract classes (I&amp;rsquo;m not sure he saw that one coming :P). For some unknown reason this kept spinning in my head&amp;hellip; Here&amp;rsquo;s an example of an abstract class and a concrete implementation&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;abstract&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;FooAbstract&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoX()
	{
		DoY();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;abstract&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoY();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;FooConcrete&lt;/span&gt; : FooAbstract
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;protected&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;override&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoY()
	{
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;FooConcrete does Y&amp;#34;&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;I find the interface-based implementation below a lot cleaner because it still provides the partial implementation but a concrete implementation is not forced into the inheritance relationship anymore. Another advantage is that the implementation only depends on the interface (the unimplemented parts) so you get some looser coupling than with abstract classes. A disadvantage is that an interface requires you to make all the unimplemented methods public&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; IAbstract myAbstract;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Foo(IAbstract myAbstract)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (myAbstract == &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;)
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;throw&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; ArgumentNullException();
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myAbstract = myAbstract;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoX()
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.myAbstract.DoY();
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;interface&lt;/span&gt; IAbstract
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoY();
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Concrete&lt;/span&gt; : IAbstract
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoY()
	{
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Concrete does Y&amp;#34;&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Conclusion: I still don&amp;rsquo;t see much use for abstract classes.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Helper methods for DateTime</title>
      <link>/post/2006-12-14-helper-methods-for-datetime/</link>
      <pubDate>Thu, 14 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-14-helper-methods-for-datetime/</guid>
      <description>
        
          &lt;p&gt;Here are a couple of methods that help you with the manipulation of DateTime structs:&lt;/p&gt;
&lt;p&gt;Code: &lt;a href=&#34;/wp-content/code/csharp/DateTimeHelpers.txt&#34;&gt;csharp/DateTimeHelpers.txt&lt;/a&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>What goes up must come down...</title>
      <link>/post/2006-12-13-what-goes-up-must-come-down/</link>
      <pubDate>Wed, 13 Dec 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-12-13-what-goes-up-must-come-down/</guid>
      <description>
        
          &lt;p&gt;What goes up must come down&amp;hellip; So you might think that after each CellMouseDown event you recieve a CellMouseUp event&amp;hellip; Well, here is some code that proves that isn&amp;rsquo;t always true&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; lastEvent;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
	{
		InitializeComponent();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.ColumnCount = &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.RowCount = &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; LastEvent
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.lastEvent; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; {
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.lastEvent == &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;)
			{
				MessageBox.Show(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;i&amp;#39;ve detected two &amp;#34;&lt;/span&gt; + &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; + &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; after each other&amp;#34;&lt;/span&gt;);
			}
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.lastEvent = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_CellMouseDown(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewCellMouseEventArgs e)
	{
		LastEvent = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MouseDown&amp;#34;&lt;/span&gt;;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_CellMouseUp(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewCellMouseEventArgs e)
	{
		LastEvent = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MouseUp&amp;#34;&lt;/span&gt;;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And with a bit of a twisted optical mouse it&amp;rsquo;s pretty easy to see the following MessageBox&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/mousedown.jpg&#34; alt=&#34;MessageBox that says the MouseDownEvent was captured two times after each other&#34;&gt;&lt;/p&gt;
&lt;p&gt;After a bit of research i also found the following at &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.mouseeventargs.aspx&#34;&gt;MouseEventArgs&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;

        
      </description>
    </item>
    
    <item>
      <title>Master-Slave for databound ComboBoxes</title>
      <link>/post/2006-11-25-master-slave-for-databound-comboboxes/</link>
      <pubDate>Sat, 25 Nov 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-11-25-master-slave-for-databound-comboboxes/</guid>
      <description>
        
          &lt;p&gt;In most examples on the Internet you&amp;rsquo;ll find that the Master has a property that returns the allowed Slaves. Here&amp;rsquo;s an example that does not require such a property. Let&amp;rsquo;s start with a simple class that represents a Person.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Person&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name = name;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we define a class to hold the choosen Master and Slave persons.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MasterSlave&lt;/span&gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; Person master;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; Person slave;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; MasterSlave()
	{
		Person[] masters = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.GetMasters();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.master = masters[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;];

		Person[] slaves = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.GetSlaves(&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.master);
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.slave = slaves[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;];
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person Master
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.master; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.master = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person Slave
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.slave; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.slave = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person[] GetMasters()
	{
		List&amp;lt;person&amp;gt; masters = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;person&amp;gt;();
		masters.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master1&amp;#34;&lt;/span&gt;));
		masters.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master2&amp;#34;&lt;/span&gt;));
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; masters.ToArray();
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person[] GetSlaves(Person person)
	{
		List&amp;lt;person&amp;gt; slaves = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;person&amp;gt;();

		&lt;span style=&#34;color:#66d9ef&#34;&gt;switch&lt;/span&gt; (person.Name)
		{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master1&amp;#34;&lt;/span&gt;:
		slaves.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master1-slave1&amp;#34;&lt;/span&gt;));
		slaves.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master1-slave2&amp;#34;&lt;/span&gt;));
		&lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;case&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master2&amp;#34;&lt;/span&gt;:
		slaves.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master2-slave1&amp;#34;&lt;/span&gt;));
		slaves.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master2-slave2&amp;#34;&lt;/span&gt;));
		slaves.Add(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;master2-slave3&amp;#34;&lt;/span&gt;));
		&lt;span style=&#34;color:#66d9ef&#34;&gt;break&lt;/span&gt;;
		}
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; slaves.ToArray();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And now we can hook these objects to your Form.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1()
	{
		InitializeComponent();

		MasterSlave masterSlave = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MasterSlave();

		BindingSource masterBindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingSource();
		masterBindingSource.DataSource = masterSlave.GetMasters();
		masterBindingSource.CurrentChanged += &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EventHandler(masterBindingSource_CurrentChanged);

		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxMaster.DataSource = masterBindingSource;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxMaster.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxMaster.DataBindings.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SelectedItem&amp;#34;&lt;/span&gt;, masterSlave, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Master&amp;#34;&lt;/span&gt;);

		BindingSource slaveBindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; BindingSource();
		slaveBindingSource.DataSource = masterSlave.GetSlaves(masterBindingSource.Current &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Person);

		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxSlave.DataSource = slaveBindingSource;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxSlave.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxSlave.DataBindings.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SelectedItem&amp;#34;&lt;/span&gt;, masterSlave, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Slave&amp;#34;&lt;/span&gt;);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; masterBindingSource_CurrentChanged(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e)
	{
		BindingSource masterBindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxMaster.DataSource &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; BindingSource;
		Person master = masterBindingSource.Current &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; Person;

		BindingSource slaveBindingSource = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxSlave.DataSource &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; BindingSource;
		MasterSlave masterSlave = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxSlave.DataBindings[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;SelectedItem&amp;#34;&lt;/span&gt;].DataSource &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; MasterSlave;
		slaveBindingSource.DataSource = masterSlave.GetSlaves(master);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>A better look at the Foreach statement</title>
      <link>/post/2006-11-23-126/</link>
      <pubDate>Thu, 23 Nov 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-11-23-126/</guid>
      <description>
        
          &lt;p&gt;Earlier this week i was a bit surprised that the following code compiled without errors or warning messages. I expected at least a warning that i was trying to assign a double value to an integer parameter&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt;[] values = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;1.1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2.2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3.3&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;4.4&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;5.5&lt;/span&gt; };

	Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;foreach with int:&amp;#34;&lt;/span&gt;);

	&lt;span style=&#34;color:#75715e&#34;&gt;// happily iterate over the double values as if they are ints...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#75715e&#34;&gt;// this outputs the lines 1, 2, 3, 4 and 5.
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; values)
	{
		Console.WriteLine(&lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;So i decided to dive into the &lt;a href=&#34;http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-334.pdf&#34;&gt;C# Language Specification&lt;/a&gt; (Section 15.8.4 The foreach statement) where i found the following:&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;!-- raw HTML omitted --&gt; {&lt;!-- raw HTML omitted --&gt; E e = ((C)(x)).GetEnumerator();&lt;!-- raw HTML omitted --&gt; try {&lt;!-- raw HTML omitted --&gt; V v;&lt;!-- raw HTML omitted --&gt; while (e.MoveNext()) {&lt;!-- raw HTML omitted --&gt; v = (V)(T)e.Current;&lt;!-- raw HTML omitted --&gt; embedded-statement&lt;!-- raw HTML omitted --&gt; }&lt;!-- raw HTML omitted --&gt; }&lt;!-- raw HTML omitted --&gt; finally {&lt;!-- raw HTML omitted --&gt; â€¦ // Dispose e&lt;!-- raw HTML omitted --&gt; }&lt;!-- raw HTML omitted --&gt; }&lt;!-- raw HTML omitted --&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; &amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
        
      </description>
    </item>
    
    <item>
      <title>Querying Active Directory</title>
      <link>/post/2006-11-04-querying-active-directory/</link>
      <pubDate>Sat, 04 Nov 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-11-04-querying-active-directory/</guid>
      <description>
        
          &lt;p&gt;A while ago i wanted to figure out which demo accounts i had already created in my &lt;a href=&#34;http://www.microsoft.com/windowsserver2003/technologies/directory/activedirectory/default.mspx&#34;&gt;Active Directory&lt;/a&gt;. Since i was smart enough to give them all a description &amp;lsquo;Demo User&amp;rsquo; this was easily done as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;using( DirectoryEntry directoryEntry = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DirectoryEntry() )
{
	using( DirectorySearcher directorySearcher = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DirectorySearcher() )
	{
		directorySearcher.Filter = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;(&amp;amp;(objectClass=user)(description=Demo User))&amp;#34;&lt;/span&gt;;
		directorySearcher.SearchScope = SearchScope.Subtree;
		directorySearcher.Sort = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SortOption(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;displayname&amp;#34;&lt;/span&gt;, SortDirection.Ascending );

		SearchResultCollection results = directorySearcher.FindAll();
		&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt;( SearchResult result &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; results )
		{
			ResultPropertyCollection propertyCollection = result.Properties;
			Console.WriteLine( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}: {1}&amp;#34;&lt;/span&gt;, propertyCollection&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;displayname&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;]&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;].ToString(), propertyCollection&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;description&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;]&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;].ToString() );
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Using a collection as parameter for a stored procedure</title>
      <link>/post/2006-10-23-using-a-collection-as-parameter-for-a-stored-procedure/</link>
      <pubDate>Mon, 23 Oct 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-10-23-using-a-collection-as-parameter-for-a-stored-procedure/</guid>
      <description>
        
          &lt;p&gt;Sometimes you want to select rows where a value is in a specific collection. Here&amp;rsquo;s an example that show how you can select all the rows in the TEST table with an id of 1, 2 or 3. First we create an SQL type to contain a list of numbers&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;CREATE&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;TYPE&lt;/span&gt; LIST_NUMBER &lt;span style=&#34;color:#66d9ef&#34;&gt;AS&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;TABLE&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;OF&lt;/span&gt; NUMBER(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;);
&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Next thing to do is add a custom type and function header to the package specification&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;PACKAGE TIMVW.TESTPACKAGE &lt;span style=&#34;color:#66d9ef&#34;&gt;AS&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;TYPE&lt;/span&gt; CRSR_REF &lt;span style=&#34;color:#66d9ef&#34;&gt;IS&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;REF&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;CURSOR&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;TYPE&lt;/span&gt; ARR&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;_IDS &lt;span style=&#34;color:#66d9ef&#34;&gt;IS&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;TABLE&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;OF&lt;/span&gt; TEST.TEST&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;\&lt;/span&gt;_ID&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Type&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;INDEX&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;BY&lt;/span&gt; BINARY_INTEGER;

&lt;span style=&#34;color:#66d9ef&#34;&gt;PROCEDURE&lt;/span&gt; GET_TESTS
(
P_IDS &lt;span style=&#34;color:#66d9ef&#34;&gt;IN&lt;/span&gt; ARR_IDS,
P_CURSOR &lt;span style=&#34;color:#66d9ef&#34;&gt;OUT&lt;/span&gt; CRSR_REF
);
&lt;span style=&#34;color:#66d9ef&#34;&gt;END&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And offcourse we have to implement the function in the body&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sql&#34; data-lang=&#34;sql&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;PROCEDURE&lt;/span&gt; GET_TESTS
(
P_IDS &lt;span style=&#34;color:#66d9ef&#34;&gt;IN&lt;/span&gt; ARR_IDS,
P_CURSOR &lt;span style=&#34;color:#66d9ef&#34;&gt;OUT&lt;/span&gt; CRSR_REF
)

&lt;span style=&#34;color:#66d9ef&#34;&gt;AS&lt;/span&gt;

V_IDS LIST_NUMBER :&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; LIST_NUMBER();

&lt;span style=&#34;color:#66d9ef&#34;&gt;BEGIN&lt;/span&gt;

V_IDS.EXTEND(P_IDS.&lt;span style=&#34;color:#66d9ef&#34;&gt;COUNT&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;FOR&lt;/span&gt; i &lt;span style=&#34;color:#66d9ef&#34;&gt;IN&lt;/span&gt; P_IDS.&lt;span style=&#34;color:#66d9ef&#34;&gt;FIRST&lt;/span&gt; .. P_IDS.&lt;span style=&#34;color:#66d9ef&#34;&gt;LAST&lt;/span&gt; LOOP
	V_IDS(i) :&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; P_IDS(i);
&lt;span style=&#34;color:#66d9ef&#34;&gt;END&lt;/span&gt; LOOP;

&lt;span style=&#34;color:#66d9ef&#34;&gt;OPEN&lt;/span&gt; P_CURSOR &lt;span style=&#34;color:#66d9ef&#34;&gt;FOR&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt;
TEST.TEST_ID,
TEST.NAME,
TEST.TYPE_CODE
&lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt;
TEST
&lt;span style=&#34;color:#66d9ef&#34;&gt;WHERE&lt;/span&gt;
TEST_ID &lt;span style=&#34;color:#66d9ef&#34;&gt;IN&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;SELECT&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;FROM&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;TABLE&lt;/span&gt;(V_IDS))
&lt;span style=&#34;color:#66d9ef&#34;&gt;ORDER&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;BY&lt;/span&gt;
TEST.TEST_ID &lt;span style=&#34;color:#66d9ef&#34;&gt;ASC&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;END&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now that we have done all this we can consume the function from our client code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (OracleConnection conn = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; OracleConnection(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;User Id=u;password=p;Data Source=ORCL&amp;#34;&lt;/span&gt;))
{
	conn.Open();

	OracleCommand command = conn.CreateCommand();
	command.CommandType = CommandType.StoredProcedure;

	command.CommandText = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;TIMVW.TESTPACKAGE.GET_TESTS&amp;#34;&lt;/span&gt;;
	command.Parameters.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;P_IDS&amp;#34;&lt;/span&gt;, OracleDbType.Int32, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;[] { &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; }, ParameterDirection.Input);
	command.Parameters[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;P_IDS&amp;#34;&lt;/span&gt;].CollectionType = OracleCollectionType.PLSQLAssociativeArray;
	command.Parameters.Add(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;P_CURSOR&amp;#34;&lt;/span&gt;, OracleDbType.RefCursor, ParameterDirection.Output);

	OracleDataReader reader = command.ExecuteReader();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (reader.Read())
	{
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;test 	}
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&lt;/span&gt;
	Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
	Console.ReadKey();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Updating the Internet Options / Lan Settings</title>
      <link>/post/2006-10-12-updating-the-internet-options-lan-settings/</link>
      <pubDate>Thu, 12 Oct 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-10-12-updating-the-internet-options-lan-settings/</guid>
      <description>
        
          &lt;p&gt;A while ago i wrote that i had created two .reg files to update my Internet Options / Lan Settings (&lt;a href=&#34;http://www.timvw.be/automating-the-configuration-of-internet-options-and-lan-settings/&#34;&gt;Automating the configuration of Internet Options / Lan Settings&lt;/a&gt;). Yesterday i build a little Windows Service that automates this completely. With &lt;a href=&#34;http://windowssdk.msdn.microsoft.com/en-gb/library/aa366329.aspx&#34;&gt;NotifyAddrChange&lt;/a&gt; i am notified whenever a change occurs in the table that maps IPv4 addresses to interfaces&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;[DllImport(&amp;#34;iphlpapi.dll&amp;#34;, CharSet = CharSet.Ansi)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; NotifyAddrChange(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; IntPtr handle, IntPtr overlapped);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The main loop of the service looks like this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.isRunning)
{
	IntPtr handle = IntPtr.Zero;
	NotifyAddrChange(&lt;span style=&#34;color:#66d9ef&#34;&gt;ref&lt;/span&gt; handle, IntPtr.Zero);
	UpdateRegistry();
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Whenever i&amp;rsquo;m connected to the LAN at work i want to use a proxy. Here&amp;rsquo;s the code that takes care of this&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; UpdateRegistry()
{
	RegistryKey registryKey = Registry.CurrentUser.OpenSubKey(&lt;span style=&#34;color:#e6db74&#34;&gt;@&amp;#34;Software\Microsoft\Windows\CurrentVersion\Internet Settings&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (IsInWorkLan())
	{
		registryKey.SetValue(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;AutoConfigURL&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;http://123.456.789.0&amp;#34;&lt;/span&gt;);
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		registryKey.DeleteValue(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;AutoConfigURL&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Figuring out whether i&amp;rsquo;m connected to the LAN at work is pretty simple. As soon as i have an IPAddress that looks like 192.168.X.Y i&amp;rsquo;m connected. Here&amp;rsquo;s how i translated this into code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; IsInWorkLan()
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; (IPAddress ipAddress &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; Dns.GetHostAddresses(Dns.GetHostName()))
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (IsInWorkLan(ipAddress))
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; IsInWorkLan(IPAddress ipAddress)
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[] bytes = ipAddress.GetAddressBytes();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ((&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)bytes[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;] == &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt; &amp;amp;&amp;amp; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt;)bytes[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;] == &lt;span style=&#34;color:#ae81ff&#34;&gt;168&lt;/span&gt;)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Screenshot of DataGridViews</title>
      <link>/post/2006-10-08-screenshot-of-datagridviews/</link>
      <pubDate>Sun, 08 Oct 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-10-08-screenshot-of-datagridviews/</guid>
      <description>
        
          &lt;p&gt;The problem with a regular screenshot is that you only get to see a part of the DataGridViews. Here&amp;rsquo;s an example of a typical form&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridviews-with-scrollbars.jpg&#34; alt=&#34;image of datagridview with scrollbars&#34;&gt;&lt;/p&gt;
&lt;p&gt;Here is a snippet that makes a screenshot of the complete DataGridViews&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;List&amp;lt;bitmap&amp;gt; bitmaps = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; List&amp;lt;bitmap&amp;gt;();
Size size = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Size();

&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;; ++i) 
{ 
	&lt;span style=&#34;color:#75715e&#34;&gt;// lookup the datagridview 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	DataGridView dataGridView = (DataGridView)&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Controls[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;dataGridView&amp;#34;&lt;/span&gt; + i]; 
	&lt;span style=&#34;color:#75715e&#34;&gt;// maximize the datagridview size (choosing between current and preferred) 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	Size oldSize = dataGridView.Size; 
	Size newSize = dataGridView.PreferredSize; 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (dataGridView.Size.Width &amp;gt; newSize.Width)
	{
		newSize.Width = dataGridView.Size.Width;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (dataGridView.Size.Height &amp;gt; newSize.Height)
	{
		newSize.Height = dataGridView.Size.Height;
	}

	dataGridView.Size = newSize;

	&lt;span style=&#34;color:#75715e&#34;&gt;// draw the datagridview into a bitmap
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	Bitmap bitmap = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Bitmap(dataGridView.Width, dataGridView.Height);
	dataGridView.DrawToBitmap(bitmap, &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Rectangle(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, dataGridView.Width, dataGridView.Height));

	&lt;span style=&#34;color:#75715e&#34;&gt;// restore the datagridview to it&amp;#39;s original size
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	dataGridView.Size = oldSize;

	bitmaps.Add(bitmap);

	&lt;span style=&#34;color:#75715e&#34;&gt;// update total bitmap size
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (newSize.Width &amp;gt; size.Width)
	{
		size.Width = newSize.Width;
	}
	size.Height += newSize.Height;
}

&lt;span style=&#34;color:#75715e&#34;&gt;// copy all the bitmaps into one large bitmap
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;Bitmap bitmapComplete = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Bitmap(size.Width, size.Height);
Graphics g = Graphics.FromImage(bitmapComplete);

&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; height = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;; ++i) 
{ 
	g.DrawImageUnscaled(bitmaps[i - &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, height); 
	height += bitmaps[i - &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;].Height; 
} 

&lt;span style=&#34;color:#75715e&#34;&gt;// bitmapComplete is ready for use 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// eg: pictureBox1.Image = bitmapComplete 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// eg: bitmapComplete.Save(@&amp;#34;C:\screenshot.jpg&amp;#34;, ImageFormat.Jpeg); 
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/datagridviews-without-scrollbars.jpg&#34; alt=&#34;image of generated screenshot&#34;&gt;&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Accessing ConnectionStrings from App.config in a Console Application Project</title>
      <link>/post/2006-10-04-accessing-connectionstrings-from-appconfig-in-a-console-application-project/</link>
      <pubDate>Wed, 04 Oct 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-10-04-accessing-connectionstrings-from-appconfig-in-a-console-application-project/</guid>
      <description>
        
          &lt;p&gt;Earlier today i added a configuration file to my Console Applicaton Project (Add Item -&amp;gt; Application Configuration File). Via &lt;a href=&#34;http://www.google.be/url?sa=t&amp;amp;ct=res&amp;amp;cd=1&amp;amp;url=http%3A%2F%2Fmsdn2.microsoft.com%2Fen-us%2Flibrary%2Fsystem.configuration.configurationsettings.aspx&amp;amp;ei=Z80jRYH_C6emiAKbksTEDA&amp;amp;sig=___7EifcEUZZI1hKTg7xiADzIZfIk=&amp;amp;sig2=l3qMgh7T4zcrtCc2IZOp-A&#34;&gt;ConfigurationSettings&lt;/a&gt; i could only access the AppSettings. It took me a while to figure out that i had to add a reference to System.Configuration.dll. Once that was done i could access the ConnectionStrings via &lt;a href=&#34;http://www.google.be/url?sa=t&amp;amp;ct=res&amp;amp;cd=1&amp;amp;url=http%3A%2F%2Fmsdn2.microsoft.com%2Fen-us%2Flibrary%2Fsystem.configuration.configurationmanager.aspx&amp;amp;ei=wM0jRbOxF7mEiALA4smRDA&amp;amp;sig=__mZt6_vi0x3-IpA4WDtLjmB8J4qU=&amp;amp;sig2=RhtohKiKtaGgUOTNFNtJ-w&#34;&gt;ConfigurationManager&lt;/a&gt;.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>From UnixTime to DateTime and back</title>
      <link>/post/2006-10-04-from-unixtime-to-datetime-and-back/</link>
      <pubDate>Wed, 04 Oct 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-10-04-from-unixtime-to-datetime-and-back/</guid>
      <description>
        
          &lt;p&gt;Here are a couple of functions that allow you to convert from &lt;a href=&#34;http://en.wikipedia.org/wiki/Unixtime&#34;&gt;UnixTime&lt;/a&gt; to &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.datetime.aspx&#34;&gt;DateTime&lt;/a&gt; and back&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Util&lt;/span&gt; {
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; DateTime UnixTime
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime(&lt;span style=&#34;color:#ae81ff&#34;&gt;1970&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;); }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; DateTime FromUnixTime( &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; unixTime )
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; UnixTime.AddSeconds( unixTime );
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;double&lt;/span&gt; ToUnixTime( DateTime dateTime )
	{
		TimeSpan timeSpan = dateTime -- UnixTime;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; timeSpan.TotalSeconds;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Code  39 barcodes recognizer</title>
      <link>/post/2006-09-18-code-39-barcodes-recognizer/</link>
      <pubDate>Mon, 18 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-18-code-39-barcodes-recognizer/</guid>
      <description>
        
          &lt;p&gt;Earlier today i read &lt;a href=&#34;http://community.bartdesmet.net/blogs/bart/archive/2006/09/18/4432.aspx&#34;&gt;Code 39 barcodes in C#&lt;/a&gt; by &lt;a href=&#34;http://community.bartdesmet.net/blogs/bart/default.aspx&#34;&gt;Bart De Smet&lt;/a&gt;. The article shows the reader how to generate a &lt;a href=&#34;http://en.wikipedia.org/wiki/Code_39&#34;&gt;Code 39 barcode&lt;/a&gt;. I thought it would be cool if you could actually recognize the barcode in the generated bitmaps so i last couple of hours i wrote a BarCode39 Reader 🙂 Feel free to get &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/BarCode39Reader.zip&#34;&gt;BarCode39Reader.zip&lt;/a&gt; sources now!(PS: I forgot to write this is still a very quick &amp;lsquo;n dirty hack. I don&amp;rsquo;t write bad code, just create a lot of opportunities to refactor 😉&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Anonymous methods</title>
      <link>/post/2006-09-16-anonymous-methods/</link>
      <pubDate>Sat, 16 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-16-anonymous-methods/</guid>
      <description>
        
          &lt;p&gt;Suppose you add a couple of buttons to a panel as shown below. What do you think the message in the MessageBoxes will be?&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1() 
	{
		InitializeComponent();

		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;; ++i) 
		{ 
			Button button = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Button(); 
			button.Text = String.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0:00}&amp;#34;&lt;/span&gt;, i); 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.flowLayoutPanel1.Controls.Add( button ); 
			button.Click += &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; EventHandler(&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt;(Object sender, EventArgs e) 
			{ 
				MessageBox.Show(String.Format(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;You clicked button {0:00}&amp;#34;&lt;/span&gt;, i)); 
			}); 
		} 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In case you&amp;rsquo;re wondering why they all have the message &amp;ldquo;You clicked button 10&amp;rdquo; i suggest you read the following articles&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://blogs.msdn.com/oldnewthing/archive/2006/08/02/686456.aspx&#34;&gt;Part 1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blogs.msdn.com/oldnewthing/archive/2006/08/03/687529.aspx&#34;&gt;Part 2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blogs.msdn.com/oldnewthing/archive/2006/08/04/688527.aspx&#34;&gt;Part 3&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

        
      </description>
    </item>
    
    <item>
      <title>DataGridView with EditOnEnter as EditMode</title>
      <link>/post/2006-09-16-datagridview-with-editonenter-as-editmode/</link>
      <pubDate>Sat, 16 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-16-datagridview-with-editonenter-as-editmode/</guid>
      <description>
        
          &lt;p&gt;Earlier this week i found that when a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx&#34;&gt;DataGridView&lt;/a&gt; has it&amp;rsquo;s &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.editmode.aspx&#34;&gt;EditMode&lt;/a&gt; property set to &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridvieweditmode.aspx&#34;&gt;EditOnEnter&lt;/a&gt; the user cannot select an entire row by clicking on the row header. This prevents the user from being able to delete a row. A couple of websearches later i found a &lt;a href=&#34;http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=98504&#34;&gt;bugreport&lt;/a&gt; but the proposed workarounds didn&amp;rsquo;t work for me 🙁 Here is a workaround that does work for me&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_MouseClick( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, MouseEventArgs e ) 
{
	DataGridView.HitTestInfo hitInfo = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.HitTest(e.X, e.Y);
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;( hitInfo.Type == DataGridViewHitTestType.RowHeader ) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.EditMode = DataGridViewEditMode.EditOnKeystrokeOrF2;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.EndEdit();
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.EditMode = DataGridViewEditMode.EditOnEnter;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Drag and Drop on a DataGridView</title>
      <link>/post/2006-09-16-drag-and-drop-on-a-datagridview/</link>
      <pubDate>Sat, 16 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-16-drag-and-drop-on-a-datagridview/</guid>
      <description>
        
          &lt;p&gt;Here is a bit of sample code that allows you to drag and drop a cellvalue in a DataGridView (don&amp;rsquo;t forget to set the AllowDrop property of the DataGridView to true). Notice that you need to translate the X and Y properties of the DragEventArgs first (unlike the X and Y properties of the MouseEventArgs)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_MouseDown( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, MouseEventArgs e )
{
	DataGridView.HitTestInfo info = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.HitTest( e.X, e.Y );
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( info.RowIndex != -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; info.ColumnIndex != -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; )
	{
		Object &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Rows[info.RowIndex].Cells[info.ColumnIndex].Value;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; )
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Rows[info.RowIndex].Cells[info.ColumnIndex].Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;;
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.DoDragDrop( &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;, DragDropEffects.Move );
		}
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_DragDrop( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DragEventArgs e )
{
	Point p = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.PointToClient( &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Point( e.X, e.Y ) );
	DataGridView.HitTestInfo info = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.HitTest( p.X, p.Y );
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( info.RowIndex != -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; info.ColumnIndex != -&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; )
	{
		Object &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt; = (Object)e.Data.GetData( &lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;( &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; ) );
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Rows[info.RowIndex].Cells[info.ColumnIndex].Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;value&lt;/span&gt;;
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_DragEnter( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DragEventArgs e )
{
	e.Effect = DragDropEffects.Move;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Inconsistent Drag and Drop API</title>
      <link>/post/2006-09-16-inconsistent-drag-and-drop-api/</link>
      <pubDate>Sat, 16 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-16-inconsistent-drag-and-drop-api/</guid>
      <description>
        
          &lt;p&gt;Every System.Windows.Forms.Control has the following events&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;public event DragEventHandler &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.dragdrop.aspx&#34;&gt;DragDrop&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;public event DragEventHandler &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.dragenter.aspx&#34;&gt;DragEnter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;public event EventHandler &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.dragleave.aspx&#34;&gt;DragLeave&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;public event DragEventHandler &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.control.dragover.aspx&#34;&gt;DragOver&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This means, when the user drags something away of the control, you can&amp;rsquo;t access the data anymore (unless you cached it somewhere when the DragEnter or DragOver events occured). Here is an extract from Microsoft patterns and practives on &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/ms229011.aspx&#34;&gt;Event Design&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;

        
      </description>
    </item>
    
    <item>
      <title>Adding DataGridViewColumns (lots of them)</title>
      <link>/post/2006-09-14-adding-datagridviewcolumns-lots-of-them/</link>
      <pubDate>Thu, 14 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-14-adding-datagridviewcolumns-lots-of-them/</guid>
      <description>
        
          &lt;p&gt;Last couple of days i&amp;rsquo;ve been trying to add a couple (750+) columns into a DataGridView. Initially i tried the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.ColumnCount = &lt;span style=&#34;color:#ae81ff&#34;&gt;750&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The code above results in the following error: &lt;strong&gt;Sum of the columns&#39; FillWeight values cannot exceed 65535.&lt;/strong&gt; Then i tried the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;DataGridViewColumn[] columns = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DataGridViewColumn[&lt;span style=&#34;color:#ae81ff&#34;&gt;750&lt;/span&gt;];
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; columns.Length; ++i ) 
{ 
	DataGridViewColumn column = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DataGridViewColumn(); 
	column.CellTemplate = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DataGridViewTextBoxCell(); 
	column.FillWeight = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;; columns[i] = column; 
} 
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Columns.AddRange( columns );
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This results in the following error: &lt;strong&gt;At least one of the DataGridView control&amp;rsquo;s columns has no cell template.&lt;/strong&gt; Thus i tried the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;DataGridViewColumn[] columns = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DataGridViewColumn[&lt;span style=&#34;color:#ae81ff&#34;&gt;750&lt;/span&gt;];
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; columns.Length; ++i ) 
{ 
	DataGridViewColumn column = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DataGridViewTextBoxColumn(); 
	column.FillWeight = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;; columns[i] = column; 
} 
&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Columns.AddRange( columns ); 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;This code works but the AddRange call took about 15 seconds to complete. With the aid of a collegue and &lt;a href=&#34;http://www.aisto.com/roeder/dotnet/&#34;&gt;Reflector&lt;/a&gt; i set the ColumnHeadersHeightSize to DisableResizing. This reduced the calltime to less than 0.5 seconds 🙂&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Implementing Master/Detail for Custom Objects with DataGridViewComboBoxColumns</title>
      <link>/post/2006-09-10-implementing-masterdetail-for-custom-objects-with-datagridviewcomboboxcolumns/</link>
      <pubDate>Sun, 10 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-10-implementing-masterdetail-for-custom-objects-with-datagridviewcomboboxcolumns/</guid>
      <description>
        
          &lt;p&gt;Imagine you have the following two classes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Parent&lt;/span&gt; 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Parent( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name ) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id = id;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name = name;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Id 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; Name 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.name; }
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Child&lt;/span&gt; : Parent 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; parentId;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Child( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id, &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; parentId, &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt; name ) : &lt;span style=&#34;color:#66d9ef&#34;&gt;base&lt;/span&gt;( id, name ) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.parentId = parentId;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; ParentId 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.parentId; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In the first ComboBoxColumn you display a list of possible Parents. In the second ComboBoxColumn you display Children, but only those that belong to the Chosen Parent. Here is how it goes&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; Object selectedValue;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1() 
	{
		InitializeComponent();

		&lt;span style=&#34;color:#75715e&#34;&gt;// Add a couple of Parents
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;; ++i ) 
		{ 
			Parent parent = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Parent( i, String.Format( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Parent{0:00}&amp;#34;&lt;/span&gt;, i ) ); 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column1.Items.Add( parent ); 
			&lt;span style=&#34;color:#75715e&#34;&gt;// Add a couple of Children to each parent 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;			&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; j = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; j &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;; ++j ) 
			{ 
				Child child = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Child( j, i, String.Format( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Child{0:00}&amp;#34;&lt;/span&gt;, i * &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt; + j ) ); 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column2.Items.Add( child ); 
			} 
		} 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column1.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;; 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column2.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;; 
	} 
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_CellParsing( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewCellParsingEventArgs e ) 
	{ 
		e.Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.selectedValue; 
		e.ParsingApplied = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;; 
	} 
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_EditingControlShowing( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewEditingControlShowingEventArgs e ) 
	{ 
		ComboBox cb = e.Control &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ComboBox; 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( cb != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; ) 
		{ 
			&lt;span style=&#34;color:#75715e&#34;&gt;// remove all the children that do not belong to the choosen parent 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;			&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; currentColumnIndex = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.CurrentCell.ColumnIndex; 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( currentColumnIndex == &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; ) 
			{ 
				cb.Items.Clear(); 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; currentRowIndex = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.CurrentCell.RowIndex; 
				Object currentCellValue = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Rows[currentRowIndex].Cells[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;].Value; 
				&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( currentCellValue != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; ) 
				{ 
					&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; parentId = ( (Parent)currentCellValue ).Id; 
					&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; ( Child child &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column2.Items ) 
					{ 
						&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( child.ParentId == parentId ) 
						{ 
							cb.Items.Add( child ); 
						} 
					} 
				} 
			} 
			cb.SelectedIndexChanged -= cb_SelectedIndexChanged; 
			cb.SelectedIndexChanged += cb_SelectedIndexChanged; 
		} 
		
		&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; cb_SelectedIndexChanged(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e) 
		{ 
			ComboBox comboBox = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ComboBox; 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.selectedValue = comboBox.SelectedItem; 
		} 
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Using DataGridViewComboBoxColumn with Custom Objects</title>
      <link>/post/2006-09-10-using-datagridviewcomboboxcolumn-with-custom-objects/</link>
      <pubDate>Sun, 10 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-10-using-datagridviewcomboboxcolumn-with-custom-objects/</guid>
      <description>
        
          &lt;p&gt;Earlier today i was playing with the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx&#34;&gt;DataGridView&lt;/a&gt; control. I wanted to have a couple of &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/xwx934x7.aspx&#34;&gt;DataGridViewComboBoxColumn&lt;/a&gt;s in order to limit the available input options for the user. The documentation clearly mentions the following&lt;/p&gt;
&lt;blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/blockquote&gt;
&lt;p&gt;Here is sample of a custom object&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Slot&lt;/span&gt; {
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; DateTime dateTime;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Slot( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; id, DateTime dateTime ) {
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id = id;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTime = dateTime;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; Id {
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.id; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; DateTime DateTime {
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dateTime; }
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And here is the workaround for a one to one mapping&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;partial&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Form1&lt;/span&gt; : Form 
{
	&lt;span style=&#34;color:#75715e&#34;&gt;// here we&amp;#39;ll store the value the user selected in one of the comboboxcolumns
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; Object selectedValue;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Form1() 
	{
		InitializeComponent();
		selectedValues = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Object[&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridView1.Columns.Count];

		&lt;span style=&#34;color:#75715e&#34;&gt;// create a couple of slots an add them to the comboboxcolumns
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;; ++i ) 
		{ 
			Slot slot = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Slot( i, DateTime.Now.AddDays( i ) ); 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column1.Items.Add( slot ); 
			&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column2.Items.Add( slot ); 
		} 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column1.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;DateTime&amp;#34;&lt;/span&gt;; 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.Column2.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Id&amp;#34;&lt;/span&gt;; 
	} 
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_CellParsing( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewCellParsingEventArgs e ) 
	{ 
		&lt;span style=&#34;color:#75715e&#34;&gt;// lookup the selected value 
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		e.Value = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.selectedValue; 
		e.ParsingApplied = &lt;span style=&#34;color:#66d9ef&#34;&gt;true&lt;/span&gt;; 
	} 
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; dataGridView1_EditingControlShowing( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, DataGridViewEditingControlShowingEventArgs e ) 
	{ 
		ComboBox cb = e.Control &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ComboBox; 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( cb != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt; ) 
		{ 
			cb.SelectedIndexChanged -= cb_SelectedIndexChanged; 
			cb.SelectedIndexChanged += cb_SelectedIndexChanged; 
		} 
	} 
	
	&lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; cb_SelectedIndexChanged(&lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e) 
	{ 
		ComboBox comboBox = sender &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; ComboBox; 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.selectedValue = comboBox.SelectedItem; 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>List the month names</title>
      <link>/post/2006-09-03-list-the-month-names/</link>
      <pubDate>Sun, 03 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-03-list-the-month-names/</guid>
      <description>
        
          &lt;p&gt;As i wrote in &lt;a href=&#34;http://www.timvw.be/generate-a-menu-with-month-names/&#34;&gt;Generate a menu with month names&lt;/a&gt; it&amp;rsquo;s silly to hardcode month names. Here&amp;rsquo;s a C# sample using localization/globalization&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System;
&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System.Globalization;
&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; System.Threading;

&lt;span style=&#34;color:#66d9ef&#34;&gt;namespace&lt;/span&gt; ConsoleApplication1 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Program&lt;/span&gt; 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; ListMonths() 
		{
			&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;; i &amp;lt; &lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;; ++i ) 
			{ 
				DateTime dateTime = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; DateTime( DateTime.Now.Year, i, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; ); 
				Console.WriteLine( dateTime.ToString( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;MMMM&amp;#34;&lt;/span&gt; ) ); 
			} 
			Console.WriteLine(); 
		} 
		
		&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main( &lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args ) 
		{ 
			Thread.CurrentThread.CurrentCulture = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CultureInfo( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;en-US&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt; );
			ListMonths(); 
			Thread.CurrentThread.CurrentCulture = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; CultureInfo( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;nl-BE&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt; ); 
			ListMonths(); 
			Console.Write( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine ); 
			Console.ReadKey(); 
		} 
	} 
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Selecting custom Objects from a ComboBox</title>
      <link>/post/2006-09-03-selecting-custom-objects-from-a-combobox/</link>
      <pubDate>Sun, 03 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-03-selecting-custom-objects-from-a-combobox/</guid>
      <description>
        
          &lt;p&gt;Earlier this week someone asked me how he could select custom objects from a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.combobox.aspx&#34;&gt;ComboBox&lt;/a&gt;. Here is the code he used&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; FillComboBoxPersons(List&amp;lt;person&amp;gt; persons) 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.Items.Clear();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.Items.Add( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-- Select Person -------------&amp;#34;&lt;/span&gt; );
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; ( Person person &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; persons ) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.Items.Add( person.Name );
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.SelectedIndex = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;In order to get the selected item he then used the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.combobox.selectedindex.aspx&#34;&gt;SelectedIndex&lt;/a&gt; property to lookup the Person in a cache of the persons collection.&lt;/p&gt;
&lt;p&gt;Here is an approach that doesn&amp;rsquo;t require you to have a cache of the collection (Since the persons are already stored in the items)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; FillComboBoxPersons(List&amp;lt;person&amp;gt; persons) 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.Items.Clear();
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.Items.Add( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;-- Select Person -------------&amp;#34;&lt;/span&gt; );
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.DisplayMember = &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Name&amp;#34;&lt;/span&gt;;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;foreach&lt;/span&gt; ( Person person &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; persons ) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.Items.Add( person );
	}
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.comboBoxPersons.SelectedIndex = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Now you can easily access the selected item through the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.listcontrol.selectedvalue.aspx&#34;&gt;SelectedValue&lt;/a&gt; property.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Selecting custom Objects from a DataGridView</title>
      <link>/post/2006-09-03-selecting-custom-objects-from-a-datagridview/</link>
      <pubDate>Sun, 03 Sep 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-09-03-selecting-custom-objects-from-a-datagridview/</guid>
      <description>
        
          &lt;p&gt;Here is a way that allows the user to select a row (custom object properties are used as column values) from a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx&#34;&gt;DataGridView&lt;/a&gt; assuming that the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.selectionmode.aspx&#34;&gt;SelectionMode&lt;/a&gt; property is set FullRowSelect&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; FillDataGridViewPersons( List&amp;lt;person&amp;gt; persons ) 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridViewPersons.Rows.Clear();

	&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; i = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;; i &amp;lt; persons.Count; ++i ) 
	{ 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridViewPersons.Rows.Add(); 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridViewPersons.Rows[i].Tag = persons[i]; 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridViewPersons.Rows[i].SetValues( &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt;[] { persons[i].Id, persons[i].Name } ); 
	} 
} 

&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; buttonDoSomething_Click( &lt;span style=&#34;color:#66d9ef&#34;&gt;object&lt;/span&gt; sender, EventArgs e ) 
{ 
	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; ( &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridViewPersons.SelectedRows.Count == &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; ) 
	{ 
		&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; selectedRowIndex = &lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridViewPersons.SelectedCells[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;].RowIndex; 
		Person selectedPerson = (Person)&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.dataGridViewPersons.Rows[selectedRowIndex].Tag; 
		MessageBox.Show( String.Format( &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;You selected the person with 	} 
&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&lt;/span&gt;} 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Unable to enlist in a distributed transaction</title>
      <link>/post/2006-08-26-unable-to-enlist-in-a-distributed-transaction/</link>
      <pubDate>Sat, 26 Aug 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-08-26-unable-to-enlist-in-a-distributed-transaction/</guid>
      <description>
        
          &lt;p&gt;Earlier today we were confronted with the following &lt;a href=&#34;http://msdn2.microsoft.com/en-US/library/system.data.oracleclient.oracleexception.aspx&#34;&gt;OracleException&lt;/a&gt;: &lt;strong&gt;Unable to enlist in a distributed transaction&lt;/strong&gt;. Our code (and accompanying tests) had been running fine for the last two weeks thus we expected there was a problem with the database. A member of the DBA team assurred us there was nothing wrong with the database. Finally we discovered that we had created a circular reference and thus the program ended up in an endless loop (well untill the database decided it had been enough anyway :p). Here is a simplified version of the problem&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoA() 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (TransactionScope scope = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TransactionScope()) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (OracleConnection con = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; OracleConnection(connectionString)) 
		{
			con.Open();
			DoB();
			scope.Complete();
		}
	}
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; DoB() 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (TransactionScope scope = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; TransactionScope()) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (OracleConnection con = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; OracleConnection(connectionString)) 
		{
			con.Open();
			DoA();
			scope.Complete();
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Without the use of &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.transactions.transactionscope.aspx&#34;&gt;TransactionScope&lt;/a&gt; this results in a &lt;strong&gt;Connection request timed out&lt;/strong&gt; exception.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Inserting pause to your Console Applications</title>
      <link>/post/2006-08-05-inserting-pause-to-your-console-applications/</link>
      <pubDate>Sat, 05 Aug 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-08-05-inserting-pause-to-your-console-applications/</guid>
      <description>
        
          &lt;p&gt;When i write Console Applications i find myself to write the following two lines quite often&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;Console.Write(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{0}Press any key to continue...&amp;#34;&lt;/span&gt;, Environment.NewLine);
Console.ReadKey();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As you already know i&amp;rsquo;m lazy so i decided to write an &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/ms165392.aspx&#34;&gt;IntelliSense Code Snippet&lt;/a&gt;. When i type &amp;ldquo;pau&amp;rdquo; Intellisense show the following:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/intellisense-drop-down-list.jpg&#34; alt=&#34;Intellisense drop down list&#34;&gt;&lt;/p&gt;
&lt;p&gt;Next i hit the tab button twice and i get the following effect:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/intellisense-code-snippet.jpg&#34; alt=&#34;Intellisense code snippet&#34;&gt;&lt;/p&gt;
&lt;p&gt;Download &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/pause.txt&#34;&gt;pause.txt&lt;/a&gt; and save it as Pause.snippet in your %My DocumentS\Visual Studio 2005\Code Snippets\Visual C#\My Code Snippets% folder.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;ve made it even simpler, you can install the snippet by simply running the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/pause.vsi&#34;&gt;pause.vsi&lt;/a&gt; package (Visual Studio Installer).&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>eID with .NET</title>
      <link>/post/2006-07-23-eid-with-net/</link>
      <pubDate>Sun, 23 Jul 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-07-23-eid-with-net/</guid>
      <description>
        
          &lt;p&gt;When i started working (already 3 weeks ago) i recieved a laptop. Friday i discovered that this laptop has a &lt;a href=&#34;http://en.wikipedia.org/wiki/Smartcard&#34;&gt;Smart card&lt;/a&gt; reader and i wanted to experiment with it. I thought it would be nice if i could read the data on my &lt;a href=&#34;http://eid.belgium.be/&#34;&gt;eID&lt;/a&gt;. Apart from &lt;a href=&#34;http://download.microsoft.com/download/4/f/d/4fd49a94-8772-4bd0-88ca-bf46e2d029fc/WHITEPAPERS/Accessing%20the%20eID%20Middleware%20from%20.NET%20(Version%201.0).doc&#34;&gt;Accessing the eID Middleware from .NET (Version 1.0)&lt;/a&gt; i couldn&amp;rsquo;t find much information. I decided to use the document as the basis for my own libeid wrapper. With the Simple (Wrapper API) reading data becomes extremely easy&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; eID.Simple;

Reader reader = Reader.GetReader();
pictureBox.Image = reader.GetImage();
labelName.Text = reader.GetName();
labelGivenNames.Text = reader.GetFirstName1() + reader.GetFirstName2() + reader.GetFirstName3();
dateTimePickerBirthdate.Value = reader.GetBirthdate();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;As usual, feel free to download the source (&lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/Belgium.zip&#34;&gt;Belgium.zip&lt;/a&gt;) and/or leave any comments&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Windows Multimedia Video Capture</title>
      <link>/post/2006-06-26-windows-multimedia-video-capture/</link>
      <pubDate>Mon, 26 Jun 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-06-26-windows-multimedia-video-capture/</guid>
      <description>
        
          &lt;p&gt;On my computer the &lt;a href=&#34;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wia/wia/overviews/startpage.asp&#34;&gt;WIA (Windows Image Acquisition)&lt;/a&gt; API is SLOOOOOW. So i decided to give the &lt;a href=&#34;http://windowssdk.msdn.microsoft.com/en-us/library/ms713477(VS.80).aspx&#34;&gt;Windows Multimedia Video Capture&lt;/a&gt; API a try. I didn&amp;rsquo;t take long to &lt;a href=&#34;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpguide/html/cpconcreatingprototypesinmanagedcode.asp&#34;&gt;create the prototypes in Managed Code&lt;/a&gt; and &lt;a href=&#34;http://msdn.microsoft.com/library/en-us/cpguide/html/cpconcallingdllfunction.asp&#34;&gt;call the DLL functions&lt;/a&gt;. Everything runs really smooth now&amp;hellip; As always, feel free to download the &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/testavicap32.zip&#34;&gt;testavicap32&lt;/a&gt; sources now!&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Windows Image Acquisition</title>
      <link>/post/2006-06-24-windows-image-acquisition/</link>
      <pubDate>Sat, 24 Jun 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-06-24-windows-image-acquisition/</guid>
      <description>
        
          &lt;p&gt;Earlier today i decided to toy around with my webcam. A couple of websearches later i ended up at &lt;a href=&#34;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wia/wia/overviews/startpage.asp&#34;&gt;WIA (Windows Image Acquisition)&lt;/a&gt;. I found a couple of articles (eg: &lt;a href=&#34;http://msdn.microsoft.com/coding4fun/someassemblyrequired/lookatme/default.aspx&#34;&gt;here&lt;/a&gt; and &lt;a href=&#34;http://blogs.msdn.com/robburke/archive/2005/09/21/472541.aspx&#34;&gt;here&lt;/a&gt;) that showed how to capture images. I wanted to display the caputered image in a &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/system.windows.forms.picturebox.aspx&#34;&gt;PictureBox&lt;/a&gt;. Unfortunately everybody seems to save the WIA.ImageFile to a file and then load the imagefile into a PictureBox. It&amp;rsquo;s obvious that i don&amp;rsquo;t want to save the image into a file first. Here is my workaround&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// Load the ImageFile into a PictureBox
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;pbImage.Image = Image.FromStream(&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MemorySteam((&lt;span style=&#34;color:#66d9ef&#34;&gt;byte&lt;/span&gt;[]) imgf.FileData.get_BinaryData()));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Experimenting with LINQ Preview (May 2006)</title>
      <link>/post/2006-06-20-experimenting-with-linq-preview-may-2006/</link>
      <pubDate>Tue, 20 Jun 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-06-20-experimenting-with-linq-preview-may-2006/</guid>
      <description>
        
          &lt;p&gt;Today i downloaded and installed &lt;a href=&#34;http://www.microsoft.com/downloads/details.aspx?familyid=1e902c21-340c-4d13-9f04-70eb5e3dceea&amp;amp;displaylang=en&#34;&gt;LINQ Preview (May 2006)&lt;/a&gt;. Well, that was the plan anyway:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://www.timvw.be/wp-content/images/linq-2006-06-error.png&#34; alt=&#34;error with linq preview installer&#34;&gt;&lt;/p&gt;
&lt;p&gt;A couple of minutes later i found &lt;a href=&#34;http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=394174&amp;amp;SiteID=1&#34;&gt;this page&lt;/a&gt; and was able to solve the problem by adding the following users with administrative rights: Power Users, Users and Creator Owner.&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Building a chain of responsibility with delegates</title>
      <link>/post/2006-05-30-building-a-chain-of-responsibility-with-delegates/</link>
      <pubDate>Tue, 30 May 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-05-30-building-a-chain-of-responsibility-with-delegates/</guid>
      <description>
        
          &lt;p&gt;Imagine that you have to write a function that verifies if there is a license available for a given clientID. Suppose that there are a couple of possibilities to find an available license. Your code would probably look like the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// This code verifies if the client with the given clientID is licensed
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// returns the licenseID or 0 if no license is available
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Int32 IsLicensed(Int32 clientID) 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;int&lt;/span&gt; result = &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;;

	&lt;span style=&#34;color:#75715e&#34;&gt;// verify if there is already a license &amp;#39;assigned&amp;#39; to the client
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	result = IsAssigned(clientID);

	&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (result == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) 
	{
		&lt;span style=&#34;color:#75715e&#34;&gt;// find a dedicated license (license that is bound to the given client)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;		result = IsDedicated(clientID);

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (result == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) 
		{
			&lt;span style=&#34;color:#75715e&#34;&gt;// find a nondedicated license (license that can be used by any client)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;			result = IsNonDedicated(clientID);
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; result;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It&amp;rsquo;s obvious that this structures becomes more complex as the number of possible ways to get a license grows. If you look a while at the structure you&amp;rsquo;ll notice a pattern: each function (IsAssigned, IsDedicated, IsNonDedicted) verifies if there is a license availble. If the function didn&amp;rsquo;t find a license the next function is performed. If you translate this to OO you would end up with something similar to the following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// this methods tries to find an available license for the given clientID
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// returns the licenseID or 0 if no license was found
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;delegate&lt;/span&gt; Int32 FindLicenseMethod(Int32 clientID);

&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;LicenseFinder&lt;/span&gt; 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; FindLicenseMethod method;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;private&lt;/span&gt; LicenseFinder next;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; LicenseFinder(FindLicenseMethod, method, LicenseFinder next) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.method = method;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.next = next;
	}

	&lt;span style=&#34;color:#75715e&#34;&gt;// property for the next licensefinder in the chain
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Next 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;get&lt;/span&gt; { &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; next; }
		&lt;span style=&#34;color:#66d9ef&#34;&gt;set&lt;/span&gt; { next = val; }
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Int32 GetLicense(Int32 clientID) 
	{
		Int32 result = method(clientID);

		&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; (result == &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; Next != &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;) 
		{
			result = Next.GetLicense(clientID);
		}

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; result;
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Int32 IsLicensed(Int32 clientID) 
	{
		LicenseFinder f = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; LicenseFinder(
		&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FindLicenseMethod(IsAssigned), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; LicenseFinder(
		&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FindLicenseMethod(IsDedicated), &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; LicenseFinder(
		&lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; FindLicenseMethod(IsNonDedicated), &lt;span style=&#34;color:#66d9ef&#34;&gt;null&lt;/span&gt;))));

		&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; f.GetLicense(clientID);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Simple serialization and deserialization of public class members</title>
      <link>/post/2006-04-21-simple-serialization-and-deserialization-of-public-class-members/</link>
      <pubDate>Fri, 21 Apr 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-04-21-simple-serialization-and-deserialization-of-public-class-members/</guid>
      <description>
        
          &lt;p&gt;Here is a simple generic class that allows you to serialize classes (well, their public members) into XML and deserialize the XML to objects again. Make sure the class (or struct) has a parameterless constructor and that all the members that you want to serialize are public. Here is the code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SimpleSerializer&lt;/span&gt;&amp;lt;t&amp;gt;
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; String Serialize(T o)
	{
		using(MemoryStream m = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MemoryStream())
		{
			XmlSerializer s = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; XmlSerializer(o.GetType());
			s.Serialize(m, o);
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Encoding.UTF8.GetString(m.ToArray());
		}
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; T Deserialize(String xml)
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;using&lt;/span&gt; (MemoryStream m = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; MemoryStream(Encoding.UTF8.GetBytes(xml)))
		{
			XmlSerializer s = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; XmlSerializer(&lt;span style=&#34;color:#66d9ef&#34;&gt;typeof&lt;/span&gt;(T));
			&lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (T)s.Deserialize(m);
		}
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Here is a simple example of a class that will be serialized&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Person&lt;/span&gt; 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; String firstname;
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; String lastname;

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; Person(String firstname, String lastname) 
	{
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.firstname = firstname;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;this&lt;/span&gt;.lastname = lastname;
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And finally, a simple console application that demonstrates how it works:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Program&lt;/span&gt; 
{
	&lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;void&lt;/span&gt; Main(&lt;span style=&#34;color:#66d9ef&#34;&gt;string&lt;/span&gt;[] args)
	{
		Person p1 = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; Person(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tim&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Van Wassenhove&amp;#34;&lt;/span&gt;);
		SimpleSerializer&amp;lt;person&amp;gt; ss = &lt;span style=&#34;color:#66d9ef&#34;&gt;new&lt;/span&gt; SimpleSerializer&amp;lt;person&amp;gt;();

		String xml = ss.Serialize(p1);
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;serialized:\n&amp;#34;&lt;/span&gt; + xml);

		Person p2 = ss.Deserialize(xml);
		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;unserialized name: &amp;#34;&lt;/span&gt; + p2.firstname);

		Console.WriteLine(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Press any key to continue...&amp;#34;&lt;/span&gt;);
		Console.ReadKey();
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>More about marshalling</title>
      <link>/post/2006-03-28-more-about-marshalling/</link>
      <pubDate>Tue, 28 Mar 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-03-28-more-about-marshalling/</guid>
      <description>
        
          &lt;p&gt;Last month i&amp;rsquo;ve started programming with the &lt;a href=&#34;http://msdn.microsoft.com/netframework/&#34;&gt;.NET Framework&lt;/a&gt; using Visual Basic, C++.NET and C# on a daily basis. The first thing i noticed is that some useful functions that were available in kernel32.dll, user32.dll, etc. have been removed from the &lt;a href=&#34;http://msdn2.microsoft.com/en-us/library/ms306608.aspx&#34;&gt;API&lt;/a&gt;. At &lt;a href=&#34;http://www.pinvoke.net&#34;&gt;pinvoke.net&lt;/a&gt; you find a summary of the functions in these &lt;a href=&#34;http://en.wikipedia.org/wiki/Dynamic-link_library&#34;&gt;DLL&lt;/a&gt;s and the PInvoke signatures.The most common approach is to build classes for the DLLs as following&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-csharp&#34; data-lang=&#34;csharp&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;namespace&lt;/span&gt; InterOp {
	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;User32&lt;/span&gt; {
&lt;span style=&#34;color:#a6e22e&#34;&gt;		[DllImport(&amp;#34;user32.dll&amp;#34;)]&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; IntPtr GetDesktopWindow();
&lt;span style=&#34;color:#a6e22e&#34;&gt;		[DllImport(&amp;#34;user32.dll&amp;#34;)]&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; IntPtr GetWindowDC(IntPtr hWnd);
&lt;span style=&#34;color:#a6e22e&#34;&gt;		[DllImport(&amp;#34;user32.dll&amp;#34;)]&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; IntPtr ReleaseDC(IntPtr hWnd, IntPtr hDC);
&lt;span style=&#34;color:#a6e22e&#34;&gt;		[DllImport(&amp;#34;user32.dll&amp;#34;)]&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; IntPtr GetWindowRect(IntPtr hWnd, RECT rect);
	}

	&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;GDI32&lt;/span&gt; {
&lt;span style=&#34;color:#a6e22e&#34;&gt;		[DllImport(&amp;#34;gdi32.dll&amp;#34;)]&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; DeleteDC(IntPtr hDC);
&lt;span style=&#34;color:#a6e22e&#34;&gt;		[DllImport(&amp;#34;gdi32.dll&amp;#34;)]&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;bool&lt;/span&gt; DeleteObject(IntPtr hObject);
&lt;span style=&#34;color:#a6e22e&#34;&gt;		[DllImport(&amp;#34;gdi32.dll&amp;#34;)]&lt;/span&gt;
		&lt;span style=&#34;color:#66d9ef&#34;&gt;public&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;static&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;extern&lt;/span&gt; IntPtr SelectObject(IntPtr hDC, IntPtr hObject);
	}
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Parsing XML</title>
      <link>/post/2004-04-06-parsing-xml/</link>
      <pubDate>Tue, 06 Apr 2004 00:00:00 +0000</pubDate>
      
      <guid>/post/2004-04-06-parsing-xml/</guid>
      <description>
        
          &lt;p&gt;Today i wrote a little program, &lt;a href=&#34;http://www.timvw.be/wp-content/code/csharp/VolumeMeter.txt&#34;&gt;VolumeMeter&lt;/a&gt; which is usefull for &lt;a href=&#34;http://www.scarlet.be&#34;&gt;Scarlet&lt;/a&gt; customers. It queries &lt;a href=&#34;http://mijn.scarlet.be&#34;&gt;mijn.scarlet.be&lt;/a&gt; and returns how many megabytes they have used this month.&lt;/p&gt;

        
      </description>
    </item>
    
  </channel>
</rss>
