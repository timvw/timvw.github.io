<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>SQL on Tim Van Wassenhove</title>
    <link>/tags/SQL/</link>
    <description>Recent content in SQL on Tim Van Wassenhove</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 27 Apr 2013 00:00:00 +0000</lastBuildDate><atom:link href="/tags/SQL/feed.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>The curious case of trailing spaces in SQL</title>
      <link>/post/2013-04-27-the-curious-case-of-trailing-spaces-in-sql/</link>
      <pubDate>Sat, 27 Apr 2013 00:00:00 +0000</pubDate>
      
      <guid>/post/2013-04-27-the-curious-case-of-trailing-spaces-in-sql/</guid>
      <description>A while ago I was quite surprised to see that the following query returns 1 instead of 0:
SELECT COUNT(*) WHERE N&amp;#39;Tim&amp;#39; = N&amp;#39;Tim &amp;#39;; -- notice the trailing space Apparently this is just standard behaviour. Here is an extract from sql1992.txt (Section 8.2 Paragraph 3):</description>
    </item>
    
    <item>
      <title>Sample query to demonstrate influence of collation in Sql Server</title>
      <link>/post/2012-10-18-sample-query-to-demonstrate-influence-of-collation-in-sql-server/</link>
      <pubDate>Thu, 18 Oct 2012 00:00:00 +0000</pubDate>
      
      <guid>/post/2012-10-18-sample-query-to-demonstrate-influence-of-collation-in-sql-server/</guid>
      <description>Lately I had the pleasure to investigate collations and here is a sample query that demonstrates how a collation impacts the behaviour of a query:
WITH [Words] AS ( SELECT N&amp;#39;Een&amp;#39; AS [word] UNION ALL SELECT N&amp;#39;Eèn&amp;#39;	UNION ALL SELECT N&amp;#39;EEN&amp;#39; ) SELECT [word]	FROM [Words] WHERE [word]	--COLLATE Latin1_General_CS_AS -- returns Een --COLLATE Latin1_General_CI_AI -- returns Een, Eèn and EEN --COLLATE LAtin1_General_CI_AS -- returns Een and EEN COLLATE Latin1_General_CS_AI -- returns Een and Eèn = N&amp;#39;Een&amp;#39;; </description>
    </item>
    
    <item>
      <title>An example of Common Table Expression and Window function usage...</title>
      <link>/post/2012-03-27-an-example-of-common-table-expression-and-window-function-usage/</link>
      <pubDate>Tue, 27 Mar 2012 00:00:00 +0000</pubDate>
      
      <guid>/post/2012-03-27-an-example-of-common-table-expression-and-window-function-usage/</guid>
      <description>Earlier this week some colleague had been assigned a maintenance task and asked me how I would solve it. Every customer is permitted to have an amount of publications. All excess publications should be removed from the system (only the n most recent ones are permitted to remain on the system).
Here is an example of the Customer table:
CREATE TABLE [dbo].[Customer]( [CustomerId] [int] IDENTITY(1,1) NOT NULL, [CustomerName] [nvarchar](50) NOT NULL, [PermittedPublications] [int] NOT NULL ); INSERT INTO [dbo].</description>
    </item>
    
    <item>
      <title>Use SQL Server Profiler to see if a connection is pooled</title>
      <link>/post/2011-08-19-use-sql-server-profiler-to-see-if-a-connection-is-pooled/</link>
      <pubDate>Fri, 19 Aug 2011 00:00:00 +0000</pubDate>
      
      <guid>/post/2011-08-19-use-sql-server-profiler-to-see-if-a-connection-is-pooled/</guid>
      <description>It took me a couple of websearches to discover how i can see in SQL Server Profiler whether or not a connection is pooled. Apparently you have to check &amp;lsquo;Show all columns&amp;rsquo; and then you can check the &amp;lsquo;EventSubClass&amp;rsquo; column:

This is how it looks like in your trace window:</description>
    </item>
    
    <item>
      <title>Building a Nums table (quickly)</title>
      <link>/post/2011-07-13-building-a-nums-table-quickly/</link>
      <pubDate>Wed, 13 Jul 2011 00:00:00 +0000</pubDate>
      
      <guid>/post/2011-07-13-building-a-nums-table-quickly/</guid>
      <description>A while ago i presented my approach to generate a nums table here.
DECLARE @count INT = 1000; WITH [Nums1] AS ( SELECT 1 AS [Value] UNION SELECT 2 AS [Value] ) , [Nums2] AS ( SELECT A.* FROM [Nums1] AS A, [Nums1] AS B, [Nums1] AS C) , [Nums3] AS ( SELECT A.* FROM [Nums2] AS A, [Nums2] AS B, [Nums2] AS C) , [Nums4] AS ( SELECT A.* FROM [Nums3] AS A, [Nums3] AS B ) , [Numbers] AS ( SELECT TOP(@count) -1 + ROW_NUMBER() OVER(ORDER BY [Value]) AS [Value] FROM[Nums4] ) SELECT * FROM [Numbers]; Because we only use this code once to fill the table we don&amp;rsquo;t really care that it is not very fast.</description>
    </item>
    
    <item>
      <title>Invoke parameterized stored procedure with PowerShell</title>
      <link>/post/2011-03-21-invoke-parameterized-stored-procedure-with-powershell/</link>
      <pubDate>Mon, 21 Mar 2011 00:00:00 +0000</pubDate>
      
      <guid>/post/2011-03-21-invoke-parameterized-stored-procedure-with-powershell/</guid>
      <description>Here is a quick snippet that demonstrates how you can invoke a parametrized stored procedure with PowerShell:
$CreateTraceCommand = $SqlConnection.CreateCommand(); $CreateTraceCommand.CommandType = [System.Data.CommandType] &amp;#34;StoredProcedure&amp;#34;; $CreateTraceCommand.CommandText = &amp;#34;sp_trace_create&amp;#34;; $TraceIdParameter = $CreateTraceCommand.Parameters.Add(&amp;#34;@traceid&amp;#34;, [System.Data.SqlDbType] &amp;#34;Int&amp;#34;); $TraceIdParameter.Direction = [System.Data.ParameterDirection] &amp;#34;Output&amp;#34;; $OptionParameter = $CreateTraceCommand.Parameters.Add(&amp;#34;@options&amp;#34;, [System.Data.SqlDbType] &amp;#34;Int&amp;#34;); $OptionParameter.Value = [int] 2; $TraceFileParameter = $CreateTraceCommand.Parameters.Add(&amp;#34;@tracefile&amp;#34;, [System.Data.SqlDbType] &amp;#34;NVarChar&amp;#34;); $TraceFileParameter.Value = [string] &amp;#34;c:\temp\test&amp;#34;; [void] $CreateTraceCommand.ExecuteNonQuery(); $TraceId = $TraceIdParameter.Value; Write-Host &amp;#34;You created a trace with ``` </description>
    </item>
    
    <item>
      <title>Techniques learned in SQLtopia: Look Ma, no loops!</title>
      <link>/post/2010-12-11-techniques-learned-in-sqltopia-look-ma-no-loops/</link>
      <pubDate>Sat, 11 Dec 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-12-11-techniques-learned-in-sqltopia-look-ma-no-loops/</guid>
      <description>I have been programming in c-based languages for more than 10 years now. Lately i have spent quite a bit of time in SQLtopia and learned a couple of techniques that are quite different from what i was used to.
Let me explain with an example: The boss comes in and asks for a report that contains all the days on which i have worked this year. As a typical c# programmer i come up with the following solution: Iterate over all the days in the year and skip the days i was out on holidays:</description>
    </item>
    
    <item>
      <title>Exploring window functions</title>
      <link>/post/2010-12-10-exploring-window-functions/</link>
      <pubDate>Fri, 10 Dec 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-12-10-exploring-window-functions/</guid>
      <description>Here is a sample query that allows you to explore the behavior of various aggregate window functions:
WITH [Nums1] AS ( SELECT 1 AS [Value] UNION SELECT 2 AS [Value] ) , [Nums2] AS ( SELECT A.* FROM [Nums1] AS A, [Nums1] AS B, [Nums1] AS C) , [Nums3] AS ( SELECT A.* FROM [Nums2] AS A, [Nums2] AS B, [Nums2] AS C) , [Nums4] AS ( SELECT A.* FROM [Nums3] AS A, [Nums3] AS B ) -- Build numbers from 1 to 1000 , [Numbers] AS ( SELECT TOP(1000) ROW_NUMBER() OVER(ORDER BY [Value]) AS [Value] FROM[Nums4] ) SELECT [Value] , ROW_NUMBER() OVER(PARTITION BY [Value] / 100 ORDER BY [Value] % 10) AS [RowNumber] , RANK() OVER(PARTITION BY [Value] / 100 ORDER BY [Value] % 10) AS [Rank] , DENSE_RANK() OVER (PARTITION BY [Value] / 100 ORDER BY [Value] % 10) AS [DenseRank] , NTILE(4) OVER (PARTITION BY [Value] / 100 ORDER BY [Value] % 10) AS [Tile100] FROM [Numbers] ORDER BY [Value]; </description>
    </item>
    
    <item>
      <title>Deploying a Database Project does not create artefacts for custom schemas</title>
      <link>/post/2010-11-01-deploying-a-database-project-does-not-create-artefacts-for-custom-schemas/</link>
      <pubDate>Mon, 01 Nov 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-11-01-deploying-a-database-project-does-not-create-artefacts-for-custom-schemas/</guid>
      <description>Last week we noticed that the artefacts for a custom schema in our Database Project were not created (or updated). It took us a while to figure out what was wrong. When you add a script via the &amp;lsquo;Add Existing item&amp;rsquo; menu in VS2010 the file&amp;rsquo;s Build Action is set to Not in Build for some unknown reason. As soon as we changed the value to Build and Deployed again our artefacts were created.</description>
    </item>
    
    <item>
      <title>T-SQL: Remove all rows from all tables in your schema</title>
      <link>/post/2010-09-07-t-sql-remove-all-rows-from-all-tables-in-your-schema/</link>
      <pubDate>Tue, 07 Sep 2010 00:00:00 +0000</pubDate>
      
      <guid>/post/2010-09-07-t-sql-remove-all-rows-from-all-tables-in-your-schema/</guid>
      <description>Sometimes i want to quickly clean up a database and start from fresh. Here is a small script that does exactly that.. (I just run the script a couple of times, untill no affected rows remain&amp;hellip; Far more efficient than figuring out which constraints exist, building up a dependency tree, and cleanly deleting all rows):
-- Remove all rows from all tables DECLARE @tableName VARCHAR(255) DECLARE tableNames CURSOR FOR SELECT name FROM sys.</description>
    </item>
    
    <item>
      <title>Update from localtime to UTC or any other timezone with Oracle</title>
      <link>/post/2007-07-17-update-from-localtime-to-utc-with-oracle/</link>
      <pubDate>Tue, 17 Jul 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-07-17-update-from-localtime-to-utc-with-oracle/</guid>
      <description>Imagine that you have a table with a column of the type DATETIME. You&amp;rsquo;ve been storing data as localtime and after a while you need to convert these datetimes to UTC. Here&amp;rsquo;s a possible approach
UPDATE events SET start = SYS_EXTRACT_UTC(FROM_TZ(start, &amp;#39;Europe/Brussels&amp;#39;)); You get a more generic variant using the AT TIME ZONE clause
UPDATE events SET start = FROM_TZ(start, &amp;#39;Europe/Brussels&amp;#39;) AT TIME ZONE &amp;#39;America/Denver&amp;#39;; </description>
    </item>
    
    <item>
      <title>Simulate AutoIncrement</title>
      <link>/post/2007-03-24-simulate-autoincrement/</link>
      <pubDate>Sat, 24 Mar 2007 00:00:00 +0000</pubDate>
      
      <guid>/post/2007-03-24-simulate-autoincrement/</guid>
      <description>Earlier today someone asked the following
  Here is a possible answer: (Don&amp;rsquo;t forget to wrap these queries in a transaction if your MySQL Engine supports it)
-- Some demo tables (and data) -- CREATE TABLE table1 (id INT(10), name VARCHAR(20), PRIMARY KEY(id)); -- CREATE TABLE table2 (id INT(10), name VARCHAR(20), PRIMARY KEY(id)); -- INSERT INTO table1 VALUES (1, &amp;#34;tim&amp;#34;), (2, &amp;#34;mike&amp;#34;);  SET @id := (SELECT MAX(id) + 1 FROM table2); INSERT INTO table2 SELECT @id := @id + 1, table1.</description>
    </item>
    
    <item>
      <title>Using a collection as parameter for a stored procedure</title>
      <link>/post/2006-10-23-using-a-collection-as-parameter-for-a-stored-procedure/</link>
      <pubDate>Mon, 23 Oct 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-10-23-using-a-collection-as-parameter-for-a-stored-procedure/</guid>
      <description>Sometimes you want to select rows where a value is in a specific collection. Here&amp;rsquo;s an example that show how you can select all the rows in the TEST table with an id of 1, 2 or 3. First we create an SQL type to contain a list of numbers
CREATE TYPE LIST_NUMBER AS TABLE OF NUMBER(10); / Next thing to do is add a custom type and function header to the package specification</description>
    </item>
    
    <item>
      <title>Searching made easy</title>
      <link>/post/2006-10-22-searching-made-easy/</link>
      <pubDate>Sun, 22 Oct 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-10-22-searching-made-easy/</guid>
      <description>Very often i have to write queries that return all the rows where one or more columns match a specific value. If i add for every column the condition &amp;lsquo;P_COLUMN IS NULL OR COLUMN = P_COLUMN&amp;rsquo; to the WHERE clause i only have to write one query. Here&amp;rsquo;s an example of such a query
PROCEDURE FIND_TESTS ( P_ID IN TEST.ID%Type, P_TITLE IN TEST.TITLE%Type, P_TYPE_CODE IN TEST.TYPE_CODE%Type, P_CURSOR OUT CURSOR REF ) AS BEGIN OPEN P_CURSOR FOR SELECT ID, TITLE, TYPE_CODE FROM TEST WHERE (P_ID IS NULL OR ID = P_ID) AND (P_TITLE IS NULL OR TITLE LIKE P_TITLE) AND (P_TYPE_CODE IS NULL OR TYPE_CODE LIKE P_TYPE_CODE) ORDER BY ID ASC; END; A couple of examples how you can use this query</description>
    </item>
    
    <item>
      <title>tweaking Oracle SQL Developer</title>
      <link>/post/2006-08-27-tweaking-oracle-sql-developer/</link>
      <pubDate>Sun, 27 Aug 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-08-27-tweaking-oracle-sql-developer/</guid>
      <description>A couple of days ago i discovered Oracle SQL Developer, a new and free graphical tool for database development. At first i was impressed by all it&amp;rsquo;s features but when i tried to modify a couple of existing stored procedures the application freezed. EricH directed me to the FAQ: Can I suppress Code Insight (and why would I want to)?. Now that i have added the &amp;lsquo;AddVMOption -J-Dsdev.insight=false&amp;rsquo; to my sqldeveloper.</description>
    </item>
    
    <item>
      <title>Experimenting with Oracle and PL/SQL</title>
      <link>/post/2006-08-21-experimenting-with-oracle-and-plsql/</link>
      <pubDate>Mon, 21 Aug 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-08-21-experimenting-with-oracle-and-plsql/</guid>
      <description>As i already wrote, last couple of days i&amp;rsquo;ve been experimenting with PL/SQL. At work we use Toad for Oracle but since TOADSoft only offers a limited freeware version i decided to write my code with GVim and use SQL*Plus at home. Here are a couple of lines i added to my login.sql file
DEFINE _EDITOR=&amp;#39;gvim -c &amp;#34;set filetype=sql&amp;#34;&amp;#39; SET SERVEROUTPUT ON SET LINESIZE 120 SET AUTOCOMMIT OFF ALTER SESSION SET NLS_DATE_FORMAT=&amp;#39;YYYY-MM-DD&amp;#39;; In a stored procedure i created and filled an instance of NUMBER_TABLE (CREATE TYPE NUMBER_TABLE AS TABLE OF NUMBER) and my stored procedure tried to select all the rows in that table (SELECT * FROM V_NUMBER_TABLE).</description>
    </item>
    
    <item>
      <title>Select best 3 laptimes for each player</title>
      <link>/post/2006-04-14-select-best-3-laptimes-for-each-player/</link>
      <pubDate>Fri, 14 Apr 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-04-14-select-best-3-laptimes-for-each-player/</guid>
      <description>Imagine that you have a schema where you store all the times a player needed to complete a parcours. A possible schema could be (postgresql)
CREATE TABLE laptimes ( lap_id SERIAL NOT NULL, player_id INT NOT NULL, laptime INT NOT NULL, PRIMARY KEY (lap_id) ); INSERT INTO laptimes (player_id, laptime) VALUES (1, 250); INSERT INTO laptimes (player_id, laptime) VALUES (1, 450); INSERT INTO laptimes (player_id, laptime) VALUES (1, 350); INSERT INTO laptimes (player_id, laptime) VALUES (1, 300); INSERT INTO laptimes (player_id, laptime) VALUES (1, 327); INSERT INTO laptimes (player_id, laptime) VALUES (2, 327); INSERT INTO laptimes (player_id, laptime) VALUES (2, 249); INSERT INTO laptimes (player_id, laptime) VALUES (2, 123); INSERT INTO laptimes (player_id, laptime) VALUES (2, 489); INSERT INTO laptimes (player_id, laptime) VALUES (2, 158); INSERT INTO laptimes (player_id, laptime) VALUES (3, 158); INSERT INTO laptimes (player_id, laptime) VALUES (3, 120); INSERT INTO laptimes (player_id, laptime) VALUES (3, 190); INSERT INTO laptimes (player_id, laptime) VALUES (4, 600); Now imagine that you want to display the best 3 results for each player.</description>
    </item>
    
    <item>
      <title>Multiple joins explained</title>
      <link>/post/2006-02-03-multiple-joins-explained/</link>
      <pubDate>Fri, 03 Feb 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-02-03-multiple-joins-explained/</guid>
      <description>I&amp;rsquo;ll try to explain how a join on more than one table works. I&amp;rsquo;ve noticed people get confused by it. Assume we have the following tables
 newsitems(news_id,post_id) postitems(post_id,user_id,content) users(user_id,name,password)  We want to display for each newsitem the content and the author.
Our base table would be the newsitems, and then we join using the item_id. Thus the query would be
SELECT * FROM newsitems INNER JOIN ON postitems USING (post_id) This returns a &amp;ldquo;virtual table&amp;rdquo; that has looks like this result(news_id,post_id,user_id,content).</description>
    </item>
    
    <item>
      <title>Select the first 50 words of an article</title>
      <link>/post/2006-01-18-select-the-first-50-words-of-an-article/</link>
      <pubDate>Wed, 18 Jan 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-01-18-select-the-first-50-words-of-an-article/</guid>
      <description>I am cleaning up my code snippets and i found the following little trick in one of them that i have removed. Assuming that different words are separated by spaces we can use SUBSTRING_INDEX as following
SELECT SUBSTRING_INDEX(body,&amp;#39; &amp;#39;,50) AS dn FROM mytable </description>
    </item>
    
    <item>
      <title>Custom ordering with MySQL</title>
      <link>/post/2004-12-09-custom-ordering-with-mysql/</link>
      <pubDate>Thu, 09 Dec 2004 00:00:00 +0000</pubDate>
      
      <guid>/post/2004-12-09-custom-ordering-with-mysql/</guid>
      <description>As a follow up to Custom Ordering I discovered the nice Field function in MySQL. after it was mentionned on my favorite PHP Forum by Weirdan. It allows one to order a column on a custom order relation.
SELECT * FROM foo ORDER BY FIELD(column, &amp;#39;Z&amp;#39;, &amp;#39;B&amp;#39;, &amp;#39;C&amp;#39;) </description>
    </item>
    
    <item>
      <title>Custom ordering</title>
      <link>/post/2004-07-18-custom-ordering/</link>
      <pubDate>Sun, 18 Jul 2004 00:00:00 +0000</pubDate>
      
      <guid>/post/2004-07-18-custom-ordering/</guid>
      <description>Assume we have a fruits table. And we want to select all the fruits that have a red or orange or blue color. But we want the resultset to have first all the fruits with color=red, then the fruits with color=blue and then the fruits with color=orange. It is obvious we can not use an alphabetical order. Thus we have to introduce our own order relation.
select * from fruits where color = &amp;#39;red&amp;#39; or color = &amp;#39;blue&amp;#39; or color = &amp;#39;orange&amp;#39; order by case when color = &amp;#39;red&amp;#39; then 0 when color = &amp;#39;blue&amp;#39; then 1 when color = &amp;#39;orange&amp;#39; then 2 end </description>
    </item>
    
  </channel>
</rss>
