<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Easy pattern for Control state - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	
  <meta itemprop="name" content="Easy pattern for Control state">
  <meta itemprop="description" content="If you have decided that your WebControl requires to maintain it’s state you will want to figure out how to implement Control state. Most examples on the web will then create an array of objects and then hardcode the indices to find stuff back… Simply define a serializable inner class and use that instead of the ‘magic array object’. Eg
class SilverlightHost : WebControl { [Serializable] class State { public object BaseState { get; set; } public string SilverlightUrl { get; set; } public string SilverlightErrorHandlerUrl { get; set; } public Dictionary&lt;string, string&gt; Parameters { get; set; } } protected override void OnInit(EventArgs e) { base.OnInit(e); Page.RegisterRequiresControlState(this); } protected override object SaveControlState() { var state = new State { BaseState = base.SaveControlState(), SilverlightUrl = SilverlightUrl, SilverlightErrorHandlerUrl = SilverlightErrorHandlerUrl, Parameters = parameters }; return state; } protected override void LoadControlState(object savedState) { var state = (State)savedState; SilverlightUrl = state.SilverlightUrl; SilverlightErrorHandlerUrl = state.SilverlightErrorHandlerUrl; parameters = state.Parameters; base.LoadControlState(state.BaseState); } }">
  <meta itemprop="datePublished" content="2009-11-21T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-01-04T22:47:36+01:00">
  <meta itemprop="wordCount" content="157">
  <meta itemprop="keywords" content="ASP.NET,CSharp"><meta property="og:url" content="https://timvw.be/2009/11/21/easy-pattern-for-control-state/">
  <meta property="og:site_name" content="Tim Van Wassenhove">
  <meta property="og:title" content="Easy pattern for Control state">
  <meta property="og:description" content="If you have decided that your WebControl requires to maintain it’s state you will want to figure out how to implement Control state. Most examples on the web will then create an array of objects and then hardcode the indices to find stuff back… Simply define a serializable inner class and use that instead of the ‘magic array object’. Eg
class SilverlightHost : WebControl { [Serializable] class State { public object BaseState { get; set; } public string SilverlightUrl { get; set; } public string SilverlightErrorHandlerUrl { get; set; } public Dictionary&lt;string, string&gt; Parameters { get; set; } } protected override void OnInit(EventArgs e) { base.OnInit(e); Page.RegisterRequiresControlState(this); } protected override object SaveControlState() { var state = new State { BaseState = base.SaveControlState(), SilverlightUrl = SilverlightUrl, SilverlightErrorHandlerUrl = SilverlightErrorHandlerUrl, Parameters = parameters }; return state; } protected override void LoadControlState(object savedState) { var state = (State)savedState; SilverlightUrl = state.SilverlightUrl; SilverlightErrorHandlerUrl = state.SilverlightErrorHandlerUrl; parameters = state.Parameters; base.LoadControlState(state.BaseState); } }">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2009-11-21T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-01-04T22:47:36+01:00">
    <meta property="article:tag" content="ASP.NET">
    <meta property="article:tag" content="CSharp">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Easy pattern for Control state">
  <meta name="twitter:description" content="If you have decided that your WebControl requires to maintain it’s state you will want to figure out how to implement Control state. Most examples on the web will then create an array of objects and then hardcode the indices to find stuff back… Simply define a serializable inner class and use that instead of the ‘magic array object’. Eg
class SilverlightHost : WebControl { [Serializable] class State { public object BaseState { get; set; } public string SilverlightUrl { get; set; } public string SilverlightErrorHandlerUrl { get; set; } public Dictionary&lt;string, string&gt; Parameters { get; set; } } protected override void OnInit(EventArgs e) { base.OnInit(e); Page.RegisterRequiresControlState(this); } protected override object SaveControlState() { var state = new State { BaseState = base.SaveControlState(), SilverlightUrl = SilverlightUrl, SilverlightErrorHandlerUrl = SilverlightErrorHandlerUrl, Parameters = parameters }; return state; } protected override void LoadControlState(object savedState) { var state = (State)savedState; SilverlightUrl = state.SilverlightUrl; SilverlightErrorHandlerUrl = state.SilverlightErrorHandlerUrl; parameters = state.Parameters; base.LoadControlState(state.BaseState); } }">
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
	<link href="https://github.com/timvw" rel="me">
    <link href="https://timvw.be/" rel="me">
    <link href="https://fosstodon.org/@timvw" rel="me">
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li><li><a rel="me" href="https://fosstodon.org/@timvw" class="masto-link" ></a></li>
			</ul>
		
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../../../">Home</a>
			</li>
			
			<li>
				<a href="../../../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">21</span>
							<span class="rest">Nov 2009</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Easy pattern for Control state</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>If you have decided that your WebControl requires to maintain it&rsquo;s state you will want to figure out how to implement Control state. Most examples on the web will then create an array of objects and then hardcode the indices to find stuff back&hellip; Simply define a serializable inner class and use that instead of the &lsquo;magic array object&rsquo;. Eg</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">class</span> <span style="color:#1f2328">SilverlightHost</span> <span style="color:#1f2328">:</span> WebControl
</span></span><span style="display:flex;"><span><span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">	[Serializable]</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">class</span> <span style="color:#1f2328">State</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">public</span> <span style="color:#cf222e">object</span> BaseState <span style="color:#1f2328">{</span> <span style="color:#cf222e">get</span><span style="color:#1f2328">;</span> <span style="color:#cf222e">set</span><span style="color:#1f2328">;</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">public</span> <span style="color:#cf222e">string</span> SilverlightUrl <span style="color:#1f2328">{</span> <span style="color:#cf222e">get</span><span style="color:#1f2328">;</span> <span style="color:#cf222e">set</span><span style="color:#1f2328">;</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">public</span> <span style="color:#cf222e">string</span> SilverlightErrorHandlerUrl <span style="color:#1f2328">{</span> <span style="color:#cf222e">get</span><span style="color:#1f2328">;</span> <span style="color:#cf222e">set</span><span style="color:#1f2328">;</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">public</span> Dictionary<span style="color:#1f2328">&lt;</span><span style="color:#cf222e">string</span><span style="color:#1f2328">,</span> <span style="color:#cf222e">string</span><span style="color:#1f2328">&gt;</span> Parameters <span style="color:#1f2328">{</span> <span style="color:#cf222e">get</span><span style="color:#1f2328">;</span> <span style="color:#cf222e">set</span><span style="color:#1f2328">;</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">protected</span> <span style="color:#cf222e">override</span> <span style="color:#cf222e">void</span> OnInit<span style="color:#1f2328">(</span>EventArgs e<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">base</span><span style="color:#1f2328">.</span>OnInit<span style="color:#1f2328">(</span>e<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>		Page<span style="color:#1f2328">.</span>RegisterRequiresControlState<span style="color:#1f2328">(</span><span style="color:#cf222e">this</span><span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">protected</span> <span style="color:#cf222e">override</span> <span style="color:#cf222e">object</span> SaveControlState<span style="color:#1f2328">()</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">var</span> state <span style="color:#1f2328">=</span> <span style="color:#cf222e">new</span> State
</span></span><span style="display:flex;"><span>		<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>			BaseState <span style="color:#1f2328">=</span> <span style="color:#cf222e">base</span><span style="color:#1f2328">.</span>SaveControlState<span style="color:#1f2328">(),</span>
</span></span><span style="display:flex;"><span>			SilverlightUrl <span style="color:#1f2328">=</span> SilverlightUrl<span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>			SilverlightErrorHandlerUrl <span style="color:#1f2328">=</span> SilverlightErrorHandlerUrl<span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>			Parameters <span style="color:#1f2328">=</span> parameters
</span></span><span style="display:flex;"><span>		<span style="color:#1f2328">};</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">return</span> state<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">protected</span> <span style="color:#cf222e">override</span> <span style="color:#cf222e">void</span> LoadControlState<span style="color:#1f2328">(</span><span style="color:#cf222e">object</span> savedState<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">var</span> state <span style="color:#1f2328">=</span> <span style="color:#1f2328">(</span>State<span style="color:#1f2328">)</span>savedState<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>		SilverlightUrl <span style="color:#1f2328">=</span> state<span style="color:#1f2328">.</span>SilverlightUrl<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>		SilverlightErrorHandlerUrl <span style="color:#1f2328">=</span> state<span style="color:#1f2328">.</span>SilverlightErrorHandlerUrl<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>		parameters <span style="color:#1f2328">=</span> state<span style="color:#1f2328">.</span>Parameters<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">base</span><span style="color:#1f2328">.</span>LoadControlState<span style="color:#1f2328">(</span>state<span style="color:#1f2328">.</span>BaseState<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span></code></pre></div>
			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../../../tags/asp.net">ASP.NET</a></li>
							
							<li><a href="../../../../tags/csharp">CSharp</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2025  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-9DP4SV12YW');
        }
      </script><script>feather.replace()</script>
</body>
</html>
