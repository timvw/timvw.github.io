<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Visual Basic on Tim Van Wassenhove&#39;s blog</title>
    <link>/tags/Visual-Basic/</link>
    <description>Recent content in Visual Basic on Tim Van Wassenhove&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 11 Sep 2009 00:00:00 +0000</lastBuildDate><atom:link href="/tags/Visual-Basic/feed.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Instruct T4 to use C# v3.5</title>
      <link>/post/2009-09-11-instruct-t4-to-use-c-v3-5/</link>
      <pubDate>Fri, 11 Sep 2009 00:00:00 +0000</pubDate>
      
      <guid>/post/2009-09-11-instruct-t4-to-use-c-v3-5/</guid>
      <description>
        
          &lt;p&gt;Consider this simple T4 template:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;&lt;/span&gt;# for (var i = 0; i &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt; 10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;++i)&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;WriteLine(&amp;#34;hello&amp;#34;);&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Trying to build the project results in a compilation error because &amp;lsquo;var&amp;rsquo; is an unknown type. A bit of research learned me that i should instruct the processor to use a specific c# version like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-xml&#34; data-lang=&#34;xml&#34;&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;&lt;/span&gt;#@ template language=&amp;#34;C#v3.5&amp;#34; inherits=&amp;#34;Microsoft.VisualStudio.TextTemplating.VSHost.ModelingTextTransformation&amp;#34; #&amp;gt;
&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;&amp;lt;&lt;/span&gt;# for (var i = 0; i &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt; 10&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;;&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;++i)&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;{&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;WriteLine(&amp;#34;hello&amp;#34;);&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;}&lt;/span&gt; &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;#&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Problem solved ðŸ™‚&lt;/p&gt;

        
      </description>
    </item>
    
    <item>
      <title>Access a control by name</title>
      <link>/post/2006-02-25-access-a-control-by-name/</link>
      <pubDate>Sat, 25 Feb 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-02-25-access-a-control-by-name/</guid>
      <description>
        
          &lt;p&gt;I know a mathematician that can do magic with stats. That&amp;rsquo;s also the reason why he works at &lt;a href=&#34;http://epp.eurostat.cec.eu.int/portal/page?_pageid=1090,30070682,1090_33076576&amp;amp;_dad=portal&amp;amp;_schema=PORTAL&#34;&gt;Eurostat&lt;/a&gt;. He&amp;rsquo;s automating a lot of his work by programming in &lt;a href=&#34;http://msdn.microsoft.com/isv/technology/vba/default.aspx&#34;&gt;Visual Basic for Applications&lt;/a&gt;. He asked me if i wanted to look at his code because he had the feeling there was a smell. Here are a couple lines&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-vb&#34; data-lang=&#34;vb&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;With&lt;/span&gt; SomeForm
.txtJanvier60.Value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vaData1(1, 2)
.txtFevrier60.Value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vaData1(1, 3)
.txtJanvier61.Value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vaData1(1, 2)
.txtFevrier61.Value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vaData1(1, 3)
...
.txtJanvier70.Value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vaData1(1, 2)
.txtFevrier70.Value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vaData1(1, 3)
&lt;span style=&#34;color:#66d9ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;With&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;It took me 5 minutes to search the web and change his code as following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-vb&#34; data-lang=&#34;vb&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Dim&lt;/span&gt; months(1) &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;String&lt;/span&gt;
months(0) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Janvier&amp;#34;&lt;/span&gt;
months(1) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Fevrier&amp;#34;&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;With&lt;/span&gt; SomeForm
&lt;span style=&#34;color:#66d9ef&#34;&gt;For&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 60 &lt;span style=&#34;color:#66d9ef&#34;&gt;to&lt;/span&gt; 70
&lt;span style=&#34;color:#66d9ef&#34;&gt;For&lt;/span&gt; j &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; 0 &lt;span style=&#34;color:#66d9ef&#34;&gt;to&lt;/span&gt; UBound(months)
.Controls(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;txt&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; months(j) &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;CStr&lt;/span&gt;(i)).Value &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vaData1(1, j &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; 2)
&lt;span style=&#34;color:#66d9ef&#34;&gt;Next&lt;/span&gt; j
&lt;span style=&#34;color:#66d9ef&#34;&gt;Next&lt;/span&gt; i
&lt;span style=&#34;color:#66d9ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;With&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
    <item>
      <title>Removing selected items from a ListBox</title>
      <link>/post/2006-02-16-removing-selected-items-from-a-listbox/</link>
      <pubDate>Thu, 16 Feb 2006 00:00:00 +0000</pubDate>
      
      <guid>/post/2006-02-16-removing-selected-items-from-a-listbox/</guid>
      <description>
        
          &lt;p&gt;Today i was experimenting with a couple of windows controls. For some reason i wasn&amp;rsquo;t able to remove the selected items from a &lt;a href=&#34;http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemwindowsformslistboxmemberstopic.asp&#34;&gt;ListBox&lt;/a&gt;. Here is the code that didn&amp;rsquo;t work&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-vbnet&#34; data-lang=&#34;vbnet&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;For&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;Each&lt;/span&gt; index &lt;span style=&#34;color:#f92672&#34;&gt;As&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;Integer&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ListBox1.SelectedIndices
	ListBox2.Items.Add(ListBox1.Items(index))
	ListBox1.Items.Remove(index)
&lt;span style=&#34;color:#66d9ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;For&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;The problem is that when you remove an item from the collection the indices change. Here is a possible solution&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-vbnet&#34; data-lang=&#34;vbnet&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;Dim&lt;/span&gt; index &lt;span style=&#34;color:#f92672&#34;&gt;As&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;Integer&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ListBox1.SelectedIndex
&lt;span style=&#34;color:#66d9ef&#34;&gt;While&lt;/span&gt; index &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;1
	ListBox2.Items.Add(ListBox1.Items(index))
	ListBox1.Items.Remove(index)
	index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ListBox1.SelectedIndex
&lt;span style=&#34;color:#66d9ef&#34;&gt;End&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;While&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
        
      </description>
    </item>
    
  </channel>
</rss>
