<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Presenting SqlCeClientFactory - Tim Van Wassenhove</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="Presenting SqlCeClientFactory"><meta itemprop=description content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it."><meta itemprop=datePublished content="2007-09-09T00:00:00+00:00"><meta itemprop=dateModified content="2021-01-04T22:47:36+01:00"><meta itemprop=wordCount content="213"><meta itemprop=keywords content="CSharp,"><meta property="og:title" content="Presenting SqlCeClientFactory"><meta property="og:description" content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it."><meta property="og:type" content="article"><meta property="og:url" content="https://timvw.be/2007/09/09/presenting-sqlceclientfactory/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2007-09-09T00:00:00+00:00"><meta property="article:modified_time" content="2021-01-04T22:47:36+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Presenting SqlCeClientFactory"><meta name=twitter:description content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it."><link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel=stylesheet type=text/css><link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://timvw.be/css/dark.css><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script>
<script src=https://timvw.be/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://timvw.be/>Tim Van Wassenhove</a></h1><div class=site-description><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social"><ul class=flat><li><a href=https://twitter.com/timvw title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://github.com/timvw title=Github><i data-feather=github></i></a></li><li><a href=https://www.linkedin.com/in/timvanwassenhove title=Linkedin><i data-feather=linkedin></i></a></li><li><a href=https://timvw.be/feed.xml title=RSS><i data-feather=rss></i></a></li><li><a class=masto-link rel=me href=https://fosstodon.org/@timvw></a></li></ul></nav></div><nav class=nav><ul class=flat><li><a href=../../../../>Home</a></li><li><a href=../../../../posts>All posts</a></li><li><a href=../../../../tags>Tags</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>09</span>
<span class=rest>Sep 2007</span></div></div><div class=matter><h1 class=title>Presenting SqlCeClientFactory</h1></div></div><div class=markdown><p>Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>SqlCeClientFactory</span> : DbProviderFactory
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>static</span> <span style=color:#000;font-weight:700>readonly</span> SqlCeClientFactory Instance = <span style=color:#000;font-weight:700>new</span> SqlCeClientFactory();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>override</span> DbCommand CreateCommand()
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>return</span> <span style=color:#000;font-weight:700>new</span> SqlCeCommand();
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>override</span> DbCommandBuilder CreateCommandBuilder()
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>return</span> <span style=color:#000;font-weight:700>new</span> SqlCeCommandBuilder();
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>override</span> DbConnection CreateConnection()
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>return</span> <span style=color:#000;font-weight:700>new</span> SqlCeConnection();
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>override</span> DbDataAdapter CreateDataAdapter()
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>return</span> <span style=color:#000;font-weight:700>new</span> SqlCeDataAdapter();
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>override</span> DbParameter CreateParameter()
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>return</span> <span style=color:#000;font-weight:700>new</span> SqlCeParameter();
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it. Anyway, here is how our App.config would look like if we wanted to register and use the SqlCeClientFactory (we could also install the assembly in the GAC and edit machine.config so that all applications can take advantage of it)</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:navy>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:navy>&lt;connectionStrings&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:navy>&lt;add</span> <span style=color:teal>name=</span><span style=color:#d14>&#34;localdb&#34;</span> <span style=color:teal>providerName=</span><span style=color:#d14>&#34;System.Data.SqlServerCe&#34;</span> <span style=color:teal>connectionString=</span><span style=color:#d14>&#34;Data Source=&#39;localdb.sdf&#39;;&#34;</span><span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:navy>&lt;/connectionStrings&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:navy>&lt;system.data&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:navy>&lt;dbProviderFactories&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:navy>&lt;add</span> <span style=color:teal>name=</span><span style=color:#d14>&#34;SQL Server Everywhere Edition Data Provider&#34;</span> <span style=color:teal>invariant=</span><span style=color:#d14>&#34;System.Data.SqlServerCe&#34;</span> <span style=color:teal>description=</span><span style=color:#d14>&#34;.NET Framework Data Provider for Microsoft SQL Server Everywhere Edition&#34;</span> <span style=color:teal>type=</span><span style=color:#d14>&#34;SqlCeApplication.SqlCeClientFactory, SqlCeApplication&#34;</span> <span style=color:navy>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:navy>&lt;/dbProviderFactories&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:navy>&lt;/system.data&gt;</span>
</span></span><span style=display:flex><span><span style=color:navy>&lt;/configuration&gt;</span>
</span></span></code></pre></div><p>And now we can use the <a href=http://www.timvw.be/helper-methods-for-dbconnection/>DbConnectionHelper</a> to create a DbConnection and do some work</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#000;font-weight:700>static</span> <span style=color:#000;font-weight:700>void</span> Main(<span style=color:#458;font-weight:700>string</span>[] args)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>using</span> (DbConnection conn = DbConnectionHelper.GetConnection(<span style=color:#d14>&#34;localdb&#34;</span>))
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		conn.Open();
</span></span><span style=display:flex><span>		<span style=color:#998;font-style:italic>// do some work...</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	Console.Write(<span style=color:#d14>&#34;{0}Press any key to continue...&#34;</span>, Environment.NewLine);
</span></span><span style=display:flex><span>	Console.ReadKey();
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><div class=tags><ul class=flat><li><a href=../../../../tags/csharp>CSharp</a></li></ul></div></div></div><div class="footer wrapper"><nav class=nav><div>2022 <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div></nav></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9DP4SV12YW",{anonymize_ip:!1})}</script><script>feather.replace()</script></body></html>