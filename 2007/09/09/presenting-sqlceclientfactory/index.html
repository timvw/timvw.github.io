<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Presenting SqlCeClientFactory - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	
  <meta itemprop="name" content="Presenting SqlCeClientFactory">
  <meta itemprop="description" content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn’t provide it. Anyway, here is how our App.config would look like if we wanted to register and use the SqlCeClientFactory (we could also install the assembly in the GAC and edit machine.config so that all applications can take advantage of it)">
  <meta itemprop="datePublished" content="2007-09-09T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-01-04T22:47:36+01:00">
  <meta itemprop="wordCount" content="213">
  <meta itemprop="keywords" content="CSharp"><meta property="og:url" content="https://timvw.be/2007/09/09/presenting-sqlceclientfactory/">
  <meta property="og:site_name" content="Tim Van Wassenhove">
  <meta property="og:title" content="Presenting SqlCeClientFactory">
  <meta property="og:description" content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn’t provide it. Anyway, here is how our App.config would look like if we wanted to register and use the SqlCeClientFactory (we could also install the assembly in the GAC and edit machine.config so that all applications can take advantage of it)">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-09-09T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-01-04T22:47:36+01:00">
    <meta property="article:tag" content="CSharp">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Presenting SqlCeClientFactory">
  <meta name="twitter:description" content="Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory
public class SqlCeClientFactory : DbProviderFactory { public static readonly SqlCeClientFactory Instance = new SqlCeClientFactory(); public override DbCommand CreateCommand() { return new SqlCeCommand(); } public override DbCommandBuilder CreateCommandBuilder() { return new SqlCeCommandBuilder(); } public override DbConnection CreateConnection() { return new SqlCeConnection(); } public override DbDataAdapter CreateDataAdapter() { return new SqlCeDataAdapter(); } public override DbParameter CreateParameter() { return new SqlCeParameter(); } } As you can see, the implementation is trivial, so i still wonder why microsoft didn’t provide it. Anyway, here is how our App.config would look like if we wanted to register and use the SqlCeClientFactory (we could also install the assembly in the GAC and edit machine.config so that all applications can take advantage of it)">
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
	<link href="https://github.com/timvw" rel="me">
    <link href="https://timvw.be/" rel="me">
    <link href="https://fosstodon.org/@timvw" rel="me">
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li><li><a rel="me" href="https://fosstodon.org/@timvw" class="masto-link" ></a></li>
			</ul>
		
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../../../">Home</a>
			</li>
			
			<li>
				<a href="../../../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../../../tags">Tags</a>
			</li>
			
			<li>
				<a href="../../../../contact/">Contact</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">09</span>
							<span class="rest">Sep 2007</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Presenting SqlCeClientFactory</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Apart from Microsoft.SqlServerCe.Client.SqlCeClientFactory in Microsoft.SqlServerCe.Client (an undocumented and unsupported library) there is no DbProviderFactory for System.Data.SqlServerCe. Today i decided to write a SqlCeClientFactory</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">public</span> <span style="color:#cf222e">class</span> <span style="color:#1f2328">SqlCeClientFactory</span> <span style="color:#1f2328">:</span> DbProviderFactory
</span></span><span style="display:flex;"><span><span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">static</span> <span style="color:#cf222e">readonly</span> SqlCeClientFactory Instance <span style="color:#1f2328">=</span> <span style="color:#cf222e">new</span> SqlCeClientFactory<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">override</span> DbCommand CreateCommand<span style="color:#1f2328">()</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">return</span> <span style="color:#cf222e">new</span> SqlCeCommand<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">override</span> DbCommandBuilder CreateCommandBuilder<span style="color:#1f2328">()</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">return</span> <span style="color:#cf222e">new</span> SqlCeCommandBuilder<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">override</span> DbConnection CreateConnection<span style="color:#1f2328">()</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">return</span> <span style="color:#cf222e">new</span> SqlCeConnection<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">override</span> DbDataAdapter CreateDataAdapter<span style="color:#1f2328">()</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">return</span> <span style="color:#cf222e">new</span> SqlCeDataAdapter<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">override</span> DbParameter CreateParameter<span style="color:#1f2328">()</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">return</span> <span style="color:#cf222e">new</span> SqlCeParameter<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span></code></pre></div><p>As you can see, the implementation is trivial, so i still wonder why microsoft didn&rsquo;t provide it. Anyway, here is how our App.config would look like if we wanted to register and use the SqlCeClientFactory (we could also install the assembly in the GAC and edit machine.config so that all applications can take advantage of it)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#0550ae">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0550ae">&lt;connectionStrings&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#0550ae">&lt;add</span> <span style="color:#1f2328">name=</span><span style="color:#0a3069">&#34;localdb&#34;</span> <span style="color:#1f2328">providerName=</span><span style="color:#0a3069">&#34;System.Data.SqlServerCe&#34;</span> <span style="color:#1f2328">connectionString=</span><span style="color:#0a3069">&#34;Data Source=&#39;localdb.sdf&#39;;&#34;</span><span style="color:#0550ae">/&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0550ae">&lt;/connectionStrings&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0550ae">&lt;system.data&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#0550ae">&lt;dbProviderFactories&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#0550ae">&lt;add</span> <span style="color:#1f2328">name=</span><span style="color:#0a3069">&#34;SQL Server Everywhere Edition Data Provider&#34;</span> <span style="color:#1f2328">invariant=</span><span style="color:#0a3069">&#34;System.Data.SqlServerCe&#34;</span> <span style="color:#1f2328">description=</span><span style="color:#0a3069">&#34;.NET Framework Data Provider for Microsoft SQL Server Everywhere Edition&#34;</span> <span style="color:#1f2328">type=</span><span style="color:#0a3069">&#34;SqlCeApplication.SqlCeClientFactory, SqlCeApplication&#34;</span> <span style="color:#0550ae">/&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#0550ae">&lt;/dbProviderFactories&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#0550ae">&lt;/system.data&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#0550ae">&lt;/configuration&gt;</span>
</span></span></code></pre></div><p>And now we can use the <a href="http://www.timvw.be/helper-methods-for-dbconnection/">DbConnectionHelper</a> to create a DbConnection and do some work</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">static</span> <span style="color:#cf222e">void</span> Main<span style="color:#1f2328">(</span><span style="color:#cf222e">string</span><span style="color:#1f2328">[]</span> args<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">using</span> <span style="color:#1f2328">(</span>DbConnection conn <span style="color:#1f2328">=</span> DbConnectionHelper<span style="color:#1f2328">.</span>GetConnection<span style="color:#1f2328">(</span><span style="color:#0a3069">&#34;localdb&#34;</span><span style="color:#1f2328">))</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		conn<span style="color:#1f2328">.</span>Open<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#57606a">// do some work...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	Console<span style="color:#1f2328">.</span>Write<span style="color:#1f2328">(</span><span style="color:#0a3069">&#34;{0}Press any key to continue...&#34;</span><span style="color:#1f2328">,</span> Environment<span style="color:#1f2328">.</span>NewLine<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>	Console<span style="color:#1f2328">.</span>ReadKey<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span></code></pre></div>
			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../../../tags/csharp">CSharp</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2025  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-9DP4SV12YW');
        }
      </script><script>feather.replace()</script>
</body>
</html>
