<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Developing a DataSource for your DataGridView - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Developing a DataSource for your DataGridView">
<meta itemprop="description" content="Imagine that you want to develop a DataSource that is capable to represent the data displayed in the following excel sheet
For each region the values are given. The YEAR value is defined as the sum of Q1, Q2, Q3 and Q4, eg: for EMEA this is SUM(B2:E2). The GLOBAL values are calculated as the sum of the regions for the quarter, eg: for Q1 this is SUM(B2:B5). We&rsquo;ll start with the easiest task: Add columns to the DGV and define the headers"><meta itemprop="datePublished" content="2007-01-04T00:00:00+00:00" />
<meta itemprop="dateModified" content="2021-01-04T22:47:36+01:00" />
<meta itemprop="wordCount" content="411">
<meta itemprop="keywords" content="CSharp,Windows Forms," /><meta property="og:title" content="Developing a DataSource for your DataGridView" />
<meta property="og:description" content="Imagine that you want to develop a DataSource that is capable to represent the data displayed in the following excel sheet
For each region the values are given. The YEAR value is defined as the sum of Q1, Q2, Q3 and Q4, eg: for EMEA this is SUM(B2:E2). The GLOBAL values are calculated as the sum of the regions for the quarter, eg: for Q1 this is SUM(B2:B5). We&rsquo;ll start with the easiest task: Add columns to the DGV and define the headers" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://timvw.be/2007/01/04/developing-a-datasource-for-your-datagridview/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2007-01-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-01-04T22:47:36+01:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Developing a DataSource for your DataGridView"/>
<meta name="twitter:description" content="Imagine that you want to develop a DataSource that is capable to represent the data displayed in the following excel sheet
For each region the values are given. The YEAR value is defined as the sum of Q1, Q2, Q3 and Q4, eg: for EMEA this is SUM(B2:E2). The GLOBAL values are calculated as the sum of the regions for the quarter, eg: for Q1 this is SUM(B2:B5). We&rsquo;ll start with the easiest task: Add columns to the DGV and define the headers"/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li><li><a class="masto-link" rel="me" href="https://fosstodon.org/@timvw"></a></li>
			</ul>
		
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../../../">Home</a>
			</li>
			
			<li>
				<a href="../../../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">04</span>
							<span class="rest">Jan 2007</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Developing a DataSource for your DataGridView</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Imagine that you want to develop a DataSource that is capable to represent the data displayed in the following excel sheet</p>
<p><img src="http://www.timvw.be/wp-content/images/dgv-ds-1.gif" alt="screenshot of excel sheet"></p>
<p>For each region the values are given. The YEAR value is defined as the sum of Q1, Q2, Q3 and Q4, eg: for EMEA this is SUM(B2:E2). The GLOBAL values are calculated as the sum of the regions for the quarter, eg: for Q1 this is SUM(B2:B5). We&rsquo;ll start with the easiest task: Add columns to the DGV and define the headers</p>
<p><img src="http://www.timvw.be/wp-content/images/dgv-ds-2.gif" alt="screenshot of first datagridview"></p>
<p>If we look at the DGV it becomes clear that each row exists out of a Label, values for Q1 to Q4 and the sum of those values. If we translate this to code we end up with something like: <a href="http://www.timvw.be/wp-content/code/csharp/SalesRow.txt">SalesRow</a></p>
<p>I&rsquo;ve implemented <a href="http://msdn2.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx">INotifyPropertyChanged</a> because i want the DGV to request and display the updated Year value when one of the quarterly values changes. Configure the Columns to use these properties as DataPropertyName and add a couple of SalesRow instances to a <a href="http://msdn2.microsoft.com/en-us/library/ms132679.aspx">BindingList</a> that we use as DataSource for the DGV.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> Form1()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	InitializeComponent();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.dataGridView1.AutoGenerateColumns = <span style="color:#000;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnRegion.DataPropertyName = <span style="color:#d14">&#34;Label&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ1.DataPropertyName = <span style="color:#d14">&#34;Q1&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ2.DataPropertyName = <span style="color:#d14">&#34;Q2&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ3.DataPropertyName = <span style="color:#d14">&#34;Q3&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ4.DataPropertyName = <span style="color:#d14">&#34;Q4&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnYear.DataPropertyName = <span style="color:#d14">&#34;Year&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	BindingList&lt;salesRow&gt; bindingList = <span style="color:#000;font-weight:bold">new</span> BindingList&lt;salesRow&gt;();
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;EMEA&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span> }));
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;LATAM&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span> }));
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;APAC&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span> }));
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;NORAM&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span> }));
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource = bindingList;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Notice that the Year value is nicely updated when the user changes one of the quarterly values</p>
<p><img src="http://www.timvw.be/wp-content/images/dgv-ds-3.gif" alt="screenshot of datagridview with rows for regions."></p>
<p>In order to calculate the GLOBAL values we inherit from the SalesRow class and override the implementation for the Q1, Q2, Q3, Q4 and Year properties: <a href="http://www.timvw.be/wp-content/code/csharp/GlobalSalesRow.txt">GlobalSalesRow</a>.</p>
<p>Finally we can wrap everyting in a <a href="http://www.timvw.be/wp-content/code/csharp/SalesRows.txt">SalesRows</a> class to represent our Data. Hooking this code up is as easy as</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> Form1()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	InitializeComponent();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.dataGridView1.AutoGenerateColumns = <span style="color:#000;font-weight:bold">false</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnRegion.DataPropertyName = <span style="color:#d14">&#34;Label&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ1.DataPropertyName = <span style="color:#d14">&#34;Q1&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ2.DataPropertyName = <span style="color:#d14">&#34;Q2&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ3.DataPropertyName = <span style="color:#d14">&#34;Q3&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnQ4.DataPropertyName = <span style="color:#d14">&#34;Q4&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.ColumnYear.DataPropertyName = <span style="color:#d14">&#34;Year&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	BindingList&lt;salesRow&gt; bindingList = <span style="color:#000;font-weight:bold">new</span> BindingList&lt;salesRow&gt;();
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;EMEA&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span> }));
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;LATAM&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span> }));
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;APAC&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span>, <span style="color:#099">100</span> }));
</span></span><span style="display:flex;"><span>	bindingList.Add(<span style="color:#000;font-weight:bold">new</span> SalesRow(<span style="color:#d14">&#34;NORAM&#34;</span>, <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">int</span>[] { <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span>, <span style="color:#099">150</span> }));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	SalesRows salesRows = <span style="color:#000;font-weight:bold">new</span> SalesRows(bindingList);
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataMember = <span style="color:#d14">&#34;Rows&#34;</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource = salesRows;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And here is a screenshot of the result</p>
<p><img src="http://www.timvw.be/wp-content/images/dgv-ds-4.gif" alt="screenshot of the complete implementation at work"></p>
<p>Feel free to download the complete project: <a href="http://www.timvw.be/wp-content/code/csharp/DataGridViewDataSource.zip">DataGridViewDataSource.zip</a>.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../../../tags/csharp">CSharp</a></li>
							
							<li><a href="../../../../tags/windows-forms">Windows Forms</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2022  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-9DP4SV12YW', { 'anonymize_ip': false });
}
</script>
<script>feather.replace()</script>
</body>
</html>
