<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Introduction to Akka - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta itemprop="name" content="Introduction to Akka">
<meta itemprop="description" content="Functional programming is all about immutable data and pure functions.
Akka is nothing like that.
The core concept in Akka is an Actor that handles messages (function invocations).
Here is how this looks like in practice:
trait Actor { type Receive = PartialFunction[Any, Unit] def receive: Actor.Receive } As you can see there is nothing pure about the receive function (It is a PartialFunction returning Unit).
In order to call the receive function you have to send the actor a message via it&rsquo;s !">
<meta itemprop="dateModified" content="2021-01-04T15:19:18+01:00" />
<meta itemprop="wordCount" content="490">



<meta itemprop="keywords" content="" />
<meta property="og:title" content="Introduction to Akka" />
<meta property="og:description" content="Functional programming is all about immutable data and pure functions.
Akka is nothing like that.
The core concept in Akka is an Actor that handles messages (function invocations).
Here is how this looks like in practice:
trait Actor { type Receive = PartialFunction[Any, Unit] def receive: Actor.Receive } As you can see there is nothing pure about the receive function (It is a PartialFunction returning Unit).
In order to call the receive function you have to send the actor a message via it&rsquo;s !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://timvw.be/draft/introduction-to-akka/" />
<meta property="article:modified_time" content="2021-01-04T15:19:18+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction to Akka"/>
<meta name="twitter:description" content="Functional programming is all about immutable data and pure functions.
Akka is nothing like that.
The core concept in Akka is an Actor that handles messages (function invocations).
Here is how this looks like in practice:
trait Actor { type Receive = PartialFunction[Any, Unit] def receive: Actor.Receive } As you can see there is nothing pure about the receive function (It is a PartialFunction returning Unit).
In order to call the receive function you have to send the actor a message via it&rsquo;s !"/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav></div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../post">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
				<div class="matter">
					<h1 class="title">Introduction to Akka</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Functional programming is all about immutable data and pure functions.</p>
<p>Akka is nothing like that.</p>
<p>The core concept in Akka is an Actor that handles messages (function invocations).</p>
<p>Here is how this looks like in practice:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#000;font-weight:bold">trait</span> <span style="color:#458;font-weight:bold">Actor</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000;font-weight:bold">type</span> <span style="color:#458;font-weight:bold">Receive</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">PartialFunction</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">Any</span>, <span style="color:#458;font-weight:bold">Unit</span><span style="color:#000;font-weight:bold">]</span>

  <span style="color:#000;font-weight:bold">def</span> receive<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Actor.Receive</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>As you can see there is nothing pure about the receive function (It is a <a href="http://www.scala-lang.org/api/current/#scala.PartialFunction">PartialFunction</a> returning <a href="http://www.scala-lang.org/api/current/#scala.Unit">Unit</a>).</p>
<p>In order to call the receive function you have to send the actor a message via it&rsquo;s ! or tell method. Here is how those methods are defined:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#000;font-weight:bold">trait</span> <span style="color:#458;font-weight:bold">ScalaActorRef</span> <span style="color:#000;font-weight:bold">{</span> ref<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorRef</span> <span style="color:#000;font-weight:bold">⇒</span>
  <span style="color:#000;font-weight:bold">def</span> <span style="color:#000;font-weight:bold">!(</span>message<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Any</span><span style="color:#000;font-weight:bold">)(</span><span style="color:#000;font-weight:bold">implicit</span> sender<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorRef</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">Actor</span><span style="color:#000;font-weight:bold">.</span>noSender<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Unit</span>
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000;font-weight:bold">abstract</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ActorRef</span> <span style="color:#000;font-weight:bold">extends</span> java<span style="color:#000;font-weight:bold">.</span>lang<span style="color:#000;font-weight:bold">.</span><span style="color:#458;font-weight:bold">Comparable</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">ActorRef</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">with</span> <span style="color:#458;font-weight:bold">Serializable</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000;font-weight:bold">final</span> <span style="color:#000;font-weight:bold">def</span> tell<span style="color:#000;font-weight:bold">(</span>msg<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Any</span><span style="color:#000;font-weight:bold">,</span> sender<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorRef</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Unit</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.!(</span>msg<span style="color:#000;font-weight:bold">)(</span>sender<span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>So what happens behind the scenes when you send a message? It depends on the implementation of ActorRef. Let&rsquo;s start with the LocalActorRef:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#000;font-weight:bold">private</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">akka</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">LocalActorRef</span> <span style="color:#000;font-weight:bold">private</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">akka</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">val</span> actorCell<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorCell</span> <span style="color:#000;font-weight:bold">=</span> newActorCell<span style="color:#000;font-weight:bold">(</span><span style="color:#458;font-weight:bold">_system</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">_props</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">_dispatcher</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">_supervisor</span><span style="color:#000;font-weight:bold">)</span>
  actorCell<span style="color:#000;font-weight:bold">.</span>init<span style="color:#000;font-weight:bold">(</span>sendSupervise <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">_mailboxType</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000;font-weight:bold">override</span> <span style="color:#000;font-weight:bold">def</span> <span style="color:#000;font-weight:bold">!(</span>message<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Any</span><span style="color:#000;font-weight:bold">)(</span><span style="color:#000;font-weight:bold">implicit</span> sender<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorRef</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">Actor</span><span style="color:#000;font-weight:bold">.</span>noSender<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Unit</span> <span style="color:#000;font-weight:bold">=</span> actorCell<span style="color:#000;font-weight:bold">.</span>sendMessage<span style="color:#000;font-weight:bold">(</span>message<span style="color:#000;font-weight:bold">,</span> sender<span style="color:#000;font-weight:bold">)</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>So what is that actorCell? -&gt; forward to Dispatch</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#000;font-weight:bold">private</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">akka</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">trait</span> <span style="color:#458;font-weight:bold">Dispatch</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000;font-weight:bold">def</span> sendMessage<span style="color:#000;font-weight:bold">(</span>msg<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Envelope</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Unit</span> <span style="color:#000;font-weight:bold">=</span>
    <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
      <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>system<span style="color:#000;font-weight:bold">.</span>settings<span style="color:#000;font-weight:bold">.</span><span style="color:#458;font-weight:bold">SerializeAllMessages</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        <span style="color:#000;font-weight:bold">val</span> unwrapped <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>msg<span style="color:#000;font-weight:bold">.</span>message <span style="color:#000;font-weight:bold">match</span> <span style="color:#000;font-weight:bold">{</span>
          <span style="color:#000;font-weight:bold">case</span> <span style="color:#458;font-weight:bold">DeadLetter</span><span style="color:#000;font-weight:bold">(</span>wrapped<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">_</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">_</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">⇒</span> wrapped
          <span style="color:#000;font-weight:bold">case</span> other                     <span style="color:#000;font-weight:bold">⇒</span> other
        <span style="color:#000;font-weight:bold">}).</span>asInstanceOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">AnyRef</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(!</span>unwrapped<span style="color:#000;font-weight:bold">.</span>isInstanceOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">NoSerializationVerificationNeeded</span><span style="color:#000;font-weight:bold">])</span> <span style="color:#000;font-weight:bold">{</span>
          <span style="color:#000;font-weight:bold">val</span> s <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">SerializationExtension</span><span style="color:#000;font-weight:bold">(</span>system<span style="color:#000;font-weight:bold">)</span>
          <span style="color:#000;font-weight:bold">val</span> serializer <span style="color:#000;font-weight:bold">=</span> s<span style="color:#000;font-weight:bold">.</span>findSerializerFor<span style="color:#000;font-weight:bold">(</span>unwrapped<span style="color:#000;font-weight:bold">)</span>
          <span style="color:#000;font-weight:bold">val</span> bytes <span style="color:#000;font-weight:bold">=</span> serializer<span style="color:#000;font-weight:bold">.</span>toBinary<span style="color:#000;font-weight:bold">(</span>unwrapped<span style="color:#000;font-weight:bold">)</span>
          serializer <span style="color:#000;font-weight:bold">match</span> <span style="color:#000;font-weight:bold">{</span>
            <span style="color:#000;font-weight:bold">case</span> ser2<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">SerializerWithStringManifest</span> <span style="color:#000;font-weight:bold">⇒</span>
              <span style="color:#000;font-weight:bold">val</span> manifest <span style="color:#000;font-weight:bold">=</span> ser2<span style="color:#000;font-weight:bold">.</span>manifest<span style="color:#000;font-weight:bold">(</span>unwrapped<span style="color:#000;font-weight:bold">)</span>
              s<span style="color:#000;font-weight:bold">.</span>deserialize<span style="color:#000;font-weight:bold">(</span>bytes<span style="color:#000;font-weight:bold">,</span> serializer<span style="color:#000;font-weight:bold">.</span>identifier<span style="color:#000;font-weight:bold">,</span> manifest<span style="color:#000;font-weight:bold">).</span>get <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span>
            <span style="color:#000;font-weight:bold">case</span> <span style="color:#000;font-weight:bold">_</span> <span style="color:#000;font-weight:bold">⇒</span>
              s<span style="color:#000;font-weight:bold">.</span>deserialize<span style="color:#000;font-weight:bold">(</span>bytes<span style="color:#000;font-weight:bold">,</span> unwrapped<span style="color:#000;font-weight:bold">.</span>getClass<span style="color:#000;font-weight:bold">).</span>get
          <span style="color:#000;font-weight:bold">}</span>
        <span style="color:#000;font-weight:bold">}</span>
      <span style="color:#000;font-weight:bold">}</span>
      dispatcher<span style="color:#000;font-weight:bold">.</span>dispatch<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">,</span> msg<span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> handleException
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>So, what happens when you create an ActorSystem?</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#000;font-weight:bold">object</span> <span style="color:#458;font-weight:bold">ActorSystem</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000;font-weight:bold">def</span> apply<span style="color:#000;font-weight:bold">()</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorSystem</span> <span style="color:#000;font-weight:bold">=</span> apply<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;default&#34;</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000;font-weight:bold">def</span> apply<span style="color:#000;font-weight:bold">(</span>name<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">String</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorSystem</span> <span style="color:#000;font-weight:bold">=</span> apply<span style="color:#000;font-weight:bold">(</span>name<span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">None</span><span style="color:#000;font-weight:bold">)</span>
  <span style="color:#000;font-weight:bold">def</span> apply<span style="color:#000;font-weight:bold">(</span>name<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">String</span><span style="color:#000;font-weight:bold">,</span> config<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Option</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">Config</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span> classLoader<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Option</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">ClassLoader</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">None</span><span style="color:#000;font-weight:bold">,</span> defaultExecutionContext<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Option</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">ExecutionContext</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">None</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorSystem</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">val</span> cl <span style="color:#000;font-weight:bold">=</span> classLoader<span style="color:#000;font-weight:bold">.</span>getOrElse<span style="color:#000;font-weight:bold">(</span>findClassLoader<span style="color:#000;font-weight:bold">())</span>
    <span style="color:#000;font-weight:bold">val</span> appConfig <span style="color:#000;font-weight:bold">=</span> config<span style="color:#000;font-weight:bold">.</span>getOrElse<span style="color:#000;font-weight:bold">(</span><span style="color:#458;font-weight:bold">ConfigFactory</span><span style="color:#000;font-weight:bold">.</span>load<span style="color:#000;font-weight:bold">(</span>cl<span style="color:#000;font-weight:bold">))</span>
    <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">ActorSystemImpl</span><span style="color:#000;font-weight:bold">(</span>name<span style="color:#000;font-weight:bold">,</span> appConfig<span style="color:#000;font-weight:bold">,</span> cl<span style="color:#000;font-weight:bold">,</span> defaultExecutionContext<span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">None</span><span style="color:#000;font-weight:bold">).</span>start<span style="color:#000;font-weight:bold">()</span>
  <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>So, what happens when you create an Actor?</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#000;font-weight:bold">private</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">akka</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ActorSystemImpl</span><span style="color:#000;font-weight:bold">(</span>
  <span style="color:#000;font-weight:bold">def</span> actorOf<span style="color:#000;font-weight:bold">(</span>props<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">Props</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorRef</span> <span style="color:#000;font-weight:bold">=</span>
    <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>guardianProps<span style="color:#000;font-weight:bold">.</span>isEmpty<span style="color:#000;font-weight:bold">)</span> guardian<span style="color:#000;font-weight:bold">.</span>underlying<span style="color:#000;font-weight:bold">.</span>attachChild<span style="color:#000;font-weight:bold">(</span>props<span style="color:#000;font-weight:bold">,</span> systemService <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">throw</span> <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">UnsupportedOperationException</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;cannot create top-level actor from the outside on ActorSystem with custom user guardian&#34;</span><span style="color:#000;font-weight:bold">)</span>

  <span style="color:#000;font-weight:bold">def</span> guardian<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">LocalActorRef</span> <span style="color:#000;font-weight:bold">=</span> provider<span style="color:#000;font-weight:bold">.</span>guardian

  <span style="color:#000;font-weight:bold">val</span> provider<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">ActorRefProvider</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">val</span> arguments <span style="color:#000;font-weight:bold">=</span> <span style="color:#458;font-weight:bold">Vector</span><span style="color:#000;font-weight:bold">(</span>
      classOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">String</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">→</span> name<span style="color:#000;font-weight:bold">,</span>
      classOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">Settings</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">→</span> settings<span style="color:#000;font-weight:bold">,</span>
      classOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">EventStream</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">→</span> eventStream<span style="color:#000;font-weight:bold">,</span>
      classOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">DynamicAccess</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">→</span> dynamicAccess<span style="color:#000;font-weight:bold">)</span>

    dynamicAccess<span style="color:#000;font-weight:bold">.</span>createInstanceFor<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">ActorRefProvider</span><span style="color:#000;font-weight:bold">](</span><span style="color:#458;font-weight:bold">ProviderClass</span><span style="color:#000;font-weight:bold">,</span> arguments<span style="color:#000;font-weight:bold">).</span>get
  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">case</span> <span style="color:#458;font-weight:bold">NonFatal</span><span style="color:#000;font-weight:bold">(</span>e<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">⇒</span>
      <span style="color:#458;font-weight:bold">Try</span><span style="color:#000;font-weight:bold">(</span>stopScheduler<span style="color:#000;font-weight:bold">())</span>
      <span style="color:#000;font-weight:bold">throw</span> e
  <span style="color:#000;font-weight:bold">}</span>

<span style="color:#000;font-weight:bold">object</span> <span style="color:#458;font-weight:bold">ActorSystem</span> <span style="color:#000;font-weight:bold">{</span>
  <span style="color:#000;font-weight:bold">final</span> <span style="color:#000;font-weight:bold">val</span> <span style="color:#458;font-weight:bold">ProviderClass</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">String</span> <span style="color:#000;font-weight:bold">=</span>
    getString<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;akka.actor.provider&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">match</span> <span style="color:#000;font-weight:bold">{</span>
      <span style="color:#000;font-weight:bold">case</span> <span style="color:#d14">&#34;local&#34;</span>   <span style="color:#000;font-weight:bold">⇒</span> classOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">LocalActorRefProvider</span><span style="color:#000;font-weight:bold">].</span>getName
      <span style="color:#998;font-style:italic">// these two cannot be referenced by class as they may not be on the classpath
</span><span style="color:#998;font-style:italic"></span>      <span style="color:#000;font-weight:bold">case</span> <span style="color:#d14">&#34;remote&#34;</span>  <span style="color:#000;font-weight:bold">⇒</span> <span style="color:#d14">&#34;akka.remote.RemoteActorRefProvider&#34;</span>
      <span style="color:#000;font-weight:bold">case</span> <span style="color:#d14">&#34;cluster&#34;</span> <span style="color:#000;font-weight:bold">⇒</span> <span style="color:#d14">&#34;akka.cluster.ClusterActorRefProvider&#34;</span>
      <span style="color:#000;font-weight:bold">case</span> fqcn      <span style="color:#000;font-weight:bold">⇒</span> fqcn
    <span style="color:#000;font-weight:bold">}</span>  
<span style="color:#000;font-weight:bold">}</span>

<span style="color:#000;font-weight:bold">private</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">akka</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">LocalActorRefProvider</span> <span style="color:#000;font-weight:bold">private</span><span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">akka</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000;font-weight:bold">(</span>
  <span style="color:#000;font-weight:bold">override</span> <span style="color:#000;font-weight:bold">lazy</span> <span style="color:#000;font-weight:bold">val</span> guardian<span style="color:#000;font-weight:bold">:</span> <span style="color:#458;font-weight:bold">LocalActorRef</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#000;font-weight:bold">val</span> cell <span style="color:#000;font-weight:bold">=</span> rootGuardian<span style="color:#000;font-weight:bold">.</span>underlying
    cell<span style="color:#000;font-weight:bold">.</span>reserveChild<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;user&#34;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000;font-weight:bold">val</span> ref <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> <span style="color:#458;font-weight:bold">LocalActorRef</span><span style="color:#000;font-weight:bold">(</span>system<span style="color:#000;font-weight:bold">,</span> system<span style="color:#000;font-weight:bold">.</span>guardianProps<span style="color:#000;font-weight:bold">.</span>getOrElse<span style="color:#000;font-weight:bold">(</span><span style="color:#458;font-weight:bold">Props</span><span style="color:#000;font-weight:bold">(</span>classOf<span style="color:#000;font-weight:bold">[</span><span style="color:#458;font-weight:bold">LocalActorRefProvider.Guardian</span><span style="color:#000;font-weight:bold">],</span> guardianStrategy<span style="color:#000;font-weight:bold">)),</span>
      defaultDispatcher<span style="color:#000;font-weight:bold">,</span> defaultMailbox<span style="color:#000;font-weight:bold">,</span> rootGuardian<span style="color:#000;font-weight:bold">,</span> rootPath <span style="color:#000;font-weight:bold">/</span> <span style="color:#d14">&#34;user&#34;</span><span style="color:#000;font-weight:bold">)</span>
    cell<span style="color:#000;font-weight:bold">.</span>initChild<span style="color:#000;font-weight:bold">(</span>ref<span style="color:#000;font-weight:bold">)</span>
    ref<span style="color:#000;font-weight:bold">.</span>start<span style="color:#000;font-weight:bold">()</span>
    ref
  <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>You can read more about the <a href="http://doc.akka.io/docs/akka/current/general/supervision.html">Guardians</a></p>

			</div>

			<div class="tags">
				
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
