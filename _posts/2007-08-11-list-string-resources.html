---
layout: post
status: publish
published: true
title: List string resources
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 189
wordpress_url: http://www.timvw.be/list-string-resources/
date: '2007-08-11 19:05:34 +0200'
date_gmt: '2007-08-11 17:05:34 +0200'
categories: []
tags:
- C#
comments: []
---
<p>Earlier today someone asked how he could list the string resources (name, value and comment) in a Resource file. Here is some code that generates a nice list of the information:<&#47;p><br />
[code lang="csharp"]<br />
static void Main(string[] args)<br />
{<br />
 DislayResourceStrings(GetResourceStrings(@"C:\Resource1.resx"));</p>
<p> Console.Write("{0}Press any key to continue...", Environment.NewLine);<br />
 Console.ReadKey();<br />
}</p>
<p>public static List<resourceString> GetResourceStrings(string path)<br />
{<br />
 List<resourceString> resourceStrings = new List<resourceString>();</p>
<p> XPathDocument doc = new XPathDocument(path);<br />
 foreach (XPathNavigator node in doc.CreateNavigator().Select("&#47;&#47;data"))<br />
 {<br />
  string type = node.GetAttribute("type", string.Empty);<br />
  if (type == string.Empty)<br />
  {<br />
   XPathNavigator nav;</p>
<p>   string name = node.GetAttribute("name", string.Empty);<br />
   nav = node.SelectSingleNode(".&#47;value");<br />
   string value = nav != null ? nav.Value : string.Empty;</p>
<p>   nav = node.SelectSingleNode(".&#47;comment");<br />
   string comment = nav != null ? nav.Value : string.Empty;</p>
<p>   resourceStrings.Add(new ResourceString(name, value, comment));<br />
  }<br />
 }</p>
<p>  return resourceStrings;<br />
}</p>
<p>public static void DisplayResourceStrings(List<resourceString> resourceStrings)<br />
{<br />
 string format = "{0, -25} {1, -25} {2, -25}";<br />
 Console.WriteLine(format, "Name", "Value", "Comment");<br />
 Console.WriteLine(format, "----", "-----", "-------");</p>
<p> foreach (ResourceString resourceString in resourceStrings)<br />
 {<br />
  Console.WriteLine(format, resourceString.Name, resourceString.Value, resourceString.Comment);<br />
 }<br />
}</p>
<p>public struct ResourceString<br />
{<br />
 public string Name;<br />
 public string Value;<br />
 public string Comment;</p>
<p> public ResourceString(string name, string value, string comment)<br />
 {<br />
  this.Name = name;<br />
  this.Value = value;<br />
  this.Comment = comment;<br />
 }<br />
}[&#47;code]</p>
