---
layout: post
status: publish
published: true
title: Invoke parameterized stored procedure with PowerShell
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 2124
wordpress_url: http://www.timvw.be/?p=2124
date: '2011-03-21 21:30:08 +0100'
date_gmt: '2011-03-21 20:30:08 +0100'
categories:
- Uncategorized
tags:
- SQL
- PowerShell
comments: []
---
<p>Here is a quick snippet that demonstrates how you can invoke a parametrized stored procedure with PowerShell:<&#47;p></p>
<p>[code lang="powershell"]<br />
$CreateTraceCommand = $SqlConnection.CreateCommand();<br />
$CreateTraceCommand.CommandType = [System.Data.CommandType] "StoredProcedure";<br />
$CreateTraceCommand.CommandText = "sp_trace_create";<br />
$TraceIdParameter = $CreateTraceCommand.Parameters.Add("@traceid", [System.Data.SqlDbType] "Int");<br />
$TraceIdParameter.Direction = [System.Data.ParameterDirection] "Output";<br />
$OptionParameter = $CreateTraceCommand.Parameters.Add("@options", [System.Data.SqlDbType] "Int");<br />
$OptionParameter.Value = [int] 2;<br />
$TraceFileParameter = $CreateTraceCommand.Parameters.Add("@tracefile", [System.Data.SqlDbType] "NVarChar");<br />
$TraceFileParameter.Value = [string] "c:\temp\test";<br />
[void] $CreateTraceCommand.ExecuteNonQuery();<br />
$TraceId = $TraceIdParameter.Value;<br />
Write-Host "You created a trace with id: $TraceId";<br />
[&#47;code]</p>
