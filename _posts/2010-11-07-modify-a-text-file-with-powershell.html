---
layout: post
status: publish
published: true
title: Modify a text file with PowerShell
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 1962
wordpress_url: http://www.timvw.be/?p=1962
date: '2010-11-07 20:44:22 +0100'
date_gmt: '2010-11-07 19:44:22 +0100'
categories:
- Uncategorized
tags:
- PowerShell
comments:
- id: 2479
  author: Kevin Makela
  author_email: kevinmakela@msn.com
  author_url: ''
  date: '2010-12-30 00:05:29 +0100'
  date_gmt: '2010-12-29 23:05:29 +0100'
  content: "(!!!THANKS!!!)\r\n\r\nI was all set to check NTFS perms, close down the
    application, etc.\r\n\r\nGlad I checked and found your post first!"
- id: 185195
  author: Tohuw
  author_email: ron@tohuw.net
  author_url: ''
  date: '2013-04-01 21:04:56 +0200'
  date_gmt: '2013-04-01 20:04:56 +0200'
  content: Thanks! I was losing my mind over this. It's really quite silly that extra
    syntax is required to unlock the file when performing a simple read.
---
<p>A while ago i wanted to update a connection string in a configuration file. My first attempt was the following:<&#47;p></p>
<p>[code lang="powershell"]<br />
Get-Content $File<br />
| Foreach { $_ -Replace "Source>(.*?)<", "Source>$New<" }<br />
| Set-Content $File;<br />
[&#47;code]</p>
<p>Running this scripts leads to the following error: "Set-Content : The process cannot access the file because it is being used by another process." In order to avoid this you can complete the read operation before you start writing as following:<&#47;p></p>
<p>[code lang="powershell"]<br />
(Get-Content $File)<br />
| Foreach { $_ -Replace "Source>(.*?)<", "Source>$New<" }<br />
| Set-Content $File;<br />
[&#47;code]</p>
