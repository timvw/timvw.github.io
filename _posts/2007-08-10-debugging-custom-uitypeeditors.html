---
layout: post
status: publish
published: true
title: Debugging custom UITypeEditors
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 187
wordpress_url: http://www.timvw.be/debugging-custom-uitypeeditors/
date: '2007-08-10 18:26:42 +0200'
date_gmt: '2007-08-10 16:26:42 +0200'
categories: []
tags:
- C#
- Visual Studio
- Windows Forms
comments:
- id: 243
  author: Chris McKenzie
  author_email: crmckenzie@gmail.com
  author_url: http://dotnetengineer.blogspot.com
  date: '2008-01-21 22:45:25 +0100'
  date_gmt: '2008-01-21 20:45:25 +0100'
  content: Thanks for this article. You saved me some time!
- id: 244
  author: James
  author_email: james.e@minns.it
  author_url: ''
  date: '2008-09-28 12:23:01 +0200'
  date_gmt: '2008-09-28 10:23:01 +0200'
  content: Thanks for sharing this tip!
---
<p>If you read this you're probably gonna think: What a moron! Anyway, i'm sharing this in the hope that i'll be the last to undergo the following. In order to test my custom <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.drawing.design.uitypeeditor.aspx">UITypeEditor<&#47;a> i did the following:<&#47;p></p>
<ol>
<li>Create a <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.windows.forms.usercontrol.aspx">UserControl<&#47;a><&#47;li>
<li>Add a property to the control <&#47;li>
<li>Add an <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.componentmodel.editorattribute.aspx">Editor<&#47;a> attribute to the property<&#47;li>
<li>Build<&#47;li>
<li>Drag a UserControl on the designer form<&#47;li>
<li>Test via Visual Studio's Property Window if the UITypeEditor works as expected<&#47;li>
<li>Everytime i changed some code: <b>Restart Visual Studio<&#47;b>, load the project and repeat 6.<&#47;li><br />
<&#47;ol></p>
<p>A tedious task to say the least. Yesterday i figured out that i could <b>drag a <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.windows.forms.propertygrid.aspx">PropertyGrid<&#47;a> on the designer form, and set it's SelectedObject property to a class with a property that uses the custom UITypeEditor; Instead of having to reload visual studio i can simply start a debug session, and click on the property in the PropertyGrid.<&#47;b> Now it's a breeze to develop custom UITypeEditors :)<&#47;p><br />
<img src="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;images&#47;uitypeeditor.gif" alt=""&#47;><br />
[code lang="csharp"]private void Form1_Load(object sender, EventArgs e)<br />
{<br />
 &#47;&#47; display an instance of PersonEntry,<br />
 &#47;&#47; a class with a property that should use the custom UITypeEditor i want to test<br />
 this.propertyGrid1.SelectedObject = new PersonEntry(new Person("Tim", "Van Wassenhove"));<br />
}</p>
<p>public class PersonEntry<br />
{<br />
 ...</p>
<p> &#47;&#47; instruct the PropertyGrid to use my custom PersonUITypeEditor<br />
 [Editor(typeof(PersonUITypeEditor), typeof(UITypeEditor))]<br />
 public Person Person<br />
 {<br />
  get { return this.person; }<br />
  set { this.person = value; }<br />
 }<br />
}</p>
<p>public class PersonUITypeEditor : UITypeEditor<br />
{<br />
 public override UITypeEditorEditStyle GetEditStyle(ITypeDescriptorContext context)<br />
 {<br />
  return UITypeEditorEditStyle.Modal;<br />
 }</p>
<p> public override object EditValue(ITypeDescriptorContext context, IServiceProvider provider, object value)<br />
 {<br />
  Person person = value as Person;</p>
<p>  IWindowsFormsEditorService svc = context.GetService(typeof(IWindowsFormsEditorService)) as IWindowsFormsEditorService;<br />
  if (svc != null)<br />
  {<br />
   using (PersonEditorForm personEditorForm = new PersonEditorForm(person))<br />
   {<br />
    if (svc.ShowDialog(personEditorForm) == DialogResult.OK)<br />
    {<br />
     return personEditorForm.Person;<br />
    }<br />
   }<br />
  }</p>
<p>  return value;<br />
 }<br />
}[&#47;code]</p>
