---
layout: post
status: publish
published: true
title: Using System.DirectoryServices.AccountManagement to find the members of an
  AD group
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 214
wordpress_url: http://www.timvw.be/using-systemdirectoryservicesaccountmanagement-to-find-the-members-of-an-ad-group/
date: '2008-03-08 21:14:48 +0100'
date_gmt: '2008-03-08 19:14:48 +0100'
categories: []
tags:
- C#
comments:
- id: 266
  author: Gopi Kallepalli
  author_email: ''
  author_url: ''
  date: '2009-03-03 22:30:40 +0100'
  date_gmt: '2009-03-03 21:30:40 +0100'
  content: Thanks for the method. This redcued my code by a lot.
---
<p>A while ago i posted some code that demonstrated how to <a href="http:&#47;&#47;www.timvw.be&#47;find-the-members-of-an-ad-group&#47;">find the members of an AD group<&#47;a>. If you're using the brandnew .Net 3.5 framework you can take advantage of the <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.directoryservices.accountmanagement.aspx">System.DirectoryServices.AccountManagement<&#47;a> library which is an abstraction for AD (DS, LDS) and SAM accounts. Using this new library my method can be simplified:<&#47;p><br />
[code lang="csharp"]private static IEnumerable<string> FindUsernames(string groupname)<br />
{<br />
 PrincipalContext principalContext = new PrincipalContext(ContextType.Domain, "mydomain");<br />
 GroupPrincipal groupPrincipal = GroupPrincipal.FindByIdentity(principalContext, groupname);</p>
<p> foreach (Principal principal in groupPrincipal.Members)<br />
 {<br />
  yield return principal.DistinguishedName;<br />
 }<br />
}[&#47;code]</p>
<p>If you're looking for more information i would recommend that you read <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;magazine&#47;cc135979.aspx">Managing Directory Security Principals in the .NET Framework 3.5<&#47;a>.<&#47;p></p>
