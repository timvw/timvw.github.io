---
layout: post
status: publish
published: true
title: Removing Dead Tracks (Duplicates that don&#039;t exist) from iTunes using C#
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 1811
wordpress_url: http://www.timvw.be/?p=1811
date: '2010-07-20 18:59:15 +0200'
date_gmt: '2010-07-20 17:59:15 +0200'
categories: []
tags:
- C#
comments: []
---
<p>Last week i noticed the following post from Scott Hanselman: <a href="http:&#47;&#47;www.hanselman.com&#47;blog&#47;RemovingDeadTracksDuplicatesThatDontExistFromITunesUsingC.aspx">Removing Dead Tracks (Duplicates that don't exist) from iTunes using C#<&#47;a>. As a good boy scout i noticed that these days iTunesLib.IITTrackCollection inherits from IEnumerable so i rewrote the code a little:<&#47;p></p>
<p>[code lang="csharp"]class Program<br />
{<br />
 [STAThread]<br />
 static void Main()<br />
 {<br />
  var itunes = new iTunesApp();<br />
  itunes.DeleteTracksThatDoNotExist();<br />
 }<br />
}</p>
<p>public static class ITunesExtensions<br />
{<br />
 public static void DeleteTracksThatDoNotExist(this IiTunes itunes)<br />
 {<br />
  var tracksThatDoNotExist = FindTracksThatDoNotExist(itunes);<br />
  foreach (var track in tracksThatDoNotExist) track.Delete();<br />
 }</p>
<p> public static IEnumerable<iitfileOrCDTrack> FindTracksThatDoNotExist(this IiTunes iTunes)<br />
 {<br />
  return iTunes.LibraryPlaylist.Tracks<br />
   .OfType<iitfileOrCDTrack>()<br />
   .Where(track => !File.Exists(track.Location));<br />
 }<br />
}[&#47;code]</p>
