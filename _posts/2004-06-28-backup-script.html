---
layout: post
status: publish
published: true
title: Backup script
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 84
wordpress_url: http://www.timvw.be/backup-script/
date: '2004-06-28 00:55:15 +0200'
date_gmt: '2004-06-27 22:55:15 +0200'
categories: []
tags:
- Bash
comments: []
---
<p>The current shell server i'm using returns bogus output for commands like df. Mind the negative value for 1-k blocks.<&#47;p></p>
<p>timvw@localhost:~$ df<&#47;p></p>
<table>
<tr>
<td>Filesystem<&#47;td></p>
<td>1k-blocks<&#47;td></p>
<td>Used<&#47;td></p>
<td>Available<&#47;td></p>
<td>Use%<&#47;td></p>
<td>Mounted on<&#47;td><br />
<&#47;tr></p>
<tr>
<td>&#47;dev&#47;hda1<&#47;td></p>
<td><b>-780429856382<&#47;b><&#47;td></p>
<td>1<&#47;td></p>
<td>0<&#47;td></p>
<td>74%<&#47;td></p>
<td>&#47;<&#47;td><br />
<&#47;tr><br />
<&#47;table></p>
<p>It thought it would be a good idea to have a backup once in a while, but most of the times when i did it, i forgot to backup my database. So i wrote a little backup.script that remembers to do that for me.<&#47;p><br />
[code lang="bash"]<br />
#!&#47;bin&#47;bash<br />
###############################################################################<br />
# Generate a backup file of homedirectory and database<br />
# Author: Tim Van Wassenhove <timvw@users.sourceforge.net><br />
# Update: 2005-09-16 01:56:00<br />
###############################################################################<br />
# dump database<br />
mysqldump -u username -ppassword -h invalid.org dbname > ~&#47;mysql.dmp</p>
<p># generate gzipped archive of homedirectory<br />
tar -czf &#47;tmp&#47;backup.tgz ~</p>
<p># move backup to homedirectory and change name<br />
mv &#47;tmp&#47;backup.tgz ~&#47;madoka-`date +%F`.tgz</p>
<p># remove database dump<br />
rm ~&#47;mysql.dmp<br />
[&#47;code]</p>
