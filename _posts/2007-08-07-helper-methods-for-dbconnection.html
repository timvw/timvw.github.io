---
layout: post
status: publish
published: true
title: Helper methods for DbProviderFactory
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 186
wordpress_url: http://www.timvw.be/helper-methods-for-dbconnection/
date: '2007-08-07 01:12:47 +0200'
date_gmt: '2007-08-06 23:12:47 +0200'
categories: []
tags:
- C#
comments: []
---
<p>Here are a couple of functions that make it easier to take advantage of the DbProviderFactory to create DbConnections:<&#47;p><br />
[code lang="csharp"]public DbConnection GetDbConnection(string connectionStringName)<br />
{<br />
 return GetDbConnection(ConfigurationManager.ConnectionStrings[connectionStringName]);<br />
}</p>
<p>public DbConnection GetDbConnection(ConnectionStringSettings connectionStringSettings)<br />
{<br />
 return GetDbConnection(connectionStringSettings.ProviderName, connectionStringSettings.ConnectionString);<br />
}</p>
<p>public DbConnection GetDbConnection(string providerInvariantName, string connectionString)<br />
{<br />
 DbConnection connection = DbProviderFactories.GetFactory(providerInvariantName).CreateConnection();<br />
 connection.ConnectionString = connectionString;<br />
 return connection;<br />
}[&#47;code]</p>
<p>Using these functions, the pattern for querying a database could be something as following:<&#47;p><br />
[code lang="csharp"]using (DbConnection conn = GetDbConnection("Local_Northwind"))<br />
{<br />
 conn.Open();</p>
<p> using (DbCommand cmd = conn.CreateCommand())<br />
 {<br />
  cmd.CommandText = "SELECT EmployeeID, FirstName, LastName FROM Employees";<br />
  using (DbDataReader reader = cmd.ExecuteReader())<br />
  {<br />
   &#47;&#47; process the result<br />
  }<br />
 }<br />
}[&#47;code]</p>
