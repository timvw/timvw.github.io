---
layout: post
status: publish
published: true
title: DataGridView to Excel
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 159
wordpress_url: http://www.timvw.be/datagridview-to-excel/
date: '2007-04-05 20:36:34 +0200'
date_gmt: '2007-04-05 18:36:34 +0200'
categories: []
tags:
- C#
- Windows Forms
comments:
- id: 183
  author: ''
  author_email: bryanling82@hotmail.com
  author_url: ''
  date: '2007-05-14 11:37:18 +0200'
  date_gmt: '2007-05-14 09:37:18 +0200'
  content: |-
    i have problem with generate excel file from datagridview in vb.net(window app). Do you mind to show me how it code?

    thanks
- id: 184
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-05-14 11:49:48 +0200'
  date_gmt: '2007-05-14 09:49:48 +0200'
  content: Just compile my code, use  <a href="http:&#47;&#47;www.aisto.com&#47;roeder&#47;dotnet&#47;"
    rel="nofollow">Reflector<&#47;a> to decompile to vb and you're set...
- id: 185
  author: Marcus
  author_email: maurer@cityfux.de
  author_url: ''
  date: '2007-05-28 13:02:42 +0200'
  date_gmt: '2007-05-28 11:02:42 +0200'
  content: |-
    Hallo,

    I'm searching something compareable like your Datagrid to Excel Code vor VB.NET.

    All of this stuff is new for me and I have to find a quickly sollution. Can you help me with this? Sure, you will get paid for your work.

    Yours

    marcus (germany)
- id: 186
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-05-28 16:10:08 +0200'
  date_gmt: '2007-05-28 14:10:08 +0200'
  content: |-
    Apparently the reflector export code addin isn't flawless.. Anyway, here is a VB version:
    <a href="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;vb&#47;DataGridViewToExcel.zip" rel="nofollow">http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;vb&#47;DataGridViewToExcel.zip<&#47;a>
- id: 187
  author: John Askew
  author_email: johnaskew@aol.com
  author_url: ''
  date: '2007-06-28 19:05:10 +0200'
  date_gmt: '2007-06-28 17:05:10 +0200'
  content: |-
    Thanks!

    Excel 2007 complains about the format, but will open it ok when prompt is ignored.
- id: 188
  author: iain wicks
  author_email: iainwicks@smartscan.co.uk
  author_url: http://www.smartscan.com
  date: '2007-08-15 10:25:00 +0200'
  date_gmt: '2007-08-15 08:25:00 +0200'
  content: |-
    Hello Tim,
    I am also trying to export my datagridview ro excel in VB.Net 2005.

    i downloaded your example program but it won't open propperly?!

    it says.....

    Could not find type 'DataGridViewToExcel.ExcelButton'. Please make sure that the assembly that contains this type is referenced. If this type is a part of your development project, make sure that the project has been successfully built.

    how can i fix this so i can see the program running and get an idea of how i can acheive the same results in my program!!

    thanks in advance,

    Iain
- id: 189
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-08-15 10:29:42 +0200'
  date_gmt: '2007-08-15 08:29:42 +0200'
  content: |-
    Ok, i'm able to reproduce the problem: If you open the solution, and open Form1.vb in the designer.

    Solution: Rebuild the project and then open the designer again.
- id: 190
  author: iain wicks
  author_email: iainwicks@smartscan.co.uk
  author_url: http://www.smartscan.com
  date: '2007-08-15 10:31:49 +0200'
  date_gmt: '2007-08-15 08:31:49 +0200'
  content: |-
    brilliant!!
    thanks alot, hopefuly i'll be able to finish my program now!!
- id: 191
  author: iain wicks
  author_email: iainwicks@smartscan.co.uk
  author_url: http://www.smartscan.com
  date: '2007-08-15 10:38:25 +0200'
  date_gmt: '2007-08-15 08:38:25 +0200'
  content: |-
    hello again,

    how do i use that code in my program? can i just copy the class excell generator into my project??

    also how do i import carlosAg.ExcelXmlWriter from??

    sorry to be a pain!

    and once again,

    thank you
- id: 192
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-08-15 11:08:25 +0200'
  date_gmt: '2007-08-15 09:08:25 +0200'
  content: |-
    *) You could copy-paste the code into your project or you could add another project, dedicated for the control (and then add a reference to that new project)

    Adding references (or importing as you named it) is explained in <a href="http:&#47;&#47;www.deitel.com&#47;books&#47;NET&#47;AddingReferences.pdf" rel="nofollow">http:&#47;&#47;www.deitel.com&#47;books&#47;NET&#47;AddingReferences.pdf<&#47;a>
- id: 193
  author: iain wicks
  author_email: iainwicks@smartscan.co.uk
  author_url: http://www.smartscan.com
  date: '2007-08-15 14:52:38 +0200'
  date_gmt: '2007-08-15 12:52:38 +0200'
  content: |-
    brilliant I have it working!!!!!
    thank you very much for your help its much appreciated!!!
- id: 194
  author: Ersin INAN
  author_email: einan@kfmc.med.sa
  author_url: ''
  date: '2007-09-09 13:07:37 +0200'
  date_gmt: '2007-09-09 11:07:37 +0200'
  content: |-
    Great effort! I really appreciate your work.

    It is working amazing!
- id: 195
  author: John Maiden
  author_email: jmaiden@mtrdirect.com
  author_url: ''
  date: '2007-10-01 16:47:12 +0200'
  date_gmt: '2007-10-01 14:47:12 +0200'
  content: |-
    Good work. Really found this useful.

    Writing because I'm having a problem expanding your code to process an array of datagridview. If you have time, please take a look at the code and tell me what's wrong. I keep getting an error on style. Thanks in advance.

      Public Shared Function Generate(ByVal dataGridArray() As DataGridView) As Workbook
            Dim workbook As New Workbook

            For Each dataGridView As DataGridView In dataGridArray

                Dim worksheet As Worksheet = workbook.Worksheets.Add(dataGridView.Name) 'workbook.Worksheets.Add("Sheet 1")
                Dim worksheetRow As New WorksheetRow
                Dim dataGridViewColumn As DataGridViewColumn
                For Each dataGridViewColumn In dataGridView.Columns
                    worksheet.Table.Columns.Add(New WorksheetColumn(dataGridViewColumn.Width))
                    worksheetRow.Cells.Add(New WorksheetCell(dataGridViewColumn.HeaderText))
                Next
                worksheet.Table.Rows.Insert(0, worksheetRow)
                Dim worksheetDefaultStyle As WorksheetStyle = ExcelGenerator.GetWorksheetStyle(dataGridView.DefaultCellStyle, "Default")
                workbook.Styles.Add(worksheetDefaultStyle)
                Dim rowIndex As Integer
                For rowIndex = 0 To dataGridView.RowCount - 1
                    worksheetRow = worksheet.Table.Rows.Add
                    Dim columnIndex As Integer
                    For columnIndex = 0 To dataGridView.ColumnCount - 1
                        Dim cell As DataGridViewCell = dataGridView.Item(columnIndex, rowIndex)
                        Dim cellStyle As WorksheetStyle = ExcelGenerator.GetWorksheetStyle(cell.InheritedStyle, String.Concat(New Object() {"column", columnIndex, "row", rowIndex}))
                        If (Not cellStyle Is Nothing) Then
                            workbook.Styles.Add(cellStyle)
                        Else
                            cellStyle = worksheetDefaultStyle
                        End If
                        Dim dataType As DataType = ExcelGenerator.GetDataType(cell.ValueType)
                        worksheetRow.Cells.Add(cell.FormattedValue.ToString, dataType, cellStyle.ID)
                    Next columnIndex
                Next rowIndex

            Next dataGridView

            Return workbook
        End Function
- id: 196
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-10-01 19:51:44 +0200'
  date_gmt: '2007-10-01 17:51:44 +0200'
  content: |-
    As already obvious, i don't really like doing VB.Net ;)

    Anyway, i would refactor the Generate method so that it accepts a workbook instance (instead of creating one) inside the method..  This way you can create the Workbook, foreach DataGridView Generate(dataGridView, workBook and be done with it :)
- id: 197
  author: John Maiden
  author_email: jmaiden@mtrdirect.com
  author_url: ''
  date: '2007-10-01 21:51:15 +0200'
  date_gmt: '2007-10-01 19:51:15 +0200'
  content: |-
    Tim-

         The problem turns out to be that once you have defined the worksheet style the first time, the program throws if you try and define it again (for the next worksheet), even if it's the same style. I simply defined the style with the first worksheet, and let the other worksheets use the format of the first one. Thanks again for the advice.
- id: 198
  author: John Maiden
  author_email: jmaiden@mtrdirect.com
  author_url: ''
  date: '2007-10-03 20:19:06 +0200'
  date_gmt: '2007-10-03 18:19:06 +0200'
  content: |-
    Tim-

         Don't know if you care, but I found out my error. It comes down to adding new styles to the worksheet. Since I kept looping through all the data grid views I wanted to add to the worksheets, I inadvertently kept giving the new cell styles the same id ("column" + columnIndex + "row" + rowIndex) for cells on different worksheets.
- id: 199
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-10-03 21:38:07 +0200'
  date_gmt: '2007-10-03 19:38:07 +0200'
  content: |-
    All feedback is welcome ;)

    For a customer i've written a version that does the "id" generation a bit better (since "columnXXRowYY" makes your excel file grow enormously...

    And as you already mentionned, reusing styles is another tweak that can lead to serious improvements...
- id: 200
  author: SteveMcD
  author_email: s-mc-d@hotmail.com
  author_url: ''
  date: '2007-10-18 16:34:19 +0200'
  date_gmt: '2007-10-18 14:34:19 +0200'
  content: |-
    Tim,

    This code works great for me for smaller files, but I doesnt seem to save properly when theres hundreds of records. It seems to save fine, but when I try to open it in Excel it hangs. Any idea whats wrong?
- id: 201
  author: Abhishek
  author_email: ''
  author_url: ''
  date: '2007-11-10 12:05:27 +0100'
  date_gmt: '2007-11-10 10:05:27 +0100'
  content: |-
    SteveMcD,

    Your GridView has some formating like ALternateRowStyle which has different colour.So same formatting is taken by excel and so it takes time to open...
    You use the default settings of the excel and try to open...
- id: 202
  author: ProBlazer
  author_email: matt.hertzfeld@gmail.com
  author_url: ''
  date: '2007-11-21 21:37:47 +0100'
  date_gmt: '2007-11-21 19:37:47 +0100'
  content: |-
    I'm having trouble with the exported file.  I'm getting an error saying that problems came up while loading the table area.

    The example program works fine, and I just copied the code over with no modifications.  So I'm not getting why it's not working for me.

    I'm guessing that there is some character in my datagridview that is throwing off the xml formatting.  But since I don't know XML it's hard for me to pinpoint that as the problem.

    Any suggestions?
- id: 203
  author: cgandcats
  author_email: cgandcats@gmail.com
  author_url: ''
  date: '2007-12-13 07:39:43 +0100'
  date_gmt: '2007-12-13 05:39:43 +0100'
  content: |-
    I will like show only the columns of DataGridView visibles in the excel.. is this possible?

    thanks
- id: 204
  author: Peter
  author_email: scg-88@o2.pl
  author_url: ''
  date: '2007-12-19 18:49:19 +0100'
  date_gmt: '2007-12-19 16:49:19 +0100'
  content: |-
    Hi Tim.
    I really like what you have done, but I have a problem using it.

    My DataGridView has ~200 rows and ~200 columns and not all cells contain data. I try to generete excel file but it has 38MB.

    Is there a way you can help with this problem?
- id: 205
  author: Mike
  author_email: spidermike@aon.at
  author_url: ''
  date: '2008-01-12 18:55:40 +0100'
  date_gmt: '2008-01-12 16:55:40 +0100'
  content: |-
    hi,

    i really need some help. I've made a short test-project and implemented your solution for excel export, and it worked fine.
    In the project I'm currently work on, I got the error msg "problem while loading" "during the loading process errors occur in the following areas: tables" (translated from german, so might differ in english version;).

    this is the way, I do it in my app (I've also included the excelgenerator file and the carlosag lib):

    private void pRICKSTANDARDBindingNavigatorSaveItem_Click(object sender, EventArgs e)
            {
                            using (SaveFileDialog saveFileDialog = GetExcelSaveFileDialog())
                {
                    if (saveFileDialog.ShowDialog(this) == DialogResult.OK)
                    {
                        string fileName = saveFileDialog.FileName;

                        Workbook workbook = ExcelGenerator.Generate(this.STANDARDDataGridView);
                        workbook.Save(fileName);

                        Process.Start(fileName);
                    }
                }
- id: 206
  author: Mike
  author_email: spidermike@aon.at
  author_url: ''
  date: '2008-01-12 18:56:39 +0100'
  date_gmt: '2008-01-12 16:56:39 +0100'
  content: sorry, forgot to say, the error occurs when excel is trying to open the
    file ;)
- id: 207
  author: Mike
  author_email: spidermike@aon.at
  author_url: ''
  date: '2008-01-12 19:01:27 +0100'
  date_gmt: '2008-01-12 17:01:27 +0100'
  content: sorry again, but could it be, that the problem is in the datagridview itself?
    The original table is with some testdata (personID, date, valueA, valueB, ...)
    I have a relation in it to a second table, where I get a client name from, which
    is not in the original table. So the gridview shows personID, date, lastname,
    firstname, valueA, valueB, ...), doesn't this work out?
- id: 208
  author: Mike
  author_email: spidermike@aon.at
  author_url: ''
  date: '2008-01-14 21:14:54 +0100'
  date_gmt: '2008-01-14 19:14:54 +0100'
  content: |-
    me again

    it does work in the way, that the xml file is generated, and the data is in the file. but excel can't open it?!

    :(
- id: 209
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2008-01-15 11:57:46 +0100'
  date_gmt: '2008-01-15 09:57:46 +0100'
  content: |-
    Hello Mike,

    I don't have time to check it out but i remember that i've experienced the same problem with a couple of colors that excel didn't support... So you may want to debug the generated xml file to figure out where exactly it goes wrong..
- id: 210
  author: bokzer
  author_email: juan.samaniego@yahoo.com
  author_url: ''
  date: '2008-01-17 23:03:41 +0100'
  date_gmt: '2008-01-17 21:03:41 +0100'
  content: |-
    Tim
    Hi, very good post, it was very helpful, ewven thou I have a problem. when I export to excel double values that had been added to the Gridview it appear in excel as string and with a small green triangle on the superior left corner of each cell. How can I export with the field type properly.
    Thank You very much
- id: 211
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2008-01-18 09:06:31 +0100'
  date_gmt: '2008-01-18 07:06:31 +0100'
  content: |-
    Hello Bokzer,

    The problem is that excel depends on the local to figure out what the decimal separator is.. In  order to circumvent that problem i had decided to map all .Net double values to Excel string values...

    If you want you can change the code in the  Generate method:

    [code lang="csharp"]
    DataType dataType = GetDataType( cell.ValueType );

    string value = cell.FormattedValue.ToString();
    if( cell.ValueType == typeof( double ) )
    {
     if( value == string.Empty )
     {
      dataType = DataType.String;
     }
     else
     {
      Regex regex = new Regex( "[a-zA-Z]" );
      if( regex.IsMatch( value ) )
      {
       dataType = DataType.String;
      }
     }

     value = value.Replace( " ", string.Empty );
    }

    worksheetRow.Cells.Add( value, dataType, cellStyle.ID );
    [&#47;code]
- id: 212
  author: Mike
  author_email: spidermike@aon.at
  author_url: ''
  date: '2008-01-21 09:57:35 +0100'
  date_gmt: '2008-01-21 07:57:35 +0100'
  content: |-
    hi tim

    well, I've opened the xml file with visual studio, and it shows no error ... can't find the problem :(
- id: 213
  author: bokzer
  author_email: juan.samaniego@yahoo.com
  author_url: ''
  date: '2008-01-22 22:31:13 +0100'
  date_gmt: '2008-01-22 20:31:13 +0100'
  content: |-
    Hi Tim
    I have another question. Before I exporte I use the gv.AutoResizeRows() and gv.AutoRizeColumns() so everything fit perfectly but when the gridview is exported to excel the columns width change and become bigger. How can I fix it so the columns width are not bigger than the content length and fit perfectly?
    Thank you very much again
- id: 214
  author: Sandy
  author_email: sandra.j.armstead@sprint.com
  author_url: ''
  date: '2008-01-28 23:10:21 +0100'
  date_gmt: '2008-01-28 21:10:21 +0100'
  content: I am exporting a gridview to excel, and when I get the Open or Save prompt,
    the save works great, but the open goes to excel and I get a message saying that
    the file can't be found in the internet temporary folder. Any idea why the file
    is not being saved in the temporary folder?
- id: 215
  author: Marcelo
  author_email: mrodriguezr@ute.com.uy
  author_url: ''
  date: '2008-02-11 18:59:33 +0100'
  date_gmt: '2008-02-11 16:59:33 +0100'
  content: |-
    Dear Tim. I use your DataGridViewToExcel but in some cases not work. The excel leave a Exception when raise the .xls generated. Can you help me? Can you giveme your email and I send de xls generate.
    Thanks!!
- id: 216
  author: Rita
  author_email: ''
  author_url: ''
  date: '2008-02-20 16:16:18 +0100'
  date_gmt: '2008-02-20 14:16:18 +0100'
  content: |-
    Hello

    I&acute;m using your code to export a datagriview to excel and works fine.
    The problem is, when I try to import the xls file to the datagridview I get this error:

    External table is not in the expected format.

    I alter your code to don&rsquo;t set the style but it didn&rsquo;t work.

    If I copy the content of the xls file to another xls file and try to import, it works fine .

    Can any one help me
- id: 217
  author: amir
  author_email: amirgandomkar@gmail.com
  author_url: ''
  date: '2008-04-06 09:43:20 +0200'
  date_gmt: '2008-04-06 07:43:20 +0200'
  content: |-
    Hello tim.
    i Will Source CarlosAg.ExcelXmlWriter.
    you can find.
- id: 218
  author: AntonyChristopher
  author_email: a_chibochristopher@hotmail.com
  author_url: ''
  date: '2008-04-18 14:27:48 +0200'
  date_gmt: '2008-04-18 12:27:48 +0200'
  content: |-
    this promgram work well with datagridviews conected to table that have small amounts of data!

    when the data..etc are large it creates an excel file that never opens!...please help what can i do?
- id: 219
  author: Grant
  author_email: ''
  author_url: ''
  date: '2008-04-22 00:00:06 +0200'
  date_gmt: '2008-04-21 22:00:06 +0200'
  content: You sir are a genius! Thanks for this - just what i was looking 4
- id: 220
  author: zBuster@MSDN-Forms
  author_email: ''
  author_url: http://MSDN
  date: '2008-08-06 19:36:24 +0200'
  date_gmt: '2008-08-06 17:36:24 +0200'
  content: Thanks this helped more than you know.....
- id: 221
  author: zBuster@MSDN-Forms
  author_email: ''
  author_url: http://MSDN
  date: '2008-08-06 19:55:04 +0200'
  date_gmt: '2008-08-06 17:55:04 +0200'
  content: |-
    Question......

    Now that I can save the Excel file my open thing don't work anymore it ses that the file is in use by another program...
    Even if I re-run the program that saved the file in the first place.....
    Is there a way to add something to the code I got from you to tell it to close the file so the programs open thing works.....

    here is the code I used to open the file:

    this.dataGridView1.DataSource = null;

                            this.dataGridView1.DataBindings.Clear();
                            this.dataGridView1.ClearSelection();

                            this.dataGridView1.Rows.Clear();
                            this.dataGridView1.Columns.Clear();

                            OleDbConnection cnn = new OleDbConnection("Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + FileName + ";Extended Properties=\"Excel 8.0;HDR=No;IMEX=1\";");
                            OleDbDataAdapter da;
                            DataSet ds;

                            da = new OleDbDataAdapter("Select * from [" + SheetName1 + "]", cnn);
                            ds = new DataSet("TestExcel");

                            da.Fill(ds, "TestExcel");
                            dataGridView1.DataSource = ds.Tables[0];

    ~OR~

    Is there a better way to make my Excel opener to open the file your code in my program saved....

    (I'll be watching the form sight so if an answer is posted I'll see it...)

    Thank you for your time,

    zBuster
- id: 222
  author: zBuster@MSDN-Forms
  author_email: NSanelli.08@gmail.com
  author_url: http://MSDN
  date: '2008-08-06 21:01:38 +0200'
  date_gmt: '2008-08-06 19:01:38 +0200'
  content: |-
    ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~ALSO~~~~~~~

    I restarted the computer and did some things to my code...
    AND>>>>>>>

    The program said that the excel file was not in the correct format....

    So, could you tell me of a way to be able to open a file that your code saved with code from the same program....

    AND>>>>>>>
    Could you tell me how to also make it to where the program is still able to open regular excel files too....(Like it knows the difference between the two...)

    ~~~~~~~~(I'll be watching this page to see if any new posts come up about my three posts...)~~~~~~~~
- id: 223
  author: pyar
  author_email: pavithra@testingczars.com
  author_url: ''
  date: '2008-08-18 12:07:55 +0200'
  date_gmt: '2008-08-18 10:07:55 +0200'
  content: Hello,so far your code to export datgridview(dgv)to Excel is wrking fine.My
    issue is "Is it possible to save(export) 2 separate dgv in same Excel sheet with
    dgv1 in sheet1 and dgv2 in sheet2 of same Excel"? Kindly reply as soon as possible.Thnx
- id: 224
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2008-08-18 15:10:18 +0200'
  date_gmt: '2008-08-18 13:10:18 +0200'
  content: |-
    @pyar:

    It's certainly possible but you'll have to write it yourself...
- id: 225
  author: Shreya
  author_email: drshreya@gmail.com
  author_url: ''
  date: '2008-09-09 01:00:44 +0200'
  date_gmt: '2008-09-08 23:00:44 +0200'
  content: |-
    Would like to know if I could export the results of a query in the dataset directly to excel without using datagridview and Run my macro.

    Thanks in Advance!
    Shreya
- id: 226
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2008-09-09 07:37:07 +0200'
  date_gmt: '2008-09-09 05:37:07 +0200'
  content: Yes you can, and if you perform a websearch you will find plenty of resources
    that carefully explain the process.
- id: 227
  author: Hasan
  author_email: hasanjaffal@hotmail.com
  author_url: http://www.hasanjaffal.com
  date: '2008-10-23 13:00:47 +0200'
  date_gmt: '2008-10-23 11:00:47 +0200'
  content: |-
    well
    gr8 job guys
- id: 228
  author: Dusty
  author_email: stephen.t.miller@gmail.com
  author_url: ''
  date: '2008-10-25 01:10:02 +0200'
  date_gmt: '2008-10-24 23:10:02 +0200'
  content: |-
    The datagridview to Excel works great. I've even managed to change the sheet name.  Can you give me any pointers on how to include more than one sheet in an excel workbook.?

    Much appreciated.
- id: 229
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2008-10-25 07:17:17 +0200'
  date_gmt: '2008-10-25 05:17:17 +0200'
  content: |-
    <p>It is a matter of calling:<&#47;p>

    [code lang="csharp"]book.Worksheets.Add("name of sheet");[&#47;code]

    <p>For the consumer you could implement a custom type editor that allows the user to pick one or more datagridviews that exist on the designer form.. And in the generate method iterate over these selected instances (I have used that technique succesfully at one customer for a couple of years now.)
- id: 230
  author: maximodus
  author_email: patladormatlador@hotmail.com
  author_url: ''
  date: '2008-11-04 14:26:56 +0100'
  date_gmt: '2008-11-04 12:26:56 +0100'
  content: |-
    i don t no why but this promgram work well with datagridviews conected to table that have small amounts of data!

    when the data..etc are large it creates an excel file that never opens!what can i do?
- id: 231
  author: J Boon
  author_email: jp.boon@gmail.com
  author_url: ''
  date: '2008-12-01 15:36:04 +0100'
  date_gmt: '2008-12-01 13:36:04 +0100'
  content: |-
    Hello Tim,

    I have the same problem as some posters.. i get the message that the excel file was not in the correct format&hellip;.

    do you have a proper solution for this?

    thanks in advance!
- id: 232
  author: Omar Aguilar Valero
  author_email: oaguilarv@gmail.com
  author_url: http://www.setecomair.com.pe
  date: '2008-12-02 22:39:40 +0100'
  date_gmt: '2008-12-02 20:39:40 +0100'
  content: |-
    very good,,
    congratulations, the class is unique and very good

    Thank You
    Atte.
    Omar
- id: 233
  author: Davy
  author_email: ''
  author_url: ''
  date: '2009-03-09 13:37:38 +0100'
  date_gmt: '2009-03-09 12:37:38 +0100'
  content: Thank you very much, I have been searching for a way to implement this
    using other methods, but this one really does the trick.
- id: 234
  author: Sergey Sargsyan
  author_email: sargser@yahoo.com
  author_url: ''
  date: '2009-03-19 14:35:12 +0100'
  date_gmt: '2009-03-19 13:35:12 +0100'
  content: thank you very much, my extension isn't supports color so this the best
    support for me
- id: 235
  author: Michele V.
  author_email: m.vergine@inwind.it
  author_url: http://www.topclassitalia.com
  date: '2009-07-01 15:46:49 +0200'
  date_gmt: '2009-07-01 14:46:49 +0200'
  content: Thanks a lot a wonderful application.... many and many hours saved (not
    to speak of headache)
- id: 2198
  author: Jason D
  author_email: psycho_pigskin@hotmail.com
  author_url: ''
  date: '2010-12-22 23:40:15 +0100'
  date_gmt: '2010-12-22 22:40:15 +0100'
  content: "Tim great work.\r\nThis will come in very handy!\r\n\r\nJust a quick one,
    from your example code what line needs modifying to apply a different style to
    column headers?  I've been trying to make this work for few hours now and I know
    its something simple.\r\n\r\nAny help appreciated."
- id: 2269
  author: Jason D
  author_email: psycho_pigskin@hotmail.com
  author_url: ''
  date: '2010-12-24 15:34:49 +0100'
  date_gmt: '2010-12-24 14:34:49 +0100'
  content: "also does anyone know how to set the page orientation to landscape?\r\n\r\nThanks"
- id: 4235
  author: Neha
  author_email: priyankathapak.2010@rediffmail.com
  author_url: http://dfdf
  date: '2011-01-31 09:51:30 +0100'
  date_gmt: '2011-01-31 08:51:30 +0100'
  content: can I get this code in vb.net
- id: 13066
  author: christoven
  author_email: chen.taurus90@gmail.com
  author_url: ''
  date: '2011-06-15 16:07:28 +0200'
  date_gmt: '2011-06-15 15:07:28 +0200'
  content: "Sir,\r\n\r\ni have a one question..\r\n\r\nif I have 2 datagridView in
    1 form, whether it can convert both datagrid into 1 file?"
- id: 14608
  author: Ladislav
  author_email: ''
  author_url: ''
  date: '2011-07-06 01:37:34 +0200'
  date_gmt: '2011-07-06 00:37:34 +0200'
  content: "Thanks\r\nI suffer with it for two days\r\ngreat work........"
- id: 23735
  author: Godfrey
  author_email: godfreylngt@gmail.com
  author_url: ''
  date: '2011-11-24 06:01:54 +0100'
  date_gmt: '2011-11-24 05:01:54 +0100'
  content: hey,great code. Can i please get it in vb.net?
- id: 297596
  author: BernoulliLizard
  author_email: peterconnello@gmail.com
  author_url: ''
  date: '2013-12-09 20:21:35 +0100'
  date_gmt: '2013-12-09 19:21:35 +0100'
  content: Is there a way to set the border style and background color for specific
    cells? I do not want the entire worksheet to have the same style.
---
<p>The <a href="http:&#47;&#47;www.carlosag.net&#47;Tools&#47;ExcelXmlWriter&#47;Default.aspx">CarlosAg Excel Xml Writer Library<&#47;a> does not require <a href="http:&#47;&#47;office.microsoft.com&#47;en-us&#47;excel&#47;default.aspx">Excel<&#47;a> in order to generate Excel Workbooks. I already presented a method to print a DataGridView (<a href="http:&#47;&#47;www.timvw.be&#47;print-a-control&#47;">here<&#47;a>) and now i present you a method that allows you to export a DataGridView to an Excel Workbook: <a href="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;csharp&#47;DataGridViewToExcel.zip">DataGridViewToExcel.zip<&#47;a>.<&#47;p><br />
<img src="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;images&#47;datagridview-to-excel-1.gif" alt="screenshot of the source datagridview"&#47;><br />
<img src="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;images&#47;datagridview-to-excel-2.gif" alt="screenshot of the generated excel workbook"&#47;></p>
