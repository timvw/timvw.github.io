---
layout: post
status: publish
published: true
title: Programming the Bus Pirate with C#
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 1614
wordpress_url: http://www.timvw.be/?p=1614
date: '2010-01-16 12:10:21 +0100'
date_gmt: '2010-01-16 11:10:21 +0100'
categories: []
tags:
- C#
comments: []
---
<p>A while ago i received my <a href="http:&#47;&#47;code.google.com&#47;p&#47;the-bus-pirate&#47;">Bus Pirate<&#47;a> from <a href="http:&#47;&#47;www.seeedstudio.com&#47;depot&#47;">Seeed Studio Depot<&#47;a>. In essence it is a universal serial bus interface and i would love to program it using c#. I know that i can use the DataReceived event and then fiddle with bits (read <a href="http:&#47;&#47;msmvps.com&#47;blogs&#47;coad&#47;archive&#47;2005&#47;03&#47;23&#47;39466.aspx#usb">here<&#47;a> if you're into that kind of self-punishment) but spawning a separate thread to do the blocking work is ten times less work to get it up and running:<&#47;p></p>
<p>[code lang="csharp"]static void Main()<br />
{<br />
 using (var serialPort = new SerialPort("COM9", 115200, Parity.None, 8, StopBits.One))<br />
 {<br />
  serialPort.Open();</p>
<p>  new Thread(() => WriteLinesFrom(serialPort)).Start();</p>
<p>  while (true)<br />
  {<br />
   var command = Console.ReadLine();<br />
   if (command == "EXIT") break;<br />
   serialPort.WriteLine(command);<br />
  }<br />
 }<br />
}</p>
<p>static void WriteLinesFrom(SerialPort serialPort)<br />
{<br />
 try<br />
 {<br />
  while (true) Console.WriteLine(serialPort.ReadLine());<br />
 }<br />
 catch (Exception)<br />
 {<br />
  break;<br />
  }<br />
 }<br />
}[&#47;code]</p>
