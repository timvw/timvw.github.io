---
layout: post
status: publish
published: true
title: Calculate EndpointAddress for Silverlight client
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 1691
wordpress_url: http://www.timvw.be/?p=1691
date: '2010-02-15 21:44:18 +0100'
date_gmt: '2010-02-15 20:44:18 +0100'
categories: []
tags:
- C#
- Silverlight
comments: []
---
<p>Because Silverlight checks the origin it considers http:&#47;&#47;localhost and http:&#47;&#47;127.0.0.1 as different locations. In case you want your visitors to be able to use both addresses you can recalculate the address as following:<&#47;p></p>
<p>[code lang="csharp"]EndpointAddress GetEndpointAddress(EndpointAddress endpointAddress)<br />
{<br />
 var scheme = Application.Current.Host.Source.GetComponents(UriComponents.Scheme, UriFormat.Unescaped);<br />
 var serverAndPort = Application.Current.Host.Source.GetComponents(UriComponents.HostAndPort, UriFormat.Unescaped);<br />
 var pathAndQuery = endpointAddress.Uri.GetComponents(UriComponents.PathAndQuery, UriFormat.Unescaped);<br />
 return new EndpointAddress(scheme + ":&#47;&#47;" + serverAndPort + pathAndQuery);<br />
}[&#47;code]</p>
<p>And you can use this method as following:<&#47;p></p>
<p>[code lang="csharp"]var client = new DirectoryServiceClient();<br />
client.Endpoint.Address = GetEndpointAddress(client.Endpoint.Address);<br />
client.GetMessageCompleted += ClientGetMessageCompleted;<br />
client.GetMessageAsync();[&#47;code]</p>
