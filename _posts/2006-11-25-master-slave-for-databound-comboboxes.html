---
layout: post
status: publish
published: true
title: Master-Slave for databound ComboBoxes
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 127
wordpress_url: http://www.timvw.be/master-slave-for-databound-comboboxes/
date: '2006-11-25 14:16:52 +0100'
date_gmt: '2006-11-25 12:16:52 +0100'
categories: []
tags:
- C#
- Windows Forms
comments: []
---
<p>In most examples on the Internet you'll find that the Master has a property that returns the allowed Slaves. Here's an example that does not require such a property. Let's start with a simple class that represents a Person.<&#47;p><br />
[code lang="csharp"]public class Person<br />
{<br />
 private string name;</p>
<p> public Person(string name)<br />
 {<br />
  this.name = name;<br />
 }</p>
<p> public string Name<br />
 {<br />
  get { return this.name; }<br />
  set { this.name = value; }<br />
 }<br />
}[&#47;code]</p>
<p>And now we define a class to hold the choosen Master and Slave persons.<&#47;p><br />
[code lang="csharp"]public class MasterSlave<br />
{<br />
 private Person master;<br />
 private Person slave;</p>
<p> public MasterSlave()<br />
 {<br />
  Person[] masters = this.GetMasters();<br />
  this.master = masters[0];</p>
<p>  Person[] slaves = this.GetSlaves(this.master);<br />
  this.slave = slaves[0];<br />
 }</p>
<p> public Person Master<br />
 {<br />
  get { return this.master; }<br />
  set { this.master = value; }<br />
 }</p>
<p> public Person Slave<br />
 {<br />
  get { return this.slave; }<br />
  set { this.slave = value; }<br />
 }</p>
<p> public Person[] GetMasters()<br />
 {<br />
  List
<person> masters = new List
<person>();<br />
  masters.Add(new Person("master1"));<br />
  masters.Add(new Person("master2"));<br />
  return masters.ToArray();<br />
 }</p>
<p> public Person[] GetSlaves(Person person)<br />
 {<br />
  List
<person> slaves = new List
<person>();</p>
<p>  switch (person.Name)<br />
  {<br />
   case "master1":<br />
    slaves.Add(new Person("master1-slave1"));<br />
    slaves.Add(new Person("master1-slave2"));<br />
    break;<br />
   case "master2":<br />
    slaves.Add(new Person("master2-slave1"));<br />
    slaves.Add(new Person("master2-slave2"));<br />
    slaves.Add(new Person("master2-slave3"));<br />
    break;<br />
  }<br />
  return slaves.ToArray();<br />
 }<br />
}[&#47;code]</p>
<p>And now we can hook these objects to your Form.<&#47;p><br />
[code lang="csharp"]<br />
public partial class Form1 : Form<br />
{<br />
 public Form1()<br />
 {<br />
  InitializeComponent();</p>
<p>  MasterSlave masterSlave = new MasterSlave();</p>
<p>  BindingSource masterBindingSource = new BindingSource();<br />
  masterBindingSource.DataSource = masterSlave.GetMasters();<br />
  masterBindingSource.CurrentChanged += new EventHandler(masterBindingSource_CurrentChanged);</p>
<p>  this.comboBoxMaster.DataSource = masterBindingSource;<br />
  this.comboBoxMaster.DisplayMember = "Name";<br />
  this.comboBoxMaster.DataBindings.Add("SelectedItem", masterSlave, "Master");</p>
<p>  BindingSource slaveBindingSource = new BindingSource();<br />
  slaveBindingSource.DataSource = masterSlave.GetSlaves(masterBindingSource.Current as Person);</p>
<p>  this.comboBoxSlave.DataSource = slaveBindingSource;<br />
  this.comboBoxSlave.DisplayMember = "Name";<br />
  this.comboBoxSlave.DataBindings.Add("SelectedItem", masterSlave, "Slave");<br />
 }</p>
<p>  private void masterBindingSource_CurrentChanged(object sender, EventArgs e)<br />
  {<br />
   BindingSource masterBindingSource = this.comboBoxMaster.DataSource as BindingSource;<br />
   Person master = masterBindingSource.Current as Person;</p>
<p>   BindingSource slaveBindingSource = this.comboBoxSlave.DataSource as BindingSource;<br />
   MasterSlave masterSlave = this.comboBoxSlave.DataBindings["SelectedItem"].DataSource as MasterSlave;<br />
   slaveBindingSource.DataSource = masterSlave.GetSlaves(master);<br />
  }<br />
 }<br />
}[&#47;code]</p>
