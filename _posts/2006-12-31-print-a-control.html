---
layout: post
status: publish
published: true
title: Print a Control
author:
  display_name: timvw
  login: admin
  email: tim@timvw.be
  url: http://timvw.myopenid.com/
author_login: admin
author_email: tim@timvw.be
author_url: http://timvw.myopenid.com/
wordpress_id: 138
wordpress_url: http://www.timvw.be/print-a-control/
date: '2006-12-31 02:50:50 +0100'
date_gmt: '2006-12-31 00:50:50 +0100'
categories: []
tags:
- C#
- Windows Forms
comments:
- id: 71
  author: frac
  author_email: fracted@hotmail.com
  author_url: ''
  date: '2007-03-05 23:10:43 +0100'
  date_gmt: '2007-03-05 21:10:43 +0100'
  content: Hi there, I got this to work in a test application quite well.  I was wondering
    if you have seen anything like this in vb.net?
- id: 72
  author: Tim Van Wassenhove &raquo; DataGridView to Excel
  author_email: ''
  author_url: http://www.timvw.be/datagridview-to-excel/
  date: '2007-04-05 20:36:41 +0200'
  date_gmt: '2007-04-05 18:36:41 +0200'
  content: '[...] Excel in order to generate Excel Workbooks. I already presented
    a method to print a DataGridView (here) and now i present you a method that allows
    you to export a DataGridView to an Excel Workbook: [...]'
- id: 73
  author: Raj Desai
  author_email: rajdesaim@yahoo.com
  author_url: http://none
  date: '2007-05-12 04:40:01 +0200'
  date_gmt: '2007-05-12 02:40:01 +0200'
  content: |-
    Hi

    I don't know where to use this and how. I am assuming that I have a declare a class of the same name. I tried that but your link to ControlPrintPageEventHandler does not work.

    &#47;&#47; Initialise a controlPrintPageEventHandler and register the PrintPage method&acirc;&euro;&brvbar;
    ResizedControlPrintPageEventHandler resizedControlPrintPageEventHandler = new ResizedControlPrintPageEventHandler(this.dataGridView1);
    this.printDocument1.PrintPage += resizedControlPrintPageEventHandler.PrintPage;

    Please help.

    thanks,
    -Raj
- id: 74
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-05-12 09:46:48 +0200'
  date_gmt: '2007-05-12 07:46:48 +0200'
  content: |-
    Seems odd because overhere the links do work...

    <a href="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;csharp&#47;ControlPrintPageEventHandler.zip" rel="nofollow">http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;csharp&#47;ControlPrintPageEventHandler.zip<&#47;a>
    <a href="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;csharp&#47;ResizedControlPrintPageEventHandler.txt" rel="nofollow">http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;csharp&#47;ResizedControlPrintPageEventHandler.txt<&#47;a>
- id: 75
  author: Noobie-Newbie
  author_email: jimmychankokchern1@msn.com
  author_url: ''
  date: '2007-05-24 08:16:18 +0200'
  date_gmt: '2007-05-24 06:16:18 +0200'
  content: |-
    Thanks for your help on the following thread
    http:&#47;&#47;forums.microsoft.com&#47;MSDN&#47;ShowPost.aspx?PostID=1630670&amp;SiteID=1

    I have a Question to ask. If I want to print a landscape instead of Portrait, how do i do it.

    Thanks
- id: 76
  author: Noobie-Newbie
  author_email: ''
  author_url: ''
  date: '2007-05-24 12:00:23 +0200'
  date_gmt: '2007-05-24 10:00:23 +0200'
  content: |-
    I have solve the problem.
    just add pageSetupDialog

    Anyway, Once again thanks for your help
- id: 77
  author: zlf
  author_email: zlfcn@hotmail.com
  author_url: ''
  date: '2007-07-05 16:53:58 +0200'
  date_gmt: '2007-07-05 14:53:58 +0200'
  content: Hello, I want to use the print algorithm in this article in my application,
    I want to confirm with you whether it is free to use. I mean it is no copyrighted
    code? Thanks
- id: 78
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-07-05 23:17:21 +0200'
  date_gmt: '2007-07-05 21:17:21 +0200'
  content: |-
    Hello,

    All the code you find on my blog is completely free to use...
- id: 79
  author: NeedHelp
  author_email: ''
  author_url: ''
  date: '2007-08-10 19:15:58 +0200'
  date_gmt: '2007-08-10 17:15:58 +0200'
  content: |-
    Hey, is there a way to make it Landscape without a page setup dialog?  I wanted to do it in the code so it would be automatically like that.  I tried to set it by putting:

                printDocument1.DefaultPageSettings.Landscape = true;

    in the button click event.  Then I add this document to a printpreview dialog, but it is always portrait.  I hope this is enough information for you to help, let me know if need anything else from me.

    Thanks!
- id: 80
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-08-10 23:22:35 +0200'
  date_gmt: '2007-08-10 21:22:35 +0200'
  content: |-
    I'm not quite sure in which direction you want to rotate.. I haven't changed the Landscape, simply added a call to RotateFlip in the PrintPage method (You can experiment yourself with the available <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.drawing.rotatefliptype.aspx" rel="nofollow">RotateFlipTypes<&#47;a>)..

    [code lang="csharp"]
    public virtual void PrintPage(object sender, PrintPageEventArgs e)
    {
     if (this.currentPage == 0)
     {
      &#47;&#47; the only addition was the call to RotateFlip
      this.bitmap = new Bitmap(this.control.Width, this.control.Height);
      this.control.DrawToBitmap(this.bitmap, this.control.Bounds);
      this.bitmap.RotateFlip(RotateFlipType.Rotate270FlipNone);

      &#47;&#47; if i calculate it after that the image has been rotated, i don't have to change code :))
      this.requiredPagesForWidth = ((int)this.bitmap.Width &#47; e.MarginBounds.Width) + 1;
      this.requiredPagesForHeight = ((int)this.bitmap.Height &#47; e.MarginBounds.Height) + 1;
      this.lastPage = (this.requiredPagesForWidth * this.requiredPagesForHeight) - 1;
     }

     e.HasMorePages = (this.currentPage < this.lastPage);

     int posX = ((int)this.currentPage % this.requiredPagesForWidth) * e.MarginBounds.Width;
     int posY = ((int)this.currentPage &#47; this.requiredPagesForWidth) * e.MarginBounds.Height;

     e.Graphics.DrawImage(this.bitmap, new Rectangle(e.MarginBounds.X, e.MarginBounds.Y, e.MarginBounds.Width, e.MarginBounds.Height), new Rectangle(posX, posY, e.MarginBounds.Width, e.MarginBounds.Height), GraphicsUnit.Pixel);

     ++this.currentPage;
     if (this.currentPage > this.lastPage)
     {
      this.currentPage = 0;
     }
    }[&#47;code]

    Hoping to help.
- id: 81
  author: NeedHelp
  author_email: ''
  author_url: ''
  date: '2007-08-15 16:54:54 +0200'
  date_gmt: '2007-08-15 14:54:54 +0200'
  content: |-
    Thanks, I got it all figured out on the landscape thing.  Now, I have another question.  I have a control with three datagrids.  Is there an easy way to use these classes to print them with so much room in between so that they all appear?

    Thank you
- id: 82
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2007-08-15 17:13:56 +0200'
  date_gmt: '2007-08-15 15:13:56 +0200'
  content: There is always a way to get things done. My first idea would be to  calculate
    the sum of these DGV's their width and height, create a giant bitmap containing
    the 3 DGV bitmaps, and print... But the implementation is up to you this time
    ;)
- id: 83
  author: NeedHelp
  author_email: ''
  author_url: ''
  date: '2007-08-15 17:32:23 +0200'
  date_gmt: '2007-08-15 15:32:23 +0200'
  content: Alright, thanks!
- id: 84
  author: Farhan
  author_email: farhan.ejaz@gmail.com
  author_url: ''
  date: '2007-12-12 12:02:35 +0100'
  date_gmt: '2007-12-12 10:02:35 +0100'
  content: |-
    Superb article.
    I have seen many codes to print the datagridview but you have solved the problem in least of the codes...
    gr8888888888888
- id: 85
  author: alex
  author_email: a.kokmadi@gmail.com
  author_url: ''
  date: '2008-01-14 12:49:59 +0100'
  date_gmt: '2008-01-14 10:49:59 +0100'
  content: |-
    Hello i would like to ask if there is any code for datagridview to excel in vb.net!
    thanks
- id: 86
  author: Ron
  author_email: ronb1983@gmail.com
  author_url: ''
  date: '2008-05-29 21:57:18 +0200'
  date_gmt: '2008-05-29 19:57:18 +0200'
  content: |-
    RE: Print Control Code
    Hi Tim,  I having trouble getting data in my grid to show in preview or print.  No data appears in the report.  I'm new at this stuff.  Here is my code, Can you help me out?
              DateTime fromdt = dateTimePicker1.Value;
                DateTime todt = dateTimePicker2.Value;
                string offname = comboBox1.Text;

                var db = new dispatchDataContext();
                var q = db.SP_DispatchOfficerLogSearch(fromdt, todt, offname);
                dataGridView1.DataSource = q.ToList();
                &#47;&#47; Alter Datagrid Heading
                dataGridView1.Columns[0].HeaderText = "Call Log Time";
                dataGridView1.Columns[1].HeaderText = "Officer Name";
                dataGridView1.Columns[2].HeaderText = "Description";
                dataGridView1.Columns[3].HeaderText = "Quick Note";
                dataGridView1.Columns[0].Width = 117;
                dataGridView1.Columns[1].Width = 170;
                dataGridView1.Columns[2].Width = 180;
                dataGridView1.Columns[3].Width = 240;
                this.comboBox1.SelectedIndex = -1;
                ResizedControlPrintPageEventHandler resizedControlPrintPageEventHandler = new ResizedControlPrintPageEventHandler(this.dataGridView1);
                this.printDocument1.PrintPage += resizedControlPrintPageEventHandler.PrintPage;
- id: 87
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2008-05-30 17:34:22 +0200'
  date_gmt: '2008-05-30 15:34:22 +0200'
  content: |-
    <p>I can imagine potential issues when DataBinding hasn't completed.. In order to figure that out, you should handle the DataBindingComplete event on the DataGridView. Here is a possible solution:<&#47;p>
    [code lang="csharp"]public partial class Form1 : Form
    {
     private ManualResetEvent mre;

     public Form1()
     {
      InitializeComponent();
      this.dataGridView1.DataBindingComplete += new DataGridViewBindingCompleteEventHandler(dataGridView1_DataBindingComplete);
     }

     void dataGridView1_DataBindingComplete(object sender, DataGridViewBindingCompleteEventArgs e)
     {
      this.mre.Set();
     }

     private void button1_Click(object sender, EventArgs e)
     {
      List<string> names = new List<string>();
      names.Add("tim");
      names.Add("jeff");
      this.mre = new ManualResetEvent(false);
      this.dataGridView1.DataSource = names;

      ThreadPool.QueueUserWorkItem(this.PrintAsSoonAsDataBindingHasCompleted);
     }

     private void PrintAsSoonAsDataBindingHasCompleted(object state)
     {
      this.mre.WaitOne();
      ResizedControlPrintPageEventHandler resizedControlPrintPageEventHandler = new ResizedControlPrintPageEventHandler(this.dataGridView1);
      this.printDocument1.PrintPage += resizedControlPrintPageEventHandler.PrintPage;
      this.printDocument1.Print();
     }
    }[&#47;code]
- id: 88
  author: Naresh Jakher
  author_email: njakher@annetsite.com
  author_url: ''
  date: '2008-07-29 09:43:20 +0200'
  date_gmt: '2008-07-29 07:43:20 +0200'
  content: |-
    Hi,

    I am using your code in one of my application to print the datagridview and it works gr8, But when the datagridsize is more than the size of my screen it doesnt print all the columns. I have a poup window displaying the datagrid and window's Windowstate Property = FormWindowState.Maximized.
- id: 89
  author: Ivan
  author_email: ivanlewis@aol.in
  author_url: ''
  date: '2008-08-24 15:25:10 +0200'
  date_gmt: '2008-08-24 13:25:10 +0200'
  content: form1 does not contain a definition for current page
- id: 90
  author: timvw
  author_email: timvanwassenhove@gmail.com
  author_url: http://www.timvw.be
  date: '2008-08-25 07:58:42 +0200'
  date_gmt: '2008-08-25 05:58:42 +0200'
  content: The code that is available for download simply works as is. If you copy-pasted
    the code from this blog post you'll have to add a definition for currentPage yourself.
- id: 81681
  author: ''
  author_email: ''
  author_url: ''
  date: '2012-09-26 12:48:27 +0200'
  date_gmt: '2012-09-26 11:48:27 +0200'
  content: Hi! i have a problem. i can't print the whole datagridview. i can only
    print the portion that appears on the screen.. please help,,
---
<p>A while ago i discovered the <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.windows.forms.control.drawtobitmap.aspx">DrawToBitmap<&#47;a> method on the <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.windows.forms.control.aspx">Control<&#47;a> class. The availability of this method makes it relatively easy to implement a <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.drawing.printing.printpageeventhandler.aspx">PrintPageEventHandler<&#47;a> for the <a href="http:&#47;&#47;msdn2.microsoft.com&#47;en-us&#47;library&#47;system.drawing.printing.printdocument.aspx">PrintDocument<&#47;a> class. Here is an example implementation that prints a DataGridView:<&#47;p><br />
[code lang="csharp"]private void buttonPrint_Click(object sender, EventArgs e)<br />
{<br />
 this.printDocument1.Print();<br />
}</p>
<p>void printDocument1_BeginPrint(object sender, PrintEventArgs e)<br />
{<br />
 this.currentPage = 0;<br />
}</p>
<p>private void printDocument1_PrintPage(object sender, System.Drawing.Printing.PrintPageEventArgs e)<br />
{<br />
 Size oldSize = this.dataGridView1.Size;<br />
 this.dataGridView1.Height = Math.Max(this.dataGridView1.Height, this.dataGridView1.PreferredSize.Height);<br />
 this.dataGridView1.Width = Math.Max(this.dataGridView1.Width, this.dataGridView1.PreferredSize.Width);</p>
<p> int requiredPagesForWidth = ((int)this.dataGridView1.Width &#47; e.MarginBounds.Width) + 1;<br />
 int requiredPagesForHeight = ((int)this.dataGridView1.Height &#47; e.MarginBounds.Height) + 1;<br />
 int requiredPages = requiredPagesForWidth * requiredPagesForHeight;<br />
 e.HasMorePages = (this.currentPage < requiredPages - 1);</p>
<p> int posX = ((int)this.currentPage % requiredPagesForWidth) * e.MarginBounds.Width;<br />
 int posY = ((int)this.currentPage &#47; requiredPagesForWidth) * e.MarginBounds.Height;</p>
<p> Graphics graphics = e.Graphics;<br />
 Bitmap bitmap = new Bitmap(this.dataGridView1.Width, this.dataGridView1.Height);<br />
 this.dataGridView1.DrawToBitmap(bitmap, this.dataGridView1.Bounds);<br />
 graphics.DrawImage(bitmap, new Rectangle(e.MarginBounds.X, e.MarginBounds.Y, e.MarginBounds.Width, e.MarginBounds.Height), new Rectangle(posX, posY, e.MarginBounds.Width, e.MarginBounds.Height), GraphicsUnit.Pixel);</p>
<p> this.dataGridView1.Size = oldSize;<br />
 ++this.currentPage;<br />
}[&#47;code]</p>
<p>Now that you understand the main idea, let's wrap it in a class and make it reusable: <a href="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;csharp&#47;ResizedControlPrintPageEventHandler.txt">ResizedControlPrintPageEventHandler<&#47;a>. Using this class is as simple as:<&#47;p><br />
[code lang="csharp"]<br />
&#47;&#47; Initialise a controlPrintPageEventHandler and register the PrintPage method...<br />
ResizedControlPrintPageEventHandler resizedControlPrintPageEventHandler = new ResizedControlPrintPageEventHandler(this.dataGridView1);<br />
this.printDocument1.PrintPage += resizedControlPrintPageEventHandler.PrintPage;</p>
<p>&#47;&#47; Print the control<br />
private void buttonPrint_Click(object sender, EventArgs e)<br />
{<br />
 this.printDocument1.Print();<br />
}</p>
<p>&#47;&#47; Give the user a preview<br />
private void buttonPreview_Click(object sender, EventArgs e)<br />
{<br />
 this.printPreviewDialog1.Show();<br />
}[&#47;code]</p>
<p>Here are a couple of screenshots:<&#47;p><br />
<img src="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;images&#47;print-datagridview1.gif" alt="Screenshot of demo application that has a datagridview with scrollbars."&#47;><br />
<img src="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;images&#47;print-datagridview2.gif" alt="Screenshot of print preview. Notice that the scrollbars are gone."&#47;><br />
<img src="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;images&#47;print-datagridview3.gif" alt="Screenshot of the print document."&#47;></p>
<p>Feel free to download the class and demo application: <a href="http:&#47;&#47;www.timvw.be&#47;wp-content&#47;code&#47;csharp&#47;ControlPrintPageEventHandler.zip">ControlPrintPageEventHandler.zip<&#47;a>.<&#47;p></p>
