<!DOCTYPE html>
<html>
<head>
	<meta name="generator" content="Hugo 0.80.0" />
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Tim Van Wassenhove - Passionate geek, interested in Technology. Proud father of two </title><meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="alternate" type="application/rss+xml" href="https://timvw.be/feed.xml" title="Tim Van Wassenhove" />
	<meta itemprop="name" content="Tim Van Wassenhove">
<meta itemprop="description" content="">
<meta property="og:title" content="Tim Van Wassenhove" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://timvw.be/" />
<meta property="og:updated_time" content="2021-03-15T11:42:40+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tim Van Wassenhove"/>
<meta name="twitter:description" content=""/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="recent-posts section">
			<div class="posts">
				
				
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">21</span>
										<span class="rest">Jun 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Note about makecert.exe</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>A couple of days ago i didn&rsquo;t have a binary version of <a href="http://www.openssl.org">OpenSSL</a> around so i decided to use <a href="http://msdn.microsoft.com/en-us/library/bfsktky3(VS.80).aspx">Makecert.exe</a>. I generated a couple of test certificates and started playing around with them.</p>
<p>Whenever i tried to decrypt an instance of <a href="http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.encryptedxml(VS.80).aspx">EncryptedXml</a> a <a href="http://msdn.microsoft.com/en-us/library/system.security.cryptography.cryptographicexception.aspx">CryptographicException</a> (&ldquo;Bad Key.&quot;) was thrown and when i tried to use a <a href="http://msdn.microsoft.com/en-us/library/aa529579.aspx">mutualCertificate11Security</a> assertion (<a href="http://msdn.microsoft.com/en-us/library/aa139619.aspx">WSE 3.0</a>) the same CryptographicException (&ldquo;WSE600: Unable to unwrap a symmetric key using the private key of an X.509 certificate. Please check if the account &lsquo;ASPNET&rsquo; has permissions to read the private key of certificate with subject name&hellip; &ldquo;) was thrown.</p>
<p>The problem is that by default, makecert.exe generates a key type that is suited for signature. If you want to use the key for other purposes than signing (eg: SSL authentication) you have to use the -sky exchange option. The following commands made my problems disappear:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">makecert -n <span style="color:#d14">&#34;CN=Client&#34;</span> -pe -ss My -sr CurrentUser -sky exchange client.cer
makecert -n <span style="color:#d14">&#34;CN=Host&#34;</span> -pe -ss My -sr LocalMachine -sky exchange host.cer
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/information-technology">Information Technology</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">17</span>
										<span class="rest">Jun 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">PInvoke Interop Assistant released</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Earlier at <a href="http://www.microsoft.com/events/TechEd2008/default.mspx">Tech Ed North America</a> i heared how <a href="">Jesse Kaplan</a>, program Manager for Extensibility and add-ins for the CLR team, announced a new tool to help us with PInvoke signatures. Today i noticed that the tool, <a href="http://www.codeplex.com/clrinterop">PInvoke Interop Assistant</a> has now been made available at CodePlex.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/information-technology">Information Technology</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">14</span>
										<span class="rest">Jun 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Enumerate all properties and their value of an object</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Earlier today someone asked me how to generate a List with all the properties (and their respective value) that an object has. With C# 2.0 i would have created a class to represent a single element, PropertyRow, with a Name and a Value property and a class that is IEnumerable<!-- raw HTML omitted --> to hold all PropertyRows.</p>
<p>With C# 3.0 we can take advantage of <a href="http://msdn.microsoft.com/en-us/library/bb397696.aspx">anonymous types</a> and the code we have to write is fairly minimal</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">Person angelina = <span style="color:#000;font-weight:bold">new</span> Person(<span style="color:#d14">&#34;Angelina&#34;</span>, <span style="color:#d14">&#34;Jolie&#34;</span>, <span style="color:#d14">&#34;0275198123&#34;</span>, <span style="color:#d14">&#34;CloseToMe blv 12&#34;</span>);

<span style="color:#458;font-weight:bold">var</span> propertyRows =
	<span style="color:#000;font-weight:bold">from</span> propertyInfo <span style="color:#000;font-weight:bold">in</span> angelina.GetType().GetProperties()
	<span style="color:#000;font-weight:bold">select</span> <span style="color:#000;font-weight:bold">new</span> { Name = propertyInfo.Name, Value = propertyInfo.GetValue(angelina, <span style="color:#000;font-weight:bold">null</span>) };

BindingSource bs = <span style="color:#000;font-weight:bold">new</span> BindingSource();
bs.DataSource = propertyRows;

<span style="color:#000;font-weight:bold">this</span>.dataGridView1.DataSource = bs;
</code></pre></div><p>Just as with anonymous delegates, as soon as you notice that you define the same anonymous class more than once, you may want to consider to take it out of the anonymousity.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">09</span>
										<span class="rest">Jun 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Became Microsoft Certified Technology Specialist...</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Not that i really care, but <a href="http://wimvdd.blogspot.com">my manager</a> seems to do, last week, during a couple of dead moments at Tech-Ed North America (I&rsquo;ll blog about that later on this week) i decided to take a couple of exams (<a href="http://www.microsoft.com/learning/en/us/exams/70-536.mspx">70-536</a>, <a href="http://www.microsoft.com/learning/en/us/exams/70-526.mspx">70-526</a> and <a href="http://www.microsoft.com/learning/en/us/exams/70-528.mspx">70-528</a>) and passed them üòâ</p>
<p>This means that i&rsquo;m now a <a href="http://www.microsoft.com/learning/mcp/mcts/winapps/default.mspx">MCTS: .NET Framework 2.0 Windows Applications</a> and a <a href="http://www.microsoft.com/learning/mcp/mcts/webapps/default.mspx">MCTS: .NET Framework 2.0 Web Applications</a>.</p>
<p>Feel free to check out <a href="http://www.microsoft.com/learning/mcp/transcripts">my transcript</a> with Transcript</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/awards-and-certifications">Awards and Certifications</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">24</span>
										<span class="rest">May 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Exploring the Microsoft Sync Framework</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Earlier this week i&rsquo;ve been experimenting with the <a href="http://msdn.microsoft.com/en-us/sync/default.aspx">Microsoft Sync Framework</a>. In a typical n-tier architecture the client can&rsquo;t access the remote database directly but uses a proxy instead. The available [Earlier this week i&rsquo;ve been experimenting with the <a href="http://msdn.microsoft.com/en-us/sync/default.aspx">Microsoft Sync Framework</a>. In a typical n-tier architecture the client can&rsquo;t access the remote database directly but uses a proxy instead. The available](<a href="http://msdn.microsoft.com/en-us/library/microsoft.synchronization.data.serversyncproviderproxy(SQL.100).aspx">http://msdn.microsoft.com/en-us/library/microsoft.synchronization.data.serversyncproviderproxy(SQL.100).aspx</a>) has only one constructor which accepts an object. With reflector i found out that the proxy simply uses reflection to call some methods. Here are a couple of helper classes that help you prevent runtime errors due to this approach</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#008080">[ServiceContract(Namespace = &#34;http://www.timvw.be/Synchronization&#34;)]</span>
<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> IServerSyncProvider
{
<span style="color:#008080">	[OperationContract]</span>
	SyncServerInfo GetServerInfo(SyncSession syncSession);
<span style="color:#008080">
</span><span style="color:#008080">	[OperationContract]</span>
	SyncSchema GetSchema(Collection&lt;<span style="color:#458;font-weight:bold">string</span>&gt; tableNames, SyncSession syncSession);
<span style="color:#008080">
</span><span style="color:#008080">	[OperationContract]</span>
	SyncContext GetChanges(SyncGroupMetadata groupMetadata, SyncSession syncSession);
<span style="color:#008080">
</span><span style="color:#008080">	[OperationContract]</span>
	SyncContext ApplyChanges(SyncGroupMetadata groupMetadata, DataSet dataSet, SyncSession syncSession);
	}
}

<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">MyServerSyncProviderProxy</span> : ServerSyncProviderProxy
{
		<span style="color:#000;font-weight:bold">public</span> MyServerSyncProviderProxy(IServerSyncProvider serverSyncProvider)
		: <span style="color:#000;font-weight:bold">base</span>(serverSyncProvider)
		{
		}
}
</code></pre></div><p>And now you can easily consume a ServerSyncProviderProxy as following</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">SyncAgent syncAgent = <span style="color:#000;font-weight:bold">new</span> SyncAgent();
EndpointAddress address = <span style="color:#000;font-weight:bold">new</span> EndpointAddress(<span style="color:#d14">&#34;http://somewhere/Be.Timvw.Demo.Host/ServerSyncProvider.svc&#34;</span>);
BasicHttpBinding binding = <span style="color:#000;font-weight:bold">new</span> BasicHttpBinding();
ChannelFactory&lt;iserverSyncProvider&gt; factory = <span style="color:#000;font-weight:bold">new</span> ChannelFactory&lt;iserverSyncProvider&gt;(binding, address);
IServerSyncProvider serverSyncProvider = factory.CreateChannel();
syncAgent.RemoteProvider = <span style="color:#000;font-weight:bold">new</span> SafeServerSyncProviderProxy(serverSyncProvider);
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">19</span>
										<span class="rest">May 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Presenting a generic Effectivity</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Very often we have to manage objects and their changes over time. Usually we implement this by adding a <a href="http://www.timvw.be/presenting-a-generic-range/">Range<!-- raw HTML omitted --></a> to the data. <a href="http://martinfowler.com/">Martin Fowler</a> has a name for this pattern: <a href="http://martinfowler.com/ap2/effectivity.html">Effectivity</a> and i have an implementation for the following interface</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> IEffectivity&lt;T&gt; : IComparable&lt;ieffectivity&lt;T&gt;&gt;
{
	T Element { <span style="color:#000;font-weight:bold">get</span>; }
	IRange&lt;dateTime&gt; ValidityPeriod { <span style="color:#000;font-weight:bold">get</span>; }
	<span style="color:#458;font-weight:bold">bool</span> IsEffectiveOn(DateTime validityDate);
}
</code></pre></div><p>Feel free to download <a href="http://www.timvw.be/wp-content/code/csharp/IEffectivity.txt">IEffectivity.txt</a>, <a href="http://www.timvw.be/wp-content/code/csharp/Effectivity.txt">Effectivity.txt</a> and <a href="http://www.timvw.be/wp-content/code/csharp/EffectivityTester.txt">EffectivityTester.txt</a>.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/patterns">Patterns</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">19</span>
										<span class="rest">May 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Presenting a generic EffectivityManager</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>I&rsquo;ve already presented a <a href="http://www.timvw.be/presenting-a-generic-effectivity/">Generic Effectivity</a>. Offcourse, managing all these effectivities (versions of data) can be handled in a generic way too. A bit of experience mixed with <a href="http://martinfowler.com/ap2/timeNarrative.html">Patterns for things that change with time</a> allowed me to come up with the following interface</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> IEffectivityManager&lt;T&gt; : IList&lt;ieffectivity&lt;T&gt;&gt;
{
	IEffectivity&lt;T&gt; Add(T t, DateTime begin);
	IEffectivity&lt;T&gt; GetSnapshot(DateTime validityDate);
	<span style="color:#458;font-weight:bold">bool</span> TryGetSnapshot(DateTime validityDate, <span style="color:#000;font-weight:bold">out</span> IEffectivity&lt;T&gt; effectivity);
}
</code></pre></div><p>Feel free to download <a href="http://www.timvw.be/wp-content/code/csharp/IEffectivityManager.txt">IEffectivityManager.txt</a>, <a href="http://www.timvw.be/wp-content/code/csharp/EffectivityManager.txt">EffectivityManager.txt</a> and <a href="http://www.timvw.be/wp-content/code/csharp/EffectivityManagerTester.txt">EffectivityManagerTester.txt</a>.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/patterns">Patterns</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">17</span>
										<span class="rest">May 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Presenting a generic Range</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Quite often i&rsquo;m writing code that compares one value against a range of other values. Most implementations compare the value against the boundaries (smallest and largest in the collection of other values). Having written this sort of code way too much i&rsquo;ve decided to generalize the problem and distill an interface</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> IRange&lt;T&gt;
{
	T Begin { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">set</span>; }
	T End { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">set</span>; }
	<span style="color:#458;font-weight:bold">bool</span> Includes(T t);
	<span style="color:#458;font-weight:bold">bool</span> Includes(IRange&lt;T&gt; range);
	<span style="color:#458;font-weight:bold">bool</span> Overlaps(IRange&lt;T&gt; range);
}
</code></pre></div><p>Offcourse, i&rsquo;ve also written implementation. Feel free to download <a href="http://www.timvw.be/wp-content/code/csharp/IRange.txt">IRange.txt</a>, <a href="http://www.timvw.be/wp-content/code/csharp/Range.txt">Range.txt</a> and <a href="http://www.timvw.be/wp-content/code/csharp/RangeTester.txt">RangeTester.txt</a></p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/patterns">Patterns</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">21</span>
										<span class="rest">Apr 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Build OpenSSL with Visual Studio 2008</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>These days building <a href="http://www.openssl.org">OpenSSL</a> with Visual Studio 2008 has become really easy. I don&rsquo;t like to edit .cnf files so i decided to patch the code a little so that the default configuration file becomes openssl.config</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#458;font-weight:bold">string</span> basePath = <span style="color:#d14">@&#34;C:\src\openssl-0.9.8g&#34;</span>;

<span style="color:#458;font-weight:bold">string</span> originalConfigfile = <span style="color:#d14">&#34;openssl.cnf&#34;</span>;
<span style="color:#458;font-weight:bold">string</span> updatedConfigfile = <span style="color:#d14">&#34;openssl.config&#34;</span>;
<span style="color:#000;font-weight:bold">foreach</span> (<span style="color:#458;font-weight:bold">string</span> filename <span style="color:#000;font-weight:bold">in</span> Directory.GetFiles(basePath, <span style="color:#d14">&#34;\*.\*&#34;</span>, SearchOption.AllDirectories))
{
	<span style="color:#458;font-weight:bold">string</span> contents = File.ReadAllText(filename);
	<span style="color:#000;font-weight:bold">if</span> (contents.Contains(originalConfigfile))
	{
		Console.WriteLine(filename);
		File.WriteAllText(filename, contents.Replace(originalConfigfile, updatedConfigfile));
	}
}

File.WriteAllText(basePath + <span style="color:#d14">@&#34;\apps\&#34;</span> + updatedConfigfile, File.ReadAllText(basePath + <span style="color:#d14">@&#34;\apps\&#34;</span> + originalConfigfile));
</code></pre></div><p>Open a Visual Studio 2008 Command prompt and add references to the <a href="http://blogs.msdn.com/windowssdk">Microsoft SDK</a> as following</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">SET <span style="color:#008080">PATH</span><span style="color:#000;font-weight:bold">=</span>%PATH%;C:<span style="color:#d14">\P</span>rogram Files<span style="color:#d14">\M</span>icrosoft SDKs<span style="color:#d14">\W</span>indows<span style="color:#d14">\v</span>6.0A<span style="color:#d14">\b</span>in
SET <span style="color:#008080">LIB</span><span style="color:#000;font-weight:bold">=</span>%LIB%;C:<span style="color:#d14">\P</span>rogram Files<span style="color:#d14">\M</span>icrosoft SDKs<span style="color:#d14">\W</span>indows<span style="color:#d14">\v</span>6.0A<span style="color:#d14">\L</span>ib
SET <span style="color:#008080">INCLUDE</span><span style="color:#000;font-weight:bold">=</span>%INCLUDE%;C:<span style="color:#d14">\P</span>rogram Files<span style="color:#d14">\M</span>icrosoft SDKs<span style="color:#d14">\W</span>indows<span style="color:#d14">\v</span>6.0A<span style="color:#d14">\I</span>nclude
</code></pre></div><p>Now we simply have to follow the tasks listed in INSTALL.W32:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">perl Configure VC-WIN32 --prefix<span style="color:#000;font-weight:bold">=</span>c:/openssl
ms<span style="color:#d14">\d</span>o_masm
nmake -f ms<span style="color:#d14">\n</span>tdll.mak
nmake -f ms<span style="color:#d14">\n</span>tdll.mak <span style="color:#0086b3">test</span>
nmake -f ms<span style="color:#d14">\n</span>tdll.mak install
</code></pre></div><p>Happy OpenSSL&rsquo;ing!</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/free-software">Free Software</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">22</span>
										<span class="rest">Mar 2008</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Easily switching between configuration files with MSBuild</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>A couple of days ago i wrote about <a href="http://www.timvw.be/easily-switching-between-appconfig-files-with-msbuild/">Easily switching between App.Config files with MSBuild</a>. Christophe Gijbels, a fellow <a href="http://www.compuware.be/root/Careers/index.asp">compuwarrior</a>, pointed out that developers usually need to copy more than a single App.Config file&hellip; I would propose to add a Folder for each Customer that contains all the specific configuration files. Eg</p>
<p><img src="http://www.timvw.be/wp-content/images/customerconfigurations.gif" alt="screenshot of solution explorer with proposed folder structures"></p>
<p>Now i have to configure MSBuild so that the right files are copied into the <a href="http://msdn2.microsoft.com/en-us/library/bb629394.aspx">OutDir</a>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#998;font-style:italic">&lt;!-- Define the CustomerPath depending on the choosen Configuration --&gt;</span>
<span style="color:#000080">&lt;propertyGroup</span> <span style="color:#008080">Condition=</span><span style="color:#d14">&#34; $(Configuration) == &#39;Customer1 Debug&#39; &#34;</span><span style="color:#000080">&gt;</span> 
	<span style="color:#000080">&lt;customerPath&gt;</span>Customer1<span style="color:#000080">&lt;/customerPath&gt;</span> 
<span style="color:#000080">&lt;/propertyGroup&gt;</span> 
<span style="color:#000080">&lt;propertyGroup</span> <span style="color:#008080">Condition=</span><span style="color:#d14">&#34; $(Configuration) == &#39;Customer2 Debug&#39; &#34;</span><span style="color:#000080">&gt;</span> 
	<span style="color:#000080">&lt;customerPath&gt;</span>Customer2<span style="color:#000080">&lt;/customerPath&gt;</span> 
<span style="color:#000080">&lt;/propertyGroup&gt;</span> 

<span style="color:#998;font-style:italic">&lt;!-- Define AppConfig in the CustomerPath  --&gt;</span>
<span style="color:#000080">&lt;propertyGroup&gt;</span>
	<span style="color:#000080">&lt;appConfig&gt;</span>$(CustomerPath)\App.config<span style="color:#000080">&lt;/appConfig&gt;</span> 
<span style="color:#000080">&lt;/propertyGroup&gt;</span> 

<span style="color:#998;font-style:italic">&lt;!-- Find all files in CustomerPath, excluding AppConfig --&gt;</span>
<span style="color:#000080">&lt;itemGroup&gt;</span>
	<span style="color:#000080">&lt;customerFiles</span> <span style="color:#008080">Include=</span><span style="color:#d14">&#34;$(CustomerPath)\*.*&#34;</span> <span style="color:#008080">Exclude=</span><span style="color:#d14">&#34;$(CustomerPath)\App.config&#34;</span> <span style="color:#000080">/&gt;</span>
<span style="color:#000080">&lt;/itemGroup&gt;</span>

<span style="color:#000080">&lt;target</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;AfterBuild&#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;copy</span> <span style="color:#008080">SourceFiles=</span><span style="color:#d14">&#34;@(CustomerFiles)&#34;</span> <span style="color:#008080">DestinationFolder=</span><span style="color:#d14">&#34;$(OutDir)&#34;</span> <span style="color:#008080">SkipUnchangedFiles=</span><span style="color:#d14">&#34;true&#34;</span><span style="color:#000080">/&gt;</span>
<span style="color:#000080">&lt;/target&gt;</span>
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/visual-studio">Visual Studio</a></li>
										
									</ul>
								
							
						</div></div>
				
				

<ul class="pagination">
	<li class="page-item page-prev">
	
    <a href="../../page/24/" class="page-link" aria-label="Previous"><span aria-hidden="true">‚Üê Prev page</span></a>
	
	</li>
	<li class="page-item page-next">
	
    <a href="../../page/26/" class="page-link" aria-label="Next"><span aria-hidden="true">Next page ‚Üí</span></a>
	
	</li>
</ul>


			</div>
		</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
