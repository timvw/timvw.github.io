<!DOCTYPE html>
<html>
<head>
	<meta name="generator" content="Hugo 0.80.0" />
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Tim Van Wassenhove - Passionate geek, interested in Technology. Proud father of two </title><meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="alternate" type="application/rss+xml" href="https://timvw.be/feed.xml" title="Tim Van Wassenhove" />
	<meta itemprop="name" content="Tim Van Wassenhove">
<meta itemprop="description" content="">
<meta property="og:title" content="Tim Van Wassenhove" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://timvw.be/" />
<meta property="og:updated_time" content="2021-11-08T15:25:16+01:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tim Van Wassenhove"/>
<meta name="twitter:description" content=""/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="recent-posts section">
			<div class="posts">
				
				
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">28</span>
										<span class="rest">May 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">WCF REST: generate correct Content-Length header for HEAD request</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>The point of a HEAD request is to return a Content-Length header, but with an empty body.
The WCF transport stack has the annoying &lsquo;feature&rsquo; that it &lsquo;corrects&rsquo; the Content-Length header based on the stream that is returned.
With the aid of Carlos Figueira&rsquo;s <a href="http://social.msdn.microsoft.com/Forums/en/wcf/thread/c2672206-f255-4b14-b45e-7e3d057f4ffc">MyLengthOnlyStream</a> i was able to workaround that &lsquo;feature&rsquo; :)
(I know, i know, a good old HttpHandler is so much easier to implement!)</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">28</span>
										<span class="rest">May 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Windows Internals: Including Windows Server 2008 and Windows Vista, Fifth Edition</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Given the fact that i have been developing software for MS-Windows the last couple of years i found it important to learn a bit more about the internals of the operating systems on which my applications run so i ordered a copy of <a href="http://www.amazon.com/Windows%C2%AE-Internals-Including-Windows-PRO-Developer/dp/0735625301">Windows Internals: Including Windows Server 2008 and Windows Vista, Fifth Edition</a> back in september and learned quite a bit from the chapters that i found interesting: security, authorization, networking and analyzing crashes. I skimmed through the chapters on memory management, scheduling and file systems because they reminded me too much of Tanenbaum&rsquo;s excellent <a href="http://www.amazon.com/Modern-Operating-Systems-Andrew-Tanenbaum/dp/0136006639/ref=dp_ob_title_bk">Modern Operating Systems</a>.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/book-reviews">Book reviews</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">02</span>
										<span class="rest">May 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Enumerating SpecialFolders</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p><a href="http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx">Environment.SpecialFolder</a> is a value-type that i always seem to forget about. Let&rsquo;s try to do something about that by posting about it here :)</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">foreach</span> (<span style="color:#458;font-weight:bold">var</span> name <span style="color:#000;font-weight:bold">in</span> Enum.GetNames(<span style="color:#000;font-weight:bold">typeof</span>(Environment.SpecialFolder)))
{
	<span style="color:#458;font-weight:bold">var</span> specialFolder = (Environment.SpecialFolder)Enum.Parse(<span style="color:#000;font-weight:bold">typeof</span>(Environment.SpecialFolder), name);
	Console.WriteLine(<span style="color:#d14">&#34;{0,25} =&gt; {1}&#34;</span>, name, Environment.GetFolderPath(specialFolder));
}
</code></pre></div><!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Start Menu\Programs
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\Documents
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\Documents
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\Favorites
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Recent
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\SendTo
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Start Menu
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\Music
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\Desktop
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Templates
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Local
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Local\Microsoft\Windows\Temporary Internet Files
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Roaming\Microsoft\Windows\Cookies
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\AppData\Local\Microsoft\Windows\History
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\ProgramData
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Windows\system32
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Program Files
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Users\timvw\Pictures
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<pre><code>&lt;td&gt;
  C:\Program Files\Common Files
&lt;/td&gt;
</code></pre>
<!-- raw HTML omitted -->

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">01</span>
										<span class="rest">May 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Get root directory for IsolatedStorageFiles</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Sometimes you want to know the absolute path of a file that is persisted with <a href="http://msdn.microsoft.com/en-us/library/system.io.isolatedstorage.isolatedstoragefile(VS.95).aspx">IsolatedStorageFile</a>. Apparently there is an internal property RootDirectory which contains this information</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">IsolatedStorageFileExtensions</span>
{
	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">string</span> GetRootDirectory(<span style="color:#000;font-weight:bold">this</span> IsolatedStorageFile isf)
	{
		<span style="color:#458;font-weight:bold">var</span> property = isf.GetType().GetProperty(<span style="color:#d14">&#34;RootDirectory&#34;</span>, BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.GetProperty);
		<span style="color:#000;font-weight:bold">return</span> (<span style="color:#458;font-weight:bold">string</span>)property.GetValue(isf, <span style="color:#000;font-weight:bold">null</span>);
	}
}
</code></pre></div><p>Here is a real world example of using <a href="http://sharpbits.codeplex.com/">SharpBITS.NET</a> to download a file to IsolatedStorage:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Program</span>
{
	<span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">void</span> Main()
	{
		<span style="color:#458;font-weight:bold">var</span> mgr = <span style="color:#000;font-weight:bold">new</span> BitsManager();
		mgr.OnJobError += mgr_OnJobError;
		mgr.OnJobTransferred += mgr_OnJobTransferred;

		<span style="color:#458;font-weight:bold">var</span> job = mgr.CreateJob(<span style="color:#d14">&#34;job@&#34;</span> + DateTime.Now, JobType.Download);
		<span style="color:#458;font-weight:bold">var</span> src = <span style="color:#d14">@&#34;http://localhost/&#34;</span>;
		<span style="color:#458;font-weight:bold">var</span> dst = Path.Combine(GetIsfRoot(), <span style="color:#d14">&#34;test.html&#34;</span>);
		job.AddFile(src,dst);
		job.Resume();

		Console.WriteLine(<span style="color:#d14">&#34;running...&#34;</span>);
		Console.ReadKey();
	}

	<span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">void</span> mgr_OnJobTransferred(<span style="color:#458;font-weight:bold">object</span> sender, NotificationEventArgs e)
	{
		e.Job.Complete();
		Console.WriteLine(<span style="color:#d14">&#34;completed: &#34;</span> + e.Job.DisplayName);
	}

	<span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">void</span> mgr_OnJobError(<span style="color:#458;font-weight:bold">object</span> sender, ErrorNotificationEventArgs e)
	{
		Console.WriteLine(<span style="color:#d14">&#34;error: &#34;</span> + e.Error.Description);
	}

	<span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">string</span> GetIsfRoot()
	{
		<span style="color:#000;font-weight:bold">using</span> (<span style="color:#458;font-weight:bold">var</span> f = IsolatedStorageFile.GetUserStoreForAssembly())
		{
			<span style="color:#000;font-weight:bold">return</span> f.GetRootDirectory();
		}
	}
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">19</span>
										<span class="rest">Apr 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">97 Things Every Software Architect Should Know: Collective Wisdom from the Experts</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>I learned a couple of valuable lessons from <a href="http://www.amazon.com/Things-Every-Software-Architect-Should/dp/059652269X">97 Things Every Software Architect Should Know: Collective Wisdom from the Experts</a> so i would certainly recommend this very readabile book!</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/book-reviews">Book reviews</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">18</span>
										<span class="rest">Feb 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Exploring System.Interactive</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>A couple of weeks ago i was working on an application that would transfer data through a couple of components as a List<!-- raw HTML omitted -->. In essence, all we were doing over and over again was the following:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">interface</span> IMapper
{
	TEntity FromObjectList(List objectList);
	List ToObjectList(TEntity entity);
}
</code></pre></div><p>My initial implementation (using EnumerableEx operators from <!-- raw HTML omitted -->Reactive Extensions<!-- raw HTML omitted -->) looked like this</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> TEntity FromObjectList(List objectList)
{
	<span style="color:#458;font-weight:bold">var</span> entity = <span style="color:#000;font-weight:bold">new</span> TEntity();
	
	properties
		.Zip(objectList, (property, <span style="color:#000;font-weight:bold">value</span>) =&gt; AssignValueToProperty(entity, property, <span style="color:#000;font-weight:bold">value</span>))
		.Run();

	<span style="color:#000;font-weight:bold">return</span> entity;
}

<span style="color:#458;font-weight:bold">int</span> AssignValueToProperty(<span style="color:#458;font-weight:bold">object</span> entity, PropertyInfo property, <span style="color:#458;font-weight:bold">object</span> <span style="color:#000;font-weight:bold">value</span>)
{
	property.SetValue(entity, <span style="color:#000;font-weight:bold">value</span>, <span style="color:#000;font-weight:bold">null</span>);
	<span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
}

<span style="color:#000;font-weight:bold">public</span> List ToObjectList(TEntity entity)
{
	<span style="color:#000;font-weight:bold">return</span> properties
	.Select(property =&gt; property.GetValue(entity, <span style="color:#000;font-weight:bold">null</span>))
	.ToList();
}
</code></pre></div><p>And the consumer code looks like this:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#458;font-weight:bold">var</span> person = <span style="color:#000;font-weight:bold">new</span> Person { Id = <span style="color:#099">2</span>, Score = <span style="color:#099">1.3</span>, Name = <span style="color:#d14">&#34;Tim&#34;</span>, Title = <span style="color:#d14">&#34;Sir&#34;</span> };

<span style="color:#458;font-weight:bold">var</span> personMapper = <span style="color:#000;font-weight:bold">new</span> Mapper()
	.Map(x =&gt; x.Id)
	.Map(x =&gt; x.Score)
	.Map(x =&gt; x.Name)
	.Map(x =&gt; x.Title);

<span style="color:#458;font-weight:bold">var</span> data = personMapper.ToObjectList(person);
<span style="color:#458;font-weight:bold">var</span> clonedPerson = personMapper.FromObjectList(data);
</code></pre></div><p>Wait a minute, in most situations we simply want to map all properties on the object. Let&rsquo;s create a mapper for this</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">AutoMapper</span> : Mapper <span style="color:#000;font-weight:bold">where</span> TEntity : <span style="color:#000;font-weight:bold">new</span>()
{
	<span style="color:#000;font-weight:bold">public</span> AutoMapper()
	{
		<span style="color:#000;font-weight:bold">typeof</span>(TEntity).GetProperties().Run(property =&gt; Map(property));
	}
}
</code></pre></div><p>And now we don&rsquo;t have to waste time doing the same thing over and over again! Because we always need to map all properties of our types we ended up with the following</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Mapper</span>
{
	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> List ToObjectsList(<span style="color:#000;font-weight:bold">this</span> TEntity entity)
	{
		<span style="color:#000;font-weight:bold">return</span> entity.GetType().GetProperties()
		.Select(property =&gt; property.GetValue(entity, <span style="color:#000;font-weight:bold">null</span>))
		.ToList();
	}
	
	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> TEntity ToEntity(<span style="color:#000;font-weight:bold">this</span> List objectsList) <span style="color:#000;font-weight:bold">where</span> TEntity : <span style="color:#000;font-weight:bold">new</span>()
	{
		TEntity entity = <span style="color:#000;font-weight:bold">new</span> TEntity();
		entity.GetType().GetProperties()
			.Zip(objectsList, (property, <span style="color:#000;font-weight:bold">value</span>) =&gt;{ property.SetValue(entity, <span style="color:#000;font-weight:bold">value</span>,<span style="color:#000;font-weight:bold">null</span>); <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;})
			.Run();
		<span style="color:#000;font-weight:bold">return</span> entity;
	}
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">17</span>
										<span class="rest">Feb 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Learned something from Resharper: Enumerable.OfType&lt;TResult&gt;</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>A couple of weeks ago i discovered <a href="http://msdn.microsoft.com/en-us/library/bb360913.aspx">Enumerable.OfType<!-- raw HTML omitted --></a> when i let Resharper rewrite my code as a Linq statement. Here is the original code:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#458;font-weight:bold">var</span> selectedPersons = <span style="color:#000;font-weight:bold">new</span> List&lt;personSelectItem&gt;();
<span style="color:#000;font-weight:bold">foreach</span>(<span style="color:#458;font-weight:bold">var</span> selectedItem <span style="color:#000;font-weight:bold">in</span> selectedItems)
{
	<span style="color:#458;font-weight:bold">var</span> selectedPerson = selectedItem <span style="color:#000;font-weight:bold">as</span> PersonSelectItem;
	<span style="color:#000;font-weight:bold">if</span> (selectedPerson == <span style="color:#000;font-weight:bold">null</span>) <span style="color:#000;font-weight:bold">continue</span>;
	selectedPersons.Add(selectedPerson);
}
</code></pre></div><p>And here is how it looks after the rewrite:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#458;font-weight:bold">var</span> selectedPersons = selectedItems.OfType&lt;personSelectItem&gt;().ToList();
</code></pre></div><p>Yup, the <a href="http://www.jetbrains.com/resharper/">Resharper</a> license was definitely worth it&rsquo;s money.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">15</span>
										<span class="rest">Feb 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Calculate EndpointAddress for Silverlight client</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Because Silverlight checks the origin it considers http://localhost and http://127.0.0.1 as different locations. In case you want your visitors to be able to use both addresses you can recalculate the address as following:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">EndpointAddress GetEndpointAddress(EndpointAddress endpointAddress)
{
	<span style="color:#458;font-weight:bold">var</span> scheme = Application.Current.Host.Source.GetComponents(UriComponents.Scheme, UriFormat.Unescaped);
	<span style="color:#458;font-weight:bold">var</span> serverAndPort = Application.Current.Host.Source.GetComponents(UriComponents.HostAndPort, UriFormat.Unescaped);
	<span style="color:#458;font-weight:bold">var</span> pathAndQuery = endpointAddress.Uri.GetComponents(UriComponents.PathAndQuery, UriFormat.Unescaped);
	<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> EndpointAddress(scheme + <span style="color:#d14">&#34;://&#34;</span> + serverAndPort + pathAndQuery);
}
</code></pre></div><p>And you can use this method as following:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#458;font-weight:bold">var</span> client = <span style="color:#000;font-weight:bold">new</span> DirectoryServiceClient();
client.Endpoint.Address = GetEndpointAddress(client.Endpoint.Address);
client.GetMessageCompleted += ClientGetMessageCompleted;
client.GetMessageAsync();
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
										<li><a href="../../tags/silverlight">Silverlight</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">12</span>
										<span class="rest">Feb 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Clever TemplateFile hack</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>In my current project i use TemplateFileTask (<a href="http://msbuildtasks.tigris.org/">MSBuild Community Tasks Project</a>) to generate configuration files. I ran into the problem that i don&rsquo;t want to expose a MEX endpoint in production. This is my initial template file</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;service</span> <span style="color:#008080">behaviorconfiguration=</span><span style="color:#d14">&#34;DemoBehavior&#34;</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;DemoService.FileService&#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;endpoint</span> <span style="color:#008080">address=</span><span style="color:#d14">&#34;&#34;</span> <span style="color:#008080">binding=</span><span style="color:#d14">&#34;ws2007HttpBinding&#34;</span> <span style="color:#008080">contract=</span><span style="color:#d14">&#34;DemoService.IFileService&#34;</span> <span style="color:#000080">/&gt;</span>
	${MexEndpoint}
<span style="color:#000080">&lt;/service&gt;</span>
</code></pre></div><p>And here is my initial msbuild task</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;Project</span> <span style="color:#008080">ToolsVersion=</span><span style="color:#d14">&#34;3.5&#34;</span> <span style="color:#008080">dDfaultTargets=</span><span style="color:#d14">&#34;GenerateConfigFiles&#34;</span> <span style="color:#008080">xmlns=</span><span style="color:#d14">&#34;http://schemas.microsoft.com/developer/msbuild/2003&#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;Import</span> <span style="color:#008080">Project=</span><span style="color:#d14">&#34;$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets&#34;</span><span style="color:#000080">/&gt;</span>
	<span style="color:#000080">&lt;Target</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;GenerateConfigFiles&#34;</span><span style="color:#000080">&gt;</span>
		<span style="color:#000080">&lt;PropertyGroup&gt;</span>
			<span style="color:#000080">&lt;MexEndpoint&gt;</span>
				<span style="color:#000080">&lt;endpoint</span> <span style="color:#008080">address=</span><span style="color:#d14">&#34;mex&#34;</span> <span style="color:#008080">binding=</span><span style="color:#d14">&#34;mexHttpBinding&#34;</span> <span style="color:#008080">contract=</span><span style="color:#d14">&#34;IMetadataExchange&#34;</span> <span style="color:#000080">/&gt;</span>
			<span style="color:#000080">&lt;/MexEndpoint&gt;</span>
		<span style="color:#000080">&lt;/PropertyGroup&gt;</span>

		<span style="color:#000080">&lt;PropertyGroup</span> <span style="color:#008080">Condition=</span><span style="color:#d14">&#34; &#39;$(Env)&#39;==&#39;Production&#39; &#34;</span><span style="color:#000080">&gt;</span>
			<span style="color:#000080">&lt;MexEndpoint&gt;&lt;/MexEndpoint&gt;</span>
		<span style="color:#000080">&lt;/PropertyGroup&gt;</span>

		<span style="color:#000080">&lt;ItemGroup&gt;</span>
			<span style="color:#000080">&lt;Tokens</span> <span style="color:#008080">Include=</span><span style="color:#d14">&#34;MexEndpoint&#34;</span><span style="color:#000080">&gt;</span>
				<span style="color:#000080">&lt;ReplacementValue&gt;</span>$(MexEndpoint)<span style="color:#000080">&lt;/ReplacementValue&gt;</span>
			<span style="color:#000080">&lt;/Tokens&gt;</span>
		<span style="color:#000080">&lt;/ItemGroup&gt;</span>

		<span style="color:#000080">&lt;TemplateFile</span> <span style="color:#008080">Template=</span><span style="color:#d14">&#34;Web.template.config&#34;</span> <span style="color:#008080">OutputFileName=</span><span style="color:#d14">&#34;Web.config&#34;</span> <span style="color:#008080">Tokens=</span><span style="color:#d14">&#34;@(Tokens)&#34;</span> <span style="color:#000080">/&gt;</span>
	<span style="color:#000080">&lt;/Target&gt;</span>
<span style="color:#000080">&lt;/Project&gt;</span>
</code></pre></div><p>This results in the following configuration file: (WCF does not like the xml namespace declaration):</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;service</span> <span style="color:#008080">behaviorconfiguration=</span><span style="color:#d14">&#34;DemoBehavior&#34;</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;DemoService.FileService&#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;endpoint</span> <span style="color:#008080">address=</span><span style="color:#d14">&#34;&#34;</span> <span style="color:#008080">binding=</span><span style="color:#d14">&#34;ws2007HttpBinding&#34;</span> <span style="color:#008080">contract=</span><span style="color:#d14">&#34;DemoService.IFileService&#34;</span> <span style="color:#000080">/&gt;</span>
	<span style="color:#000080">&lt;endpoint</span> <span style="color:#008080">address=</span><span style="color:#d14">&#34;mex&#34;</span> <span style="color:#008080">binding=</span><span style="color:#d14">&#34;mexHttpBinding&#34;</span> <span style="color:#008080">contract=</span><span style="color:#d14">&#34;IMetadataExchange&#34;</span> <span style="color:#008080">xmlns=</span><span style="color:#d14">&#34;http://schemas.microsoft.com/developer/msbuild/2003&#34;</span> <span style="color:#000080">/&gt;</span>
<span style="color:#000080">&lt;/service&gt;</span>
</code></pre></div><p>I noticed that a smart collegue of mine came up with the following template file:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;service</span> <span style="color:#008080">behaviorconfiguration=</span><span style="color:#d14">&#34;DemoBehavior&#34;</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;DemoService.FileService&#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;endpoint</span> <span style="color:#008080">address=</span><span style="color:#d14">&#34;&#34;</span> <span style="color:#008080">binding=</span><span style="color:#d14">&#34;ws2007HttpBinding&#34;</span> <span style="color:#008080">contract=</span><span style="color:#d14">&#34;DemoService.IFileService&#34;</span> <span style="color:#000080">/&gt;</span>
	<span style="color:#a61717;background-color:#e3d2d2">&lt;</span>${MexBegin}endpoint address=&#34;mex&#34; binding=&#34;mexHttpBinding&#34; contract=&#34;IMetadataExchange&#34; /${MexEnd}&gt;
<span style="color:#000080">&lt;/service&gt;</span>
</code></pre></div><p>And this is how he defines the MexBegin and MexEnd properties in msbuild:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;PropertyGroup&gt;</span>
	<span style="color:#000080">&lt;MexBegin&gt;&lt;/MexBegin&gt;</span>
	<span style="color:#000080">&lt;MexEnd&gt;&lt;/MexEnd&gt;</span>
<span style="color:#000080">&lt;/PropertyGroup&gt;</span>

<span style="color:#000080">&lt;PropertyGroup</span> <span style="color:#008080">Condition=</span><span style="color:#d14">&#34; &#39;$(Env)&#39;==&#39;Production&#39; &#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;MexBegin&gt;</span>!--<span style="color:#000080">&lt;/MexBegin&gt;</span>
	<span style="color:#000080">&lt;MexEnd&gt;</span>--<span style="color:#000080">&lt;/MexEnd&gt;</span>
<span style="color:#000080">&lt;/PropertyGroup&gt;</span>
</code></pre></div><p>This leads to a nice MEX endpoint for all environments and in Production we get the following:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#998;font-style:italic">&lt;!--endpoint address=&#34;mex&#34; binding=&#34;mexHttpBinding&#34; contract=&#34;IMetadataExchange&#34; /--&gt;</span>
</code></pre></div><p>Perhaps it is cleaner to implement my own TemplateFileTask but untill then this clever hack does the job.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/msbuild">MSBuild</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">10</span>
										<span class="rest">Feb 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Another missing method for IEnumerable&lt;T&gt;</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Currently there are two overloads for OrderBy on Enumerable</p>
<ul>
<li>OrderBy(this IEnumerable<!-- raw HTML omitted --> source, Func&lt;TSource, TKey&gt; keySelector)</li>
<li>OrderBy(this IEnumerable<!-- raw HTML omitted --> source, Func&lt;TSource, TKey&gt; keySelector, IComparer<!-- raw HTML omitted --> comparer)</li>
</ul>
<p>Because i don&rsquo;t want to implement an IComparer<!-- raw HTML omitted --> each time i have implemented the following class</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">DelegateComparer</span>&lt;T&gt; : IComparer&lt;T&gt;
{
	<span style="color:#000;font-weight:bold">public</span> Func&lt;t, T, <span style="color:#458;font-weight:bold">int</span>&gt; CompareFunction { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">set</span>; }

	<span style="color:#000;font-weight:bold">public</span> DelegateComparer(Func&lt;t, T, <span style="color:#458;font-weight:bold">int</span>&gt; compareFunction)
	{
		CompareFunction = compareFunction;
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">int</span> Compare(T x, T y)
	{
		<span style="color:#000;font-weight:bold">return</span> CompareFunction(x, y);
	}
}
</code></pre></div><p>And now i can define a nice extension method:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> IOrderedEnumerable&lt;tsource&gt; OrderBy&lt;tsource, TKey&gt;(<span style="color:#000;font-weight:bold">this</span> IEnumerable&lt;tsource&gt; source, Func&lt;tsource, TKey&gt; keySelector, Func&lt;tkey, TKey, <span style="color:#458;font-weight:bold">int</span>&gt; compareFunction)
{
	<span style="color:#458;font-weight:bold">var</span> comparer = <span style="color:#000;font-weight:bold">new</span> DelegateComparer&lt;tkey&gt;(compareFunction);
	<span style="color:#000;font-weight:bold">return</span> source.OrderBy(keySelector, comparer);
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
				

<ul class="pagination">
	<li class="page-item page-prev">
	
    <a href="../../page/9/" class="page-link" aria-label="Previous"><span aria-hidden="true">← Prev page</span></a>
	
	</li>
	<li class="page-item page-next">
	
    <a href="../../page/11/" class="page-link" aria-label="Next"><span aria-hidden="true">Next page →</span></a>
	
	</li>
</ul>


			</div>
		</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2021  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
