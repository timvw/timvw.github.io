<!DOCTYPE html>
<html>
<head>
	<meta name="generator" content="Hugo 0.92.2" />
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Tim Van Wassenhove - Passionate geek, interested in Technology. Proud father of two </title><meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="alternate" type="application/rss+xml" href="https://timvw.be/feed.xml" title="Tim Van Wassenhove" />
	<meta itemprop="name" content="Tim Van Wassenhove">
<meta itemprop="description" content=""><meta property="og:title" content="Tim Van Wassenhove" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://timvw.be/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tim Van Wassenhove"/>
<meta name="twitter:description" content=""/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="recent-posts section">
			<div class="posts">
				
				
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">02</span>
										<span class="rest">Feb 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Verify that a X509Certificate can be used for key exchange</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Here is another method that earned it&rsquo;s place in my ever growing toolbox:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">bool</span> CanDoKeyExchange(<span style="color:#000;font-weight:bold">this</span> X509Certificate2 certificate)
{
	<span style="color:#000;font-weight:bold">if</span> (!certificate.HasPrivateKey) <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">false</span>;

	<span style="color:#458;font-weight:bold">var</span> privateKey = certificate.PrivateKey <span style="color:#000;font-weight:bold">as</span> RSACryptoServiceProvider;
	<span style="color:#000;font-weight:bold">if</span> (privateKey == <span style="color:#000;font-weight:bold">null</span>) <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">false</span>;

	<span style="color:#458;font-weight:bold">var</span> canDoKeyExchange = privateKey.CspKeyContainerInfo.KeyNumber == KeyNumber.Exchange;
	<span style="color:#000;font-weight:bold">return</span> canDoKeyExchange;
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">28</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Presenting ValueType&lt;T&gt;</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Here is a base class for some code that i have written once too many in my life: (In case you&rsquo;re an early adaptor (.Net 4.0) you may want to use System.Tuple<!-- raw HTML omitted --> as base class)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ValueType</span>&lt;T&gt; : IComparable, IComparable&lt;valueType&lt;T&gt;&gt;, IEquatable&lt;valueType&lt;T&gt;&gt; <span style="color:#000;font-weight:bold">where</span> T : IComparable&lt;T&gt;
{
	<span style="color:#000;font-weight:bold">protected</span> T Value { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">set</span>; }
	
	<span style="color:#000;font-weight:bold">public</span> ValueType(T <span style="color:#000;font-weight:bold">value</span>)
	{
		Value = <span style="color:#000;font-weight:bold">value</span>;
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">override</span> <span style="color:#458;font-weight:bold">int</span> GetHashCode()
	{
		<span style="color:#000;font-weight:bold">return</span> Value.GetHashCode();
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">override</span> <span style="color:#458;font-weight:bold">string</span> ToString()
	{
		<span style="color:#000;font-weight:bold">return</span> Value.ToString();
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">override</span> <span style="color:#458;font-weight:bold">bool</span> Equals(<span style="color:#458;font-weight:bold">object</span> obj)
	{
		<span style="color:#000;font-weight:bold">return</span> Equals(obj <span style="color:#000;font-weight:bold">as</span> ValueType&lt;T&gt;);
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">bool</span> Equals(ValueType&lt;T&gt; other)
	{
		<span style="color:#000;font-weight:bold">return</span> Compare(<span style="color:#000;font-weight:bold">this</span>, other) == <span style="color:#099">0</span>;
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">int</span> CompareTo(<span style="color:#458;font-weight:bold">object</span> obj)
	{
		<span style="color:#000;font-weight:bold">return</span> CompareTo(<span style="color:#000;font-weight:bold">this</span>, obj <span style="color:#000;font-weight:bold">as</span> ValueType&lt;T&gt;);
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">int</span> CompareTo(ValueType&lt;T&gt; other)
	{
		<span style="color:#000;font-weight:bold">return</span> Compare(<span style="color:#000;font-weight:bold">this</span>, other);
	}

	<span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">int</span> Compare(ValueType&lt;T&gt; instance1, ValueType&lt;T&gt; instance2)
	{
		<span style="color:#000;font-weight:bold">if</span> (ReferenceEquals(instance1, instance2)) <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
		<span style="color:#000;font-weight:bold">if</span> (ReferenceEquals(instance1, <span style="color:#000;font-weight:bold">null</span>)) <span style="color:#000;font-weight:bold">return</span> -<span style="color:#099">1</span>;
		<span style="color:#000;font-weight:bold">if</span> (ReferenceEquals(instance2, <span style="color:#000;font-weight:bold">null</span>)) <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">1</span>;

		<span style="color:#000;font-weight:bold">if</span> (ReferenceEquals(instance1.Value, instance2.Value)) <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
		<span style="color:#000;font-weight:bold">if</span> (ReferenceEquals(instance1.Value, <span style="color:#000;font-weight:bold">null</span>)) <span style="color:#000;font-weight:bold">return</span> -<span style="color:#099">1</span>;
		<span style="color:#000;font-weight:bold">if</span> (ReferenceEquals(instance2.Value, <span style="color:#000;font-weight:bold">null</span>)) <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">1</span>;

		<span style="color:#000;font-weight:bold">return</span> instance1.Value.CompareTo(instance2.Value);
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">operator</span> ==(ValueType&lt;T&gt; instance1, ValueType&lt;T&gt; instance2)
	{
		<span style="color:#000;font-weight:bold">return</span> Compare(instance1, instance2) == <span style="color:#099">0</span>;
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">operator</span> !=(ValueType&lt;T&gt; instance1, ValueType&lt;T&gt; instance2)
	{
		<span style="color:#000;font-weight:bold">return</span> !(instance1 == instance2);
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">operator</span> &lt;(ValueType&lt;T&gt; instance1, ValueType&lt;T&gt; instance2)
	{
		<span style="color:#000;font-weight:bold">return</span> Compare(instance1, instance2) &lt; <span style="color:#099">0</span>; 
	} 
		<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">bool</span> <span style="color:#000;font-weight:bold">operator</span> &gt;(ValueType&lt;T&gt; instance1, ValueType&lt;T&gt; instance2)
	{
		<span style="color:#000;font-weight:bold">return</span> Compare(instance1, instance2) &gt; <span style="color:#099">0</span>;
	}
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
										<li><a href="../../tags/patterns">Patterns</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">27</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Do we need an EventAggregator when we have an IOC container?</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>An <a href="http://msdn.microsoft.com/en-us/library/cc707867.aspx">Event Aggregator</a> is an example of a <a href="http://www.eaipatterns.com/PublishSubscribeChannel.html">Publish/Subscribe channel</a>. A while ago i started wondering if we still need an Event Aggregator in our compisite applications if we have an IOC container that takes cares of dependency wiring. An IOC container can easily inject the Event/MessageHandler(s) in the Event/MessagePublisher(s)&hellip; I&rsquo;m still not sure about the answer (Yes/No).</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/information-technology">Information Technology</a></li>
										
										<li><a href="../../tags/patterns">Patterns</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">26</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">About dependencies</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>This weekend i noticed a couple of posts by Uncle Bob trying to get some discussions going. In <a href="http://blog.objectmentor.com/articles/2010/01/23/mocking-mocking-and-testing-outcomes">Mocking Mocking and Testing Outcomes</a> at some point he generates a fake of some class</p>
<blockquote>
<p>“Oh, ick!” you say. Yes, I agree it’s a lot of code. On the other hand, it took me just a single keystroke on my IDE to generate all those dummy methods. (In IntelliJ it was simply command-I to implement all unimplemented methods.) So it wasn’t particularly hard. And, of course, I can put this code somewhere where nobody had to look at it unless they want to. It has the advantage that anybody who knows Java can understand it, and can look right at the methods to see what they are returning. No “special” knowledge of the mocking framework is necessary.</p>
</blockquote>
<p>So adding a lot of generated code, which no-one should ever look at, is better than a mocking framework? Hahaha, why would i want to repeat myself creating all those fake objects? (<a href="http://c2.com/cgi/wiki?DontRepeatYourself">DRY</a>)</p>
<p>Another problem that i have with his example is the fact that the &lsquo;dependency&rsquo; has a ton of methods that are not used by the consumer, so it makes me wonder: why are those methods there? Define an interface for the required methods, and have your consumer use that interface instead. This way you don&rsquo;t have to look at those unused methods which only clutter the API.</p>
<p>A second read made it clear that Uncle Bob is talking about unit-tests, which are typically implemented as state-based tests. In case you&rsquo;re doing integration tests, you will have (more) dependencies and want to verify the interaction between your system under test and the dependencies. And that is (imho) the scenario where mocking frameworks really shine 🙂</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/information-technology">Information Technology</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">23</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">About forced design</h1>
							</div>
						</div>
								
						<div class="markdown">
							<blockquote>
<p>if you need typemock your design is wrong.</p>
</blockquote>
<p>Although i understand what people are trying to say with that quote, it&rsquo;s wrong on many levels. I pretty much agree with everything that Roy wrote in <a href="http://weblogs.asp.net/rosherove/archive/2009/11/12/test-driven-design-willed-vs-forced-designs.aspx">Test driven design – Willed vs. Forced Designs</a>. As some commenters pointed out it is hard to convince management that they need an isolation framework, let alone that they have to pay for one.</p>
<p>A couple of thoughts:</p>
<ul>
<li>What about Pex Stubs &amp; Moles? It uses the profiling API (less limitations than rhino/moq/&hellip;) too and for a lot of shops doing .Net development it&rsquo;s free.</li>
<li>I really don&rsquo;t understand people that are unwilling to pay for tools that can contribute to the generation of business value (eg: Resharper, NCover, NDepend, &hellip;) when they don&rsquo;t come from Microsoft.</li>
<li>Filling up gaps in the .Net/Microsoft space seems like an awful business model.</li>
</ul>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/information-technology">Information Technology</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">16</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Programming the Bus Pirate with C#</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>A while ago i received my <a href="http://code.google.com/p/the-bus-pirate/">Bus Pirate</a> from <a href="http://www.seeedstudio.com/depot/">Seeed Studio Depot</a>. In essence it is a universal serial bus interface and i would love to program it using c#. I know that i can use the DataReceived event and then fiddle with bits (read <a href="http://msmvps.com/blogs/coad/archive/2005/03/23/39466.aspx#usb">here</a> if you&rsquo;re into that kind of self-punishment) but spawning a separate thread to do the blocking work is ten times less work to get it up and running</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">void</span> Main()
{
	<span style="color:#000;font-weight:bold">using</span> (<span style="color:#458;font-weight:bold">var</span> serialPort = <span style="color:#000;font-weight:bold">new</span> SerialPort(<span style="color:#d14">&#34;COM9&#34;</span>, <span style="color:#099">115200</span>, Parity.None, <span style="color:#099">8</span>, StopBits.One))
	{
		serialPort.Open();
		<span style="color:#000;font-weight:bold">new</span> Thread(() =&gt; WriteLinesFrom(serialPort)).Start();

		<span style="color:#000;font-weight:bold">while</span> (<span style="color:#000;font-weight:bold">true</span>)
		{
			<span style="color:#458;font-weight:bold">var</span> command = Console.ReadLine();
			<span style="color:#000;font-weight:bold">if</span> (command == <span style="color:#d14">&#34;EXIT&#34;</span>) <span style="color:#000;font-weight:bold">break</span>;
			serialPort.WriteLine(command);
		}
	}
}

<span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">void</span> WriteLinesFrom(SerialPort serialPort)
{
	<span style="color:#000;font-weight:bold">try</span>
	{
		<span style="color:#000;font-weight:bold">while</span> (<span style="color:#000;font-weight:bold">true</span>) Console.WriteLine(serialPort.ReadLine());
	}
	<span style="color:#000;font-weight:bold">catch</span> (Exception)
	{
		<span style="color:#000;font-weight:bold">break</span>;
	}
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">09</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">About raising events</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Very often i see people write the following to &lsquo;safely&rsquo; raise a method</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">event</span> EventHandler Stopped;

<span style="color:#000;font-weight:bold">void</span> RaiseStoppedEvent()
{
	<span style="color:#000;font-weight:bold">if</span> (Stopped != <span style="color:#000;font-weight:bold">null</span>) Stopped(<span style="color:#000;font-weight:bold">this</span>, EventArgs.Empty);
}
</code></pre></div><p>Some developers think that they should program defensively and avoid the potential concurrency problem</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">event</span> EventHandler Stopped;

<span style="color:#000;font-weight:bold">void</span> RaiseStoppedEvent()
{
	<span style="color:#458;font-weight:bold">var</span> handler = Stopped;
	<span style="color:#000;font-weight:bold">if</span> (handler!= <span style="color:#000;font-weight:bold">null</span>) handler(<span style="color:#000;font-weight:bold">this</span>, EventArgs.Empty);
}
</code></pre></div><p>And then there is Tim&rsquo;s way to raise an event: (If i&rsquo;m not mistaken it was <a href="http://www.ayende.com">Ayende</a> who once blogged about this)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">event</span> EventHandler Stopped = <span style="color:#000;font-weight:bold">delegate</span> { };

<span style="color:#000;font-weight:bold">void</span> RaiseStoppedEvent()
{
	Stopped(<span style="color:#000;font-weight:bold">this</span>, EventArgs.Empty);
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">09</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Add &amp;quot;Run as administrator&amp;quot; to .sln files</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p><a href="http://www.howtogeek.com/howto/windows-vista/add-run-as-administrator-to-any-file-type-in-windows-vista/">Another trick</a> i learned from the &ldquo;How-To Geek&rdquo; is how to add a &ldquo;Run as administrator&rdquo; option in the windows shell for .sln files which makes life considerably easier 😉</p>
<ul>
<li><a href="http://www.timvw.be/wp-content/code/csharp/AddRunAsAdministratorToSlnFilesInShell.reg.txt">AddRunAsAdministratorToSlnFilesInShell.reg.txt</a></li>
<li><a href="http://www.timvw.be/wp-content/code/csharp/AddRunAsAdministratorAsDefaultToSlnFilesInShell.reg.txt">AddRunAsAdministratorAsDefaultToSlnFilesInShell.reg.txt</a></li>
</ul>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/visual-studio">Visual Studio</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">08</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Creating graphs with the Silverlight Toolkit</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>As i wrote already: In a chart the elements on the X-axis are usually numbers or dates, and the elements on the Y-axis are usually doubles. We can define such a combination as following</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Point</span>&lt;T&gt;
{
	<span style="color:#000;font-weight:bold">public</span> T X { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">set</span>; }
	<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">double</span> Y { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">set</span>; }
}
</code></pre></div><p>Here is a little helper function for creating line series that are used by the <a href="http://silverlight.codeplex.com/">Silverlight Toolkit</a>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> LineSeries Create&lt;T&gt;(<span style="color:#458;font-weight:bold">string</span> title, Series&lt;T&gt; series, Func&lt;t, <span style="color:#458;font-weight:bold">double</span>&gt; f) <span style="color:#000;font-weight:bold">where</span> T : IComparable&lt;T&gt;
{
	<span style="color:#458;font-weight:bold">var</span> points = series.Select(x =&gt; <span style="color:#000;font-weight:bold">new</span> Point&lt;T&gt; { X = x, Y = f(x) });

	<span style="color:#458;font-weight:bold">var</span> lineSeries = <span style="color:#000;font-weight:bold">new</span> LineSeries
	{
		Title = title,
		ItemsSource = points,
		IndependentValuePath = <span style="color:#d14">&#34;X&#34;</span>,
		DependentValuePath = <span style="color:#d14">&#34;Y&#34;</span>
	};

	<span style="color:#000;font-weight:bold">return</span> lineSeries;
}
</code></pre></div><p>Given all this infrastructure we can easily draw the graph of a function:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> MainPage()
{
	InitializeComponent();

	<span style="color:#458;font-weight:bold">var</span> series = <span style="color:#099">0.</span>To(<span style="color:#099">100</span>);

	Func&lt;<span style="color:#458;font-weight:bold">int</span>, <span style="color:#458;font-weight:bold">double</span>&gt; multiplyByTwo = x =&gt; <span style="color:#099">2</span> * x;
	Chart1.Series.Add(Create(<span style="color:#d14">&#34;2x&#34;</span>, series, multiplyByTwo));

	Func&lt;<span style="color:#458;font-weight:bold">int</span>, <span style="color:#458;font-weight:bold">double</span>&gt; multiplyByThree = x =&gt; <span style="color:#099">3</span> * x;
	Chart1.Series.Add(Create(<span style="color:#d14">&#34;x/2&#34;</span>, series, multiplyByThree));
}
</code></pre></div><p>Here is how the result looks like (too much data on the chart)</p>
<p><img src="http://www.timvw.be/wp-content/images/silverlightchart.png" alt="screenshot of chart in silverlight toolkit"></p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
										<li><a href="../../tags/silverlight">Silverlight</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">08</span>
										<span class="rest">Jan 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Creating series of elements</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Lately i have done quite a bit of charting. Very often the X-axis is populated with a series of numbers or dates. This can be as simple as: (My very little DSL in <a href="http://codebetter.com/blogs/jeremy.miller/archive/2010/01/06/writing-internal-dsl-s-in-msdn.aspx">Jeremy D. Miller Style</a>)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#008080">[Test]</span> <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">void</span> ShouldBeAbleToGetSeriesOfNumbers()
{
	<span style="color:#998;font-style:italic">// Arrange
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#458;font-weight:bold">var</span> series = <span style="color:#099">3.</span>To(<span style="color:#099">5</span>);

	<span style="color:#998;font-style:italic">// Act
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#458;font-weight:bold">var</span> elements = series.Elements;

	<span style="color:#998;font-style:italic">// Assert
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#458;font-weight:bold">var</span> expected = <span style="color:#000;font-weight:bold">new</span>[] { <span style="color:#099">3</span>, <span style="color:#099">4</span>, <span style="color:#099">5</span> };
	CollectionAssert.AreEqual(expected, elements);
}
<span style="color:#008080">
</span><span style="color:#008080">[Test]</span> <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">void</span> ShouldBeAbleToGetSeriesOfDays()
{
	<span style="color:#998;font-style:italic">// Arrange
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#458;font-weight:bold">var</span> now = DateTime.Now.Date;
	<span style="color:#458;font-weight:bold">var</span> twoDaysLater = now.AddDays(<span style="color:#099">2</span>);
	<span style="color:#458;font-weight:bold">var</span> series = now.To(twoDaysLater);

	<span style="color:#998;font-style:italic">// Act
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#458;font-weight:bold">var</span> elements = series.Elements;

	<span style="color:#998;font-style:italic">// Assert
</span><span style="color:#998;font-style:italic"></span>	<span style="color:#458;font-weight:bold">var</span> expectedDays = <span style="color:#000;font-weight:bold">new</span>[] { now, now.AddDays(<span style="color:#099">1</span>), now.AddDays(<span style="color:#099">2</span>) };
	CollectionAssert.AreEqual(expectedDays, elements);
}
</code></pre></div><p>And here is the code that makes these tests pass</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Series</span>
{
	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Series&lt;<span style="color:#458;font-weight:bold">int</span>&gt; To(<span style="color:#000;font-weight:bold">this</span> <span style="color:#458;font-weight:bold">int</span> <span style="color:#000;font-weight:bold">from</span>, <span style="color:#458;font-weight:bold">int</span> to)
	{
		<span style="color:#000;font-weight:bold">return</span> Create(<span style="color:#000;font-weight:bold">from</span>, to);
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Series&lt;dateTime&gt; To(<span style="color:#000;font-weight:bold">this</span> DateTime <span style="color:#000;font-weight:bold">from</span>, DateTime to)
	{
		<span style="color:#000;font-weight:bold">return</span> Create(<span style="color:#000;font-weight:bold">from</span>, to);
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Series&lt;dateTime&gt; Create(DateTime <span style="color:#000;font-weight:bold">from</span>, DateTime to)
	{
		<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> Series&lt;dateTime&gt;(<span style="color:#000;font-weight:bold">from</span>.Date, to.Date, d =&gt; d.AddDays(<span style="color:#099">1</span>));
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Series&lt;dateTime&gt; Create(DateTime <span style="color:#000;font-weight:bold">from</span>, <span style="color:#458;font-weight:bold">int</span> numberOfDays)
	{
		<span style="color:#000;font-weight:bold">return</span> Create(<span style="color:#000;font-weight:bold">from</span>.Date, <span style="color:#000;font-weight:bold">from</span>.Date.AddDays(numberOfDays));
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Series&lt;<span style="color:#458;font-weight:bold">int</span>&gt; Create(<span style="color:#458;font-weight:bold">int</span> <span style="color:#000;font-weight:bold">from</span>, <span style="color:#458;font-weight:bold">int</span> to)
	{
		<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> Series&lt;<span style="color:#458;font-weight:bold">int</span>&gt;(<span style="color:#000;font-weight:bold">from</span>, to, n =&gt; n + <span style="color:#099">1</span>);
	}

	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> Series&lt;<span style="color:#458;font-weight:bold">int</span>&gt; Create(<span style="color:#458;font-weight:bold">int</span> <span style="color:#000;font-weight:bold">from</span>, <span style="color:#458;font-weight:bold">int</span> to, <span style="color:#458;font-weight:bold">int</span> stepSize)
	{
		<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> Series&lt;<span style="color:#458;font-weight:bold">int</span>&gt;(<span style="color:#000;font-weight:bold">from</span>, to, n =&gt; n + stepSize);
	}
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Series</span>&lt;T&gt; : IEnumerable&lt;T&gt; <span style="color:#000;font-weight:bold">where</span> T : IComparable
{
	<span style="color:#000;font-weight:bold">public</span> T From { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">set</span>; }
	<span style="color:#000;font-weight:bold">public</span> T To { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">set</span>; }
	<span style="color:#000;font-weight:bold">public</span> Func&lt;t, T&gt; Step { <span style="color:#000;font-weight:bold">get</span>; <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">set</span>; }

	<span style="color:#000;font-weight:bold">public</span> Series(T <span style="color:#000;font-weight:bold">from</span>, T to, Func&lt;t, T&gt; step)
	{
		From = <span style="color:#000;font-weight:bold">from</span>;
		To = to;
		Step = step;
	}

	<span style="color:#000;font-weight:bold">public</span> IEnumerable&lt;T&gt; Elements
	{
		<span style="color:#000;font-weight:bold">get</span>
		{
			<span style="color:#458;font-weight:bold">var</span> current = From;
			<span style="color:#000;font-weight:bold">while</span> (current.CompareTo(To) &lt;= <span style="color:#099">0</span>) 
			{ 
				<span style="color:#000;font-weight:bold">yield</span> <span style="color:#000;font-weight:bold">return</span> current; current = Step(current); 
			} 
		} 
	} 
	
	<span style="color:#000;font-weight:bold">public</span> IEnumerator&lt;T&gt; GetEnumerator()
	{
		<span style="color:#000;font-weight:bold">return</span> Elements.GetEnumerator();
	}

	IEnumerator IEnumerable.GetEnumerator()
	{
		<span style="color:#000;font-weight:bold">return</span> GetEnumerator();
	}
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/csharp">CSharp</a></li>
										
										<li><a href="../../tags/patterns">Patterns</a></li>
										
									</ul>
								
							
						</div></div>
				
				

<ul class="pagination">
	<li class="page-item page-prev">
	
    <a href="../../page/10/" class="page-link" aria-label="Previous"><span aria-hidden="true">← Prev page</span></a>
	
	</li>
	<li class="page-item page-next">
	
    <a href="../../page/12/" class="page-link" aria-label="Next"><span aria-hidden="true">Next page →</span></a>
	
	</li>
</ul>


			</div>
		</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2022  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
