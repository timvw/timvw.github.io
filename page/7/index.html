<!DOCTYPE html>
<html>
<head>
	<meta name="generator" content="Hugo 0.92.2" />
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Tim Van Wassenhove - Passionate geek, interested in Technology. Proud father of two </title><meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="alternate" type="application/rss+xml" href="https://timvw.be/feed.xml" title="Tim Van Wassenhove" />
	<meta itemprop="name" content="Tim Van Wassenhove">
<meta itemprop="description" content=""><meta property="og:title" content="Tim Van Wassenhove" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://timvw.be/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tim Van Wassenhove"/>
<meta name="twitter:description" content=""/>
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../">Home</a>
			</li>
			
			<li>
				<a href="../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../tags">Tags</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="recent-posts section">
			<div class="posts">
				
				
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">17</span>
										<span class="rest">Nov 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Load all script files at PowerShell startup</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>These days i have quite some scripts files that i want to be loaded each time i launch PowerShell. <a href="http://msdn.microsoft.com/en-us/library/bb613488%28VS.85%29.aspx">Windows PowerShell Profiles</a> teaches me where i should store my $profile. Here is what it looks like:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#998;font-style:italic"># Lookup powershell scripts location</span>
<span style="color:#008080">$UserProfile</span> = (<span style="color:#0086b3">Get-ChildItem</span> Env<span style="color:#a61717;background-color:#e3d2d2">:</span>UserProfile).Value;
<span style="color:#008080">$ScriptFolder</span> = <span style="color:#d14">&#34;$UserProfile\My documents\WindowsPowerShell&#34;</span>;

<span style="color:#998;font-style:italic"># Source all .ps1 files in PowerShell profile folder  </span>
<span style="color:#0086b3">Get-ChildItem</span> <span style="color:#008080">$ScriptFolder</span> -name -include <span style="color:#d14">&#39;*.ps1&#39;</span> -exclude <span style="color:#d14">&#39;profile.ps1&#39;</span>   
| <span style="color:#000;font-weight:bold">foreach</span> { (. <span style="color:#d14">&#34;$ScriptFolder\$_&#34;</span>) };

<span style="color:#998;font-style:italic"># Configure environment for VS2010  </span>
SetVS2010;
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/powershell">PowerShell</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">11</span>
										<span class="rest">Nov 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Get variable value from variable with PowerShell</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Sometimes you only know at runtime in which variable a certain value is stored. Let me clarify with an example:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#008080">$tim</span> = 30;
<span style="color:#008080">$evy</span> = 24;
<span style="color:#008080">$name</span> = <span style="color:#0086b3">Read-Host</span> <span style="color:#d14">&#34;Enter your name&#34;</span>;
</code></pre></div><p>In essence, if $name equals tim we want to use $tim and if $name equals evy we want to use $evy. This can be achieved with Get-Variable:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#008080">$age</span> = <span style="color:#0086b3">Get-Variable</span> <span style="color:#008080">$name</span> -valueOnly;
<span style="color:#0086b3">Write-Host</span> <span style="color:#d14">&#34;Your age is $age&#34;</span>;
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/powershell">PowerShell</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">11</span>
										<span class="rest">Nov 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Update ConfigurationStrings in SSIS package with PowerShell</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Here are some functions that allow you to update ConfigurationStrings in a SSIS package (dtsx) using PowerShell:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#000;font-weight:bold">function</span> UpdateConfigurationStrings(<span style="color:#008080">$file</span>)
{
	<span style="color:#008080">$xml</span> = <span style="color:#008080">[xml]</span> (<span style="color:#0086b3">Get-Content</span> <span style="color:#008080">$file</span>);
	<span style="color:#008080">$ns</span> = <span style="color:#0086b3">New-Object</span> Xml.XmlNamespaceManager <span style="color:#008080">$xml</span>.NameTable;
	<span style="color:#008080">$ns</span>.AddNamespace(<span style="color:#d14">&#34;DTS&#34;</span>, <span style="color:#d14">&#34;www.microsoft.com/SqlServer/Dts&#34;</span>);
	UpdateConfigurationNodes <span style="color:#008080">$xml</span> <span style="color:#008080">$ns</span>;
	<span style="color:#0086b3">Set-Content</span> <span style="color:#008080">$file</span> <span style="color:#008080">$xml</span>.OuterXml;
}

<span style="color:#000;font-weight:bold">function</span> UpdateConfigurationNodes(<span style="color:#008080">$xml</span>, <span style="color:#008080">$ns</span>)
{
	<span style="color:#008080">$selectConfigurationNodes</span> = <span style="color:#d14">&#34;//DTS:Configuration&#34;</span>;
	<span style="color:#008080">$xml</span>.SelectNodes(<span style="color:#008080">$selectConfigurationNodes</span>, <span style="color:#008080">$ns</span>) | <span style="color:#000;font-weight:bold">foreach</span> { UpdateConfigurationNode <span style="color:#008080">$_</span> <span style="color:#008080">$ns</span>; };
}

<span style="color:#000;font-weight:bold">function</span> UpdateConfigurationNode(<span style="color:#008080">$configurationNode</span>, <span style="color:#008080">$ns</span>)
{
	<span style="color:#008080">$selectConfigurationString</span> = <span style="color:#d14">&#34;./DTS:Property[@DTS:Name=&#39;ConfigurationString&#39;]&#34;</span>;
	<span style="color:#008080">$configurationStringNode</span> = <span style="color:#008080">$configurationNode</span>.SelectSingleNode(<span style="color:#008080">$selectConfigurationString</span>, <span style="color:#008080">$ns</span>);

	<span style="color:#008080">$oldConfigurationStringValue</span> = <span style="color:#008080">$configurationStringNode</span>.<span style="color:#d14">&#39;#text&#39;</span>;
	<span style="color:#008080">$newConfigurationStringValue</span> = GetNewConfigurationStringValue <span style="color:#008080">$oldConfigurationStringValue</span>;
	<span style="color:#008080">$configurationStringNode</span>.<span style="color:#d14">&#39;#text&#39;</span> = <span style="color:#d14">&#34;$newConfigurationStringValue&#34;</span>;
}

<span style="color:#000;font-weight:bold">function</span> GetNewConfigurationStringValue(<span style="color:#008080">$oldConfigurationStringValue</span>)
{
	<span style="color:#998;font-style:italic"># implement some logic to determine new value</span>
	<span style="color:#000;font-weight:bold">return</span> <span style="color:#d14">&#34;new value&#34;</span>;
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/powershell">PowerShell</a></li>
										
										<li><a href="../../tags/ssis">SSIS</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">07</span>
										<span class="rest">Nov 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Build your solution with Visual Studio from MSBuild</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Unfortunately MSBuild and <a href="http://bidshelper.codeplex.com/">BIDS Helper</a> are not able to build an .asdatabase from our Analysis Services project (.dwproj). Here is a task which invokes Visual Studio to build such a solution:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;Target</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;DevEnvBuild&#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;Error</span> <span style="color:#008080">Condition=</span><span style="color:#d14">&#34;&#39;$(SolutionFile)&#39;==&#34;</span><span style="color:#a61717;background-color:#e3d2d2">&#34;</span> <span style="color:#008080">Text=</span><span style="color:#d14">&#34;Missing SolutionFile&#34;</span> <span style="color:#000080">/&gt;</span>
	<span style="color:#000080">&lt;PropertyGroup&gt;</span>
		<span style="color:#000080">&lt;DevEnvTool</span> <span style="color:#008080">Condition=</span><span style="color:#d14">&#34;&#39;$(DevEnvTool)&#39;==&#34;</span><span style="color:#a61717;background-color:#e3d2d2">&#34;</span><span style="color:#000080">&gt;</span>C:\Program Files\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe<span style="color:#000080">&lt;/DevEnvTool&gt;</span>
		<span style="color:#000080">&lt;DevEnvSwitch</span> <span style="color:#008080">Condition=</span><span style="color:#d14">&#34;&#39;$(DevEnvSwitch)&#39;==&#34;</span><span style="color:#a61717;background-color:#e3d2d2">&#34;</span><span style="color:#000080">&gt;</span>Build<span style="color:#000080">&lt;/DevEnvSwitch&gt;</span>
		<span style="color:#000080">&lt;DevEnvBuildCommand&gt;</span>&#34;$(DevEnvTool)&#34; &#34;$(SolutionFile)&#34; /$(DevEnvSwitch)<span style="color:#000080">&lt;/DevEnvBuildCommand&gt;</span>
	<span style="color:#000080">&lt;/PropertyGroup&gt;</span>
	<span style="color:#000080">&lt;Exec</span> <span style="color:#008080">Command=</span><span style="color:#d14">&#34;$(DevEnvBuildCommand)&#34;</span> <span style="color:#000080">/&gt;</span>
<span style="color:#000080">&lt;/Target&gt;</span>
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/msbuild">MSBuild</a></li>
										
										<li><a href="../../tags/ssas">ssas</a></li>
										
										<li><a href="../../tags/visual-studio">Visual Studio</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">07</span>
										<span class="rest">Nov 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Invoke PowerShell script from MSBuild</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Here is a small MSBuild target that allows you to invoke a PowerShell script, eg: powershell.exe &amp; &lsquo;script.ps1&rsquo; -SomeParam &lsquo;x&rsquo;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#000080">&lt;Target</span> <span style="color:#008080">Name=</span><span style="color:#d14">&#34;InvokePowerShell&#34;</span><span style="color:#000080">&gt;</span>
	<span style="color:#000080">&lt;PropertyGroup&gt;</span>
		<span style="color:#000080">&lt;PowerShellCommand&gt;</span>&#34;$(PowerShellTool)&#34; &#34;<span style="color:#a61717;background-color:#e3d2d2">&amp;</span> &#39;$(ScriptFile)&#39; -SomeParam &#39;$(SomeParam)&#39; &#34;<span style="color:#000080">&lt;/PowerShellCommand&gt;</span>
	<span style="color:#000080">&lt;/PropertyGroup&gt;</span>
	<span style="color:#000080">&lt;Exec</span> <span style="color:#008080">Command=</span><span style="color:#d14">&#34;$(PowerShellCommand)&#34;</span> <span style="color:#000080">/&gt;</span>
<span style="color:#000080">&lt;/Target&gt;</span>
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/msbuild">MSBuild</a></li>
										
										<li><a href="../../tags/powershell">PowerShell</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">07</span>
										<span class="rest">Nov 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Modify a text file with PowerShell</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>A while ago i wanted to update a connection string in a configuration file. My first attempt was the following:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#0086b3">Get-Content</span> <span style="color:#008080">$File</span>
| <span style="color:#000;font-weight:bold">Foreach</span> { <span style="color:#008080">$_</span> <span style="color:#000;font-weight:bold">-Replace</span> <span style="color:#d14">&#34;Source&gt;(.*?)&lt;&#34;</span>, <span style="color:#d14">&#34;Source&gt;$New&lt;&#34;</span> }
| <span style="color:#0086b3">Set-Content</span> <span style="color:#008080">$File</span>;
</code></pre></div><p>Running this scripts leads to the following error: &ldquo;Set-Content : The process cannot access the file because it is being used by another process.&rdquo; In order to avoid this you can complete the read operation before you start writing as following:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">(<span style="color:#0086b3">Get-Content</span> <span style="color:#008080">$File</span>)
| <span style="color:#000;font-weight:bold">Foreach</span> { <span style="color:#008080">$_</span> <span style="color:#000;font-weight:bold">-Replace</span> <span style="color:#d14">&#34;Source&gt;(.*?)&lt;&#34;</span>, <span style="color:#d14">&#34;Source&gt;$New&lt;&#34;</span> }
| <span style="color:#0086b3">Set-Content</span> <span style="color:#008080">$File</span>;
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/powershell">PowerShell</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">01</span>
										<span class="rest">Nov 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Deploying a Database Project does not create artefacts for custom schemas</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Last week we noticed that the artefacts for a custom schema in our Database Project were not created (or updated). It took us a while to figure out what was wrong. When you add a script via the &lsquo;Add Existing item&rsquo; menu in VS2010 the file&rsquo;s <strong>Build Action</strong> is set to <strong>Not in Build</strong> for some unknown reason. As soon as we changed the value to <strong>Build</strong> and Deployed again our artefacts were created.</p>

						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/sql">SQL</a></li>
										
										<li><a href="../../tags/vs2010">vs2010</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">25</span>
										<span class="rest">Oct 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">Update all repositories with Powershell</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>I typically store the repositories i am working on under D:\Code. Each morning i had to right click on each of those folders and select &lsquo;SVN Update&rsquo; using <a href="http://tortoisesvn.tigris.org/">Tortoise SVN</a>. Today i decided there had to be a better way to accomplish this tedious task:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#0086b3">dir </span>d:\code | <span style="color:#000;font-weight:bold">foreach</span> { svn update <span style="color:#008080">$_</span>.FullName }
</code></pre></div><p>And in case you really like tortoise, you can do the following:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#0086b3">dir </span>c:\code | <span style="color:#000;font-weight:bold">foreach</span> { tortoiseproc /command<span style="color:#a61717;background-color:#e3d2d2">:</span>update /closeonend<span style="color:#a61717;background-color:#e3d2d2">:</span>1 /path<span style="color:#a61717;background-color:#e3d2d2">:</span>$(<span style="color:#008080">$_</span>.FullName) }
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/powershell">PowerShell</a></li>
										
										<li><a href="../../tags/tortoisesvn">TortoiseSVN</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">07</span>
										<span class="rest">Sep 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">T-SQL: Remove all rows from all tables in your schema</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Sometimes i want to quickly clean up a database and start from fresh. Here is a small script that does exactly that.. (I just run the script a couple of times, untill no affected rows remain&hellip; Far more efficient than figuring out which constraints exist, building up a dependency tree, and cleanly deleting all rows):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#998;font-style:italic">-- Remove all rows from all tables
</span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@</span>tableName<span style="color:#bbb"> </span><span style="color:#0086b3">VARCHAR</span>(<span style="color:#099">255</span>)<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">DECLARE</span><span style="color:#bbb"> </span>tableNames<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">CURSOR</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FOR</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>name<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb"> </span>sys.Tables;<span style="color:#bbb">
</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">OPEN</span><span style="color:#bbb"> </span>tableNames<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">FETCH</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">NEXT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb"> </span>tableNames<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">INTO</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@</span>tableName<span style="color:#bbb">
</span><span style="color:#bbb"></span>WHILE<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>FETCH_STATUS<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#099">0</span><span style="color:#bbb"> 
</span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">BEGIN</span><span style="color:#bbb">
</span><span style="color:#bbb">	</span><span style="color:#000;font-weight:bold">EXEC</span>(<span style="color:#d14">&#39;DELETE FROM [&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@</span>tableName<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;]&#39;</span>)<span style="color:#bbb">
</span><span style="color:#bbb">	</span><span style="color:#000;font-weight:bold">FETCH</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">NEXT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb"> </span>tableNames<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">INTO</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@</span>tableName<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">END</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">CLOSE</span><span style="color:#bbb"> </span>tableNames<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">DEALLOCATE</span><span style="color:#bbb"> </span>tableNames<span style="color:#bbb">
</span></code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/sql">SQL</a></li>
										
										<li><a href="../../tags/t-sql">t-sql</a></li>
										
									</ul>
								
							
						</div></div>
				
					<div class="post">
						<div class="post-header">
							
								<div class="meta">
									<div class="date">
										<span class="day">07</span>
										<span class="rest">Sep 2010</span>
									</div>
								</div>
							
							<div class="matter">
								<h1 class="title">WIF: whr parameter is a hint for user Home Realm</h1>
							</div>
						</div>
								
						<div class="markdown">
							<p>Yesterday i was reading the <a href="http://claimsid.codeplex.com/">Claims Based Identity &amp; Access Control Guide</a> and learned that the whr parameter is a hint from the application to the STS about the user&rsquo;s STS. So if i look back at the code in <a href="http://www.timvw.be/wif-change-sts-per-request/">WIF: Change STS per request</a> i should not hardcode the HomeRealm parameter to timvw but use the company name instead.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#458;font-weight:bold">string</span> GetRedirectUrl(<span style="color:#458;font-weight:bold">string</span> company, <span style="color:#458;font-weight:bold">string</span> companySts, <span style="color:#458;font-weight:bold">string</span> realm, <span style="color:#458;font-weight:bold">string</span> returnUrl)
{
	<span style="color:#458;font-weight:bold">var</span> signInRequestMessage = <span style="color:#000;font-weight:bold">new</span> SignInRequestMessage(<span style="color:#000;font-weight:bold">new</span> Uri(companySts), realm)
	{
	Context = returnUrl,
	HomeRealm = company
	};

	<span style="color:#000;font-weight:bold">return</span> signInRequestMessage.WriteQueryString();
}
</code></pre></div>
						</div>
			
						<div class="tags">
							
								
									<ul class="flat">
										
										<li><a href="../../tags/sts">sts</a></li>
										
										<li><a href="../../tags/wif">wif</a></li>
										
									</ul>
								
							
						</div></div>
				
				

<ul class="pagination">
	<li class="page-item page-prev">
	
    <a href="../../page/6/" class="page-link" aria-label="Previous"><span aria-hidden="true">← Prev page</span></a>
	
	</li>
	<li class="page-item page-next">
	
    <a href="../../page/8/" class="page-link" aria-label="Next"><span aria-hidden="true">Next page →</span></a>
	
	</li>
</ul>


			</div>
		</div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2022  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2585435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<script>feather.replace()</script>
</body>
</html>
