<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>How does the controller know which action method to invoke? - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	
  <meta itemprop="name" content="How does the controller know which action method to invoke?">
  <meta itemprop="description" content="Yesterday i attended another great VISUG event on ASP.NET presented by Maarten Balliauw. He demonstrated a custom filter but did not dig into the mechanics of action method resolving. With the aid of of the ActionName attribute we can map different methods to the same action. The following methods will all map to the same “Detail” action
public ActionResult Detail(int productId) { ... } public ActionResult Detail(int productId, string name) { ... } [ActionName(&#34;Detail&#34;)] public ActionResult DisplayDetail(int productId) { ... } [ActionName(&#34;Detail&#34;)] public ActionResult ModifyDetail(int productId, string name) { ... } So how does the Controller know which method to invoke? The answer can be found in the ActionMethodSelector which tries to find the method as following">
  <meta itemprop="datePublished" content="2008-10-15T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-01-04T22:47:36+01:00">
  <meta itemprop="wordCount" content="258">
  <meta itemprop="keywords" content="ASP.NET,CSharp"><meta property="og:url" content="https://timvw.be/2008/10/15/how-does-the-controller-know-which-action-method-to-invoke/">
  <meta property="og:site_name" content="Tim Van Wassenhove">
  <meta property="og:title" content="How does the controller know which action method to invoke?">
  <meta property="og:description" content="Yesterday i attended another great VISUG event on ASP.NET presented by Maarten Balliauw. He demonstrated a custom filter but did not dig into the mechanics of action method resolving. With the aid of of the ActionName attribute we can map different methods to the same action. The following methods will all map to the same “Detail” action
public ActionResult Detail(int productId) { ... } public ActionResult Detail(int productId, string name) { ... } [ActionName(&#34;Detail&#34;)] public ActionResult DisplayDetail(int productId) { ... } [ActionName(&#34;Detail&#34;)] public ActionResult ModifyDetail(int productId, string name) { ... } So how does the Controller know which method to invoke? The answer can be found in the ActionMethodSelector which tries to find the method as following">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2008-10-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-01-04T22:47:36+01:00">
    <meta property="article:tag" content="ASP.NET">
    <meta property="article:tag" content="CSharp">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="How does the controller know which action method to invoke?">
  <meta name="twitter:description" content="Yesterday i attended another great VISUG event on ASP.NET presented by Maarten Balliauw. He demonstrated a custom filter but did not dig into the mechanics of action method resolving. With the aid of of the ActionName attribute we can map different methods to the same action. The following methods will all map to the same “Detail” action
public ActionResult Detail(int productId) { ... } public ActionResult Detail(int productId, string name) { ... } [ActionName(&#34;Detail&#34;)] public ActionResult DisplayDetail(int productId) { ... } [ActionName(&#34;Detail&#34;)] public ActionResult ModifyDetail(int productId, string name) { ... } So how does the Controller know which method to invoke? The answer can be found in the ActionMethodSelector which tries to find the method as following">
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
	<link href="https://github.com/timvw" rel="me">
    <link href="https://timvw.be/" rel="me">
    <link href="https://fosstodon.org/@timvw" rel="me">
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li><li><a rel="me" href="https://fosstodon.org/@timvw" class="masto-link" ></a></li>
			</ul>
		
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../../../">Home</a>
			</li>
			
			<li>
				<a href="../../../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../../../tags">Tags</a>
			</li>
			
			<li>
				<a href="../../../../about/">About Me</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">15</span>
							<span class="rest">Oct 2008</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">How does the controller know which action method to invoke?</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Yesterday i attended another great <a href="http://www.visug.be">VISUG</a> event on ASP.NET presented by <a href="http://blog.maartenballiauw.be/">Maarten Balliauw</a>. He demonstrated a custom filter but did not dig into the mechanics of action method resolving. With the aid of of the ActionName attribute we can map different methods to the same action. The following methods will all map to the same &ldquo;Detail&rdquo; action</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">public</span> ActionResult Detail<span style="color:#1f2328">(</span><span style="color:#cf222e">int</span> productId<span style="color:#1f2328">)</span> <span style="color:#1f2328">{</span> <span style="color:#1f2328">...</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">public</span> ActionResult Detail<span style="color:#1f2328">(</span><span style="color:#cf222e">int</span> productId<span style="color:#1f2328">,</span> <span style="color:#cf222e">string</span> name<span style="color:#1f2328">)</span> <span style="color:#1f2328">{</span> <span style="color:#1f2328">...</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">[ActionName(&#34;Detail&#34;)]</span> <span style="color:#cf222e">public</span> ActionResult DisplayDetail<span style="color:#1f2328">(</span><span style="color:#cf222e">int</span> productId<span style="color:#1f2328">)</span> <span style="color:#1f2328">{</span> <span style="color:#1f2328">...</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">[ActionName(&#34;Detail&#34;)]</span> <span style="color:#cf222e">public</span> ActionResult ModifyDetail<span style="color:#1f2328">(</span><span style="color:#cf222e">int</span> productId<span style="color:#1f2328">,</span> <span style="color:#cf222e">string</span> name<span style="color:#1f2328">)</span> <span style="color:#1f2328">{</span> <span style="color:#1f2328">...</span> <span style="color:#1f2328">}</span>
</span></span></code></pre></div><p>So how does the Controller know which method to invoke? The answer can be found in the ActionMethodSelector which tries to find the method as following</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">public</span> MethodInfo FindActionMethod<span style="color:#1f2328">(</span>ControllerContext controllerContext<span style="color:#1f2328">,</span> <span style="color:#cf222e">string</span> action<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	List<span style="color:#1f2328">&lt;</span>methodInfo<span style="color:#1f2328">&gt;</span> methodsMatchingName <span style="color:#1f2328">=</span> GetMatchingAliasedMethods<span style="color:#1f2328">(</span>controllerContext<span style="color:#1f2328">,</span> action<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>	methodsMatchingName<span style="color:#1f2328">.</span>AddRange<span style="color:#1f2328">(</span>NonAliasedMethods<span style="color:#1f2328">[</span>action<span style="color:#1f2328">]);</span>
</span></span><span style="display:flex;"><span>	List<span style="color:#1f2328">&lt;</span>methodInfo<span style="color:#1f2328">&gt;</span> finalMethods <span style="color:#1f2328">=</span> RunSelectionFilters<span style="color:#1f2328">(</span>controllerContext<span style="color:#1f2328">,</span> methodsMatchingName<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">switch</span> <span style="color:#1f2328">(</span>finalMethods<span style="color:#1f2328">.</span>Count<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">case</span> <span style="color:#0550ae">0</span><span style="color:#1f2328">:</span> <span style="color:#cf222e">return</span> <span style="color:#cf222e">null</span><span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">case</span> <span style="color:#0550ae">1</span><span style="color:#1f2328">:</span> <span style="color:#cf222e">return</span> finalMethods<span style="color:#1f2328">[</span><span style="color:#0550ae">0</span><span style="color:#1f2328">];</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">default</span><span style="color:#1f2328">:</span> <span style="color:#cf222e">throw</span> CreateAmbiguousMatchException<span style="color:#1f2328">(</span>finalMethods<span style="color:#1f2328">,</span> action<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span></code></pre></div><p>In the RunSelectionFilters method all the found ActionSelection Attributes have their IsValidForRequest method called in the hope that only one potential method remains.</p>
<p>The most common scenario is that we want our controller to behave depending upon the request method (POST vs GET). For this scenario there is the AcceptVerbsAttribute. eg</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#1f2328">[ActionName(&#34;Detail&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">[AcceptVerbs(&#34;GET&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">public</span> ActionResult DisplayDetail<span style="color:#1f2328">(</span><span style="color:#cf222e">int</span> productId<span style="color:#1f2328">)</span> <span style="color:#1f2328">{</span> <span style="color:#1f2328">...</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">
</span></span></span><span style="display:flex;"><span><span style="color:#1f2328">[ActionName(&#34;Detail&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">[AcceptVerbs(&#34;POST&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">public</span> ActionResult ModifyDetail<span style="color:#1f2328">(</span><span style="color:#cf222e">int</span> productId<span style="color:#1f2328">,</span> <span style="color:#cf222e">string</span> name<span style="color:#1f2328">)</span> <span style="color:#1f2328">{</span> <span style="color:#1f2328">...</span> <span style="color:#1f2328">}</span>
</span></span></code></pre></div><p>The implementation of the IsValidForRequest method in the AcceptVerbsAttribute is pretty simple</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">public</span> <span style="color:#cf222e">override</span> <span style="color:#cf222e">bool</span> IsValidForRequest<span style="color:#1f2328">(</span>ControllerContext controllerContext<span style="color:#1f2328">,</span> MethodInfo methodInfo<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">if</span> <span style="color:#1f2328">(</span>controllerContext <span style="color:#1f2328">==</span> <span style="color:#cf222e">null</span><span style="color:#1f2328">)</span> <span style="color:#cf222e">throw</span> <span style="color:#cf222e">new</span> ArgumentNullException<span style="color:#1f2328">(</span><span style="color:#0a3069">&#34;controllerContext&#34;</span><span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">string</span> incomingVerb <span style="color:#1f2328">=</span> controllerContext<span style="color:#1f2328">.</span>HttpContext<span style="color:#1f2328">.</span>Request<span style="color:#1f2328">.</span>HttpMethod<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">return</span> Verbs<span style="color:#1f2328">.</span>Contains<span style="color:#1f2328">(</span>incomingVerb<span style="color:#1f2328">,</span> StringComparer<span style="color:#1f2328">.</span>OrdinalIgnoreCase<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span></code></pre></div>
			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../../../tags/asp.net">ASP.NET</a></li>
							
							<li><a href="../../../../tags/csharp">CSharp</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2025  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-9DP4SV12YW');
        }
      </script><script>feather.replace()</script>
</body>
</html>
