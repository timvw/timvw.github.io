<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Programming the csproj file - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	
  <meta itemprop="name" content="Programming the csproj file">
  <meta itemprop="description" content="Imagine that you have a couple of project files that reference framework libraries that are on a buildserver. Upgrading to a newer version requires that you update all the references… I wrote some wrapper classes (ProjectFile, AssemblyReference) that make this tedious task a breeze. Here is an example of their usage
string path = &#34;D:\\Projects\\MyProject&#34;; string[] projectFileNames = ProjectFile.Find(path); foreach (string projectFileName in projectFileNames) { ProjectFile projectFile = new ProjectFile(projectFileName); bool updated = false; foreach (AssemblyReference assemblyReference in projectFile.AssemblyReferences) { if (assemblyReference.HintPath.ToLower().StartsWith(&#34;\\\\buildserver\\framework\\2.0&#34;)) { string newHintPath = assemblyReference.HintPath.Replace(&#34;\\2.0\\&#34;, &#34;\\2.1\\&#34;); assemblyReference.HintPath = newHintPath; AssemblyName assemblyName = AssemblyName.GetAssemblyName(assemblyReference.HintPath); assemblyReference.AssemblyName = assemblyName.FullName &#43; &#34;, processorArchitecture=&#34; &#43; assemblyName.ProcessorArchitecture; updated = true; } } if (updated) { projectFile.Save(); } } Edit: Be careful because it might be possible that the code changes the encoding of your csproj file (and it seems that the TFS 2005 merge tool doesn’t like that). Currently files are written as UTF-8, which is the default for VS2005 csproj files.">
  <meta itemprop="datePublished" content="2008-01-25T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-01-04T22:47:36+01:00">
  <meta itemprop="wordCount" content="158">
  <meta itemprop="keywords" content="CSharp"><meta property="og:url" content="https://timvw.be/2008/01/25/programming-the-csproj-file/">
  <meta property="og:site_name" content="Tim Van Wassenhove">
  <meta property="og:title" content="Programming the csproj file">
  <meta property="og:description" content="Imagine that you have a couple of project files that reference framework libraries that are on a buildserver. Upgrading to a newer version requires that you update all the references… I wrote some wrapper classes (ProjectFile, AssemblyReference) that make this tedious task a breeze. Here is an example of their usage
string path = &#34;D:\\Projects\\MyProject&#34;; string[] projectFileNames = ProjectFile.Find(path); foreach (string projectFileName in projectFileNames) { ProjectFile projectFile = new ProjectFile(projectFileName); bool updated = false; foreach (AssemblyReference assemblyReference in projectFile.AssemblyReferences) { if (assemblyReference.HintPath.ToLower().StartsWith(&#34;\\\\buildserver\\framework\\2.0&#34;)) { string newHintPath = assemblyReference.HintPath.Replace(&#34;\\2.0\\&#34;, &#34;\\2.1\\&#34;); assemblyReference.HintPath = newHintPath; AssemblyName assemblyName = AssemblyName.GetAssemblyName(assemblyReference.HintPath); assemblyReference.AssemblyName = assemblyName.FullName &#43; &#34;, processorArchitecture=&#34; &#43; assemblyName.ProcessorArchitecture; updated = true; } } if (updated) { projectFile.Save(); } } Edit: Be careful because it might be possible that the code changes the encoding of your csproj file (and it seems that the TFS 2005 merge tool doesn’t like that). Currently files are written as UTF-8, which is the default for VS2005 csproj files.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2008-01-25T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-01-04T22:47:36+01:00">
    <meta property="article:tag" content="CSharp">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Programming the csproj file">
  <meta name="twitter:description" content="Imagine that you have a couple of project files that reference framework libraries that are on a buildserver. Upgrading to a newer version requires that you update all the references… I wrote some wrapper classes (ProjectFile, AssemblyReference) that make this tedious task a breeze. Here is an example of their usage
string path = &#34;D:\\Projects\\MyProject&#34;; string[] projectFileNames = ProjectFile.Find(path); foreach (string projectFileName in projectFileNames) { ProjectFile projectFile = new ProjectFile(projectFileName); bool updated = false; foreach (AssemblyReference assemblyReference in projectFile.AssemblyReferences) { if (assemblyReference.HintPath.ToLower().StartsWith(&#34;\\\\buildserver\\framework\\2.0&#34;)) { string newHintPath = assemblyReference.HintPath.Replace(&#34;\\2.0\\&#34;, &#34;\\2.1\\&#34;); assemblyReference.HintPath = newHintPath; AssemblyName assemblyName = AssemblyName.GetAssemblyName(assemblyReference.HintPath); assemblyReference.AssemblyName = assemblyName.FullName &#43; &#34;, processorArchitecture=&#34; &#43; assemblyName.ProcessorArchitecture; updated = true; } } if (updated) { projectFile.Save(); } } Edit: Be careful because it might be possible that the code changes the encoding of your csproj file (and it seems that the TFS 2005 merge tool doesn’t like that). Currently files are written as UTF-8, which is the default for VS2005 csproj files.">
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
	<link href="https://github.com/timvw" rel="me">
    <link href="https://timvw.be/" rel="me">
    <link href="https://fosstodon.org/@timvw" rel="me">
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://twitter.com/timvw" title="Twitter"><i data-feather="twitter"></i></a></li><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li><li><a rel="me" href="https://fosstodon.org/@timvw" class="masto-link" ></a></li>
			</ul>
		
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../../../">Home</a>
			</li>
			
			<li>
				<a href="../../../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../../../tags">Tags</a>
			</li>
			
			<li>
				<a href="../../../../about/">About Me</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">25</span>
							<span class="rest">Jan 2008</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Programming the csproj file</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Imagine that you have a couple of project files that reference framework libraries that are on a buildserver. Upgrading to a newer version requires that you update all the references&hellip; I wrote some wrapper classes (<a href="http://www.timvw.be/wp-content/code/csharp/ProjectFile.txt">ProjectFile</a>, <a href="http://www.timvw.be/wp-content/code/csharp/AssemblyReference.txt">AssemblyReference</a>) that make this tedious task a breeze. Here is an example of their usage</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">string</span> path <span style="color:#1f2328">=</span> <span style="color:#0a3069">&#34;D:\\Projects\\MyProject&#34;</span><span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">string</span><span style="color:#1f2328">[]</span> projectFileNames <span style="color:#1f2328">=</span> ProjectFile<span style="color:#1f2328">.</span>Find<span style="color:#1f2328">(</span>path<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">foreach</span> <span style="color:#1f2328">(</span><span style="color:#cf222e">string</span> projectFileName <span style="color:#cf222e">in</span> projectFileNames<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	ProjectFile projectFile <span style="color:#1f2328">=</span> <span style="color:#cf222e">new</span> ProjectFile<span style="color:#1f2328">(</span>projectFileName<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">bool</span> updated <span style="color:#1f2328">=</span> <span style="color:#cf222e">false</span><span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">foreach</span> <span style="color:#1f2328">(</span>AssemblyReference assemblyReference <span style="color:#cf222e">in</span> projectFile<span style="color:#1f2328">.</span>AssemblyReferences<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#cf222e">if</span> <span style="color:#1f2328">(</span>assemblyReference<span style="color:#1f2328">.</span>HintPath<span style="color:#1f2328">.</span>ToLower<span style="color:#1f2328">().</span>StartsWith<span style="color:#1f2328">(</span><span style="color:#0a3069">&#34;\\\\buildserver\\framework\\2.0&#34;</span><span style="color:#1f2328">))</span>
</span></span><span style="display:flex;"><span>		<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#cf222e">string</span> newHintPath <span style="color:#1f2328">=</span> assemblyReference<span style="color:#1f2328">.</span>HintPath<span style="color:#1f2328">.</span>Replace<span style="color:#1f2328">(</span><span style="color:#0a3069">&#34;\\2.0\\&#34;</span><span style="color:#1f2328">,</span> <span style="color:#0a3069">&#34;\\2.1\\&#34;</span><span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>			assemblyReference<span style="color:#1f2328">.</span>HintPath <span style="color:#1f2328">=</span> newHintPath<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			AssemblyName assemblyName <span style="color:#1f2328">=</span> AssemblyName<span style="color:#1f2328">.</span>GetAssemblyName<span style="color:#1f2328">(</span>assemblyReference<span style="color:#1f2328">.</span>HintPath<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>			assemblyReference<span style="color:#1f2328">.</span>AssemblyName <span style="color:#1f2328">=</span> assemblyName<span style="color:#1f2328">.</span>FullName <span style="color:#1f2328">+</span> <span style="color:#0a3069">&#34;, processorArchitecture=&#34;</span> <span style="color:#1f2328">+</span> assemblyName<span style="color:#1f2328">.</span>ProcessorArchitecture<span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			updated <span style="color:#1f2328">=</span> <span style="color:#cf222e">true</span><span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">if</span> <span style="color:#1f2328">(</span>updated<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>		projectFile<span style="color:#1f2328">.</span>Save<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span></code></pre></div><p><strong>Edit:</strong> Be careful because it might be possible that the code changes the encoding of your csproj file (and it seems that the TFS 2005 merge tool doesn&rsquo;t like that). Currently files are written as UTF-8, which is the default for VS2005 csproj files.</p>

			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../../../tags/csharp">CSharp</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2025  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-9DP4SV12YW');
        }
      </script><script>feather.replace()</script>
</body>
</html>
