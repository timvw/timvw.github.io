<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Updating Assembly References with TFS - Tim Van Wassenhove</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="Updating Assembly References with TFS"><meta itemprop=description content="A while ago i posted some code that allows you to update the Assembly references. Here is some code that uses the Team Foundation Server SDK that checks the csproj files out and updates their references. Afterwards it&rsquo;s possible to check the modified csproj files in with a reference to a WorkItem (or to undo the checkout in case no modifications were made).
static void Main() { string tfsServerName = &#34;tfsrtm08&#34;; string projectsPath = @&#34;D:\Projects&#34;; Console."><meta itemprop=datePublished content="2008-02-18T00:00:00+00:00"><meta itemprop=dateModified content="2021-01-04T22:47:36+01:00"><meta itemprop=wordCount content="281"><meta itemprop=keywords content="CSharp,"><meta property="og:title" content="Updating Assembly References with TFS"><meta property="og:description" content="A while ago i posted some code that allows you to update the Assembly references. Here is some code that uses the Team Foundation Server SDK that checks the csproj files out and updates their references. Afterwards it&rsquo;s possible to check the modified csproj files in with a reference to a WorkItem (or to undo the checkout in case no modifications were made).
static void Main() { string tfsServerName = &#34;tfsrtm08&#34;; string projectsPath = @&#34;D:\Projects&#34;; Console."><meta property="og:type" content="article"><meta property="og:url" content="https://timvw.be/2008/02/18/updating-assembly-references-with-tfs/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2008-02-18T00:00:00+00:00"><meta property="article:modified_time" content="2021-01-04T22:47:36+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Updating Assembly References with TFS"><meta name=twitter:description content="A while ago i posted some code that allows you to update the Assembly references. Here is some code that uses the Team Foundation Server SDK that checks the csproj files out and updates their references. Afterwards it&rsquo;s possible to check the modified csproj files in with a reference to a WorkItem (or to undo the checkout in case no modifications were made).
static void Main() { string tfsServerName = &#34;tfsrtm08&#34;; string projectsPath = @&#34;D:\Projects&#34;; Console."><link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel=stylesheet type=text/css><link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://timvw.be/css/dark.css><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script>
<script src=https://timvw.be/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://timvw.be/>Tim Van Wassenhove</a></h1><div class=site-description><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social"><ul class=flat><li><a href=https://twitter.com/timvw title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://github.com/timvw title=Github><i data-feather=github></i></a></li><li><a href=https://www.linkedin.com/in/timvanwassenhove title=Linkedin><i data-feather=linkedin></i></a></li><li><a href=https://timvw.be/feed.xml title=RSS><i data-feather=rss></i></a></li></ul></nav></div><nav class=nav><ul class=flat><li><a href=../../../../>Home</a></li><li><a href=../../../../posts>All posts</a></li><li><a href=../../../../tags>Tags</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>18</span>
<span class=rest>Feb 2008</span></div></div><div class=matter><h1 class=title>Updating Assembly References with TFS</h1></div></div><div class=markdown><p>A while ago i <a href=http://www.timvw.be/programming-the-csproj-file/>posted some code that allows you to update the Assembly references</a>. Here is some code that uses the <a href=http://msdn2.microsoft.com/en-us/library/bb130146(VS.80).aspx>Team Foundation Server SDK</a> that checks the csproj files out and updates their references. Afterwards it&rsquo;s possible to check the modified csproj files in with a reference to a WorkItem (or to undo the checkout in case no modifications were made).</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#000;font-weight:700>static</span> <span style=color:#000;font-weight:700>void</span> Main()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#458;font-weight:700>string</span> tfsServerName = <span style=color:#d14>&#34;tfsrtm08&#34;</span>;
</span></span><span style=display:flex><span>	<span style=color:#458;font-weight:700>string</span> projectsPath = <span style=color:#d14>@&#34;D:\Projects&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	Console.WriteLine( <span style=color:#d14>&#34;Connecting to TFS [&#34;</span> + tfsServerName + <span style=color:#d14>&#34;]...&#34;</span> );
</span></span><span style=display:flex><span>	TeamFoundationServer teamFoundationServer = TeamFoundationServerFactory.GetServer( tfsServerName );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	Console.WriteLine( Environment.NewLine + <span style=color:#d14>&#34;Modified ProjectFiles:&#34;</span> );
</span></span><span style=display:flex><span>	List&lt;workspace&gt; workSpacesWithUpdatedProjectFiles = UpdateReferencesInProjectFiles( teamFoundationServer, projectsPath );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	Console.WriteLine( Environment.NewLine + <span style=color:#d14>&#34;Modified Workspaces: &#34;</span> );
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>foreach</span>( Workspace workSpace <span style=color:#000;font-weight:700>in</span> workSpacesWithUpdatedProjectFiles )
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		Console.WriteLine( workSpace.Name );
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#998;font-style:italic>//int workItemId = -1;</span>
</span></span><span style=display:flex><span>	<span style=color:#998;font-style:italic>//CheckInPendingChanges( teamFoundationServer, workItemId, workSpacesWithUpdatedProjectFiles );</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	Console.Write( <span style=color:#d14>&#34;{0}Press any key to continue...&#34;</span>, Environment.NewLine );
</span></span><span style=display:flex><span>	Console.ReadKey();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>private</span> <span style=color:#000;font-weight:700>static</span> List&lt;workspace&gt; UpdateReferencesInProjectFiles( TeamFoundationServer teamFoundationServer, <span style=color:#458;font-weight:700>string</span> projectsPath )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	VersionControlServer versionControlServer = (VersionControlServer) teamFoundationServer.GetService( <span style=color:#000;font-weight:700>typeof</span>( VersionControlServer ) );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	List&lt;workspace&gt; workSpacesWithUpdatedProjectFiles = <span style=color:#000;font-weight:700>new</span> List&lt;workspace&gt;();
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>foreach</span>( <span style=color:#458;font-weight:700>string</span> projectFileName <span style=color:#000;font-weight:700>in</span> ProjectFile.Find( projectsPath ) )
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		Workspace workSpace = versionControlServer.GetWorkspace( Path.GetFullPath( projectFileName ) );
</span></span><span style=display:flex><span>		workSpace.PendEdit( projectFileName );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>if</span>( UpdateReferencesInProjectFile( projectFileName ) )
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			Console.WriteLine( projectFileName );
</span></span><span style=display:flex><span>			<span style=color:#000;font-weight:700>if</span>( !workSpacesWithUpdatedProjectFiles.Contains( workSpace ) )
</span></span><span style=display:flex><span>			{
</span></span><span style=display:flex><span>				workSpacesWithUpdatedProjectFiles.Add( workSpace );
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#000;font-weight:700>else</span>
</span></span><span style=display:flex><span>		{
</span></span><span style=display:flex><span>			workSpace.Undo( projectFileName );
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>return</span> workSpacesWithUpdatedProjectFiles;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000;font-weight:700>private</span> <span style=color:#000;font-weight:700>static</span> <span style=color:#000;font-weight:700>void</span> CheckInPendingChanges( TeamFoundationServer teamFoundationServer, <span style=color:#458;font-weight:700>int</span> workItemId, List&lt;workspace&gt; workSpacesWithUpdatedProjectFiles )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	WorkItemStore workItemStore = (WorkItemStore) teamFoundationServer.GetService( <span style=color:#000;font-weight:700>typeof</span>( WorkItemStore ) );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	WorkItem workItem = workItemStore.GetWorkItem( workItemId );
</span></span><span style=display:flex><span>	WorkItemCheckinInfo[] workItemChanges = <span style=color:#000;font-weight:700>new</span> WorkItemCheckinInfo[] { <span style=color:#000;font-weight:700>new</span> WorkItemCheckinInfo( workItem, WorkItemCheckinAction.Associate ) };
</span></span><span style=display:flex><span>	<span style=color:#000;font-weight:700>foreach</span>( Workspace workSpace <span style=color:#000;font-weight:700>in</span> workSpacesWithUpdatedProjectFiles )
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span>		PendingChange[] pendingChanges = workSpace.GetPendingChanges();
</span></span><span style=display:flex><span>		workSpace.CheckIn( pendingChanges, <span style=color:#458;font-weight:700>string</span>.Empty, <span style=color:#000;font-weight:700>null</span>, workItemChanges, <span style=color:#000;font-weight:700>null</span> );
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Feel free to download the code: <a href=http://www.timvw.be/wp-content/code/csharp/ReferenceManager.zip>ReferenceManager.zip</a>.</p></div><div class=tags><ul class=flat><li><a href=../../../../tags/csharp>CSharp</a></li></ul></div></div></div><div class="footer wrapper"><nav class=nav><div>2022 <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div></nav></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9DP4SV12YW",{anonymize_ip:!1})}</script><script>feather.replace()</script></body></html>