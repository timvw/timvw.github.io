<!doctype html><html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge"><title>Why MockRepository does not implement IDisposable - Tim Van Wassenhove</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta itemprop=name content="Why MockRepository does not implement IDisposable">
<meta itemprop=description content="Earlier this week i was experimenting with Rhino Mocks and i was wondering why the MockRepository does not implement IDisposable unlike most other mocking frameworks for .NET. After a bit of searching i found out that (here) originally the MockRepository did implement the interface, but that the implementation was removed because it is can be painful (hiding the original exception) when unexpected exceptions are thrown.
I really like the API. Here is a simple example and notice that i did not have to provide the method name (as in the string &ldquo;GetTime&rdquo;) for the excepted calls."><meta itemprop=datePublished content="2008-09-26T00:00:00+00:00">
<meta itemprop=dateModified content="2021-01-04T22:47:36+01:00">
<meta itemprop=wordCount content="176">
<meta itemprop=keywords content="CSharp,"><meta property="og:title" content="Why MockRepository does not implement IDisposable">
<meta property="og:description" content="Earlier this week i was experimenting with Rhino Mocks and i was wondering why the MockRepository does not implement IDisposable unlike most other mocking frameworks for .NET. After a bit of searching i found out that (here) originally the MockRepository did implement the interface, but that the implementation was removed because it is can be painful (hiding the original exception) when unexpected exceptions are thrown.
I really like the API. Here is a simple example and notice that i did not have to provide the method name (as in the string &ldquo;GetTime&rdquo;) for the excepted calls.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://timvw.be/2008/09/26/why-mockrepository-does-not-implement-idisposable/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2008-09-26T00:00:00+00:00">
<meta property="article:modified_time" content="2021-01-04T22:47:36+01:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Why MockRepository does not implement IDisposable">
<meta name=twitter:description content="Earlier this week i was experimenting with Rhino Mocks and i was wondering why the MockRepository does not implement IDisposable unlike most other mocking frameworks for .NET. After a bit of searching i found out that (here) originally the MockRepository did implement the interface, but that the implementation was removed because it is can be painful (hiding the original exception) when unexpected exceptions are thrown.
I really like the API. Here is a simple example and notice that i did not have to provide the method name (as in the string &ldquo;GetTime&rdquo;) for the excepted calls.">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700" rel=stylesheet type=text/css>
<link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/normalize.css>
<link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/main.css>
<link id=dark-scheme rel=stylesheet type=text/css href=https://timvw.be/css/dark.css>
<script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script>
<script src=https://timvw.be/js/main.js></script>
</head>
<body>
<div class="container wrapper">
<div class=header>
<h1 class=site-title><a href=https://timvw.be/>Tim Van Wassenhove</a></h1>
<div class=site-description><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
<ul class=flat><li><a href=https://twitter.com/timvw title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://github.com/timvw title=Github><i data-feather=github></i></a></li><li><a href=https://www.linkedin.com/in/timvanwassenhove title=Linkedin><i data-feather=linkedin></i></a></li><li><a href=https://timvw.be/feed.xml title=RSS><i data-feather=rss></i></a></li></ul>
</nav>
</div>
<nav class=nav>
<ul class=flat>
<li>
<a href=../../../../>Home</a>
</li>
<li>
<a href=../../../../posts>All posts</a>
</li>
<li>
<a href=../../../../tags>Tags</a>
</li>
</ul>
</nav>
</div>
<div class=post>
<div class=post-header>
<div class=meta>
<div class=date>
<span class=day>26</span>
<span class=rest>Sep 2008</span>
</div>
</div>
<div class=matter>
<h1 class=title>Why MockRepository does not implement IDisposable</h1>
</div>
</div>
<div class=markdown>
<p>Earlier this week i was experimenting with <a href=http://ayende.com/projects/rhino-mocks.aspx>Rhino Mocks</a> and i was wondering why the MockRepository does not implement <a href=http://msdn.microsoft.com/en-us/library/system.idisposable.aspx>IDisposable</a> unlike most other mocking frameworks for .NET. After a bit of searching i found out that (<a href="http://groups.google.com/group/RhinoMocks/browse_thread/thread/c1a89f58d512d03e/48ca85746276c97b?lnk=gst&q=idisposable+mockrepository&pli=1">here</a>) originally the MockRepository did implement the interface, but that the implementation was removed because it is can be painful (hiding the original exception) when unexpected exceptions are thrown.</p>
<p>I really like the API. Here is a simple example and notice that i did not have to provide the method name (as in the string &ldquo;GetTime&rdquo;) for the excepted calls.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=color:teal>[TestClass]</span>
<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>class</span> <span style=color:#458;font-weight:700>WhenTestingApplicabilityOfContract</span>
{
	<span style=color:#000;font-weight:700>private</span> MockRepository repository;
<span style=color:teal>
</span><span style=color:teal>	[TestInitialize]</span>
	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>void</span> BeforeEachMethod()
	{
		<span style=color:#000;font-weight:700>this</span>.repository = <span style=color:#000;font-weight:700>new</span> MockRepository();
	}
<span style=color:teal>
</span><span style=color:teal>	[TestCleanup]</span>
	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>void</span> AfterEachMethod()
	{
		<span style=color:#000;font-weight:700>this</span>.repository.VerifyAll();
	}
<span style=color:teal>
</span><span style=color:teal>	[TestMethod]</span>
	<span style=color:#000;font-weight:700>public</span> <span style=color:#000;font-weight:700>void</span> ShouldReturnTrueWhenTimeInPeriodOfContract()
	{
		ITimeProvider provider = <span style=color:#000;font-weight:700>this</span>.repository.StrictMock&lt;itimeProvider&gt;();

		using(<span style=color:#000;font-weight:700>this</span>.repository.Record())
		{
			Expect.Call(provider.GetTime()).Return(<span style=color:#000;font-weight:700>new</span> DateTime(<span style=color:#099>2007</span>, <span style=color:#099>01</span>, <span style=color:#099>01</span>));
			Expect.Call(provider.GetTime()).Return(<span style=color:#000;font-weight:700>new</span> DateTime(<span style=color:#099>2008</span>, <span style=color:#099>01</span>, <span style=color:#099>01</span>));
			Expect.Call(provider.GetTime()).Return(<span style=color:#000;font-weight:700>new</span> DateTime(<span style=color:#099>2009</span>, <span style=color:#099>01</span>, <span style=color:#099>01</span>));
		}

		using(<span style=color:#000;font-weight:700>this</span>.repository.Playback())
		{
			Contract contract = <span style=color:#000;font-weight:700>new</span> Contract(provider, <span style=color:#000;font-weight:700>new</span> DateTime(<span style=color:#099>2008</span>, <span style=color:#099>01</span>, <span style=color:#099>01</span>), <span style=color:#000;font-weight:700>new</span> DateTime(<span style=color:#099>2008</span>, <span style=color:#099>12</span>, <span style=color:#099>31</span>));

			Assert.IsFalse(contract.IsApplicable(), <span style=color:#d14>&#34;not applicablein 2007&#34;</span>);
			Assert.IsTrue(contract.IsApplicable(), <span style=color:#d14>&#34;applicable in 2008&#34;</span>);
			Assert.IsFalse(contract.IsApplicable(), <span style=color:#d14>&#34;not applicable in 2009&#34;</span>);
		}
	}
}
</code></pre></div>
</div>
<div class=tags>
<ul class=flat>
<li><a href=../../../../tags/csharp>CSharp</a></li>
</ul>
</div></div>
</div>
<div class="footer wrapper">
<nav class=nav>
<div>2022 <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div>
</nav>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-9DP4SV12YW',{anonymize_ip:!1})}</script>
<script>feather.replace()</script>
</body>
</html>