<!doctype html><html>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge"><title>Presenting OneTimePasswordMembershipProvider - Tim Van Wassenhove</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta itemprop=name content="Presenting OneTimePasswordMembershipProvider">
<meta itemprop=description content="What good is a TimeOTP client if you don&rsquo;t have anything to use it with? Last week i have implemented a MembershipProvider that uses Time-based One-Time Password to validate the user credentials. Basically, it is a wrapper around an existing MembershipProvider, you get to choose which one via the providerType attribute in the configuration, and requires that it can access the password of users. Here is an example configuration that relies on the SqlMembershipProvider"><meta itemprop=datePublished content="2008-08-29T00:00:00+00:00">
<meta itemprop=dateModified content="2021-01-04T22:47:36+01:00">
<meta itemprop=wordCount content="187">
<meta itemprop=keywords content="CSharp,"><meta property="og:title" content="Presenting OneTimePasswordMembershipProvider">
<meta property="og:description" content="What good is a TimeOTP client if you don&rsquo;t have anything to use it with? Last week i have implemented a MembershipProvider that uses Time-based One-Time Password to validate the user credentials. Basically, it is a wrapper around an existing MembershipProvider, you get to choose which one via the providerType attribute in the configuration, and requires that it can access the password of users. Here is an example configuration that relies on the SqlMembershipProvider">
<meta property="og:type" content="article">
<meta property="og:url" content="https://timvw.be/2008/08/29/presenting-onetimepasswordmembershipprovider/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2008-08-29T00:00:00+00:00">
<meta property="article:modified_time" content="2021-01-04T22:47:36+01:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Presenting OneTimePasswordMembershipProvider">
<meta name=twitter:description content="What good is a TimeOTP client if you don&rsquo;t have anything to use it with? Last week i have implemented a MembershipProvider that uses Time-based One-Time Password to validate the user credentials. Basically, it is a wrapper around an existing MembershipProvider, you get to choose which one via the providerType attribute in the configuration, and requires that it can access the password of users. Here is an example configuration that relies on the SqlMembershipProvider">
<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700" rel=stylesheet type=text/css>
<link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/normalize.css>
<link rel=stylesheet type=text/css media=screen href=https://timvw.be/css/main.css>
<link id=dark-scheme rel=stylesheet type=text/css href=https://timvw.be/css/dark.css>
<script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script>
<script src=https://timvw.be/js/main.js></script>
</head>
<body>
<div class="container wrapper">
<div class=header>
<h1 class=site-title><a href=https://timvw.be/>Tim Van Wassenhove</a></h1>
<div class=site-description><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
<ul class=flat><li><a href=https://twitter.com/timvw title=Twitter><i data-feather=twitter></i></a></li><li><a href=https://github.com/timvw title=Github><i data-feather=github></i></a></li><li><a href=https://www.linkedin.com/in/timvanwassenhove title=Linkedin><i data-feather=linkedin></i></a></li><li><a href=https://timvw.be/feed.xml title=RSS><i data-feather=rss></i></a></li></ul>
</nav>
</div>
<nav class=nav>
<ul class=flat>
<li>
<a href=../../../../>Home</a>
</li>
<li>
<a href=../../../../posts>All posts</a>
</li>
<li>
<a href=../../../../tags>Tags</a>
</li>
</ul>
</nav>
</div>
<div class=post>
<div class=post-header>
<div class=meta>
<div class=date>
<span class=day>29</span>
<span class=rest>Aug 2008</span>
</div>
</div>
<div class=matter>
<h1 class=title>Presenting OneTimePasswordMembershipProvider</h1>
</div>
</div>
<div class=markdown>
<p>What good is a <a href=http://www.timvw.be/presenting-timeotpclient/>TimeOTP</a> client if you don&rsquo;t have anything to use it with? Last week i have implemented a <a href=http://msdn.microsoft.com/en-us/library/system.web.security.membershipprovider.aspx>MembershipProvider</a> that uses <a href=http://www.timvw.be/presenting-hmac-based-otp-and-time-based-otp/>Time-based One-Time Password</a> to validate the user credentials. Basically, it is a wrapper around an existing MembershipProvider, you get to choose which one via the providerType attribute in the configuration, and requires that it can access the password of users. Here is an example configuration that relies on the SqlMembershipProvider</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=color:#999;font-weight:700;font-style:italic>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
<span style=color:navy>&lt;configuration&gt;</span>
	<span style=color:navy>&lt;connectionStrings&gt;</span>
		<span style=color:navy>&lt;add</span> <span style=color:teal>name=</span><span style=color:#d14>&#34;MyDatabase&#34;</span> <span style=color:teal>connectionString=</span><span style=color:#d14>&#34;xxxxx&#34;</span> <span style=color:teal>providerName=</span><span style=color:#d14>&#34;System.Data.SqlClient&#34;</span><span style=color:navy>/&gt;</span>
	<span style=color:navy>&lt;/connectionStrings&gt;</span>
	
	<span style=color:navy>&lt;system.web&gt;</span>
		<span style=color:navy>&lt;membership</span> <span style=color:teal>defaultProvider=</span><span style=color:#d14>&#34;OTPMembershipProvider&#34;</span><span style=color:navy>&gt;</span> <span style=color:navy>&lt;providers&gt;</span> <span style=color:navy>&lt;add</span> <span style=color:teal>connectionStringName=</span><span style=color:#d14>&#34;MyDatabase&#34;</span> <span style=color:teal>enablePasswordRetrieval=</span><span style=color:#d14>&#34;true&#34;</span> <span style=color:teal>enablePasswordReset=</span><span style=color:#d14>&#34;true&#34;</span> <span style=color:teal>requiresQuestionAndAnswer=</span><span style=color:#d14>&#34;false&#34;</span> <span style=color:teal>applicationName=</span><span style=color:#d14>&#34;/DemoOTP&#34;</span> <span style=color:teal>requiresUniqueEmail=</span><span style=color:#d14>&#34;false&#34;</span> <span style=color:teal>passwordFormat=</span><span style=color:#d14>&#34;Clear&#34;</span> <span style=color:teal>maxInvalidPasswordAttempts=</span><span style=color:#d14>&#34;5&#34;</span> <span style=color:teal>minRequiredPasswordLength=</span><span style=color:#d14>&#34;7&#34;</span> <span style=color:teal>minRequiredNonalphanumericCharacters=</span><span style=color:#d14>&#34;1&#34;</span> <span style=color:teal>passwordAttemptWindow=</span><span style=color:#d14>&#34;10&#34;</span> <span style=color:teal>passwordStrengthRegularExpression=</span><span style=color:#d14>&#34;&#34;</span> <span style=color:teal>name=</span><span style=color:#d14>&#34;OTPMembershipProvider&#34;</span> <span style=color:teal>type=</span><span style=color:#d14>&#34;Be.Timvw.Framework.Web.Security.OneTimePasswordMembershipProvider, Be.Timvw.Framework.Web&#34;</span> <span style=color:teal>providerType=</span><span style=color:#d14>&#34;System.Web.Security.SqlMembershipProvider, System.Web&#34;</span> <span style=color:navy>/&gt;</span> <span style=color:navy>&lt;/providers&gt;</span> <span style=color:navy>&lt;/membership&gt;</span>
		<span style=color:navy>&lt;authentication</span> <span style=color:teal>mode=</span><span style=color:#d14>&#34;Forms&#34;</span> <span style=color:navy>/&gt;</span>
		<span style=color:navy>&lt;authorization&gt;</span>
			<span style=color:navy>&lt;allow</span> <span style=color:teal>users=</span><span style=color:#d14>&#34;timvw&#34;</span><span style=color:navy>/&gt;</span>
			<span style=color:navy>&lt;deny</span> <span style=color:teal>users=</span><span style=color:#d14>&#34;*&#34;</span><span style=color:navy>/&gt;</span>
		<span style=color:navy>&lt;/authorization&gt;</span>
	<span style=color:navy>&lt;/system.web&gt;</span>
<span style=color:navy>&lt;/configuration&gt;</span>
</code></pre></div><p>While i was writing unittests i ran into a couple of issues</p>
<ul>
<li><a href=http://www.nmock.org/>NMock</a> seemingly only works with interfaces so i had to rip out an interface out of the abstract base class and wrap that in a MockMembershipProvider.</li>
<li>Settings expectations for output parameters can be achieved with a SetNameParameterAction as described <a href=http://www.pashabitz.com/PermaLink,guid,02e35fa6-c729-43a8-85c3-8c05df7a4aa8.aspx>here</a>.</li>
</ul>
<p>Anyway, you can find the implementation of the MembershipProvider in <a href=http://www.codeplex.com/BeTimvwFramework>BeTimvwFramework</a> and <a href=http://www.timvw.be/wp-content/code/csharp/DemoOTP.zip>download the demo webapplication</a>.</p>
</div>
<div class=tags>
<ul class=flat>
<li><a href=../../../../tags/csharp>CSharp</a></li>
</ul>
</div></div>
</div>
<div class="footer wrapper">
<nav class=nav>
<div>2022 <a href=https://github.com/knadh/hugo-ink>Ink</a> theme on <a href=https://gohugo.io>Hugo</a></div>
</nav>
</div>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-9DP4SV12YW',{anonymize_ip:!1})}</script>
<script>feather.replace()</script>
</body>
</html>