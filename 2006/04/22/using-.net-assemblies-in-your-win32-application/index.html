<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Using .Net assemblies in your WIN32 application - Tim Van Wassenhove</title><meta name="viewport" content="width=device-width, initial-scale=1">
	
  <meta itemprop="name" content="Using .Net assemblies in your WIN32 application">
  <meta itemprop="description" content="Imagine that you’ve got an extensive codebase using WIN32/MFC and don’t want to give that up but on the other hand you’d like to take advantage of DOTNET classes then here’s a simple solution: First we write an Interface and an Implementation with C# as following
public interface IQuoteClient { String getQuote(); Boolean setQuote(String quote); } public class QuoteClient : IQuoteClient { // COM requires a parameterless constructor public QuoteClient() { ; } public string getQuote() { return String.Format&#34;quote&#34;;} public bool setQuote(string quote) { return true; } } Go the project Properties and check the “Make assembly COM-Visible” box which you find in the Application tab, Assembly Information. Then you go to the Build tab and check “Register for COM interop” box and at the Signing tab you check the “Sign the assembly” box and assign a key. Build the project.">
  <meta itemprop="datePublished" content="2006-04-22T00:00:00+00:00">
  <meta itemprop="dateModified" content="2021-01-04T22:47:36+01:00">
  <meta itemprop="wordCount" content="248">
  <meta itemprop="keywords" content="C&#43;&#43;"><meta property="og:url" content="https://timvw.be/2006/04/22/using-.net-assemblies-in-your-win32-application/">
  <meta property="og:site_name" content="Tim Van Wassenhove">
  <meta property="og:title" content="Using .Net assemblies in your WIN32 application">
  <meta property="og:description" content="Imagine that you’ve got an extensive codebase using WIN32/MFC and don’t want to give that up but on the other hand you’d like to take advantage of DOTNET classes then here’s a simple solution: First we write an Interface and an Implementation with C# as following
public interface IQuoteClient { String getQuote(); Boolean setQuote(String quote); } public class QuoteClient : IQuoteClient { // COM requires a parameterless constructor public QuoteClient() { ; } public string getQuote() { return String.Format&#34;quote&#34;;} public bool setQuote(string quote) { return true; } } Go the project Properties and check the “Make assembly COM-Visible” box which you find in the Application tab, Assembly Information. Then you go to the Build tab and check “Register for COM interop” box and at the Signing tab you check the “Sign the assembly” box and assign a key. Build the project.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2006-04-22T00:00:00+00:00">
    <meta property="article:modified_time" content="2021-01-04T22:47:36+01:00">
    <meta property="article:tag" content="C&#43;&#43;">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Using .Net assemblies in your WIN32 application">
  <meta name="twitter:description" content="Imagine that you’ve got an extensive codebase using WIN32/MFC and don’t want to give that up but on the other hand you’d like to take advantage of DOTNET classes then here’s a simple solution: First we write an Interface and an Implementation with C# as following
public interface IQuoteClient { String getQuote(); Boolean setQuote(String quote); } public class QuoteClient : IQuoteClient { // COM requires a parameterless constructor public QuoteClient() { ; } public string getQuote() { return String.Format&#34;quote&#34;;} public bool setQuote(string quote) { return true; } } Go the project Properties and check the “Make assembly COM-Visible” box which you find in the Application tab, Assembly Information. Then you go to the Build tab and check “Register for COM interop” box and at the Signing tab you check the “Sign the assembly” box and assign a key. Build the project.">
<link href='https://fonts.googleapis.com/css?family=Playfair+Display:700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://timvw.be/css/main.css" />

        <link id="dark-scheme" rel="stylesheet" type="text/css" href="https://timvw.be/css/dark.css" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
		<script src="https://timvw.be/js/main.js"></script>
	<link href="https://github.com/timvw" rel="me">
    <link href="https://timvw.be/" rel="me">
    <link href="https://fosstodon.org/@timvw" rel="me">
</head>

<body>
	<div class="container wrapper">
		<div class="header">
	
	<h1 class="site-title"><a href="https://timvw.be/">Tim Van Wassenhove</a></h1>
	<div class="site-description"><p>Passionate geek, interested in Technology. Proud father of two</p><nav class="nav social">
			<ul class="flat"><li><a href="https://github.com/timvw" title="Github"><i data-feather="github"></i></a></li><li><a href="https://www.linkedin.com/in/timvanwassenhove" title="Linkedin"><i data-feather="linkedin"></i></a></li><li><a href="https://timvw.be/feed.xml" title="RSS"><i data-feather="rss"></i></a></li><li><a rel="me" href="https://fosstodon.org/@timvw" class="masto-link" ></a></li>
			</ul>
		
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="../../../../">Home</a>
			</li>
			
			<li>
				<a href="../../../../posts">All posts</a>
			</li>
			
			<li>
				<a href="../../../../tags">Tags</a>
			</li>
			
			<li>
				<a href="../../../../contact/">Contact</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post">
			<div class="post-header">
				
					<div class="meta">
						<div class="date">
							<span class="day">22</span>
							<span class="rest">Apr 2006</span>
						</div>
					</div>
				
				<div class="matter">
					<h1 class="title">Using .Net assemblies in your WIN32 application</h1>
				</div>
			</div>
					
			<div class="markdown">
				<p>Imagine that you&rsquo;ve got an extensive codebase using WIN32/MFC and don&rsquo;t want to give that up but on the other hand you&rsquo;d like to take advantage of DOTNET classes then here&rsquo;s a simple solution: First we write an Interface and an Implementation with C# as following</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#cf222e">public</span> <span style="color:#cf222e">interface</span> <span style="color:#1f2328">IQuoteClient</span> <span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	String getQuote<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	Boolean setQuote<span style="color:#1f2328">(</span>String quote<span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">public</span> <span style="color:#cf222e">class</span> <span style="color:#1f2328">QuoteClient</span> <span style="color:#1f2328">:</span> IQuoteClient <span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#57606a">// COM requires a parameterless constructor</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> QuoteClient<span style="color:#1f2328">()</span> <span style="color:#1f2328">{</span> <span style="color:#1f2328">;</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">string</span> getQuote<span style="color:#1f2328">()</span> <span style="color:#1f2328">{</span> <span style="color:#cf222e">return</span> String<span style="color:#1f2328">.</span>Format<span style="color:#0a3069">&#34;quote&#34;</span><span style="color:#1f2328">;}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">public</span> <span style="color:#cf222e">bool</span> setQuote<span style="color:#1f2328">(</span><span style="color:#cf222e">string</span> quote<span style="color:#1f2328">)</span> <span style="color:#1f2328">{</span> <span style="color:#cf222e">return</span> <span style="color:#cf222e">true</span><span style="color:#1f2328">;</span> <span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span></code></pre></div><p>Go the project Properties and check the &ldquo;Make assembly COM-Visible&rdquo; box which you find in the Application tab, Assembly Information. Then you go to the Build tab and check &ldquo;Register for COM interop&rdquo; box and at the Signing tab you check the &ldquo;Sign the assembly&rdquo; box and assign a key. Build the project.</p>
<p>Now we have to extract a typelibrary, register the typelibrary and install it in the global assembly cache. Open a Visual Studio 2005 Command Prompt and go to your project\bin\Debug directory. Type the following commands</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tlbexp QuoteClient.dll
</span></span><span style="display:flex;"><span>regasm QuoteClient.dll /tlb:QuoteClient.tlb
</span></span><span style="display:flex;"><span>gacutil /i QuoteClient.dll
</span></span></code></pre></div><p>Now you can import the classes in this assembly from your WIN32 application as following</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#57606a">#import &#34;C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\mscorlib.tlb&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#57606a">#import &#34;D:\projects\Test\QuoteClient\bin\Debug\ClientLibrary.tlb&#34; no_namespace named_guids
</span></span></span></code></pre></div><p>And you can use them just like any other COM component</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>CoInitialize<span style="color:#1f2328">(</span><span style="color:#6639ba">NULL</span><span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>IQuoteClient <span style="color:#0550ae">*</span>qc <span style="color:#0550ae">=</span> <span style="color:#6639ba">NULL</span><span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span>HRESULT hr <span style="color:#0550ae">=</span> CoCreateInstance<span style="color:#1f2328">(</span>
</span></span><span style="display:flex;"><span>	CLSID_QuoteClient<span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#6639ba">NULL</span><span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>	CLSCTX_INPROC_SERVER<span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>	IID_IQuoteClient<span style="color:#1f2328">,</span>
</span></span><span style="display:flex;"><span>	<span style="color:#cf222e">reinterpret_cast</span><span style="color:#0550ae">&lt;</span><span style="color:#cf222e">void</span><span style="color:#0550ae">**&gt;</span><span style="color:#1f2328">(</span><span style="color:#0550ae">&amp;</span>qc<span style="color:#1f2328">)</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#cf222e">if</span> <span style="color:#1f2328">(</span>SUCCEEDED<span style="color:#1f2328">(</span>hr<span style="color:#1f2328">))</span> <span style="color:#1f2328">{</span>
</span></span><span style="display:flex;"><span>	cout <span style="color:#0550ae">&lt;&lt;</span> <span style="color:#0a3069">&#34;Quote: &#34;</span> <span style="color:#0550ae">&lt;&lt;</span> qc<span style="color:#0550ae">-&gt;</span>getQuote<span style="color:#1f2328">()</span> <span style="color:#0550ae">&lt;&lt;</span> endl<span style="color:#1f2328">;</span> qc<span style="color:#0550ae">-&gt;</span>Release<span style="color:#1f2328">();</span>
</span></span><span style="display:flex;"><span>	qc <span style="color:#0550ae">=</span> <span style="color:#6639ba">NULL</span><span style="color:#1f2328">;</span>
</span></span><span style="display:flex;"><span><span style="color:#1f2328">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CoUninitialize<span style="color:#1f2328">();</span>
</span></span></code></pre></div>
			</div>

			<div class="tags">
				
					
						<ul class="flat">
							
							<li><a href="../../../../tags/c&#43;&#43;">C&#43;&#43;</a></li>
							
						</ul>
					
				
			</div></div>
	</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div>2025  <a href="https://github.com/knadh/hugo-ink">Ink</a> theme on <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-9DP4SV12YW"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-9DP4SV12YW');
        }
      </script><script>feather.replace()</script>
</body>
</html>
